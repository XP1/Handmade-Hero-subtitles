1
00:00:00,170 --> 00:00:05,040
hello everyone and welcome to hand made

2
00:00:03,149 --> 00:00:08,669
here on the show Rico to complete game

3
00:00:05,040 --> 00:00:10,559
live on twitch no engine no libraries we

4
00:00:08,669 --> 00:00:13,259
take care of absolutely everything here

5
00:00:10,558 --> 00:00:16,138
it's it's the full shebang it's like

6
00:00:13,259 --> 00:00:18,660
it's like from that time when the

7
00:00:16,138 --> 00:00:21,000
universe was entirely collapsed into a

8
00:00:18,660 --> 00:00:26,339
little tiny point and then it suddenly

9
00:00:21,000 --> 00:00:29,039
exploded into being that is really what

10
00:00:26,339 --> 00:00:31,948
you're witnessing here on handmade hero

11
00:00:29,039 --> 00:00:34,649
now yesterday we saw something very

12
00:00:31,949 --> 00:00:36,840
unusual happen it has never really

13
00:00:34,649 --> 00:00:38,730
happened before on handmade hero and I

14
00:00:36,840 --> 00:00:41,280
don't have an explanation for it

15
00:00:38,729 --> 00:00:43,558
we covered lighting yesterday I just did

16
00:00:41,280 --> 00:00:45,329
a brief introduction to lighting and not

17
00:00:43,558 --> 00:00:46,738
really even talking very much about any

18
00:00:45,329 --> 00:00:48,750
specific things but just kind of giving

19
00:00:46,738 --> 00:00:50,820
the broad overview of how light works

20
00:00:48,750 --> 00:00:52,320
and how you have to sort of start

21
00:00:50,820 --> 00:00:56,159
thinking about it in terms of

22
00:00:52,320 --> 00:01:00,000
programming graphics and somehow during

23
00:00:56,159 --> 00:01:02,640
the QA we had literally dozens of

24
00:01:00,000 --> 00:01:05,010
completely on topic very specific

25
00:01:02,640 --> 00:01:06,840
lighting questions normally we you know

26
00:01:05,010 --> 00:01:07,920
we do get some on topic specific

27
00:01:06,840 --> 00:01:09,478
questions but a lot of times the

28
00:01:07,920 --> 00:01:11,549
questions are just floods of off-topic

29
00:01:09,478 --> 00:01:13,650
questions or things like this something

30
00:01:11,549 --> 00:01:16,740
about lighting is obviously magical and

31
00:01:13,650 --> 00:01:19,290
people are interested in it so I am

32
00:01:16,739 --> 00:01:20,938
delighted to see that I do not know why

33
00:01:19,290 --> 00:01:25,350
it is but I feel like we might as well

34
00:01:20,938 --> 00:01:27,779
just run with that since we have to

35
00:01:25,349 --> 00:01:29,219
implement some lighting so today I'd

36
00:01:27,780 --> 00:01:31,290
like to build on what we talked about

37
00:01:29,219 --> 00:01:32,849
yesterday I'd like to take a little bit

38
00:01:31,290 --> 00:01:34,680
of time on the blackboard to explain to

39
00:01:32,849 --> 00:01:37,048
you how normal map lighting works and

40
00:01:34,680 --> 00:01:39,540
I'd like to go write it in our engine so

41
00:01:37,049 --> 00:01:41,670
that we can see how it actually gets

42
00:01:39,540 --> 00:01:42,990
coated because it's really not actually

43
00:01:41,670 --> 00:01:45,450
that complicated at the end of the day

44
00:01:42,989 --> 00:01:47,548
you can obviously go nuts with any

45
00:01:45,450 --> 00:01:49,159
lighting thing by keeping trying to get

46
00:01:47,549 --> 00:01:51,540
more and more accurate or more and more

47
00:01:49,159 --> 00:01:52,890
fancy but just to get the basics of

48
00:01:51,540 --> 00:01:54,630
normal map lighting in is actually

49
00:01:52,890 --> 00:01:55,890
pretty straightforward so we should be

50
00:01:54,629 --> 00:01:59,789
able to show how to do that in

51
00:01:55,890 --> 00:02:01,649
relatively small amount of time so that

52
00:01:59,790 --> 00:02:03,149
said I just remind everyone if you have

53
00:02:01,649 --> 00:02:05,009
pre-ordered the game on handmade hero

54
00:02:03,149 --> 00:02:09,538
org and you want to follow along with

55
00:02:05,009 --> 00:02:11,068
today it's day 97 so unzip day 76 is

56
00:02:09,538 --> 00:02:13,679
source code from the pre-order pack

57
00:02:11,068 --> 00:02:18,089
there and that will put

58
00:02:13,680 --> 00:02:19,379
right where I am today so we really

59
00:02:18,090 --> 00:02:20,640
didn't do anything yesterday we were

60
00:02:19,378 --> 00:02:22,048
only talking about lighting and

61
00:02:20,639 --> 00:02:25,169
hopefully everyone is sort of on the

62
00:02:22,049 --> 00:02:27,989
same page at least to a basic extent

63
00:02:25,169 --> 00:02:29,818
with how lighting works and what I'd

64
00:02:27,989 --> 00:02:32,009
like to talk about today is how we're

65
00:02:29,818 --> 00:02:34,560
going to implement normal map lighting

66
00:02:32,009 --> 00:02:37,348
what a normal map actually is in you

67
00:02:34,560 --> 00:02:39,569
know sort of at the lowest level and how

68
00:02:37,348 --> 00:02:41,548
we actually gonna do computations on it

69
00:02:39,568 --> 00:02:44,429
all right and I'll try to keep this

70
00:02:41,549 --> 00:02:46,169
hopefully if I'm if I'm concise here I

71
00:02:44,430 --> 00:02:47,790
can keep this to thirty minutes so that

72
00:02:46,169 --> 00:02:49,379
we'll have 30 minutes to actually code

73
00:02:47,789 --> 00:02:52,229
it because it will take a while for us

74
00:02:49,378 --> 00:02:53,548
to just get you know the flow proper

75
00:02:52,229 --> 00:02:56,068
there's there's some structural code

76
00:02:53,549 --> 00:02:59,669
that has to happen all right so we're on

77
00:02:56,068 --> 00:03:03,598
day 97 yes we are so here we go this is

78
00:02:59,669 --> 00:03:05,159
normal maps a very simple explanation of

79
00:03:03,598 --> 00:03:07,709
how we're going to do the lighting here

80
00:03:05,158 --> 00:03:09,899
all right so what I talked about

81
00:03:07,709 --> 00:03:12,900
yesterday was I talked a lot about how

82
00:03:09,900 --> 00:03:15,239
you have surfaces in the world and you

83
00:03:12,900 --> 00:03:17,789
have light sources and the light sources

84
00:03:15,239 --> 00:03:19,530
shine light on the surface and then if

85
00:03:17,789 --> 00:03:21,090
you want to talk about what the light

86
00:03:19,530 --> 00:03:22,620
does when it hits a particular point in

87
00:03:21,090 --> 00:03:24,539
the surface you need to know the

88
00:03:22,620 --> 00:03:25,769
direction that that light was coming

89
00:03:24,539 --> 00:03:28,108
from and you also need to know the

90
00:03:25,769 --> 00:03:32,639
direction that you are trying to observe

91
00:03:28,109 --> 00:03:35,849
the light from okay and what I was sort

92
00:03:32,639 --> 00:03:37,109
of working through yesterday when I when

93
00:03:35,848 --> 00:03:38,429
I talked about all of these sorts of

94
00:03:37,109 --> 00:03:41,519
effects of lighting and all that sort of

95
00:03:38,430 --> 00:03:44,009
thing was I was saying well you know the

96
00:03:41,519 --> 00:03:45,870
the way that a surface looks how it

97
00:03:44,008 --> 00:03:47,878
appears like what kind of a surface does

98
00:03:45,870 --> 00:03:50,129
it look shiny does it look dull does it

99
00:03:47,878 --> 00:03:52,679
look wet does it look choppy and all

100
00:03:50,128 --> 00:03:55,888
these sorts of things has to do with the

101
00:03:52,680 --> 00:03:58,169
shape that the lighting ends up taking

102
00:03:55,889 --> 00:03:59,040
when you look at for any given angle

103
00:03:58,169 --> 00:04:01,169
that comes in

104
00:03:59,039 --> 00:04:02,578
what sort of the brightnesses are that

105
00:04:01,169 --> 00:04:05,969
are reflected out in all the other

106
00:04:02,579 --> 00:04:08,159
directions right and what's implicit in

107
00:04:05,969 --> 00:04:10,620
all of that and why normal maps are such

108
00:04:08,158 --> 00:04:12,899
an important thing in graphics or even I

109
00:04:10,620 --> 00:04:14,759
should say just the normal the concept

110
00:04:12,900 --> 00:04:16,530
of a normal is so important in graphics

111
00:04:14,758 --> 00:04:18,149
that the map part is just how we are

112
00:04:16,529 --> 00:04:19,978
assigning them in a particular case with

113
00:04:18,149 --> 00:04:22,199
the normal the reason that's so

114
00:04:19,978 --> 00:04:23,759
important is all of that discussion that

115
00:04:22,199 --> 00:04:25,709
whole discussion yesterday was all

116
00:04:23,759 --> 00:04:27,569
assuming an implicit thing that

117
00:04:25,709 --> 00:04:29,989
never mentioned because we're gonna get

118
00:04:27,569 --> 00:04:33,660
to it today which is that you know the

119
00:04:29,990 --> 00:04:36,960
orientation of the surface okay that

120
00:04:33,660 --> 00:04:38,430
bounce that happens again just like I

121
00:04:36,959 --> 00:04:41,549
think I used the description of a ball

122
00:04:38,430 --> 00:04:44,788
bouncing off a wall you can only really

123
00:04:41,550 --> 00:04:46,348
compute those brightness probabilities

124
00:04:44,788 --> 00:04:48,360
those those ways that the brightest are

125
00:04:46,348 --> 00:04:51,060
propagated if you actually know the

126
00:04:48,360 --> 00:04:53,370
angle that the surface is at relative to

127
00:04:51,060 --> 00:04:55,500
these things because again that function

128
00:04:53,370 --> 00:04:57,720
that says you know how bright like if

129
00:04:55,500 --> 00:05:00,180
this is the brightest that the surface

130
00:04:57,720 --> 00:05:02,250
reflects from this angle if that's the

131
00:05:00,180 --> 00:05:04,978
brightest and it gets duller here and

132
00:05:02,250 --> 00:05:07,168
very dull here right that function that

133
00:05:04,978 --> 00:05:10,319
we're trying to simulate is all based

134
00:05:07,168 --> 00:05:12,779
around this this normal here this angle

135
00:05:10,319 --> 00:05:14,639
of the light right and measuring that

136
00:05:12,779 --> 00:05:16,049
angle requires that I know the

137
00:05:14,639 --> 00:05:18,240
orientation of the surface if the

138
00:05:16,050 --> 00:05:20,550
surface was bent another way this would

139
00:05:18,240 --> 00:05:22,740
be a different angle and the lighting

140
00:05:20,550 --> 00:05:24,259
intensities would change because we

141
00:05:22,740 --> 00:05:29,759
would be talking about a different

142
00:05:24,259 --> 00:05:31,650
incidents to the surface right and so

143
00:05:29,759 --> 00:05:33,330
the reason the normal is so important is

144
00:05:31,649 --> 00:05:35,819
because the lighting equation again

145
00:05:33,329 --> 00:05:38,370
we're talking about little points that

146
00:05:35,819 --> 00:05:40,288
we're evaluating that here that sort of

147
00:05:38,370 --> 00:05:42,120
represent little infinitesimal areas

148
00:05:40,288 --> 00:05:43,579
that we're simulating in some sense or

149
00:05:42,120 --> 00:05:46,379
you might start thinking of them as like

150
00:05:43,579 --> 00:05:48,180
texels or pixels on the screen some area

151
00:05:46,379 --> 00:05:50,639
that you're simulating we're baking the

152
00:05:48,180 --> 00:05:52,709
surfaces orientation down into a single

153
00:05:50,639 --> 00:05:54,870
direction at that point which tells us

154
00:05:52,709 --> 00:05:57,658
how we're going to compute that bounce

155
00:05:54,870 --> 00:05:59,189
right and that direction is the normal

156
00:05:57,658 --> 00:06:02,430
and it's called a normal of course

157
00:05:59,189 --> 00:06:07,529
because it is unit length right it's a

158
00:06:02,430 --> 00:06:10,918
it's normalized right right it is a

159
00:06:07,529 --> 00:06:12,689
normalized vector so that normal the

160
00:06:10,918 --> 00:06:15,299
length of that normal is always one and

161
00:06:12,689 --> 00:06:17,579
it points in whatever direction you

162
00:06:15,300 --> 00:06:19,860
might say it's tangent to the surface at

163
00:06:17,579 --> 00:06:20,250
that point so if I have a surface in the

164
00:06:19,860 --> 00:06:22,949
world

165
00:06:20,250 --> 00:06:24,509
like this and I want to talk about what

166
00:06:22,949 --> 00:06:26,610
the normal is at a particular point

167
00:06:24,509 --> 00:06:29,340
we're talking about as if there was a

168
00:06:26,610 --> 00:06:32,729
plane that just sort of barely touched

169
00:06:29,339 --> 00:06:34,408
it escalated at that point what would be

170
00:06:32,728 --> 00:06:36,000
the that you know sort of the vector

171
00:06:34,408 --> 00:06:39,088
that points out perpendicular to that

172
00:06:36,000 --> 00:06:39,408
plane right and so like over here the

173
00:06:39,088 --> 00:06:40,968
norm

174
00:06:39,408 --> 00:06:42,348
would be pointing in this direction over

175
00:06:40,968 --> 00:06:43,998
here the normal way pointing this

176
00:06:42,348 --> 00:06:45,709
direction and you can kind of you know

177
00:06:43,999 --> 00:06:48,019
what this is intuitively it's just a

178
00:06:45,709 --> 00:06:50,749
vector that points directly straight out

179
00:06:48,019 --> 00:06:55,509
of the surface at that point that is the

180
00:06:50,749 --> 00:06:55,509
normal that we are talking about okay so

181
00:06:57,369 --> 00:07:02,269
what we want to be able to do is we want

182
00:07:00,139 --> 00:07:05,059
to be able to compute lighting based on

183
00:07:02,269 --> 00:07:08,658
this normal and what we're going to do

184
00:07:05,059 --> 00:07:10,909
with our normal Maps is we're going to

185
00:07:08,658 --> 00:07:13,788
do something very straightforward we're

186
00:07:10,908 --> 00:07:15,348
going to have essentially some notion

187
00:07:13,788 --> 00:07:17,300
right we need we need to have sort of

188
00:07:15,348 --> 00:07:20,178
two things if you will we need to have

189
00:07:17,300 --> 00:07:23,718
one a description of the surface right

190
00:07:20,178 --> 00:07:27,678
description of the surface that will

191
00:07:23,718 --> 00:07:29,800
tell us how we want to treat the light

192
00:07:27,678 --> 00:07:33,828
that bounces around this normal right

193
00:07:29,800 --> 00:07:37,908
and then - we need some equation in

194
00:07:33,829 --> 00:07:42,050
terms of the inputs that we have which

195
00:07:37,908 --> 00:07:48,399
is the normal to the surface the view

196
00:07:42,050 --> 00:07:52,218
direction right and the light direction

197
00:07:48,399 --> 00:07:54,199
we equation in these terms that will

198
00:07:52,218 --> 00:07:57,468
take the description of this surface and

199
00:07:54,199 --> 00:08:00,740
output a light value right you know some

200
00:07:57,468 --> 00:08:03,288
some light value which would be in our

201
00:08:00,740 --> 00:08:05,418
case maybe an RGB that's sort of what

202
00:08:03,288 --> 00:08:07,278
the color should be at this point right

203
00:08:05,418 --> 00:08:08,868
and there's some other stuff that's

204
00:08:07,278 --> 00:08:10,968
baked in here in addition description we

205
00:08:08,869 --> 00:08:12,829
would might also say maybe we say

206
00:08:10,968 --> 00:08:13,848
there's actually three things - we might

207
00:08:12,829 --> 00:08:16,939
want to say that there's a description

208
00:08:13,848 --> 00:08:18,378
of the light right because we're

209
00:08:16,939 --> 00:08:20,629
probably going to want to assume that

210
00:08:18,379 --> 00:08:22,369
lights have different sorts of things in

211
00:08:20,629 --> 00:08:24,259
there okay so that's pretty

212
00:08:22,369 --> 00:08:28,989
straightforward right so that's what we

213
00:08:24,259 --> 00:08:31,939
need to determine and so the first part

214
00:08:28,988 --> 00:08:33,860
or I should say the the easiest part of

215
00:08:31,939 --> 00:08:36,740
this the first thing we're going to do

216
00:08:33,860 --> 00:08:38,990
is in that equation the normal rank that

217
00:08:36,740 --> 00:08:41,870
is where the normal map thing comes in

218
00:08:38,990 --> 00:08:44,299
right we have a sprite we don't actually

219
00:08:41,870 --> 00:08:46,250
have surfaces right we have no such

220
00:08:44,299 --> 00:08:48,620
thing as that we have a sprite that

221
00:08:46,250 --> 00:08:51,528
somebody drew right they drew the tree

222
00:08:48,620 --> 00:08:53,029
in there right yangshin drew a tree and

223
00:08:51,528 --> 00:08:55,399
so there's no description of this

224
00:08:53,029 --> 00:08:57,350
services anywhere in here so what we

225
00:08:55,399 --> 00:09:01,340
need to have in addition to that if we

226
00:08:57,350 --> 00:09:02,570
want to ever compute this thing you know

227
00:09:01,340 --> 00:09:05,000
if we if we want to compute this whole

228
00:09:02,570 --> 00:09:06,320
set here this equation we need to know

229
00:09:05,000 --> 00:09:07,940
what that normal is and so what we're

230
00:09:06,320 --> 00:09:10,129
going to do is introduce this concept of

231
00:09:07,940 --> 00:09:11,900
a normal map and what the normal map is

232
00:09:10,129 --> 00:09:14,179
is it's something that sort of mirrors

233
00:09:11,899 --> 00:09:17,659
the sprite exactly but at every pixel

234
00:09:14,179 --> 00:09:19,669
instead of RGB we have the normal right

235
00:09:17,659 --> 00:09:22,610
so in here it's going to encode again

236
00:09:19,669 --> 00:09:25,339
this normal is a vector right yet points

237
00:09:22,610 --> 00:09:27,289
in the direction out of the surface it

238
00:09:25,340 --> 00:09:29,000
has a length of 1 which means that it is

239
00:09:27,289 --> 00:09:31,519
you know something where it's got an x

240
00:09:29,000 --> 00:09:33,649
squared or Y squared is Z squared right

241
00:09:31,519 --> 00:09:36,199
and the square root of them equals 1

242
00:09:33,649 --> 00:09:38,000
right it's a it's a normalized thing now

243
00:09:36,200 --> 00:09:40,190
what we know from that right is that we

244
00:09:38,000 --> 00:09:41,899
would only have to encode two of those

245
00:09:40,190 --> 00:09:44,000
values because we could always

246
00:09:41,899 --> 00:09:46,009
reconstruct the third one right because

247
00:09:44,000 --> 00:09:47,659
if we square both sides of this you end

248
00:09:46,009 --> 00:09:49,730
up with one equals x squared plus y

249
00:09:47,659 --> 00:09:51,259
squared plus Z squared right which means

250
00:09:49,730 --> 00:09:52,759
that if we wanted to solve for one of

251
00:09:51,259 --> 00:09:54,860
these let's say we don't want to store

252
00:09:52,759 --> 00:09:56,629
what the x squared term is for example

253
00:09:54,860 --> 00:09:58,879
or we don't want to score store what the

254
00:09:56,629 --> 00:10:00,500
Z squared term is something like that we

255
00:09:58,879 --> 00:10:04,429
can just solve for one of them so one

256
00:10:00,500 --> 00:10:06,379
minus x squared right if I move the

257
00:10:04,429 --> 00:10:09,679
extra the other side plus y square I'm

258
00:10:06,379 --> 00:10:13,189
sorry equals y squared plus Z squared

259
00:10:09,679 --> 00:10:15,439
right and I can move the one over and

260
00:10:13,190 --> 00:10:18,980
and the gate right so I can have x

261
00:10:15,440 --> 00:10:21,710
squared equals y squared plus Z squared

262
00:10:18,980 --> 00:10:23,659
oh sorry I said I wouldn't gate equals

263
00:10:21,710 --> 00:10:28,490
negative Y squared negative Z squared

264
00:10:23,659 --> 00:10:31,539
plus one right I can then square root

265
00:10:28,490 --> 00:10:35,000
both sides and end up with the actual

266
00:10:31,539 --> 00:10:37,579
equation negative y squared negative Z

267
00:10:35,000 --> 00:10:39,200
squared plus one under the radical and

268
00:10:37,580 --> 00:10:41,480
if I haven't done any math mistakes

269
00:10:39,200 --> 00:10:42,980
there which is pretty common but you can

270
00:10:41,480 --> 00:10:44,210
point out assuming that you didn't make

271
00:10:42,980 --> 00:10:45,920
any math mistakes when solving these

272
00:10:44,210 --> 00:10:47,900
equations you would end up with an

273
00:10:45,919 --> 00:10:50,029
equation for whichever variable you

274
00:10:47,899 --> 00:10:52,459
wanted in terms of the other ones right

275
00:10:50,029 --> 00:10:56,299
because this constraint that they have

276
00:10:52,460 --> 00:10:58,490
to sum to one in that way that basically

277
00:10:56,299 --> 00:11:01,490
tells you that you only have two real

278
00:10:58,490 --> 00:11:03,289
degrees of freedom here so if we want to

279
00:11:01,490 --> 00:11:05,210
at first we'll probably store all three

280
00:11:03,289 --> 00:11:06,620
but it's worth noting that if we want to

281
00:11:05,210 --> 00:11:08,180
we don't actually have to do that

282
00:11:06,620 --> 00:11:09,440
so first we'll start all three but we'll

283
00:11:08,179 --> 00:11:11,569
keep an eye on the fact that really

284
00:11:09,440 --> 00:11:13,460
that's wasteful and if we have spare

285
00:11:11,570 --> 00:11:15,290
cycles in there that we can fit it in

286
00:11:13,460 --> 00:11:17,960
certainly on the GPU we would probably

287
00:11:15,289 --> 00:11:19,399
have them we can reduce that but you

288
00:11:17,960 --> 00:11:21,350
know it depends it's always a trade-off

289
00:11:19,399 --> 00:11:25,009
whether you want to do this extra math

290
00:11:21,350 --> 00:11:27,290
here to sort of reconstruct it right so

291
00:11:25,009 --> 00:11:31,039
the normal map every Texel in the normal

292
00:11:27,289 --> 00:11:32,659
map is going to store the x y&amp;z of the

293
00:11:31,039 --> 00:11:36,379
value and we'll probably use the same

294
00:11:32,659 --> 00:11:38,480
encoding what 0 to 255 equals 0 to 1

295
00:11:36,379 --> 00:11:41,389
right so the same encoding that we were

296
00:11:38,480 --> 00:11:43,340
using for our for everything else

297
00:11:41,389 --> 00:11:45,319
for our RGB values we'll just use that

298
00:11:43,340 --> 00:11:47,149
to encode with the normal list and that

299
00:11:45,320 --> 00:11:49,400
means that when we are drawing a sprite

300
00:11:47,149 --> 00:11:51,949
at all times we always can get in

301
00:11:49,399 --> 00:11:55,340
addition to the RGB value we can also

302
00:11:51,950 --> 00:11:57,259
get what that normal was so this is

303
00:11:55,340 --> 00:11:58,910
actually really pretty easy except for

304
00:11:57,259 --> 00:12:00,830
the fact that there's an asset load on

305
00:11:58,909 --> 00:12:02,209
it it means that you know someone's got

306
00:12:00,830 --> 00:12:03,320
to produce these normal map set to get

307
00:12:02,210 --> 00:12:05,030
them from somewhere that's a separate

308
00:12:03,320 --> 00:12:07,250
issue though for actually doing

309
00:12:05,029 --> 00:12:12,350
computations we know we can just pull

310
00:12:07,250 --> 00:12:14,240
them out of the normal map okay so the

311
00:12:12,350 --> 00:12:15,560
rest of this stuff is where things get a

312
00:12:14,240 --> 00:12:18,200
little more complicated for us because

313
00:12:15,559 --> 00:12:20,000
again it's unclear exactly what we want

314
00:12:18,200 --> 00:12:21,980
to do to describe all of these

315
00:12:20,000 --> 00:12:24,559
additional things now what we would like

316
00:12:21,980 --> 00:12:26,600
to do probably is be able to simulate a

317
00:12:24,559 --> 00:12:27,949
little bit of different surface types

318
00:12:26,600 --> 00:12:29,060
right we'd like to be able to have some

319
00:12:27,950 --> 00:12:30,740
things that are shiny and some things

320
00:12:29,059 --> 00:12:33,229
that are dull probably right that might

321
00:12:30,740 --> 00:12:35,060
add some nice visual interest of things

322
00:12:33,230 --> 00:12:37,879
you know we don't know but it's just

323
00:12:35,059 --> 00:12:42,169
something to think about right and so

324
00:12:37,879 --> 00:12:43,730
you know if we were to to sort of

325
00:12:42,169 --> 00:12:46,279
conceptualize what's going to happen

326
00:12:43,730 --> 00:12:48,019
here when we are drawing these and we're

327
00:12:46,279 --> 00:12:50,149
going to draw something so we're taking

328
00:12:48,019 --> 00:12:52,370
the the - the sum of these guys here and

329
00:12:50,149 --> 00:12:53,959
we're producing what we're going to do

330
00:12:52,370 --> 00:12:55,639
for our lighting you know maybe we're

331
00:12:53,960 --> 00:12:57,530
drawing the upper part of this here and

332
00:12:55,639 --> 00:12:59,149
so we know you know the normal map of

333
00:12:57,529 --> 00:13:01,399
that says that it points off in this

334
00:12:59,149 --> 00:13:03,769
direction so we have the color the

335
00:13:01,399 --> 00:13:06,649
incoming color of the sprite we have

336
00:13:03,769 --> 00:13:08,929
that that directional vector and the

337
00:13:06,649 --> 00:13:10,909
question is what can we do with that

338
00:13:08,929 --> 00:13:12,829
directional vector that will give us the

339
00:13:10,909 --> 00:13:14,839
most bang for the buck in 2d since we

340
00:13:12,830 --> 00:13:16,280
know that we can't really do much in the

341
00:13:14,840 --> 00:13:18,379
way of realistic lighting since we don't

342
00:13:16,279 --> 00:13:20,659
have a 3d description of the scene and

343
00:13:18,379 --> 00:13:24,799
what I was sort of suggesting

344
00:13:20,659 --> 00:13:27,740
the the yesterday was maybe we could

345
00:13:24,799 --> 00:13:31,039
produce some sort of synthetic things

346
00:13:27,740 --> 00:13:34,009
that we could look up into using these

347
00:13:31,039 --> 00:13:35,748
these values to sort of cast against a

348
00:13:34,009 --> 00:13:37,519
fake version of the world that we

349
00:13:35,749 --> 00:13:39,800
construct which would allow us to

350
00:13:37,519 --> 00:13:42,259
produce lighting values at those points

351
00:13:39,799 --> 00:13:46,099
and so the first thing that I kind of

352
00:13:42,259 --> 00:13:47,539
want to say is you know I guess this is

353
00:13:46,100 --> 00:13:49,819
taken care of right description of the

354
00:13:47,539 --> 00:13:52,129
surface is the normal that's really all

355
00:13:49,818 --> 00:13:54,469
we're going to do there well that's not

356
00:13:52,129 --> 00:13:56,240
entirely true we still have to talk

357
00:13:54,470 --> 00:13:59,178
about what the parameters of this are

358
00:13:56,240 --> 00:14:01,428
the surface are going to be so let's say

359
00:13:59,178 --> 00:14:03,828
temporarily for this that all we're

360
00:14:01,428 --> 00:14:05,328
really going to do is for our surfaces

361
00:14:03,828 --> 00:14:08,269
the only real thing that we're going to

362
00:14:05,328 --> 00:14:11,539
say is like how glassy they are right

363
00:14:08,269 --> 00:14:13,879
how shiny this thing is right like how

364
00:14:11,539 --> 00:14:15,618
we'll sort of have some concept of how

365
00:14:13,879 --> 00:14:17,959
dull how shiny it is

366
00:14:15,619 --> 00:14:19,369
so maybe we'll start off by saying our

367
00:14:17,958 --> 00:14:21,558
description the surface is going to be

368
00:14:19,369 --> 00:14:24,649
like a zero to one value right

369
00:14:21,558 --> 00:14:26,990
where zero is is totally dull and this

370
00:14:24,649 --> 00:14:29,720
is like very reflective right so this is

371
00:14:26,990 --> 00:14:32,659
super shiny and we'll try to make that

372
00:14:29,720 --> 00:14:34,699
be something that we can control okay

373
00:14:32,659 --> 00:14:37,068
the description of the light is really

374
00:14:34,698 --> 00:14:39,258
the part now that we end up with having

375
00:14:37,068 --> 00:14:40,789
the problem which is well we could just

376
00:14:39,259 --> 00:14:43,039
have some lights floating in the world

377
00:14:40,789 --> 00:14:43,969
but I want to kind of do something or

378
00:14:43,039 --> 00:14:46,399
try to do something that's a little

379
00:14:43,970 --> 00:14:49,160
fancier than that and so I just try to

380
00:14:46,399 --> 00:14:50,659
think about what can I do that would be

381
00:14:49,159 --> 00:14:55,399
something that that would allow me to do

382
00:14:50,659 --> 00:15:01,100
interesting stuff there right so let's

383
00:14:55,399 --> 00:15:02,539
think about this suppose we had maybe

384
00:15:01,100 --> 00:15:03,860
let's say we were looking at a value

385
00:15:02,539 --> 00:15:06,678
that was pointing down towards the

386
00:15:03,860 --> 00:15:09,528
ground we could imagine looking at our

387
00:15:06,678 --> 00:15:15,019
ground chunks to see what the color was

388
00:15:09,528 --> 00:15:18,078
down there right - to say what that what

389
00:15:15,019 --> 00:15:20,089
you know would be seen by you know what

390
00:15:18,078 --> 00:15:23,208
light would be sort of hitting the

391
00:15:20,089 --> 00:15:25,459
bottoms of the tree right and similarly

392
00:15:23,208 --> 00:15:28,518
up here at the top when things are

393
00:15:25,458 --> 00:15:31,008
pointing upward we might imagine that a

394
00:15:28,519 --> 00:15:33,480
sky texture just some sky thing maybe

395
00:15:31,009 --> 00:15:35,970
that we have or a ceiling

396
00:15:33,480 --> 00:15:38,100
case of indoors might be sort of where

397
00:15:35,970 --> 00:15:41,519
the light was coming from there right

398
00:15:38,100 --> 00:15:43,110
and then stuff pointing sideways right

399
00:15:41,519 --> 00:15:45,570
stuff that's pointing sort of directly

400
00:15:43,110 --> 00:15:49,079
sideways is sort of looking at more

401
00:15:45,570 --> 00:15:51,290
stuff that's in the actual plane of the

402
00:15:49,078 --> 00:15:54,028
you know of the game at that at that

403
00:15:51,289 --> 00:15:55,588
area right that's the sort of stuff

404
00:15:54,028 --> 00:15:57,028
that's around it it's actually sort of

405
00:15:55,589 --> 00:15:59,250
reflecting out around there which

406
00:15:57,028 --> 00:16:01,019
suggests to me that maybe you know could

407
00:15:59,250 --> 00:16:06,089
we do something with some sort of a

408
00:16:01,019 --> 00:16:09,179
three plate scheme right could we do

409
00:16:06,089 --> 00:16:10,620
something where we have our ground which

410
00:16:09,179 --> 00:16:13,198
we already know that we had to produce

411
00:16:10,620 --> 00:16:16,769
so we've got that we could look up into

412
00:16:13,198 --> 00:16:18,929
it right could we do something where

413
00:16:16,769 --> 00:16:22,379
we've got our ground we've got a sky and

414
00:16:18,929 --> 00:16:23,969
then something we do here right and so

415
00:16:22,379 --> 00:16:25,799
what I'd like to suggest at first is

416
00:16:23,970 --> 00:16:27,449
maybe we just ignore the something

417
00:16:25,799 --> 00:16:29,490
ignore the stuff that's lateral because

418
00:16:27,448 --> 00:16:32,399
that's going to be hard and we'll focus

419
00:16:29,490 --> 00:16:36,240
on two of the three plates right so

420
00:16:32,399 --> 00:16:39,720
we'll have a above and we'll have a

421
00:16:36,240 --> 00:16:41,940
below right and we'll just use the above

422
00:16:39,720 --> 00:16:44,370
and the below as our things that we look

423
00:16:41,940 --> 00:16:45,720
up to get the lighting now again none of

424
00:16:44,370 --> 00:16:47,778
this is stuff that I'm saying

425
00:16:45,720 --> 00:16:51,060
definitively this is literally me

426
00:16:47,778 --> 00:16:54,809
hypothesizing what we might do to

427
00:16:51,059 --> 00:16:57,888
produce some sort of a useful lighting

428
00:16:54,809 --> 00:17:04,879
contribution for our game okay

429
00:16:57,889 --> 00:17:09,240
so what I propose is we will take our

430
00:17:04,880 --> 00:17:11,189
normal values here right and one of the

431
00:17:09,240 --> 00:17:13,798
parameters of our normal value right if

432
00:17:11,189 --> 00:17:15,540
we've got XY and Z well one of the

433
00:17:13,798 --> 00:17:17,279
values and it depends on how we choose

434
00:17:15,539 --> 00:17:18,990
to encode it but let's say that when

435
00:17:17,279 --> 00:17:23,250
we're encoding you know whether things

436
00:17:18,990 --> 00:17:25,740
point you know up or down right let's

437
00:17:23,250 --> 00:17:28,439
say that's encoded as a Z value or

438
00:17:25,740 --> 00:17:30,839
something well that means the Z value

439
00:17:28,439 --> 00:17:34,710
would essentially give us a blend

440
00:17:30,839 --> 00:17:38,009
between the above and below things to

441
00:17:34,710 --> 00:17:40,548
sample right meaning as we cross from

442
00:17:38,009 --> 00:17:42,990
pointing upwards to pointing downwards

443
00:17:40,548 --> 00:17:45,269
we would want to change which one we

444
00:17:42,990 --> 00:17:47,250
were sampling between and furthermore if

445
00:17:45,269 --> 00:17:49,559
we imagine the three plate version

446
00:17:47,250 --> 00:17:50,519
we'll we'll sort of talk about it being

447
00:17:49,559 --> 00:17:53,099
there for now

448
00:17:50,519 --> 00:17:57,480
we'll say we have a top a middle and a

449
00:17:53,099 --> 00:17:59,819
bottom let's say right if we just assume

450
00:17:57,480 --> 00:18:02,670
that this is just a uniform lighting for

451
00:17:59,819 --> 00:18:05,939
now right then we might say if you're at

452
00:18:02,670 --> 00:18:07,710
one point o in your you know in this

453
00:18:05,940 --> 00:18:09,470
encoding here and you know what I just

454
00:18:07,710 --> 00:18:13,250
realized

455
00:18:09,470 --> 00:18:15,870
for these values I think this I I

456
00:18:13,250 --> 00:18:18,119
misspoke here we probably don't want to

457
00:18:15,869 --> 00:18:20,219
use the same encoding because we want to

458
00:18:18,119 --> 00:18:25,079
be able to do positive and negative

459
00:18:20,220 --> 00:18:27,960
values right so really we probably want

460
00:18:25,079 --> 00:18:30,720
to say you know let's say we store X's

461
00:18:27,960 --> 00:18:34,769
and Y's here right we probably want to

462
00:18:30,720 --> 00:18:38,250
say that 0 to 255 max from negative 1 to

463
00:18:34,769 --> 00:18:40,859
1 right so yeah I think I misspoke there

464
00:18:38,250 --> 00:18:42,150
a little bit we probably want that so we

465
00:18:40,859 --> 00:18:43,469
probably want something although it

466
00:18:42,150 --> 00:18:44,640
doesn't really matter at the end of the

467
00:18:43,470 --> 00:18:48,809
day as long as we know how we're

468
00:18:44,640 --> 00:18:50,550
conceptualizing it but still so yeah so

469
00:18:48,809 --> 00:18:52,740
we might say that you know if it was

470
00:18:50,549 --> 00:18:55,109
negative 1 point out that value we would

471
00:18:52,740 --> 00:18:57,390
be sampling directly downward and if it

472
00:18:55,109 --> 00:19:00,500
was 1.0 we reflect sampling directly

473
00:18:57,390 --> 00:19:03,690
upward and as we move between those two

474
00:19:00,500 --> 00:19:06,329
we are effectively sort of you know

475
00:19:03,690 --> 00:19:09,990
sampling different we're sort of

476
00:19:06,329 --> 00:19:11,609
sampling less of the top more of the

477
00:19:09,990 --> 00:19:14,579
bottom more of the middle whatever and

478
00:19:11,609 --> 00:19:16,379
so this would be right at 0.5 would be

479
00:19:14,579 --> 00:19:18,329
right in the mid plane and so this would

480
00:19:16,380 --> 00:19:20,130
be like a linear blend between top and

481
00:19:18,329 --> 00:19:23,099
mid that a linear blend between mid and

482
00:19:20,130 --> 00:19:25,500
bottom that sort of thing right so one

483
00:19:23,099 --> 00:19:27,240
of our parameters would control which of

484
00:19:25,500 --> 00:19:28,890
these three things we were blending

485
00:19:27,240 --> 00:19:31,230
between and then the other two

486
00:19:28,890 --> 00:19:34,410
parameters would control where we were

487
00:19:31,230 --> 00:19:38,420
sampling in these right and so if you

488
00:19:34,410 --> 00:19:40,590
imagine these as being sort of a I

489
00:19:38,420 --> 00:19:45,690
should I put it if you imagine these as

490
00:19:40,589 --> 00:19:47,819
being sort of a a picture that we're

491
00:19:45,690 --> 00:19:49,410
sort of casting against right we're sort

492
00:19:47,819 --> 00:19:51,689
of we're sort of looking in a direction

493
00:19:49,410 --> 00:19:53,430
to see what we see so if you imagine the

494
00:19:51,690 --> 00:19:55,890
top it's like some sky thing that we're

495
00:19:53,430 --> 00:19:58,049
looking at then what we would do is we'd

496
00:19:55,890 --> 00:19:59,190
say well okay here's where we are in the

497
00:19:58,049 --> 00:20:01,148
world because we know where we're

498
00:19:59,190 --> 00:20:03,700
drawing the pixel and here's like the

499
00:20:01,148 --> 00:20:06,878
erection were casting so let's solve for

500
00:20:03,700 --> 00:20:09,009
where that cast would hit this you know

501
00:20:06,878 --> 00:20:11,528
thing that we're sampling and we'll grab

502
00:20:09,009 --> 00:20:15,269
the color value out of that you know out

503
00:20:11,528 --> 00:20:17,499
of it there does that make sense and so

504
00:20:15,269 --> 00:20:19,868
that's what we would use our other two

505
00:20:17,499 --> 00:20:23,278
parameters of the normal for for solving

506
00:20:19,868 --> 00:20:26,439
that you know that cast equation right

507
00:20:23,278 --> 00:20:27,608
we would do that cast for top for middle

508
00:20:26,440 --> 00:20:29,200
and for bottom

509
00:20:27,608 --> 00:20:31,269
well middle we don't know what to do

510
00:20:29,200 --> 00:20:32,889
with yet because that's not so easy so

511
00:20:31,269 --> 00:20:34,808
pretend I didn't say that we don't know

512
00:20:32,888 --> 00:20:36,848
what we're gonna do here work on that

513
00:20:34,808 --> 00:20:38,440
but for top and bottom we can do that

514
00:20:36,848 --> 00:20:43,118
pretty straightforwardly we can compute

515
00:20:38,440 --> 00:20:45,190
those cast values and once we do that we

516
00:20:43,118 --> 00:20:47,259
can then produce the final result right

517
00:20:45,190 --> 00:20:49,778
and in this case we'd never really blend

518
00:20:47,259 --> 00:20:51,878
top and bottom together because you know

519
00:20:49,778 --> 00:20:53,288
middle zoe's in there and and and

520
00:20:51,878 --> 00:20:55,648
obviously there's no contribution of

521
00:20:53,288 --> 00:20:58,179
from the bottom if you think about this

522
00:20:55,648 --> 00:21:01,028
from a sideways view here's the top

523
00:20:58,179 --> 00:21:03,669
here's the bottom then obviously when

524
00:21:01,028 --> 00:21:06,190
you've got that vector as it starts to

525
00:21:03,669 --> 00:21:08,139
point upwards right as that value gets

526
00:21:06,190 --> 00:21:10,210
as this parameter gets to zero point

527
00:21:08,138 --> 00:21:12,038
five it literally never hits the bottom

528
00:21:10,210 --> 00:21:13,960
anymore right before it was kind of

529
00:21:12,038 --> 00:21:16,479
casting out right and it would always

530
00:21:13,960 --> 00:21:19,179
hit the bottom at some point there right

531
00:21:16,479 --> 00:21:20,319
but it's some but once you get two point

532
00:21:19,179 --> 00:21:22,690
five it'll literally never hit the

533
00:21:20,319 --> 00:21:24,489
bottom and the same is true of top right

534
00:21:22,690 --> 00:21:26,710
once you get to 0.5 on that parameter

535
00:21:24,489 --> 00:21:28,179
there's no no matter what the other two

536
00:21:26,710 --> 00:21:30,098
parameters are you're always just

537
00:21:28,179 --> 00:21:32,528
casting directly in that plane so you'll

538
00:21:30,098 --> 00:21:33,968
never hit the top right and so there's

539
00:21:32,528 --> 00:21:35,108
really no overlap there's no it never a

540
00:21:33,969 --> 00:21:36,788
plane between top and bottom only

541
00:21:35,108 --> 00:21:38,888
between top and middle and middle and

542
00:21:36,788 --> 00:21:40,989
bottom let's say depending on how we

543
00:21:38,888 --> 00:21:42,308
choose to make all this work and I don't

544
00:21:40,989 --> 00:21:44,409
really know exactly how we're going to

545
00:21:42,308 --> 00:21:46,118
like I said it's all a hack at some

546
00:21:44,409 --> 00:21:48,070
level because we can't compute the real

547
00:21:46,118 --> 00:21:50,829
thing but the question is can we produce

548
00:21:48,069 --> 00:21:54,579
a hack that gives us something that we

549
00:21:50,829 --> 00:21:56,288
want right so I feel like that's an

550
00:21:54,579 --> 00:21:59,168
interesting way of making a description

551
00:21:56,288 --> 00:22:02,169
for the light for now and so the other

552
00:21:59,169 --> 00:22:04,359
thing that we'll say is well if we want

553
00:22:02,169 --> 00:22:07,179
to describe the surface and we have that

554
00:22:04,358 --> 00:22:09,189
that zero to one value I would propose

555
00:22:07,179 --> 00:22:11,528
that the way that we use that zero to

556
00:22:09,190 --> 00:22:12,849
one shininess value could be similar to

557
00:22:11,528 --> 00:22:15,099
what I was talking about yesterday with

558
00:22:12,848 --> 00:22:17,230
blurring things if you think about

559
00:22:15,099 --> 00:22:19,178
how the light effects something that's

560
00:22:17,230 --> 00:22:23,200
very shiny what's basically happening

561
00:22:19,179 --> 00:22:25,000
there is you're looking up actual you

562
00:22:23,200 --> 00:22:26,830
know the actual reflection you're trying

563
00:22:25,000 --> 00:22:29,470
to reproduce the actual thing that's

564
00:22:26,829 --> 00:22:31,359
there very accurately in the shiniest so

565
00:22:29,470 --> 00:22:33,700
you almost in a shiny object you almost

566
00:22:31,359 --> 00:22:35,439
see the exact picture of what the light

567
00:22:33,700 --> 00:22:37,120
is that's coming in right you see like

568
00:22:35,440 --> 00:22:39,100
an outline of a window with the Sun

569
00:22:37,119 --> 00:22:41,199
coming through it or whatever on you

570
00:22:39,099 --> 00:22:43,569
know on this reflective thing whereas if

571
00:22:41,200 --> 00:22:45,250
it's dull you just see a vague amount of

572
00:22:43,569 --> 00:22:48,369
light and the color of the light right

573
00:22:45,250 --> 00:22:50,230
it's just kind of a wash so again what

574
00:22:48,369 --> 00:22:53,709
we could do here is take these planes

575
00:22:50,230 --> 00:22:55,480
and just blur them right now if we were

576
00:22:53,710 --> 00:22:57,009
to blur them every time we did a look up

577
00:22:55,480 --> 00:22:58,599
it would be fantastically expensive

578
00:22:57,009 --> 00:23:00,460
because you know you'd have to blur this

579
00:22:58,599 --> 00:23:02,529
big area to see what the total incoming

580
00:23:00,460 --> 00:23:04,360
light was for a really dull object but

581
00:23:02,529 --> 00:23:06,970
what we can do is when we produce our

582
00:23:04,359 --> 00:23:08,798
top and our bottom bitmaps we can just

583
00:23:06,970 --> 00:23:11,798
successively blur the whole image just

584
00:23:08,798 --> 00:23:14,918
one time right so we just take the top

585
00:23:11,798 --> 00:23:17,558
and we blur it down and we decide how

586
00:23:14,919 --> 00:23:20,110
much how many levels of blurriness we

587
00:23:17,558 --> 00:23:24,668
want right so we have a top like I said

588
00:23:20,109 --> 00:23:28,538
maybe we do a 256 by 256 top thing and

589
00:23:24,669 --> 00:23:31,179
then we just kind of have a 128 by 128 a

590
00:23:28,538 --> 00:23:34,480
64 by 64 right just down sampling by two

591
00:23:31,179 --> 00:23:36,460
each time tilt down to some level that

592
00:23:34,480 --> 00:23:38,288
we think is the right level right so we

593
00:23:36,460 --> 00:23:39,519
essentially have you know five or six of

594
00:23:38,288 --> 00:23:42,099
these something like that maybe four or

595
00:23:39,519 --> 00:23:44,769
whatever and then we use that that

596
00:23:42,099 --> 00:23:47,048
parameter that's zero to one to decide

597
00:23:44,769 --> 00:23:49,000
first of all which two we're going to do

598
00:23:47,048 --> 00:23:51,700
so maybe you know let's say we did four

599
00:23:49,000 --> 00:23:54,579
of them so if it's zero we're sampling

600
00:23:51,700 --> 00:23:58,538
out of the 32 by 32 from zero to you

601
00:23:54,579 --> 00:24:01,089
know 0.33 right we'd be sampling out of

602
00:23:58,538 --> 00:24:02,679
the in between these two we'd grab one

603
00:24:01,089 --> 00:24:04,959
from here and one from here and blend

604
00:24:02,679 --> 00:24:06,580
between them or something like this and

605
00:24:04,960 --> 00:24:10,779
then from zero you know from there to

606
00:24:06,579 --> 00:24:12,699
six six same thing and then 21.0 right

607
00:24:10,779 --> 00:24:13,690
so we'd pick two and we'd like blend

608
00:24:12,700 --> 00:24:17,380
between them or something like that

609
00:24:13,690 --> 00:24:19,659
right and that seems like a relatively

610
00:24:17,380 --> 00:24:22,120
easy you know way to make that work and

611
00:24:19,659 --> 00:24:23,500
we could even say if we wanted to to

612
00:24:22,119 --> 00:24:25,959
keep things easier for our software

613
00:24:23,500 --> 00:24:29,420
renderer since nothing is animatedly

614
00:24:25,960 --> 00:24:31,250
changing from blurry to smooth presume

615
00:24:29,420 --> 00:24:33,050
we don't probably actually need to ever

616
00:24:31,250 --> 00:24:35,990
do this amount of blending we could just

617
00:24:33,049 --> 00:24:38,720
say that the surface description is just

618
00:24:35,990 --> 00:24:40,910
going to be a literally a pic of which

619
00:24:38,720 --> 00:24:43,100
one of these you're going into right so

620
00:24:40,910 --> 00:24:45,620
it's just like you know two bits or

621
00:24:43,099 --> 00:24:47,750
something which says which of these four

622
00:24:45,619 --> 00:24:49,879
you look into right zero zero looks into

623
00:24:47,750 --> 00:24:52,700
this one zero one looks into that one

624
00:24:49,880 --> 00:24:55,520
one zero looks into this one and one one

625
00:24:52,700 --> 00:24:57,950
looks into that one right so we could

626
00:24:55,519 --> 00:25:00,139
really just force this to be a discrete

627
00:24:57,950 --> 00:25:03,140
process if we want to and probably be

628
00:25:00,140 --> 00:25:05,509
totally fine with that so I don't know

629
00:25:03,140 --> 00:25:09,290
this may all be an awful idea it may

630
00:25:05,509 --> 00:25:10,730
totally not work but like I said try to

631
00:25:09,289 --> 00:25:12,889
come up with approximated lighting for

632
00:25:10,730 --> 00:25:15,380
2d games is all about experimenting to

633
00:25:12,890 --> 00:25:16,820
find out what will work so I think this

634
00:25:15,380 --> 00:25:18,920
is sort of the scheme that we'll try to

635
00:25:16,819 --> 00:25:20,269
go with for now and so let's move off of

636
00:25:18,920 --> 00:25:22,960
the whiteboard

637
00:25:20,269 --> 00:25:25,910
I'm sorry blackboard for the moment and

638
00:25:22,960 --> 00:25:28,519
since we've got a good 35 minutes let's

639
00:25:25,910 --> 00:25:30,290
try to get some of this implemented all

640
00:25:28,519 --> 00:25:32,210
right so first things first what we need

641
00:25:30,289 --> 00:25:34,460
to do is we need to introduce the

642
00:25:32,210 --> 00:25:36,410
concept of a normal map to our pipeline

643
00:25:34,460 --> 00:25:38,210
because we do not have that yet and so

644
00:25:36,410 --> 00:25:40,700
when this thing says we've got a texture

645
00:25:38,210 --> 00:25:43,220
here what we want to do is in addition

646
00:25:40,700 --> 00:25:45,110
to the texture have a normal map right

647
00:25:43,220 --> 00:25:47,420
so that it can have a pointer to

648
00:25:45,109 --> 00:25:49,459
whatever that normal map is going to be

649
00:25:47,420 --> 00:25:51,200
and we need to pass that all the way

650
00:25:49,460 --> 00:25:53,630
through the system so when you push the

651
00:25:51,200 --> 00:25:56,120
coordinate thing on here right you're

652
00:25:53,630 --> 00:25:57,800
gonna have a thing where you pass the

653
00:25:56,119 --> 00:26:00,169
normal map and the normal map is going

654
00:25:57,799 --> 00:26:02,779
to get stored and pulled out by the

655
00:26:00,170 --> 00:26:06,200
renderer later when it calls that fancy

656
00:26:02,779 --> 00:26:08,029
the draw triangle slowly thing and one

657
00:26:06,200 --> 00:26:09,319
of the things that probably we should

658
00:26:08,029 --> 00:26:11,359
have done here I don't actually know why

659
00:26:09,319 --> 00:26:13,579
I didn't we could just pass the entry

660
00:26:11,359 --> 00:26:15,949
directly this thing that seems like a

661
00:26:13,579 --> 00:26:17,449
pretty reasonable idea well maybe new I

662
00:26:15,950 --> 00:26:19,039
guess we've gone this far without doing

663
00:26:17,450 --> 00:26:20,090
that I won't bother it for now because

664
00:26:19,039 --> 00:26:22,220
we're probably gonna change a little bit

665
00:26:20,089 --> 00:26:24,049
of that stuff anyway so in draw

666
00:26:22,220 --> 00:26:27,890
rectangles slowly we're just going to

667
00:26:24,049 --> 00:26:31,609
assume that we've got that normal map

668
00:26:27,890 --> 00:26:33,259
now right loaded bitmap normal map like

669
00:26:31,609 --> 00:26:36,529
so we're gonna see when we've got that

670
00:26:33,259 --> 00:26:39,170
normal map and we're going to have in

671
00:26:36,529 --> 00:26:41,899
here the opportunity to basically just

672
00:26:39,170 --> 00:26:44,019
reuse all of the work that we did

673
00:26:41,900 --> 00:26:46,160
sample our normal map right now

674
00:26:44,019 --> 00:26:49,460
technically we would want to bilinear

675
00:26:46,160 --> 00:26:51,500
blend the normal map as well and so you

676
00:26:49,460 --> 00:26:54,769
can kind of see the sort of problems

677
00:26:51,500 --> 00:26:57,170
that that introduces because sort of

678
00:26:54,769 --> 00:27:00,349
I'll show you what we're talking about

679
00:26:57,170 --> 00:27:02,000
here if I have a normal map right and in

680
00:27:00,349 --> 00:27:04,039
that normal map I'm pulling from like

681
00:27:02,000 --> 00:27:05,509
right here I presumably want to do the

682
00:27:04,039 --> 00:27:07,279
same thing I was doing before where I

683
00:27:05,509 --> 00:27:09,740
figure out what the normals are here

684
00:27:07,279 --> 00:27:11,930
here here and here and I grab out

685
00:27:09,740 --> 00:27:14,870
exactly the right one from there right

686
00:27:11,930 --> 00:27:23,240
the problem with that is remember

687
00:27:14,869 --> 00:27:25,219
normals have to be normal right that's

688
00:27:23,240 --> 00:27:26,890
kind of just obvious you know when I say

689
00:27:25,220 --> 00:27:29,569
it's probably not something that's very

690
00:27:26,890 --> 00:27:30,680
strange to you but it's true right

691
00:27:29,569 --> 00:27:32,509
normals have to be normal

692
00:27:30,680 --> 00:27:36,200
and if normals are going to be normal

693
00:27:32,509 --> 00:27:39,529
then I can't just I can't just lurk to

694
00:27:36,200 --> 00:27:41,240
normals together because they won't be

695
00:27:39,529 --> 00:27:44,000
normal after I'm done right let's

696
00:27:41,240 --> 00:27:45,920
imagine that I'm here right and I've got

697
00:27:44,000 --> 00:27:47,599
this normal in fact I'll draw this for

698
00:27:45,920 --> 00:27:52,490
you actually try to draw this relatively

699
00:27:47,599 --> 00:27:55,369
precisely right suppose that I have you

700
00:27:52,490 --> 00:27:57,980
know a normal pointing here and a normal

701
00:27:55,369 --> 00:28:01,189
pointing here well a linear blend is

702
00:27:57,980 --> 00:28:03,410
going to give me a motion along that

703
00:28:01,190 --> 00:28:05,090
line right so if I were to linear blend

704
00:28:03,410 --> 00:28:07,370
fifty percent between these two normals

705
00:28:05,089 --> 00:28:09,199
I would end up with this vector and what

706
00:28:07,369 --> 00:28:10,819
you'll notice is it's very stumpy it

707
00:28:09,200 --> 00:28:13,100
should be out here if it was normal

708
00:28:10,819 --> 00:28:15,409
length it should be that tall but

709
00:28:13,099 --> 00:28:16,699
instead it's much shorter than that what

710
00:28:15,410 --> 00:28:17,960
does that mean well it means that

711
00:28:16,700 --> 00:28:20,660
whatever we were going to do with it

712
00:28:17,960 --> 00:28:23,450
would be wrong because we don't actually

713
00:28:20,660 --> 00:28:26,390
we're not actually accounting for that

714
00:28:23,450 --> 00:28:27,920
difference in in if we baked in the fact

715
00:28:26,390 --> 00:28:30,410
that it was normal to our equations we

716
00:28:27,920 --> 00:28:32,090
wouldn't be able to handle that right so

717
00:28:30,410 --> 00:28:33,380
this is something to be aware of we

718
00:28:32,089 --> 00:28:35,029
don't have to fix it quite yet because

719
00:28:33,380 --> 00:28:36,650
we have to see maybe it's it's

720
00:28:35,029 --> 00:28:39,649
relatively free to bake it into our

721
00:28:36,650 --> 00:28:41,509
equations to see what we can do to to

722
00:28:39,650 --> 00:28:42,950
fix that or something like this maybe

723
00:28:41,509 --> 00:28:45,079
we'll have to take into that account

724
00:28:42,950 --> 00:28:47,150
anyway so we don't have to panic yet but

725
00:28:45,079 --> 00:28:49,639
it's worth noting that like lerp four

726
00:28:47,150 --> 00:28:51,080
colors works a lot better than lerp for

727
00:28:49,640 --> 00:28:53,420
normals because generally when you lurk

728
00:28:51,079 --> 00:28:54,079
normals you have to do that you have to

729
00:28:53,420 --> 00:28:55,970
handle that Reed

730
00:28:54,079 --> 00:28:57,678
zatia right you have to you have to

731
00:28:55,970 --> 00:28:59,600
project them back out onto the sphere

732
00:28:57,679 --> 00:29:00,769
and that kind of gets back a little bit

733
00:28:59,599 --> 00:29:03,288
to this thing that I was talking about

734
00:29:00,769 --> 00:29:05,120
before that's why you typically don't

735
00:29:03,288 --> 00:29:07,220
mind doing this kind of thing because

736
00:29:05,119 --> 00:29:09,439
since you would have to basically

737
00:29:07,220 --> 00:29:11,450
renormalize anyway what you can do is

738
00:29:09,440 --> 00:29:13,278
just lurk to values and then renormalize

739
00:29:11,450 --> 00:29:14,808
to get the third since you were going to

740
00:29:13,278 --> 00:29:16,759
have to do that anyway if you decided to

741
00:29:14,808 --> 00:29:19,428
store just the X and the y so it kind of

742
00:29:16,759 --> 00:29:22,278
all works out in in some sense if you

743
00:29:19,429 --> 00:29:27,710
think about it that way all right so

744
00:29:22,278 --> 00:29:29,898
moving on from there let's go ahead and

745
00:29:27,710 --> 00:29:32,538
do our sampling here one thing we might

746
00:29:29,898 --> 00:29:34,308
want to do is turn this into something

747
00:29:32,538 --> 00:29:36,319
that we can reuse because we see this

748
00:29:34,308 --> 00:29:39,048
happening a lot what what we would like

749
00:29:36,319 --> 00:29:43,250
to do is just do like you know sample

750
00:29:39,048 --> 00:29:44,808
from a texture well is a sample from

751
00:29:43,250 --> 00:29:47,808
texture first let's get a little more

752
00:29:44,808 --> 00:29:53,839
simpler but like this is unpack you know

753
00:29:47,808 --> 00:29:55,308
a thirty to unpack 4x8 something like

754
00:29:53,839 --> 00:29:59,058
that you know something that basically

755
00:29:55,308 --> 00:30:01,099
takes a pointer and does this unpack so

756
00:29:59,058 --> 00:30:03,379
we don't have to keep saying it over and

757
00:30:01,099 --> 00:30:07,129
over and over again so I can say textile

758
00:30:03,380 --> 00:30:08,778
pointer a right like so and have it do

759
00:30:07,130 --> 00:30:11,269
that unpack so I'm going to go ahead and

760
00:30:08,778 --> 00:30:13,940
have that be an inline function here

761
00:30:11,269 --> 00:30:17,048
that we can call from multiple places so

762
00:30:13,940 --> 00:30:21,070
that's an inline that's gonna be unpack

763
00:30:17,048 --> 00:30:23,538
4x8 it's going to take the the value and

764
00:30:21,069 --> 00:30:26,778
we'll call that the packed value right

765
00:30:23,538 --> 00:30:29,450
and it's just going to produce that

766
00:30:26,778 --> 00:30:33,380
result exact same way that we were doing

767
00:30:29,450 --> 00:30:41,210
okay so off we go pack pack pack pack

768
00:30:33,380 --> 00:30:43,460
packed like so and then we return that

769
00:30:41,210 --> 00:30:45,470
right and that's just a nice way to get

770
00:30:43,460 --> 00:30:47,480
that unpacking done so that we don't

771
00:30:45,470 --> 00:30:49,278
have to keep writing that code over and

772
00:30:47,480 --> 00:30:53,450
over and over and over again which is

773
00:30:49,278 --> 00:30:55,909
obviously pretty annoying so in here now

774
00:30:53,450 --> 00:30:59,240
we can replace all of these so that's an

775
00:30:55,909 --> 00:31:02,720
unpack this is an unpacked 4x8 of Texel

776
00:30:59,240 --> 00:31:04,120
point Gorby this is an unpack 4x8 of

777
00:31:02,720 --> 00:31:09,360
Texel pointer

778
00:31:04,119 --> 00:31:10,829
mmm see and finally textile pointer

779
00:31:09,359 --> 00:31:14,799
whoops

780
00:31:10,829 --> 00:31:16,419
unpack textile pointer tee and I believe

781
00:31:14,799 --> 00:31:18,220
we already handled the color a stuff

782
00:31:16,420 --> 00:31:20,009
here right because we're we're doing

783
00:31:18,220 --> 00:31:24,519
that right there

784
00:31:20,009 --> 00:31:26,529
so we unpack the texels mm-hmm gonna be

785
00:31:24,519 --> 00:31:31,389
just fine and so if we want to do this

786
00:31:26,529 --> 00:31:34,089
we could we could do sorry my throat's a

787
00:31:31,390 --> 00:31:35,710
little sticky we can do this exact same

788
00:31:34,089 --> 00:31:39,220
thing for the normal map so if we want

789
00:31:35,710 --> 00:31:42,100
to we can change Texel to normal and off

790
00:31:39,220 --> 00:31:44,259
you go and similarly we can just go

791
00:31:42,099 --> 00:31:49,269
ahead and unpack those here so here we

792
00:31:44,259 --> 00:31:52,720
go textile normal and the weird part

793
00:31:49,269 --> 00:31:55,299
though if you take a look at this is the

794
00:31:52,720 --> 00:31:57,610
unpack here is a little bit strange

795
00:31:55,299 --> 00:31:59,950
because if we're reading 32-bit values

796
00:31:57,609 --> 00:32:02,379
out of here we actually end up with more

797
00:31:59,950 --> 00:32:08,019
values than we actually need right we

798
00:32:02,380 --> 00:32:09,580
end up with four values and what exactly

799
00:32:08,019 --> 00:32:12,009
are we going to do with four values we

800
00:32:09,579 --> 00:32:16,539
only need three at most potentially only

801
00:32:12,009 --> 00:32:19,299
two so what's that fourth value so

802
00:32:16,539 --> 00:32:22,539
typically what we often do in graphics

803
00:32:19,299 --> 00:32:24,909
in this scenario since as you might

804
00:32:22,539 --> 00:32:27,399
imagine this sort of thing comes up

805
00:32:24,910 --> 00:32:29,800
fairly frequently what we'll often do is

806
00:32:27,400 --> 00:32:31,990
take the description of the surface and

807
00:32:29,799 --> 00:32:34,419
bake that into the normal map as well

808
00:32:31,990 --> 00:32:37,420
right so if we have a four-channel map

809
00:32:34,420 --> 00:32:39,789
here we might store x and y and then

810
00:32:37,420 --> 00:32:41,350
we'll also store you know even if we're

811
00:32:39,789 --> 00:32:43,750
storing Z we still got that final

812
00:32:41,349 --> 00:32:46,059
component let's say we'll store in that

813
00:32:43,750 --> 00:32:49,059
in what would be the Alpha Channel we

814
00:32:46,059 --> 00:32:51,309
can actually store say what we want the

815
00:32:49,059 --> 00:32:53,289
glossiness of the surface to be right so

816
00:32:51,309 --> 00:32:56,200
we could have that fourth component

817
00:32:53,289 --> 00:32:59,889
could be how glossy the surface is at

818
00:32:56,200 --> 00:33:02,470
that point now whether or not we candle

819
00:32:59,890 --> 00:33:04,509
that being super smooth or not who knows

820
00:33:02,470 --> 00:33:06,759
but that allows us to paint a single

821
00:33:04,509 --> 00:33:09,519
sprite that has both reflective and non

822
00:33:06,759 --> 00:33:12,970
reflective portions to it right and so

823
00:33:09,519 --> 00:33:14,410
that can be kind of nice alright so if

824
00:33:12,970 --> 00:33:16,600
we've got this here and we want to

825
00:33:14,410 --> 00:33:18,220
produce these what we can do is say

826
00:33:16,599 --> 00:33:20,769
alright we've got the Texel

827
00:33:18,220 --> 00:33:22,350
the Texel got lurked here and that's the

828
00:33:20,769 --> 00:33:25,960
lerp but we can also go ahead and

829
00:33:22,349 --> 00:33:27,789
produce the same lerp for the normals

830
00:33:25,960 --> 00:33:29,769
and then we just have to decide if we

831
00:33:27,789 --> 00:33:32,579
want to do something with that later

832
00:33:29,769 --> 00:33:34,420
that's going to be you know a little bit

833
00:33:32,579 --> 00:33:35,710
fancier than just a lerp like

834
00:33:34,420 --> 00:33:39,430
renormalizing or something fat but

835
00:33:35,710 --> 00:33:41,410
there's our normal and after that we've

836
00:33:39,430 --> 00:33:42,430
essentially got the normal to play with

837
00:33:41,410 --> 00:33:44,080
in our pipeline

838
00:33:42,430 --> 00:33:45,910
so here's the Hadamard product that we

839
00:33:44,079 --> 00:33:47,799
were doing to cut to use the incoming

840
00:33:45,910 --> 00:33:50,680
color to color the surface we can now do

841
00:33:47,799 --> 00:33:53,680
some more work here where we use the

842
00:33:50,680 --> 00:33:57,190
normal to you know to do some kind of a

843
00:33:53,680 --> 00:34:01,900
lighting lookup right so in order to do

844
00:33:57,190 --> 00:34:04,210
that we have to introduce yet more you

845
00:34:01,900 --> 00:34:05,740
know you get more bitmaps in here right

846
00:34:04,210 --> 00:34:08,079
if we want to be able to compute

847
00:34:05,740 --> 00:34:10,269
lighting like I was sort of saying we're

848
00:34:08,079 --> 00:34:12,909
going to have to start introducing a few

849
00:34:10,269 --> 00:34:14,199
more bitmaps in here now loaded bitmap

850
00:34:12,909 --> 00:34:15,609
might be the wrong thing for this

851
00:34:14,199 --> 00:34:18,219
because like I was saying we kind of

852
00:34:15,610 --> 00:34:19,450
want there to be a range of them

853
00:34:18,219 --> 00:34:21,639
potentially where they've been blurred

854
00:34:19,449 --> 00:34:23,769
or something like that so really if we

855
00:34:21,639 --> 00:34:25,869
if we you know want to do this right

856
00:34:23,769 --> 00:34:29,289
what we're going to have to introduce is

857
00:34:25,869 --> 00:34:32,349
some kind of a structured system that

858
00:34:29,289 --> 00:34:33,969
has multiple bitmaps in one place right

859
00:34:32,349 --> 00:34:36,789
it's got to have multiple blurryness

860
00:34:33,969 --> 00:34:40,000
levels right and so you might imagine

861
00:34:36,789 --> 00:34:46,119
something like let's say we had you know

862
00:34:40,000 --> 00:34:49,210
loaded bitmap here and we have logs

863
00:34:46,119 --> 00:34:51,099
levels of detail let's say and we'll

864
00:34:49,210 --> 00:34:52,780
have some number of those so there's

865
00:34:51,099 --> 00:34:54,639
like eight of them or something or you

866
00:34:52,780 --> 00:34:56,260
know maybe four of them I like we said

867
00:34:54,639 --> 00:34:59,409
four originally it was how many there

868
00:34:56,260 --> 00:35:01,780
were and this is going to be like our

869
00:34:59,409 --> 00:35:04,440
our concept of like that that sort of

870
00:35:01,780 --> 00:35:07,510
that top that bottom that sort of blur

871
00:35:04,440 --> 00:35:08,889
those blur levels right and so this is

872
00:35:07,510 --> 00:35:10,870
going to be we'll call this an

873
00:35:08,889 --> 00:35:12,250
environment map for now because that's

874
00:35:10,869 --> 00:35:14,889
sort of what it is it's a map that says

875
00:35:12,250 --> 00:35:16,510
what the environment looks like and so

876
00:35:14,889 --> 00:35:17,799
we'll kind of pass that in here and

877
00:35:16,510 --> 00:35:20,830
we'll say alright there's an environment

878
00:35:17,800 --> 00:35:22,690
map really we could do some other stuff

879
00:35:20,829 --> 00:35:26,489
here but you know we'll say we'll say

880
00:35:22,690 --> 00:35:29,260
out at the top we'll say what the the

881
00:35:26,489 --> 00:35:32,029
sort of the the base width and height

882
00:35:29,260 --> 00:35:36,800
are which are sort of saying

883
00:35:32,030 --> 00:35:38,300
how you know how or I guess I kind of

884
00:35:36,800 --> 00:35:39,650
said they would even be square right

885
00:35:38,300 --> 00:35:41,600
because I think that's what I said out

886
00:35:39,650 --> 00:35:46,460
here I think I said you know we do like

887
00:35:41,599 --> 00:35:49,279
a 256 by 256 kind of a thing where was

888
00:35:46,460 --> 00:35:50,750
that yeah something like this I don't

889
00:35:49,280 --> 00:35:52,490
know if we want to support rectangular

890
00:35:50,750 --> 00:35:53,750
ones I mean the screens rectangular so

891
00:35:52,489 --> 00:35:55,639
that seems like that might be a smart

892
00:35:53,750 --> 00:35:57,099
thing to do but at the same time when

893
00:35:55,639 --> 00:35:59,569
we're looking up into things that may be

894
00:35:57,099 --> 00:36:01,279
that having those powers of 2 is gonna

895
00:35:59,570 --> 00:36:02,539
make it easier on us to do some certain

896
00:36:01,280 --> 00:36:04,970
like some wrapping and clamping

897
00:36:02,539 --> 00:36:08,420
operations on them so what we could do I

898
00:36:04,969 --> 00:36:10,639
don't know let's let's just say for the

899
00:36:08,420 --> 00:36:12,590
moment that these have to be powers of 2

900
00:36:10,639 --> 00:36:17,059
but will allow them to be rectangular

901
00:36:12,590 --> 00:36:19,550
potentially so we'll say X POW 2 and y

902
00:36:17,059 --> 00:36:23,269
power to something like that right and

903
00:36:19,550 --> 00:36:25,010
so that way we can encode essentially

904
00:36:23,269 --> 00:36:27,860
the fact that these are going to be a

905
00:36:25,010 --> 00:36:29,540
power of 2 width and height right

906
00:36:27,860 --> 00:36:33,470
in fact I guess I could say wit POW 2

907
00:36:29,539 --> 00:36:43,190
and height pad 2 right and so I could

908
00:36:33,469 --> 00:36:50,239
say note KC love level 0 is 2 to the

909
00:36:43,190 --> 00:36:52,639
width power 2 by 2 to the height power

910
00:36:50,239 --> 00:36:55,879
of 2 right and then it just goes down

911
00:36:52,639 --> 00:36:58,250
from there all right so assuming that we

912
00:36:55,880 --> 00:37:00,260
want to do that then we could do in here

913
00:36:58,250 --> 00:37:02,059
we could pass our environment map so

914
00:37:00,260 --> 00:37:04,580
we'd say our top environment map our

915
00:37:02,059 --> 00:37:07,579
bottom environment map and our middle

916
00:37:04,579 --> 00:37:09,500
environment map like so so we would have

917
00:37:07,579 --> 00:37:11,329
from these and in just in case you can't

918
00:37:09,500 --> 00:37:13,280
already tell this is why I saying things

919
00:37:11,329 --> 00:37:14,569
are going to get incredibly slow right

920
00:37:13,280 --> 00:37:16,400
because you can see all these things

921
00:37:14,570 --> 00:37:17,660
without any optimizations this is going

922
00:37:16,400 --> 00:37:19,490
to be incredibly expensive even with

923
00:37:17,659 --> 00:37:22,699
optimizations it's going to certainly be

924
00:37:19,489 --> 00:37:24,619
cost costly to say the least but off we

925
00:37:22,699 --> 00:37:28,569
go so we've got our top middle and our

926
00:37:24,619 --> 00:37:31,460
bottom we need to then do that sampling

927
00:37:28,570 --> 00:37:33,590
so what we would want to do here is we

928
00:37:31,460 --> 00:37:35,510
want to take our normal and we want to

929
00:37:33,590 --> 00:37:38,930
figure out what we were going to sample

930
00:37:35,510 --> 00:37:43,190
on right so we've got the concept of our

931
00:37:38,929 --> 00:37:45,379
normals Z right and our normals Z I

932
00:37:43,190 --> 00:37:45,800
guess we could we could say is going to

933
00:37:45,380 --> 00:37:48,349
tell

934
00:37:45,800 --> 00:37:50,390
whether we're pointing you know up or

935
00:37:48,349 --> 00:37:52,690
down that sort of a thing right

936
00:37:50,389 --> 00:37:54,739
so whatever the normal we'll call that

937
00:37:52,690 --> 00:37:56,119
you know we could almost call that

938
00:37:54,739 --> 00:37:57,619
something it's slightly different since

939
00:37:56,119 --> 00:37:59,299
we're not gonna really we don't know

940
00:37:57,619 --> 00:38:00,829
exactly how we want unquote encode our

941
00:37:59,300 --> 00:38:03,019
normal so yet let's call it something

942
00:38:00,829 --> 00:38:07,219
different let's just say we've got our

943
00:38:03,019 --> 00:38:09,679
our M map RN map T like the thing that

944
00:38:07,219 --> 00:38:12,019
tells us the blend of our environment

945
00:38:09,679 --> 00:38:14,989
map so right now we'll just go ahead and

946
00:38:12,019 --> 00:38:18,920
pick that off of the Z of the normal

947
00:38:14,989 --> 00:38:21,739
right if that makes sense so we'll pick

948
00:38:18,920 --> 00:38:23,720
that off the Z of the normal and we will

949
00:38:21,739 --> 00:38:25,399
go ahead and use that to figure out

950
00:38:23,719 --> 00:38:27,709
we're gonna blend between so it's pretty

951
00:38:25,400 --> 00:38:30,380
straightforward if at this point we

952
00:38:27,710 --> 00:38:34,730
could say that if the the TN map was

953
00:38:30,380 --> 00:38:38,269
less than 0.5 or if the TN map is

954
00:38:34,730 --> 00:38:40,400
greater than 0.5 right we've got the two

955
00:38:38,269 --> 00:38:45,590
cases we have one where it's actually

956
00:38:40,400 --> 00:38:49,010
exactly equal and that's a little bit

957
00:38:45,590 --> 00:38:50,150
janky because again we we sort of had

958
00:38:49,010 --> 00:38:52,100
this problem of not being able to

959
00:38:50,150 --> 00:38:53,720
compute what would actually happen when

960
00:38:52,099 --> 00:38:55,969
you're when you sort of kick up off of

961
00:38:53,719 --> 00:38:58,069
there and furthermore I guess when I

962
00:38:55,969 --> 00:39:01,189
think about it if I think about it a

963
00:38:58,070 --> 00:39:04,760
little more holistically here where is

964
00:39:01,190 --> 00:39:07,820
that diagram you know really at some

965
00:39:04,760 --> 00:39:11,930
point we might want to say that we

966
00:39:07,820 --> 00:39:14,780
switch that with that it's probably

967
00:39:11,929 --> 00:39:16,699
something considerably less than than

968
00:39:14,780 --> 00:39:18,200
0.5 at the point which is switches you

969
00:39:16,699 --> 00:39:20,089
know it might be more like 0.25 or

970
00:39:18,199 --> 00:39:22,039
something that we might want only things

971
00:39:20,090 --> 00:39:24,200
that point fairly downward to have that

972
00:39:22,039 --> 00:39:27,349
so it might be something more like if

973
00:39:24,199 --> 00:39:31,399
it's less than 0.5 you know and if it's

974
00:39:27,349 --> 00:39:33,199
greater than 0.5 then we cast into then

975
00:39:31,400 --> 00:39:35,300
we cast into the top and the bottom you

976
00:39:33,199 --> 00:39:38,329
know something like that and in the

977
00:39:35,300 --> 00:39:40,010
middle we are only looking at that that

978
00:39:38,329 --> 00:39:41,179
other map or something like that and I

979
00:39:40,010 --> 00:39:43,220
don't know like I said it's really hard

980
00:39:41,179 --> 00:39:47,059
to say this is all just very happy to

981
00:39:43,219 --> 00:39:50,089
see how things go so if we do TM map

982
00:39:47,059 --> 00:39:52,369
less than 0.25 then we're going to do

983
00:39:50,090 --> 00:39:57,650
that reflection into we're going to

984
00:39:52,369 --> 00:39:58,549
we're going to do a look up into the top

985
00:39:57,650 --> 00:40:02,090
map

986
00:39:58,550 --> 00:40:09,769
bring that down here right so let's go

987
00:40:02,090 --> 00:40:13,600
ahead and put these on here so let's see

988
00:40:09,769 --> 00:40:17,630
this is not 0.25 0.75 there we go

989
00:40:13,599 --> 00:40:20,299
alright so if we are over 0.75 on the M

990
00:40:17,630 --> 00:40:25,820
map we're gonna say that we're you know

991
00:40:20,300 --> 00:40:29,180
are sort of our are call this our farm

992
00:40:25,820 --> 00:40:33,380
app maybe equals top otherwise our floor

993
00:40:29,179 --> 00:40:36,559
map farm at people's bottom and in

994
00:40:33,380 --> 00:40:39,500
either case we're going to use the

995
00:40:36,559 --> 00:40:42,920
middle map so then we say whatever our

996
00:40:39,500 --> 00:40:48,139
farm app you know I guess our blend

997
00:40:42,920 --> 00:40:50,619
ratio is so like our key farm app our

998
00:40:48,139 --> 00:40:54,289
tea farm app we're going to assume is 0

999
00:40:50,619 --> 00:40:57,710
and then we'll say ok if we are in one

1000
00:40:54,289 --> 00:40:59,420
of these our tea farm app if 0.25 is

1001
00:40:57,710 --> 00:41:01,990
that breaking point what we want to do

1002
00:40:59,420 --> 00:41:07,309
is say whatever the end map value is

1003
00:41:01,989 --> 00:41:11,869
over 0.25 that is going to give us our

1004
00:41:07,309 --> 00:41:14,239
blend ratio right so normalize TM map as

1005
00:41:11,869 --> 00:41:16,429
it goes from point 2 5 to 0 is going to

1006
00:41:14,239 --> 00:41:18,799
make our key farm app which is the

1007
00:41:16,429 --> 00:41:21,500
amount we want to you know blend in the

1008
00:41:18,800 --> 00:41:24,080
the farm Apps contribution go up to 1

1009
00:41:21,500 --> 00:41:28,940
right and we can do the exact same thing

1010
00:41:24,079 --> 00:41:31,250
in the case of the 0.75 what we'd want

1011
00:41:28,940 --> 00:41:34,849
to do there is say all right from 0.75

1012
00:41:31,250 --> 00:41:39,110
up to 1.0 that will sort of make tea

1013
00:41:34,849 --> 00:41:42,079
farm at blend in from there right so in

1014
00:41:39,110 --> 00:41:46,400
that case I guess the way we want to do

1015
00:41:42,079 --> 00:41:50,239
that is say now we've got 1.0 half minus

1016
00:41:46,400 --> 00:41:55,099
TM map right which kind of turns that

1017
00:41:50,239 --> 00:41:57,169
into the range of 0 to 0.25 and we would

1018
00:41:55,099 --> 00:41:59,119
divide again by the 0.25 to normalize it

1019
00:41:57,170 --> 00:42:02,180
back up to 1 so that should give us

1020
00:41:59,119 --> 00:42:04,489
roughly what that blend amount would be

1021
00:42:02,179 --> 00:42:05,750
in either case and tea farm app again

1022
00:42:04,489 --> 00:42:08,599
off to check those I kind of just did

1023
00:42:05,750 --> 00:42:09,769
that in my head right there and again

1024
00:42:08,599 --> 00:42:12,019
just to make it clear what's happening

1025
00:42:09,769 --> 00:42:14,119
there I'm just producing a value tea

1026
00:42:12,019 --> 00:42:16,489
farm app that says how much we should

1027
00:42:14,119 --> 00:42:18,829
grab from the tea from that farm app

1028
00:42:16,489 --> 00:42:21,379
versus the middle map when we eventually

1029
00:42:18,829 --> 00:42:23,900
ever have that sort of other map that we

1030
00:42:21,380 --> 00:42:26,150
happen to find yet all right so once we

1031
00:42:23,900 --> 00:42:28,070
know that what we can do is sample from

1032
00:42:26,150 --> 00:42:31,340
the middle map and from the farm app

1033
00:42:28,070 --> 00:42:34,550
right we can get a color value so like

1034
00:42:31,340 --> 00:42:36,620
we'd have middle map color equals you

1035
00:42:34,550 --> 00:42:39,230
know sample from middle something like

1036
00:42:36,619 --> 00:42:41,179
this I'm just typing this in and then we

1037
00:42:39,230 --> 00:42:45,820
have our farm map color equals sample

1038
00:42:41,179 --> 00:42:49,219
from whatever the farm map was right

1039
00:42:45,820 --> 00:42:51,590
assuming that it was going to be greater

1040
00:42:49,219 --> 00:42:52,339
if tea farm map has to be greater than

1041
00:42:51,590 --> 00:42:55,700
zero here

1042
00:42:52,340 --> 00:42:58,460
well sample from that right and then we

1043
00:42:55,699 --> 00:43:01,549
would blend between them so you know we

1044
00:42:58,460 --> 00:43:04,429
almost might say result color or light

1045
00:43:01,550 --> 00:43:05,990
color right sample from whatever that

1046
00:43:04,429 --> 00:43:09,199
middle map is which we always want

1047
00:43:05,989 --> 00:43:10,729
sample from since I always I assume we

1048
00:43:09,199 --> 00:43:12,439
always want to sample from it we'll have

1049
00:43:10,730 --> 00:43:14,030
to see about that

1050
00:43:12,440 --> 00:43:15,920
but then assuming that we actually have

1051
00:43:14,030 --> 00:43:17,390
some contribution from the farm app we

1052
00:43:15,920 --> 00:43:19,280
take a look at what that color is and

1053
00:43:17,389 --> 00:43:23,750
then the light color would be equal to

1054
00:43:19,280 --> 00:43:26,540
the blend between the color that that we

1055
00:43:23,750 --> 00:43:28,969
got from the middle map and the color

1056
00:43:26,539 --> 00:43:31,279
that we got from the four map so again

1057
00:43:28,969 --> 00:43:33,619
just total hack coat you're just to say

1058
00:43:31,280 --> 00:43:37,190
hey let's let's put something in here

1059
00:43:33,619 --> 00:43:38,659
which does that blend between them and

1060
00:43:37,190 --> 00:43:41,750
so really the only thing we have to work

1061
00:43:38,659 --> 00:43:44,359
out at this point is that sample from

1062
00:43:41,750 --> 00:43:47,510
how do we sample from one of these

1063
00:43:44,360 --> 00:43:50,740
environment maps how do we how do we go

1064
00:43:47,510 --> 00:43:53,300
about figuring out given and normal and

1065
00:43:50,739 --> 00:43:55,129
some kind of idea of how what the

1066
00:43:53,300 --> 00:43:57,769
surface should be how do we actually do

1067
00:43:55,130 --> 00:44:00,320
that sampling right so we know what we

1068
00:43:57,769 --> 00:44:02,239
would need to pass right we need to pass

1069
00:44:00,320 --> 00:44:04,010
that surface description value which in

1070
00:44:02,239 --> 00:44:07,099
this case is just going to be like the

1071
00:44:04,010 --> 00:44:08,960
the fourth parameter right of our normal

1072
00:44:07,099 --> 00:44:13,219
we know we have to pass the normal

1073
00:44:08,960 --> 00:44:14,510
itself which is the XYZ right and then

1074
00:44:13,219 --> 00:44:16,250
we need to know the map that we're

1075
00:44:14,510 --> 00:44:18,050
actually going to sample from but we

1076
00:44:16,250 --> 00:44:21,469
need one more thing which is we need

1077
00:44:18,050 --> 00:44:23,630
where in the screen we are so that we

1078
00:44:21,469 --> 00:44:24,719
can kind of know roughly where we're

1079
00:44:23,630 --> 00:44:26,789
casting the

1080
00:44:24,719 --> 00:44:29,730
we're doing this this check from right

1081
00:44:26,789 --> 00:44:31,889
so we also need to know essentially this

1082
00:44:29,730 --> 00:44:34,440
value that we were using for our pixel P

1083
00:44:31,889 --> 00:44:37,469
right where we were in screen space

1084
00:44:34,440 --> 00:44:40,409
right and so we don't really have a

1085
00:44:37,469 --> 00:44:42,299
normalized version of that which is what

1086
00:44:40,409 --> 00:44:44,670
we would kind of want here so we're also

1087
00:44:42,300 --> 00:44:48,960
going to have to produce some normalized

1088
00:44:44,670 --> 00:44:52,950
version of our location in screen space

1089
00:44:48,960 --> 00:44:55,380
right which we know of course what the

1090
00:44:52,949 --> 00:44:57,029
sort of the width width max and the and

1091
00:44:55,380 --> 00:44:58,858
the height max are so we do actually

1092
00:44:57,030 --> 00:45:02,010
know what that would be we've just never

1093
00:44:58,858 --> 00:45:04,579
computed it right so we need to produce

1094
00:45:02,010 --> 00:45:10,710
something cure which is like you know

1095
00:45:04,579 --> 00:45:12,630
screen space screen space UV might be a

1096
00:45:10,710 --> 00:45:15,990
good name for it like where we are in

1097
00:45:12,630 --> 00:45:19,079
screen space normalized and that's just

1098
00:45:15,989 --> 00:45:21,509
the x over that with Max and the Y over

1099
00:45:19,079 --> 00:45:23,969
the height max right if that makes sense

1100
00:45:21,510 --> 00:45:26,280
and we can make that a little bit more

1101
00:45:23,969 --> 00:45:29,098
efficient - by just saying well we can

1102
00:45:26,280 --> 00:45:36,920
pre-compute what those are you know what

1103
00:45:29,099 --> 00:45:41,490
I mean oops there we go in with Max so

1104
00:45:36,920 --> 00:45:45,030
we know over a real with Max and in

1105
00:45:41,489 --> 00:45:49,199
height Max there's one point over height

1106
00:45:45,030 --> 00:45:54,359
max like so and so if we have those

1107
00:45:49,199 --> 00:46:03,169
values mm-hmm we can actually just do in

1108
00:45:54,358 --> 00:46:06,389
height max times the Y and in with max

1109
00:46:03,170 --> 00:46:08,639
times the X and that'll just tell us

1110
00:46:06,389 --> 00:46:12,299
where we are in screen space normalized

1111
00:46:08,639 --> 00:46:15,088
right so there we go

1112
00:46:12,300 --> 00:46:17,490
so that gives us our screen space UV so

1113
00:46:15,088 --> 00:46:19,049
that would allow this the sample from

1114
00:46:17,489 --> 00:46:20,909
function here that we're talking about

1115
00:46:19,050 --> 00:46:22,910
that would allow that to know kind of

1116
00:46:20,909 --> 00:46:26,039
where we are so we're sampling from here

1117
00:46:22,909 --> 00:46:27,809
we're sampling in this direction we're

1118
00:46:26,039 --> 00:46:30,389
sampling with this surface description

1119
00:46:27,809 --> 00:46:33,900
this is this amount of glossiness and

1120
00:46:30,389 --> 00:46:36,929
we're sampling you know this environment

1121
00:46:33,900 --> 00:46:39,349
map and so if we you know call this

1122
00:46:36,929 --> 00:46:43,318
sample environment map

1123
00:46:39,349 --> 00:46:46,140
like so we could go ahead and actually

1124
00:46:43,318 --> 00:46:49,940
write this and see what it does now for

1125
00:46:46,139 --> 00:46:52,199
right now what we could do is we can say

1126
00:46:49,940 --> 00:46:54,480
and you know another thing that we could

1127
00:46:52,199 --> 00:46:56,818
do here too as well as we could say if

1128
00:46:54,480 --> 00:46:58,619
there's a normal map right if there's a

1129
00:46:56,818 --> 00:47:01,500
normal map we don't have to do any of

1130
00:46:58,619 --> 00:47:03,450
this right and later we could have two

1131
00:47:01,500 --> 00:47:06,329
versions of this sort of shader if you

1132
00:47:03,449 --> 00:47:09,538
will that you know evaluate those

1133
00:47:06,329 --> 00:47:11,369
options so assuming that we've got that

1134
00:47:09,539 --> 00:47:12,809
we can write that sample environment

1135
00:47:11,369 --> 00:47:15,298
we'll end up with the light color and

1136
00:47:12,809 --> 00:47:18,450
then what we can do for now just to sort

1137
00:47:15,298 --> 00:47:21,568
of simplify things is again we can do

1138
00:47:18,449 --> 00:47:24,960
that Hadamard product we can take our

1139
00:47:21,568 --> 00:47:26,190
Texel and pre light it by just

1140
00:47:24,960 --> 00:47:28,650
multiplying it by that light

1141
00:47:26,190 --> 00:47:30,420
contribution right so we're basically

1142
00:47:28,650 --> 00:47:32,548
saying okay whatever the Texel was we're

1143
00:47:30,420 --> 00:47:35,338
assuming the Texel was that color at

1144
00:47:32,548 --> 00:47:37,469
maximum brightness essentially and now

1145
00:47:35,338 --> 00:47:40,529
we are going to modulate it by however

1146
00:47:37,469 --> 00:47:42,269
much light we're actually receiving from

1147
00:47:40,530 --> 00:47:44,278
the environment right that shouldn't say

1148
00:47:42,269 --> 00:47:45,900
maximum brightness basically that Texel

1149
00:47:44,278 --> 00:47:49,469
tells us how much light get reflects

1150
00:47:45,900 --> 00:47:50,730
essentially and so we're gonna multiply

1151
00:47:49,469 --> 00:47:52,019
that by the incoming light color to

1152
00:47:50,730 --> 00:47:54,690
figure out how much light actually got

1153
00:47:52,019 --> 00:47:57,809
reflected right now there's some other

1154
00:47:54,690 --> 00:47:58,950
things there that are you know we

1155
00:47:57,809 --> 00:48:00,900
haven't really talked about too much

1156
00:47:58,949 --> 00:48:02,909
about how you compute lighting equations

1157
00:48:00,900 --> 00:48:04,650
per se and part of that's because again

1158
00:48:02,909 --> 00:48:06,389
we're not really doing fully real

1159
00:48:04,650 --> 00:48:09,000
lighting so it's unclear how much we

1160
00:48:06,389 --> 00:48:10,679
really care since we're kind of doing a

1161
00:48:09,000 --> 00:48:12,119
total hack to compute the incoming

1162
00:48:10,679 --> 00:48:14,159
lighting it's not clear how much

1163
00:48:12,119 --> 00:48:15,990
accuracy we really want in terms of how

1164
00:48:14,159 --> 00:48:17,308
we process what that comes in we

1165
00:48:15,989 --> 00:48:18,959
probably want to do something that's a

1166
00:48:17,309 --> 00:48:21,298
lot more hackish which is just tune it

1167
00:48:18,960 --> 00:48:23,190
until it looks okay because there's

1168
00:48:21,298 --> 00:48:24,949
really no point in trying to do accurate

1169
00:48:23,190 --> 00:48:27,900
computations on completely fabricated

1170
00:48:24,949 --> 00:48:30,778
values right but basically what we've

1171
00:48:27,900 --> 00:48:33,240
got here is sort of the you know the

1172
00:48:30,778 --> 00:48:35,969
basics of it and so what I'd like to do

1173
00:48:33,239 --> 00:48:37,558
is just say all right for now we're

1174
00:48:35,969 --> 00:48:39,689
gonna take this sample environment map

1175
00:48:37,559 --> 00:48:44,579
thing where we've got our screen space

1176
00:48:39,690 --> 00:48:48,659
UV our normal our surface reflectance or

1177
00:48:44,579 --> 00:48:50,690
our let's call this our our glossiness

1178
00:48:48,659 --> 00:48:54,509
maybe

1179
00:48:50,690 --> 00:48:57,539
our mirror nests oh I know it could say

1180
00:48:54,510 --> 00:48:59,430
roughness and then just like zero is

1181
00:48:57,539 --> 00:49:00,269
it's perfectly reflective and one is

1182
00:48:59,429 --> 00:49:02,129
super rough

1183
00:49:00,269 --> 00:49:04,050
let's call let's do that and then we

1184
00:49:02,130 --> 00:49:05,760
have an environment map which is the map

1185
00:49:04,050 --> 00:49:07,410
to sample and for now what we're gonna

1186
00:49:05,760 --> 00:49:09,840
do is say you know what let's just

1187
00:49:07,409 --> 00:49:12,480
return the normal so the light the light

1188
00:49:09,840 --> 00:49:14,550
color is the normal so we're not

1189
00:49:12,480 --> 00:49:16,650
actually going to actually compute

1190
00:49:14,550 --> 00:49:18,269
anything here we'll literally just just

1191
00:49:16,650 --> 00:49:21,990
pretend the result was whatever the

1192
00:49:18,269 --> 00:49:24,869
normal is again just so we can start by

1193
00:49:21,989 --> 00:49:29,059
getting things working okay this is a

1194
00:49:24,869 --> 00:49:33,509
typo so let's fix that right there and

1195
00:49:29,059 --> 00:49:36,659
that is also type up our farm app is

1196
00:49:33,510 --> 00:49:38,580
environment map star flower map equals

1197
00:49:36,659 --> 00:49:40,529
zero there we go

1198
00:49:38,579 --> 00:49:47,759
in fact we could also I suppose do this

1199
00:49:40,530 --> 00:49:51,750
is just gif farm app like soups so then

1200
00:49:47,760 --> 00:49:55,110
we've got oh so we didn't do XYZ in our

1201
00:49:51,750 --> 00:49:57,449
math I guess I guess we only did RGB it

1202
00:49:55,110 --> 00:49:59,340
looks like that's actually true so what

1203
00:49:57,449 --> 00:50:03,359
we want to do is we want to change this

1204
00:49:59,340 --> 00:50:10,620
guy right here essentially to to have

1205
00:50:03,360 --> 00:50:15,450
the same look as this we want this X Y Z

1206
00:50:10,619 --> 00:50:18,259
X Y Z so we can get a little more

1207
00:50:15,449 --> 00:50:25,889
expressive there all right T for color

1208
00:50:18,260 --> 00:50:33,270
that's true T to do it's actually T farm

1209
00:50:25,889 --> 00:50:36,659
map yeah and lerp doesn't work with

1210
00:50:33,269 --> 00:50:41,820
VIII's that's totally fine we can fix

1211
00:50:36,659 --> 00:50:47,489
that we can certainly just copy that guy

1212
00:50:41,820 --> 00:50:52,890
there put him in here so v3 now has

1213
00:50:47,489 --> 00:50:59,399
alert and I guess Hadamard also does

1214
00:50:52,889 --> 00:51:02,449
some well okay so this is a little bit I

1215
00:50:59,400 --> 00:51:05,519
guess we might want to do this manually

1216
00:51:02,449 --> 00:51:08,429
because really we don't want we only

1217
00:51:05,519 --> 00:51:11,519
want to do the RGB we don't want to

1218
00:51:08,429 --> 00:51:14,279
touch the Alpha value here right because

1219
00:51:11,519 --> 00:51:15,480
we're not really affecting that alpha

1220
00:51:14,280 --> 00:51:17,519
we're not reflecting that that

1221
00:51:15,480 --> 00:51:20,309
brightness at all so we really I think

1222
00:51:17,519 --> 00:51:22,650
we want that all right

1223
00:51:20,309 --> 00:51:25,860
so finally we need to send this guy our

1224
00:51:22,650 --> 00:51:28,170
environment maps and so that would

1225
00:51:25,860 --> 00:51:30,620
require again this entry to sort of be

1226
00:51:28,170 --> 00:51:32,460
expanded to have all of these things

1227
00:51:30,619 --> 00:51:34,829
like I said there's a lot of plumbing

1228
00:51:32,460 --> 00:51:36,420
involved in this you'll find in general

1229
00:51:34,829 --> 00:51:38,670
this is actually we don't need this

1230
00:51:36,420 --> 00:51:41,700
anymore either you will find this is

1231
00:51:38,670 --> 00:51:43,740
generally actually true that when you

1232
00:51:41,699 --> 00:51:46,500
get into more complicated rendering

1233
00:51:43,739 --> 00:51:48,569
stuff typically the hard part oftentimes

1234
00:51:46,500 --> 00:51:50,130
isn't writing the equations it's the

1235
00:51:48,570 --> 00:51:51,900
plumbing it's making sure that

1236
00:51:50,130 --> 00:51:53,579
everything can move through the system

1237
00:51:51,900 --> 00:51:55,200
well and that there's always the stuff

1238
00:51:53,579 --> 00:51:57,389
that you need in the right places ends

1239
00:51:55,199 --> 00:51:59,609
up actually taking a lot of time there

1240
00:51:57,389 --> 00:52:01,529
just tends to be a lot of stuff that has

1241
00:51:59,610 --> 00:52:03,780
to all get lined up which buffers go

1242
00:52:01,530 --> 00:52:05,550
where and this is even worse on GPUs

1243
00:52:03,780 --> 00:52:07,140
because you've got stuff that you got to

1244
00:52:05,550 --> 00:52:08,610
manage on the you know moving to and

1245
00:52:07,139 --> 00:52:10,920
from the card and all that stuff there's

1246
00:52:08,610 --> 00:52:12,930
just a tremendous amount of bookkeeping

1247
00:52:10,920 --> 00:52:14,880
we have it actually pretty good right

1248
00:52:12,929 --> 00:52:16,799
now because we aren't involving the GPU

1249
00:52:14,880 --> 00:52:20,280
in this so we kind of have the luxury of

1250
00:52:16,800 --> 00:52:23,250
just you know being very direct but it

1251
00:52:20,280 --> 00:52:27,720
definitely it becomes an issue it

1252
00:52:23,250 --> 00:52:29,880
definitely becomes an issue all right so

1253
00:52:27,719 --> 00:52:37,829
there's our tough middle bottom scheme

1254
00:52:29,880 --> 00:52:39,960
like so and finally when we are passing

1255
00:52:37,829 --> 00:52:41,789
this along what we want to do here is

1256
00:52:39,960 --> 00:52:46,559
just passed zeros for everything and

1257
00:52:41,789 --> 00:52:47,969
that should give us our our tree oh you

1258
00:52:46,559 --> 00:52:50,549
know what I forgot to do forgot to add

1259
00:52:47,969 --> 00:52:52,319
those down here as well this would

1260
00:52:50,550 --> 00:52:53,700
probably there's easier ways to write

1261
00:52:52,320 --> 00:52:54,870
what I'm writing here I probably should

1262
00:52:53,699 --> 00:52:57,059
have just exposed the since it's just

1263
00:52:54,869 --> 00:52:59,039
debug code I probably should have just

1264
00:52:57,059 --> 00:53:01,860
exposed this where it just returns the

1265
00:52:59,039 --> 00:53:04,769
render coordinate system I should stop

1266
00:53:01,860 --> 00:53:07,110
having it set the values but whatever we

1267
00:53:04,769 --> 00:53:12,019
we've come this far and we'll just keep

1268
00:53:07,110 --> 00:53:12,019
going so top middle bottom

1269
00:53:12,380 --> 00:53:28,430
and then we'll just say top sound middle

1270
00:53:22,239 --> 00:53:31,609
bottom okay and that should just about

1271
00:53:28,429 --> 00:53:34,909
do it I think and we can get rid of this

1272
00:53:31,610 --> 00:53:37,700
points thing here it's not necessary

1273
00:53:34,909 --> 00:53:39,920
anymore and so now we should still cuz I

1274
00:53:37,699 --> 00:53:42,469
made everything just be Iftars tree

1275
00:53:39,920 --> 00:53:44,570
should be intact and it is so the next

1276
00:53:42,469 --> 00:53:48,019
thing we have to do is actually generate

1277
00:53:44,570 --> 00:53:50,870
a normal map that we can start to play

1278
00:53:48,019 --> 00:53:53,360
with right and so in order to do that we

1279
00:53:50,869 --> 00:53:54,799
need something that we can generate some

1280
00:53:53,360 --> 00:53:56,329
predictable set of normals from like I

1281
00:53:54,800 --> 00:53:57,590
said this would normally something where

1282
00:53:56,329 --> 00:53:59,509
we'd load them but we don't have them

1283
00:53:57,590 --> 00:54:01,970
yet so let's do something that'll just

1284
00:53:59,510 --> 00:54:06,170
generate a normal map for our tree

1285
00:54:01,969 --> 00:54:08,659
directly using some kind of a very

1286
00:54:06,170 --> 00:54:12,710
simple algorithm and so what I'm gonna

1287
00:54:08,659 --> 00:54:15,619
do is make something here which is you

1288
00:54:12,710 --> 00:54:17,389
know literally going to be just a thing

1289
00:54:15,619 --> 00:54:20,089
that I guess it's sort of like make

1290
00:54:17,389 --> 00:54:24,289
empty bitmap right it's going to be like

1291
00:54:20,090 --> 00:54:26,930
make fake or make a sphere normal map

1292
00:54:24,289 --> 00:54:31,099
right and all I'm going to do is I'm

1293
00:54:26,929 --> 00:54:33,889
going to do exactly this right in fact I

1294
00:54:31,099 --> 00:54:34,969
can even call this function in fact you

1295
00:54:33,889 --> 00:54:36,529
know what I could do is just say you

1296
00:54:34,969 --> 00:54:38,980
know what assume you've got one from

1297
00:54:36,530 --> 00:54:42,790
somewhere so we'll take a loaded bitmap

1298
00:54:38,980 --> 00:54:45,469
shooting we'll take a loaded bitmap

1299
00:54:42,789 --> 00:54:46,909
pointer and we'll just say that whatever

1300
00:54:45,469 --> 00:54:48,529
happens here you're gonna write in a

1301
00:54:46,909 --> 00:54:51,079
basically a spherical normal app so what

1302
00:54:48,530 --> 00:54:53,900
I'm gonna do is I'm going to say that

1303
00:54:51,079 --> 00:54:57,829
okay this normal map that we're going to

1304
00:54:53,900 --> 00:55:01,250
create right is just going to literally

1305
00:54:57,829 --> 00:55:03,619
be like a sphere you know it's just

1306
00:55:01,250 --> 00:55:06,650
gonna be like this sort of thing and so

1307
00:55:03,619 --> 00:55:08,210
you know when you look at it the normals

1308
00:55:06,650 --> 00:55:10,730
here will all point in these directions

1309
00:55:08,210 --> 00:55:13,340
off right the normal here will be

1310
00:55:10,730 --> 00:55:15,199
pointing directly up at you over here it

1311
00:55:13,340 --> 00:55:16,670
will be pointing slightly that way right

1312
00:55:15,199 --> 00:55:20,119
so it's just gonna be as if you were

1313
00:55:16,670 --> 00:55:23,210
looking down on a dome right that's all

1314
00:55:20,119 --> 00:55:24,868
I want to do so if I was going to do

1315
00:55:23,210 --> 00:55:26,880
that right

1316
00:55:24,869 --> 00:55:31,278
what I would do is I'm going to loop

1317
00:55:26,880 --> 00:55:44,028
over both x and y very straightforwardly

1318
00:55:31,278 --> 00:55:47,639
so here's my X like so and here's my Y

1319
00:55:44,028 --> 00:55:49,768
and for each pixel in here I'm going to

1320
00:55:47,639 --> 00:55:51,420
generate a normal based on that x and y

1321
00:55:49,768 --> 00:55:54,598
and again that's going to be based off

1322
00:55:51,420 --> 00:55:58,079
of sort of the U and V if you will of

1323
00:55:54,599 --> 00:56:00,990
this of this bitmap like where I am in

1324
00:55:58,079 --> 00:56:07,528
it so if I wanted to I could make this

1325
00:56:00,989 --> 00:56:08,699
the in width here right like so does

1326
00:56:07,528 --> 00:56:10,949
that same thing we're computing before

1327
00:56:08,699 --> 00:56:12,509
and the in flight and this is just to

1328
00:56:10,949 --> 00:56:16,828
give us some normalized values that we

1329
00:56:12,509 --> 00:56:19,829
know range from 0 to 1 across the bitmap

1330
00:56:16,829 --> 00:56:23,490
all right so there's our invite same

1331
00:56:19,829 --> 00:56:26,818
thing so if I want to produce sort of

1332
00:56:23,489 --> 00:56:29,699
the bitmap UV at that point it's going

1333
00:56:26,818 --> 00:56:33,088
to be that in width times whatever the X

1334
00:56:29,699 --> 00:56:37,889
is and the in height times whatever the

1335
00:56:33,088 --> 00:56:39,449
Y is okay and that bitmap UV is what

1336
00:56:37,889 --> 00:56:42,058
will allow me to create a normal at that

1337
00:56:39,449 --> 00:56:43,219
point so I could say that the normal at

1338
00:56:42,059 --> 00:56:46,739
that point

1339
00:56:43,219 --> 00:56:50,268
you name the normal at that point is

1340
00:56:46,739 --> 00:56:56,818
just going to be the normalized version

1341
00:56:50,268 --> 00:56:59,159
right of of this guy right if I first

1342
00:56:56,818 --> 00:57:03,960
was to say let's have it range from

1343
00:56:59,159 --> 00:57:05,969
negative 1 to 1 right so you know all

1344
00:57:03,960 --> 00:57:07,528
the way on the left side it's pointing

1345
00:57:05,969 --> 00:57:10,108
out and all the way on the right side

1346
00:57:07,528 --> 00:57:12,239
it's pointing right so we'll just kind

1347
00:57:10,108 --> 00:57:15,989
of do that we'll say all right whatever

1348
00:57:12,239 --> 00:57:17,630
the X is of this guy it's going to be

1349
00:57:15,989 --> 00:57:20,130
and this was that equation that I used

1350
00:57:17,630 --> 00:57:23,039
back when we were doing the splats I

1351
00:57:20,130 --> 00:57:25,528
think where I was sort of creating a

1352
00:57:23,039 --> 00:57:27,359
bilinear value out of a linear value

1353
00:57:25,528 --> 00:57:29,338
right I'm just going to multiply it by 2

1354
00:57:27,358 --> 00:57:30,598
so instead of going from 0 to 1 it's now

1355
00:57:29,338 --> 00:57:31,949
going from 0 to 2 and then I'm going to

1356
00:57:30,599 --> 00:57:32,759
subtract 1 so now it's going from

1357
00:57:31,949 --> 00:57:37,348
negative 1 to 1

1358
00:57:32,759 --> 00:57:38,940
right so my normal is just that in both

1359
00:57:37,349 --> 00:57:42,870
cases and

1360
00:57:38,940 --> 00:57:48,570
and the other guy right so I've got my

1361
00:57:42,869 --> 00:57:51,000
ex and I've got my why I'm trying to

1362
00:57:48,570 --> 00:57:54,330
think now do I actually need to think

1363
00:57:51,000 --> 00:58:01,170
about what the other value what the Z

1364
00:57:54,329 --> 00:58:06,119
value actually would be yeah because I I

1365
00:58:01,170 --> 00:58:07,200
also need right this is not quite gonna

1366
00:58:06,119 --> 00:58:09,239
do it for me

1367
00:58:07,199 --> 00:58:11,039
this is not quite gonna do it because

1368
00:58:09,239 --> 00:58:20,669
this is just gonna give me the flat

1369
00:58:11,039 --> 00:58:22,289
values in the plane hmm all right I

1370
00:58:20,670 --> 00:58:24,360
gotta think this through a little bit

1371
00:58:22,289 --> 00:58:26,070
more because of this this means I'll

1372
00:58:24,360 --> 00:58:27,390
have to what I was kind of hoping is

1373
00:58:26,070 --> 00:58:29,490
that we'd have some values in here I

1374
00:58:27,389 --> 00:58:31,739
guess I actually have to think about the

1375
00:58:29,489 --> 00:58:34,429
actual sphere itself right

1376
00:58:31,739 --> 00:58:38,189
I actually I have to actually produce

1377
00:58:34,429 --> 00:58:40,139
this the the actual sphere so I can

1378
00:58:38,190 --> 00:58:43,099
think about what the three values would

1379
00:58:40,139 --> 00:58:46,079
actually be at that point I fig I don't

1380
00:58:43,099 --> 00:58:51,889
maybe I'm missing the like cheap way to

1381
00:58:46,079 --> 00:58:56,340
get that but I don't think so

1382
00:58:51,889 --> 00:58:59,309
mmm yeah I don't I don't think so

1383
00:58:56,340 --> 00:59:01,500
I'm pretty sure so I guess what I would

1384
00:58:59,309 --> 00:59:02,639
say is well you know we could do there

1385
00:59:01,500 --> 00:59:04,590
actually is a pretty cheap way

1386
00:59:02,639 --> 00:59:08,460
I guess I could just say you know what

1387
00:59:04,590 --> 00:59:11,130
the Z value is just going to be those

1388
00:59:08,460 --> 00:59:13,440
two combined right in other words the

1389
00:59:11,130 --> 00:59:16,650
closer you are to the center of this

1390
00:59:13,440 --> 00:59:18,480
thing the more the whatever that's going

1391
00:59:16,650 --> 00:59:20,010
to determine what the the actual Z

1392
00:59:18,480 --> 00:59:22,230
pointing value is as well or something

1393
00:59:20,010 --> 00:59:25,230
like that right that would be pretty

1394
00:59:22,230 --> 00:59:28,380
straightforward so I could do something

1395
00:59:25,230 --> 00:59:30,119
where I said you know start with that

1396
00:59:28,380 --> 00:59:34,890
and then say normal about the equals

1397
00:59:30,119 --> 00:59:37,529
normal dot X plus normal dot y will do

1398
00:59:34,889 --> 00:59:39,569
the absolute value here this is probably

1399
00:59:37,530 --> 00:59:42,600
a bad idea we should probably actually

1400
00:59:39,570 --> 00:59:44,400
do this correctly so I'm just gonna

1401
00:59:42,599 --> 00:59:46,380
throw this in for now and maybe maybe

1402
00:59:44,400 --> 00:59:49,619
tomorrow stream will be how do we

1403
00:59:46,380 --> 00:59:50,220
generate a good simple simple thing

1404
00:59:49,619 --> 00:59:52,289
there

1405
00:59:50,219 --> 00:59:54,629
but anyway then I'll normalize that

1406
00:59:52,289 --> 00:59:57,239
normal right which I you know will give

1407
00:59:54,630 --> 00:59:59,160
me back the actual normal value and then

1408
00:59:57,239 --> 01:00:01,979
we'll have the color that we want to

1409
00:59:59,159 --> 01:00:06,449
write in will actually just be the

1410
01:00:01,980 --> 01:00:10,590
normal and then our surface our surface

1411
01:00:06,449 --> 01:00:15,210
values so our roughness value and

1412
01:00:10,590 --> 01:00:17,820
there's that roughness value so we can

1413
01:00:15,210 --> 01:00:19,170
do that pretty easily and unfortunately

1414
01:00:17,820 --> 01:00:22,650
we're pretty much out of time

1415
01:00:19,170 --> 01:00:26,070
so I guess I could quickly slam in this

1416
01:00:22,650 --> 01:00:28,740
thing here in terms of actually writing

1417
01:00:26,070 --> 01:00:32,609
to the bitmap we could grab the code

1418
01:00:28,739 --> 01:00:36,059
from from render group that says draw a

1419
01:00:32,608 --> 01:00:42,659
rectangle so we could go ahead and do

1420
01:00:36,059 --> 01:00:47,130
this row equals buffer memory write row

1421
01:00:42,659 --> 01:00:49,529
plus equals pitch on each line and then

1422
01:00:47,130 --> 01:00:52,950
for each one of these we just do pixel

1423
01:00:49,530 --> 01:00:55,200
and then the start pixel equals that

1424
01:00:52,949 --> 01:00:57,929
packing so you know that's the other

1425
01:00:55,199 --> 01:01:02,519
thing too this guy right here we could

1426
01:00:57,929 --> 01:01:04,259
certainly make this stuff be we should

1427
01:01:02,519 --> 01:01:06,269
probably pull this stuff out as well we

1428
01:01:04,260 --> 01:01:08,430
do this sort of thing enough we should

1429
01:01:06,269 --> 01:01:10,920
we should go ahead and make this B and

1430
01:01:08,429 --> 01:01:12,719
you know something more reasonable but

1431
01:01:10,920 --> 01:01:14,099
anyway so if this becomes our color

1432
01:01:12,719 --> 01:01:16,588
value again the thing that we would have

1433
01:01:14,099 --> 01:01:19,320
to do here once we have our normal we'd

1434
01:01:16,588 --> 01:01:23,639
have to translate these back into the

1435
01:01:19,320 --> 01:01:25,740
right spaces 0 to 255 and and we'll have

1436
01:01:23,639 --> 01:01:28,348
to unpack them correctly as well so I'll

1437
01:01:25,739 --> 01:01:29,399
just quickly do a thing that that sort

1438
01:01:28,349 --> 01:01:30,960
of gets us a little closer there and

1439
01:01:29,400 --> 01:01:33,420
we'll save most of the rest of the stuff

1440
01:01:30,960 --> 01:01:38,130
that we're going to do for next time so

1441
01:01:33,420 --> 01:01:39,750
here is our color value like so our

1442
01:01:38,130 --> 01:01:43,710
roughness value has to be multiplied by

1443
01:01:39,750 --> 01:01:45,630
255 these values are ranging from

1444
01:01:43,710 --> 01:01:50,519
negative 1 to 1 so they're actually

1445
01:01:45,630 --> 01:01:54,480
going to be 255 times whatever the value

1446
01:01:50,519 --> 01:01:58,349
is we have to you know basically put it

1447
01:01:54,480 --> 01:01:59,909
up into the range of 0 to 1 so this is

1448
01:01:58,349 --> 01:02:01,780
going to be negative 1 to 1 we have to

1449
01:01:59,909 --> 01:02:05,379
change its range there

1450
01:02:01,780 --> 01:02:08,110
sense to me

1451
01:02:05,380 --> 01:02:09,490
similarly the normal Z we kind of know

1452
01:02:08,110 --> 01:02:12,039
that that's always going to be pointing

1453
01:02:09,489 --> 01:02:15,549
upwards so that one actually I can just

1454
01:02:12,039 --> 01:02:16,989
be directly treated as a smaller value I

1455
01:02:15,550 --> 01:02:19,240
suppose since we know that it's it's

1456
01:02:16,989 --> 01:02:21,309
never going to actually be negative and

1457
01:02:19,239 --> 01:02:23,949
then this guy similarly has to be

1458
01:02:21,309 --> 01:02:29,710
handled the exact same way as the normal

1459
01:02:23,949 --> 01:02:34,679
X okay there we go

1460
01:02:29,710 --> 01:02:34,679
I didn't mean buffer I meant bitmap and

1461
01:02:35,190 --> 01:02:39,760
what is the question here Oh signed

1462
01:02:37,809 --> 01:02:41,230
unsigned mismatch sorry about that

1463
01:02:39,760 --> 01:02:43,990
if you really want those to be signed

1464
01:02:41,230 --> 01:02:46,210
they can certainly be signed I thought

1465
01:02:43,989 --> 01:02:49,289
we had a normalized function in our

1466
01:02:46,210 --> 01:02:53,409
handmade math dot age do we not have one

1467
01:02:49,289 --> 01:02:55,199
normalize I guess we don't we certainly

1468
01:02:53,409 --> 01:02:57,940
done the normalization operation before

1469
01:02:55,199 --> 01:03:00,460
but I guess it's true we don't we don't

1470
01:02:57,940 --> 01:03:01,360
have one normalize of course is very

1471
01:03:00,460 --> 01:03:04,090
simple right

1472
01:03:01,360 --> 01:03:06,640
normalized just takes in a vector and

1473
01:03:04,090 --> 01:03:11,289
divides it by its own Mike do we have

1474
01:03:06,639 --> 01:03:13,629
oh do we have normalizer zero anywhere

1475
01:03:11,289 --> 01:03:15,610
no wow we have we've never inflicted a

1476
01:03:13,630 --> 01:03:18,550
normalized it's weird that we've gotten

1477
01:03:15,610 --> 01:03:21,220
this far doing that but pretty simple

1478
01:03:18,550 --> 01:03:23,140
right it's just a vector divided by its

1479
01:03:21,219 --> 01:03:26,069
length and I thought we had sort of

1480
01:03:23,139 --> 01:03:30,129
talked about that so I wonder if we just

1481
01:03:26,070 --> 01:03:32,980
yeah yeah that's pretty weird pretty

1482
01:03:30,130 --> 01:03:33,250
weird all right well anyway very simple

1483
01:03:32,980 --> 01:03:37,030
oops

1484
01:03:33,250 --> 01:03:38,889
it's length not its length squared so

1485
01:03:37,030 --> 01:03:40,660
that's about it and like I said we're

1486
01:03:38,889 --> 01:03:45,730
out of time so I will go ahead and wrap

1487
01:03:40,659 --> 01:03:48,190
things up I guess this doesn't do yeah

1488
01:03:45,730 --> 01:03:50,449
divide operator so we'll just go ahead

1489
01:03:48,190 --> 01:03:53,240
and do it that way

1490
01:03:50,449 --> 01:03:55,548
and this is bitmap I think we're back to

1491
01:03:53,239 --> 01:03:56,989
compiling and again we have set

1492
01:03:55,548 --> 01:03:59,239
ourselves up to do in our laps

1493
01:03:56,989 --> 01:04:01,098
and we've got most of the stuff in there

1494
01:03:59,239 --> 01:04:03,289
but we have it quite gotten all the way

1495
01:04:01,099 --> 01:04:05,630
so we'll have to spend tomorrow actually

1496
01:04:03,289 --> 01:04:10,548
doing some more stuff with the normal

1497
01:04:05,630 --> 01:04:13,030
maps this is not quite right so I'll

1498
01:04:10,548 --> 01:04:17,980
just what to do in here actually

1499
01:04:13,030 --> 01:04:21,170
generate sphere here we'll just say that

1500
01:04:17,980 --> 01:04:23,269
and then we can you know we can play

1501
01:04:21,170 --> 01:04:27,349
with that tomorrow so I'll go ahead and

1502
01:04:23,269 --> 01:04:30,500
go to the Q &amp; A and we can field any

1503
01:04:27,349 --> 01:04:35,660
questions that there might be I don't

1504
01:04:30,500 --> 01:04:36,829
start that now and yeah I think we made

1505
01:04:35,659 --> 01:04:39,588
pretty good progress like I said there's

1506
01:04:36,829 --> 01:04:41,630
a lot of bookkeeping and so tomorrow

1507
01:04:39,588 --> 01:04:42,769
we'll be sure that plenty of time to

1508
01:04:41,630 --> 01:04:44,630
start playing with the normal and

1509
01:04:42,769 --> 01:04:45,739
getting the actual environment Maps and

1510
01:04:44,630 --> 01:04:47,059
the sampling of that sort of stuff we

1511
01:04:45,739 --> 01:04:49,608
should have cleaned out but there's a

1512
01:04:47,059 --> 01:04:53,440
lot of bit a lot of stuff there that we

1513
01:04:49,608 --> 01:04:53,440
actually have to do if that makes sense

1514
01:05:01,780 --> 01:05:05,870
your 2d art already seems to have some

1515
01:05:04,309 --> 01:05:06,949
shading will that just represent ambient

1516
01:05:05,869 --> 01:05:09,170
lighting when mixed with this dynamic

1517
01:05:06,949 --> 01:05:10,809
lighting you're trying to do yes that's

1518
01:05:09,170 --> 01:05:14,720
correct

1519
01:05:10,809 --> 01:05:16,869
you know we can't really there's really

1520
01:05:14,719 --> 01:05:19,129
no way with a 2d game it's just not

1521
01:05:16,869 --> 01:05:22,039
possible to really do all of the

1522
01:05:19,130 --> 01:05:24,260
lighting in code

1523
01:05:22,039 --> 01:05:27,739
you know because you just don't have

1524
01:05:24,260 --> 01:05:29,330
nearly the fidelity you would need to to

1525
01:05:27,739 --> 01:05:31,759
really do that effectively I don't think

1526
01:05:29,329 --> 01:05:33,440
and so what we'll try to aim for with

1527
01:05:31,760 --> 01:05:35,510
all of our art assets is they should

1528
01:05:33,440 --> 01:05:38,480
look like they are sort of ambiently lit

1529
01:05:35,510 --> 01:05:41,360
to some degree in a sort of basic way

1530
01:05:38,480 --> 01:05:44,480
and then we will sort of apply lighting

1531
01:05:41,360 --> 01:05:46,940
on top of that which is you know not the

1532
01:05:44,480 --> 01:05:48,650
way you would do it if you were going to

1533
01:05:46,940 --> 01:05:50,119
compute all of the lighting because

1534
01:05:48,650 --> 01:05:51,530
lighting is normally an additive process

1535
01:05:50,119 --> 01:05:54,949
and this is gonna be more of a

1536
01:05:51,530 --> 01:05:59,480
subtractive process right but you know

1537
01:05:54,949 --> 01:06:02,000
what can you do it makes fear a normal

1538
01:05:59,480 --> 01:06:04,340
map should y less than bitmap whitby

1539
01:06:02,000 --> 01:06:09,730
while it yes yes that that should be

1540
01:06:04,340 --> 01:06:09,730
thank you typo there

1541
01:06:14,699 --> 01:06:18,609
how far do you think you can increase

1542
01:06:16,840 --> 01:06:19,900
the capabilities of an engine like this

1543
01:06:18,610 --> 01:06:21,519
before you start to suffer from

1544
01:06:19,900 --> 01:06:26,559
performance constraints due to using

1545
01:06:21,519 --> 01:06:27,699
only the CPU well I guess I mean sort of

1546
01:06:26,559 --> 01:06:30,549
the answer that is we don't really care

1547
01:06:27,699 --> 01:06:32,500
because we're not shipping the CPU

1548
01:06:30,550 --> 01:06:34,810
version as the version that players will

1549
01:06:32,500 --> 01:06:39,340
play we're just writing the CPU version

1550
01:06:34,809 --> 01:06:41,799
for educational purposes so if we

1551
01:06:39,340 --> 01:06:45,370
actually had to ship the CPU version

1552
01:06:41,800 --> 01:06:48,490
like for some reason we were trying to

1553
01:06:45,369 --> 01:06:51,190
ship into a market where GPUs didn't

1554
01:06:48,489 --> 01:06:52,989
exist which I don't even know where that

1555
01:06:51,190 --> 01:06:57,150
would because all machines have them now

1556
01:06:52,989 --> 01:06:57,149
but if you were trying to do that um

1557
01:06:57,449 --> 01:07:01,929
yeah we might get away with this I mean

1558
01:07:00,280 --> 01:07:03,880
we'd have to really spend a lot of time

1559
01:07:01,929 --> 01:07:07,829
optimizing it but we might be able to do

1560
01:07:03,880 --> 01:07:07,829
this at some of this dynamic lighting

1561
01:07:08,610 --> 01:07:12,430
you know like I said we got what we

1562
01:07:10,900 --> 01:07:14,950
probably would have to spend a lot more

1563
01:07:12,429 --> 01:07:16,539
time optimizing it than we will because

1564
01:07:14,949 --> 01:07:17,980
we'll just optimize it a little to kind

1565
01:07:16,539 --> 01:07:22,269
of show how you would do it and get it

1566
01:07:17,980 --> 01:07:23,949
running like okay right and you know if

1567
01:07:22,269 --> 01:07:26,139
it's too slow if it's only 15 frames a

1568
01:07:23,949 --> 01:07:28,059
second and it's running at 320 by 240 or

1569
01:07:26,139 --> 01:07:32,230
something that's okay because we just

1570
01:07:28,059 --> 01:07:34,329
wanted to show how to do it but you know

1571
01:07:32,230 --> 01:07:35,349
if you actually wanted to actually run

1572
01:07:34,329 --> 01:07:38,860
this at a reasonable resolution

1573
01:07:35,349 --> 01:07:41,110
reasonable frame rate yeah I mean

1574
01:07:38,860 --> 01:07:44,260
obviously doing dynamic lighting is

1575
01:07:41,110 --> 01:07:45,849
expensive and you might be able to you

1576
01:07:44,260 --> 01:07:49,000
you might be better off picking a

1577
01:07:45,849 --> 01:07:50,469
simpler scheme for lighting as well but

1578
01:07:49,000 --> 01:07:51,969
I don't want to do that because like I

1579
01:07:50,469 --> 01:07:53,889
said we don't have to we don't have to

1580
01:07:51,969 --> 01:07:58,029
care how fast our CPU version is it's

1581
01:07:53,889 --> 01:07:59,980
it's it's for educational purposes don't

1582
01:07:58,030 --> 01:08:01,750
you need to srgb to linear one the

1583
01:07:59,980 --> 01:08:05,490
normals or use the normals instead of

1584
01:08:01,750 --> 01:08:10,539
the Texel in the lerp so we we kind of

1585
01:08:05,489 --> 01:08:13,259
endeavor to that so when we do the lerp

1586
01:08:10,539 --> 01:08:17,769
here when we unpack these and lerp

1587
01:08:13,260 --> 01:08:20,170
basically oh that's good some reason

1588
01:08:17,770 --> 01:08:26,310
Texel did not get replaced there there

1589
01:08:20,170 --> 01:08:29,609
we go when we do this right we

1590
01:08:26,310 --> 01:08:33,210
we could decode these from two zero to

1591
01:08:29,609 --> 01:08:35,400
one first but we could just leave them

1592
01:08:33,210 --> 01:08:36,420
this way because we don't actually know

1593
01:08:35,399 --> 01:08:38,608
what we're going to do with them in

1594
01:08:36,420 --> 01:08:41,100
sample environment math so the answer is

1595
01:08:38,609 --> 01:08:43,770
we definitely don't want to use srgb to

1596
01:08:41,100 --> 01:08:46,710
d5 to linear because normals are not

1597
01:08:43,770 --> 01:08:49,380
encoded in srgb right they're not a

1598
01:08:46,710 --> 01:08:53,159
perceptual brightness value so normals

1599
01:08:49,380 --> 01:08:55,170
will be encoded exactly linearly what we

1600
01:08:53,159 --> 01:08:58,710
do with them in terms of unpacking we

1601
01:08:55,170 --> 01:08:59,789
could divide them in fact no I think

1602
01:08:58,710 --> 01:09:01,859
this is correct

1603
01:08:59,789 --> 01:09:03,869
because we don't want to bother

1604
01:09:01,859 --> 01:09:06,050
multiplying these guys to make them not

1605
01:09:03,869 --> 01:09:08,939
in the range to make them zero to one

1606
01:09:06,050 --> 01:09:12,088
until after the lerp because that way we

1607
01:09:08,939 --> 01:09:13,858
can just do the multiply on the

1608
01:09:12,088 --> 01:09:15,838
resulting value and save a bunch of

1609
01:09:13,859 --> 01:09:17,760
computations the only reason we had to

1610
01:09:15,838 --> 01:09:21,539
do these here is because we wanted to do

1611
01:09:17,760 --> 01:09:23,460
the lerp in light linear space so does

1612
01:09:21,539 --> 01:09:26,789
that make sense so we really don't want

1613
01:09:23,460 --> 01:09:29,310
to decode these guys into the zero to

1614
01:09:26,789 --> 01:09:31,819
one range until after we composite them

1615
01:09:29,310 --> 01:09:31,819
I believe

1616
01:09:44,798 --> 01:09:51,250
sudonym service II says normal Z equals

1617
01:09:47,500 --> 01:09:53,739
square root of 1.0 - normal squared -

1618
01:09:51,250 --> 01:10:00,039
normal y squared I was thinking that but

1619
01:09:53,739 --> 01:10:01,840
does that actually do the right thing is

1620
01:10:00,039 --> 01:10:04,180
that actually gonna produce trick III

1621
01:10:01,840 --> 01:10:08,770
want to believe that's true so let's

1622
01:10:04,180 --> 01:10:10,090
just say that it's true and then we'll

1623
01:10:08,770 --> 01:10:12,520
see if it's true

1624
01:10:10,090 --> 01:10:14,350
sudonym 73 is our resident math expert

1625
01:10:12,520 --> 01:10:15,460
anyway so let's just assume that he's

1626
01:10:14,350 --> 01:10:17,650
thought about it and it's gonna be

1627
01:10:15,460 --> 01:10:20,079
correct and what he was suggesting is

1628
01:10:17,649 --> 01:10:22,960
well if instead of normalizing the

1629
01:10:20,079 --> 01:10:26,140
normal you actually just let the final

1630
01:10:22,960 --> 01:10:28,980
component B what the normalization would

1631
01:10:26,140 --> 01:10:31,329
be that will produce the sphere shape

1632
01:10:28,979 --> 01:10:33,339
does that make sense and so he's

1633
01:10:31,329 --> 01:10:35,890
basically saying well just take the X

1634
01:10:33,340 --> 01:10:40,569
and the y in fact it's just the length

1635
01:10:35,890 --> 01:10:46,329
right of this vector just take that and

1636
01:10:40,569 --> 01:10:50,439
let that be your you know your your

1637
01:10:46,329 --> 01:10:56,590
final value right whatever the whatever

1638
01:10:50,439 --> 01:10:58,210
the yeah whatever the the the squared

1639
01:10:56,590 --> 01:11:00,340
length of a although I guess you're

1640
01:10:58,210 --> 01:11:04,689
saying that we actually would have to

1641
01:11:00,340 --> 01:11:05,949
solve it inside the radical so I guess

1642
01:11:04,689 --> 01:11:08,250
you're saying we would have to do this

1643
01:11:05,949 --> 01:11:08,250
right

1644
01:11:13,448 --> 01:11:23,359
meaning the thing that I showed right

1645
01:11:16,789 --> 01:11:25,340
here this guy he's suggesting just

1646
01:11:23,359 --> 01:11:30,439
actually compute that so basically you

1647
01:11:25,340 --> 01:11:40,520
do again 1 minus X words y squared or Y

1648
01:11:30,439 --> 01:11:41,719
squared Z squared right like so right or

1649
01:11:40,520 --> 01:11:44,420
I guess I could also write it like this

1650
01:11:41,719 --> 01:11:46,698
that's how you wrote it in the Q&amp;A so

1651
01:11:44,420 --> 01:11:48,949
that's doing this actual equation and I

1652
01:11:46,698 --> 01:11:52,698
guess that does that produce the sphere

1653
01:11:48,948 --> 01:11:55,339
shape maybe it does I don't know let's

1654
01:11:52,698 --> 01:11:59,289
let's assume that it does for now and

1655
01:11:55,340 --> 01:11:59,289
we'll we'll just keep going

1656
01:12:04,930 --> 01:12:09,400
is your lighting look up a similar

1657
01:12:07,090 --> 01:12:12,039
technique to Matt Capps used in other

1658
01:12:09,399 --> 01:12:21,579
software I have no idea I don't know

1659
01:12:12,039 --> 01:12:23,319
what Matt Capps actually are what

1660
01:12:21,579 --> 01:12:24,729
benefits do you see from using the extra

1661
01:12:23,319 --> 01:12:26,079
time it takes to create your own engine

1662
01:12:24,729 --> 01:12:28,029
from scratch is it worth it in your

1663
01:12:26,079 --> 01:12:29,559
opinion we answer that on yesterday's

1664
01:12:28,029 --> 01:12:31,389
Q&amp;A so you can take a look at

1665
01:12:29,560 --> 01:12:37,210
yesterday's Q&amp;A if you want to see the

1666
01:12:31,390 --> 01:12:38,920
answer to that ah students turning 3 the

1667
01:12:37,210 --> 01:12:40,300
catch is that it's going to take the

1668
01:12:38,920 --> 01:12:42,340
square root of a negative number if

1669
01:12:40,300 --> 01:12:46,270
you're outside the sphere well you know

1670
01:12:42,340 --> 01:12:49,239
that's okay because what we could do

1671
01:12:46,270 --> 01:12:54,880
there is just clamp it right we could

1672
01:12:49,239 --> 01:12:58,739
say you know clamp this or or or take

1673
01:12:54,880 --> 01:13:04,060
the minimum right I'm sorry the maximum

1674
01:12:58,739 --> 01:13:05,469
of like of this you know what I'm saying

1675
01:13:04,060 --> 01:13:08,710
like the or I should say the minimum

1676
01:13:05,470 --> 01:13:14,380
just don't let it get above one right so

1677
01:13:08,710 --> 01:13:15,569
the minimum of that right that seems

1678
01:13:14,380 --> 01:13:17,650
fair

1679
01:13:15,569 --> 01:13:19,929
cuz we don't care what's outside is

1680
01:13:17,649 --> 01:13:25,059
we're just this is just a simple test so

1681
01:13:19,930 --> 01:13:26,409
that's totally fine and I guess we've

1682
01:13:25,060 --> 01:13:27,580
got a little bit of time left here and

1683
01:13:26,409 --> 01:13:29,859
there aren't any other questions so we

1684
01:13:27,579 --> 01:13:31,269
could just try running this we could

1685
01:13:29,859 --> 01:13:32,589
just try running the mixer a normal map

1686
01:13:31,270 --> 01:13:34,270
to see what it does although I guess

1687
01:13:32,590 --> 01:13:35,890
I'll save that for next the next time

1688
01:13:34,270 --> 01:13:38,550
that's for people who aren't watching

1689
01:13:35,890 --> 01:13:38,550
the q and A's

1690
01:13:41,550 --> 01:13:54,079
any other questions before we move move

1691
01:13:44,399 --> 01:13:54,079
on yeah right

1692
01:14:03,210 --> 01:14:08,920
well it looks like we have come to the

1693
01:14:05,469 --> 01:14:10,630
end of the questions so we'll pick back

1694
01:14:08,920 --> 01:14:13,480
up at with makes for a normal map

1695
01:14:10,630 --> 01:14:14,859
tomorrow again we've done most of the

1696
01:14:13,479 --> 01:14:15,968
plumbing stuff so hopefully we'll be

1697
01:14:14,859 --> 01:14:18,158
able to kind of go through and like

1698
01:14:15,969 --> 01:14:19,420
actually fix a typos that have got in

1699
01:14:18,158 --> 01:14:21,670
there and also just kind of go through

1700
01:14:19,420 --> 01:14:23,500
and and play with it and see what they

1701
01:14:21,670 --> 01:14:26,350
what the normal Maps look like and then

1702
01:14:23,500 --> 01:14:28,119
try to get them actually sampling into

1703
01:14:26,350 --> 01:14:30,489
our into our environment Maps so that we

1704
01:14:28,119 --> 01:14:31,750
can see you know something can I go like

1705
01:14:30,488 --> 01:14:33,279
all right how does this work is this

1706
01:14:31,750 --> 01:14:35,590
something that we can use is it actually

1707
01:14:33,279 --> 01:14:38,198
valuable and play with it a little bit

1708
01:14:35,590 --> 01:14:39,520
and that probably what we do next week

1709
01:14:38,198 --> 01:14:41,408
is just trying to play around those

1710
01:14:39,520 --> 01:14:43,690
environment Maps see if we can get them

1711
01:14:41,408 --> 01:14:45,879
to do something useful and maybe letting

1712
01:14:43,689 --> 01:14:46,839
that inform us a little bit because like

1713
01:14:45,880 --> 01:14:48,699
I said we don't really know we're gonna

1714
01:14:46,840 --> 01:14:50,679
do with that middle plane which is kind

1715
01:14:48,698 --> 01:14:52,329
of the thing that's a little more a

1716
01:14:50,679 --> 01:14:55,029
little more difficult because it's the

1717
01:14:52,329 --> 01:14:56,829
active area it's the area where you know

1718
01:14:55,029 --> 01:14:58,448
like things are you know if a fireball

1719
01:14:56,829 --> 01:15:00,130
is flying by that kind of stuff

1720
01:14:58,448 --> 01:15:04,000
and so I don't really know what we're

1721
01:15:00,130 --> 01:15:05,889
gonna do about that but you know we will

1722
01:15:04,000 --> 01:15:07,510
we'll tackle it the way you know you

1723
01:15:05,889 --> 01:15:10,510
tackle hacky things like this we'll just

1724
01:15:07,510 --> 01:15:12,639
do experiments make our best guess as to

1725
01:15:10,510 --> 01:15:21,060
what to try and and move on from there

1726
01:15:12,639 --> 01:15:21,060
so I think that's good let's see

1727
01:15:21,340 --> 01:15:27,100
and yeah looks like everyone so we never

1728
01:15:24,159 --> 01:15:28,539
had a question so I will wrap it up let

1729
01:15:27,100 --> 01:15:32,800
me go ahead and save the mischief file

1730
01:15:28,539 --> 01:15:34,989
always important and I will close that

1731
01:15:32,800 --> 01:15:36,760
all right thank you everyone for joining

1732
01:15:34,989 --> 01:15:38,199
me for another episode of handmade hero

1733
01:15:36,760 --> 01:15:40,090
it's been a pleasure coding with you as

1734
01:15:38,199 --> 01:15:42,069
always if you would like to follow along

1735
01:15:40,090 --> 01:15:43,900
at home the source code you can do so by

1736
01:15:42,069 --> 01:15:45,519
going to handmade hero or Arg and

1737
01:15:43,899 --> 01:15:46,960
pre-ordering the game it comes with the

1738
01:15:45,520 --> 01:15:48,730
source code during its whole development

1739
01:15:46,960 --> 01:15:50,619
so if you want to follow along that's an

1740
01:15:48,729 --> 01:15:52,419
easy way to do so you can also subscribe

1741
01:15:50,619 --> 01:15:53,680
to our patreon if you want to support

1742
01:15:52,420 --> 01:15:55,659
the video series it's always much

1743
01:15:53,680 --> 01:15:57,100
appreciated we also have a forum site

1744
01:15:55,659 --> 01:15:59,680
you can go to to ask questions and that

1745
01:15:57,100 --> 01:16:01,810
has community dun ports to Mac and Linux

1746
01:15:59,680 --> 01:16:05,560
stuff like that and we have a tweet bot

1747
01:16:01,810 --> 01:16:06,880
that you can go use to see what schedule

1748
01:16:05,560 --> 01:16:08,320
is so if you want to catch a live stream

1749
01:16:06,880 --> 01:16:10,090
get tweets to schedule at you every day

1750
01:16:08,319 --> 01:16:11,979
and it's easy it makes it easy to know

1751
01:16:10,090 --> 01:16:12,579
when the stream is going to be so that's

1752
01:16:11,979 --> 01:16:14,439
about it

1753
01:16:12,579 --> 01:16:16,210
thanks for joining me and we'll be back

1754
01:16:14,439 --> 01:16:18,219
here same time same place tomorrow 5:00

1755
01:16:16,210 --> 01:16:20,199
p.m. on Twitch where we will play around

1756
01:16:18,220 --> 01:16:22,630
those normal Maps and see how they work

1757
01:16:20,199 --> 01:16:24,869
so thanks for joining me and I'll talk

1758
01:16:22,630 --> 01:16:24,869
to you tomorrow

