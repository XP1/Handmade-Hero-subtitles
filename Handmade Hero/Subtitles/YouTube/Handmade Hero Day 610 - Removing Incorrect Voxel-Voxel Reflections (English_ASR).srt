1
00:00:00,680 --> 00:00:04,919
hello everyone and welcome to handmade

2
00:00:03,388 --> 00:00:09,209
Hero show where I code a complete game

3
00:00:04,919 --> 00:00:12,888
live on stream we ended in a very

4
00:00:09,210 --> 00:00:16,350
fortuitous place yesterday actually we

5
00:00:12,888 --> 00:00:18,778
kind of I don't know we we just had a

6
00:00:16,350 --> 00:00:21,449
good day I guess you would say

7
00:00:18,778 --> 00:00:24,629
the both things I wanted to look at and

8
00:00:21,449 --> 00:00:28,170
try to do just kind of worked it seemed

9
00:00:24,629 --> 00:00:29,608
like right right off the bat and maybe

10
00:00:28,170 --> 00:00:31,080
we've got some lurking bugs in there

11
00:00:29,609 --> 00:00:35,130
because we haven't really gone through

12
00:00:31,079 --> 00:00:37,349
it with a fine-tooth comb but it was

13
00:00:35,130 --> 00:00:40,050
pretty great and so if you take a look

14
00:00:37,350 --> 00:00:44,250
at where we ended up we put in some some

15
00:00:40,049 --> 00:00:46,229
testing that we were going to we

16
00:00:44,250 --> 00:00:47,729
returned all the reflectors red so we

17
00:00:46,229 --> 00:00:51,328
could tell the difference between direct

18
00:00:47,729 --> 00:00:52,769
light and indirect light for example but

19
00:00:51,329 --> 00:00:55,469
if you take a look at where we left off

20
00:00:52,770 --> 00:00:58,440
we have some nice ways of looking at now

21
00:00:55,469 --> 00:01:02,129
what's going on with the lighting and it

22
00:00:58,439 --> 00:01:04,349
really has improved rather dramatically

23
00:01:02,128 --> 00:01:08,039
in a number of ways there are still some

24
00:01:04,349 --> 00:01:10,319
things that we want to start looking at

25
00:01:08,040 --> 00:01:12,330
now but it's it's it's quite nice with

26
00:01:10,319 --> 00:01:15,508
the way that it's actually purpose or

27
00:01:12,329 --> 00:01:19,469
tough permeating the world right and you

28
00:01:15,509 --> 00:01:22,200
can kind of see when we take a look at

29
00:01:19,469 --> 00:01:24,269
how much more solid the localized

30
00:01:22,200 --> 00:01:26,280
lighting is it doesn't leak through

31
00:01:24,269 --> 00:01:27,780
walls it doesn't really leak through the

32
00:01:26,280 --> 00:01:29,849
floor like you still get some lighting

33
00:01:27,780 --> 00:01:32,670
here just from interpolation but you can

34
00:01:29,849 --> 00:01:35,429
see that the actual light probes don't

35
00:01:32,670 --> 00:01:36,960
pick up lighting through solid objects

36
00:01:35,430 --> 00:01:39,329
anymore like they used to just because

37
00:01:36,959 --> 00:01:42,209
of the way that the blending was working

38
00:01:39,328 --> 00:01:44,429
so we've we've really got a pretty solid

39
00:01:42,209 --> 00:01:48,539
version of the lighting now and mostly

40
00:01:44,430 --> 00:01:50,640
our problem at the moment is just how do

41
00:01:48,540 --> 00:01:54,090
we now start to improve the quality

42
00:01:50,640 --> 00:01:55,978
level of the light solution so that we

43
00:01:54,090 --> 00:01:59,009
actually kind of more know what these

44
00:01:55,978 --> 00:02:01,250
values actually are and we can have sort

45
00:01:59,009 --> 00:02:01,250
of a

46
00:02:01,269 --> 00:02:08,579
an idea that we're actually producing

47
00:02:04,560 --> 00:02:11,080
stable results because even with our our

48
00:02:08,580 --> 00:02:13,810
upgrades from yesterday we haven't

49
00:02:11,080 --> 00:02:16,120
addressed like feedback problems so do

50
00:02:13,810 --> 00:02:17,920
you see you can see here there's like

51
00:02:16,120 --> 00:02:21,430
these weird feedback problems that occur

52
00:02:17,919 --> 00:02:24,069
as as I'm moving there's lag right in

53
00:02:21,430 --> 00:02:28,900
the lighting as you know there's there's

54
00:02:24,069 --> 00:02:31,479
some lag in in the light and as I spread

55
00:02:28,900 --> 00:02:33,909
the light out it kind of has like a

56
00:02:31,479 --> 00:02:37,810
feedback effect right we're lighting

57
00:02:33,909 --> 00:02:40,389
that's left in the world is is obviously

58
00:02:37,810 --> 00:02:42,610
not always converging towards a stable

59
00:02:40,389 --> 00:02:44,829
state it can sometimes feedback on

60
00:02:42,610 --> 00:02:47,320
itself and produce more lighting and the

61
00:02:44,830 --> 00:02:49,030
red that you see here like I said is the

62
00:02:47,319 --> 00:02:52,060
secondary lighting it's lighting that's

63
00:02:49,030 --> 00:02:53,590
being picked up from reflectors and you

64
00:02:52,060 --> 00:02:57,330
can see how there's just a big

65
00:02:53,590 --> 00:02:59,739
difference depending on how I do things

66
00:02:57,330 --> 00:03:01,570
here's the lighting when I stopped in

67
00:02:59,739 --> 00:03:04,270
this room but you saw how red that it

68
00:03:01,569 --> 00:03:07,780
got before when I was just moving

69
00:03:04,270 --> 00:03:10,510
through it and so that's really I think

70
00:03:07,780 --> 00:03:13,959
the last big thing that we want to

71
00:03:10,509 --> 00:03:15,669
tackle there are a bunch of clean up

72
00:03:13,959 --> 00:03:17,500
things that we want to do once we're

73
00:03:15,669 --> 00:03:20,349
pretty happy with how the lighting

74
00:03:17,500 --> 00:03:21,849
solutions actually working but in terms

75
00:03:20,349 --> 00:03:23,949
of getting to that point where we're

76
00:03:21,849 --> 00:03:26,620
really happy with it that feedback is

77
00:03:23,949 --> 00:03:30,429
just a little bit it's just a little bit

78
00:03:26,620 --> 00:03:33,310
of a problem right and so what we'd like

79
00:03:30,430 --> 00:03:35,140
to do is figure out some way because you

80
00:03:33,310 --> 00:03:38,019
saw I mean hopefully if you've if you've

81
00:03:35,139 --> 00:03:41,349
seen the past couple episodes hopefully

82
00:03:38,019 --> 00:03:45,069
you saw just how important and powerful

83
00:03:41,349 --> 00:03:49,319
it was to draw everything that we wanted

84
00:03:45,069 --> 00:03:51,849
to look at because when we are you know

85
00:03:49,319 --> 00:03:53,199
when we're trying to debug things we're

86
00:03:51,849 --> 00:03:54,189
looking for insight and what we're

87
00:03:53,199 --> 00:03:56,798
trying to improve things we're looking

88
00:03:54,189 --> 00:03:58,530
for insight into how the system's

89
00:03:56,799 --> 00:04:01,299
working and how it might work better and

90
00:03:58,530 --> 00:04:04,299
every time we introduce some kind of a

91
00:04:01,299 --> 00:04:06,810
visualization like this where we can see

92
00:04:04,299 --> 00:04:10,269
what the lighting is actually producing

93
00:04:06,810 --> 00:04:13,870
it's really pretty dramatic in terms of

94
00:04:10,269 --> 00:04:16,480
how much insight that can give

95
00:04:13,870 --> 00:04:20,019
and so the problem that I think we have

96
00:04:16,480 --> 00:04:22,360
right now is the you know this

97
00:04:20,019 --> 00:04:25,899
visualization allowed us to really

98
00:04:22,360 --> 00:04:28,870
effectively attack the problems of the

99
00:04:25,899 --> 00:04:32,709
light leaking through various places and

100
00:04:28,870 --> 00:04:34,269
and other problems of that nature so

101
00:04:32,709 --> 00:04:36,549
what I think we need to figure out now

102
00:04:34,269 --> 00:04:40,659
is how do we create a system that shows

103
00:04:36,550 --> 00:04:42,639
us something about the energy

104
00:04:40,660 --> 00:04:46,660
propagation so we can actually start to

105
00:04:42,639 --> 00:04:48,819
think about how that has to work and one

106
00:04:46,660 --> 00:04:51,580
of the things that I think we need to do

107
00:04:48,819 --> 00:04:55,360
is we need to now that we know that this

108
00:04:51,579 --> 00:05:00,310
is pretty much our final scheme we need

109
00:04:55,360 --> 00:05:03,550
to produce some idea of what the actual

110
00:05:00,310 --> 00:05:05,199
physical quantities are of the light so

111
00:05:03,550 --> 00:05:07,300
I would say going forwards primarily

112
00:05:05,199 --> 00:05:09,310
what we need to do is figure out some

113
00:05:07,300 --> 00:05:12,100
way of visualizing the energy levels and

114
00:05:09,310 --> 00:05:14,379
how they are what they mean and how

115
00:05:12,100 --> 00:05:16,840
they're balanced and then the other

116
00:05:14,379 --> 00:05:20,469
thing that we want to do is then start

117
00:05:16,839 --> 00:05:21,879
to look at the render side so probably

118
00:05:20,470 --> 00:05:24,310
you know looking at this interpolation

119
00:05:21,879 --> 00:05:27,788
it's a little bit too square you know

120
00:05:24,310 --> 00:05:30,280
and I think we probably will can do

121
00:05:27,788 --> 00:05:32,288
things that will make it more diffuse

122
00:05:30,279 --> 00:05:34,179
that'll spread it out more and that'll

123
00:05:32,288 --> 00:05:35,949
hide some of the artifacting that you

124
00:05:34,180 --> 00:05:38,970
get because we're sampling on a regular

125
00:05:35,949 --> 00:05:38,969
grid for example right

126
00:05:44,459 --> 00:05:51,120
and so what we want to be able to do

127
00:05:48,990 --> 00:05:54,120
here is we want to be able to progress

128
00:05:51,120 --> 00:05:56,430
towards that letting quality goal using

129
00:05:54,120 --> 00:05:58,259
some visualizations that will let us see

130
00:05:56,430 --> 00:06:01,230
what's going on there

131
00:05:58,259 --> 00:06:03,870
and these are pretty good visualizations

132
00:06:01,230 --> 00:06:06,960
for showing things like the fluctuation

133
00:06:03,870 --> 00:06:09,990
of power and the lighting and so it's

134
00:06:06,959 --> 00:06:12,299
not that we don't have like something

135
00:06:09,990 --> 00:06:16,949
right like this this shows us something

136
00:06:12,300 --> 00:06:19,139
that we that we can look at and we

137
00:06:16,949 --> 00:06:20,959
probably need to clamp it down a little

138
00:06:19,139 --> 00:06:24,389
bit because you know if you take a look

139
00:06:20,959 --> 00:06:28,769
how strong these directions are they

140
00:06:24,389 --> 00:06:32,099
just they grow a little bit too too much

141
00:06:28,769 --> 00:06:36,539
right so probably we would want to in

142
00:06:32,100 --> 00:06:40,460
here if I just load up the hand-made

143
00:06:36,540 --> 00:06:40,460
here a lighting system here there we go

144
00:06:40,490 --> 00:06:49,230
when we render our octahedral maps we

145
00:06:46,589 --> 00:06:52,169
probably want something that will scale

146
00:06:49,230 --> 00:06:54,750
these values in maybe like a clamped

147
00:06:52,170 --> 00:06:59,040
fashion probably so you can see here

148
00:06:54,750 --> 00:07:00,569
we've got a scale and I don't know

149
00:06:59,040 --> 00:07:03,390
there's there's different ways we can

150
00:07:00,569 --> 00:07:05,790
draw it but we could actually even not

151
00:07:03,389 --> 00:07:08,610
use the intensity for that we could just

152
00:07:05,790 --> 00:07:10,560
draw the color right so another way of

153
00:07:08,610 --> 00:07:14,250
looking at this would be we could just

154
00:07:10,560 --> 00:07:15,750
do that right we could say you know

155
00:07:14,250 --> 00:07:17,579
we're we're just always going to draw a

156
00:07:15,750 --> 00:07:18,240
little ball and we don't actually make

157
00:07:17,579 --> 00:07:22,289
them longer

158
00:07:18,240 --> 00:07:23,699
we just make them change color and so

159
00:07:22,290 --> 00:07:25,980
then what you can do is you can look at

160
00:07:23,699 --> 00:07:28,829
these little like you know that these

161
00:07:25,980 --> 00:07:31,020
little balls here and I like that

162
00:07:28,829 --> 00:07:33,719
because it never gets out of hand but I

163
00:07:31,019 --> 00:07:37,649
do think maybe we want just a little bit

164
00:07:33,720 --> 00:07:42,030
of of a hint there so I think what we

165
00:07:37,649 --> 00:07:45,870
might want to do is is just have a clamp

166
00:07:42,029 --> 00:07:52,129
0 1 of the intensity so you know imagine

167
00:07:45,870 --> 00:07:52,129
something more like let's say we do this

168
00:07:53,519 --> 00:07:59,469
so this way we are taking a little bit

169
00:07:56,800 --> 00:08:03,009
of that intensity into account so as

170
00:07:59,470 --> 00:08:08,560
those lighting values get larger we will

171
00:08:03,009 --> 00:08:12,189
you know produce a increased length so

172
00:08:08,560 --> 00:08:14,079
we can see a little bit just to provide

173
00:08:12,189 --> 00:08:16,990
like a spatial visualization component

174
00:08:14,079 --> 00:08:21,189
to it but this way they'll never grow

175
00:08:16,990 --> 00:08:23,740
like without bound right and I think

176
00:08:21,189 --> 00:08:25,300
that's you know more what we want what I

177
00:08:23,740 --> 00:08:33,219
will say is it's a little weird that

178
00:08:25,300 --> 00:08:34,990
they flash to me right I can't say that

179
00:08:33,219 --> 00:08:39,099
I understand why that's happening and

180
00:08:34,990 --> 00:08:43,330
it's a little bit disquieting because

181
00:08:39,099 --> 00:08:45,339
when you look at how that that when you

182
00:08:43,330 --> 00:08:47,410
look at how that pattern is is occurring

183
00:08:45,339 --> 00:08:48,400
oh you know what that's just the Alpha

184
00:08:47,409 --> 00:08:52,419
is what that is

185
00:08:48,399 --> 00:08:55,000
if I do this that or not yeah okay so as

186
00:08:52,419 --> 00:08:58,240
we move around the world as you can see

187
00:08:55,000 --> 00:09:00,940
here we can now kind of more cleanly see

188
00:08:58,240 --> 00:09:03,549
the directional components of these

189
00:09:00,940 --> 00:09:05,350
things they don't grow without bound and

190
00:09:03,549 --> 00:09:06,909
that's good again this doesn't really

191
00:09:05,350 --> 00:09:09,100
help us with the power thing but it just

192
00:09:06,909 --> 00:09:11,350
keeps this visualization working a

193
00:09:09,100 --> 00:09:12,759
little more smoothly and if you want to

194
00:09:11,350 --> 00:09:15,100
look at any particular part of it you

195
00:09:12,759 --> 00:09:16,990
can still go in there and it does sort

196
00:09:15,100 --> 00:09:19,509
of have a fairly clean directional

197
00:09:16,990 --> 00:09:20,980
component to it and you can also still

198
00:09:19,509 --> 00:09:23,159
see the low colors because they never

199
00:09:20,980 --> 00:09:27,509
get too small right but you can see

200
00:09:23,159 --> 00:09:27,509
where that light is coming from and

201
00:09:30,710 --> 00:09:36,750
so now if we start to move on to the

202
00:09:35,100 --> 00:09:39,090
next part of of what we sort of need to

203
00:09:36,750 --> 00:09:41,820
do there's a couple things we could

204
00:09:39,090 --> 00:09:45,660
start to talk about so one of them is if

205
00:09:41,820 --> 00:09:48,060
you take a look at at how this you know

206
00:09:45,659 --> 00:09:49,230
this room is set up here so let me it's

207
00:09:48,059 --> 00:09:52,739
actually kind of hard to control that

208
00:09:49,230 --> 00:09:55,110
way I could be right right about there I

209
00:09:52,740 --> 00:10:01,620
don't know if that's the rough center of

210
00:09:55,110 --> 00:10:04,350
the room um yeah so if you take a look

211
00:10:01,620 --> 00:10:07,649
at that you know I'm just curious to

212
00:10:04,350 --> 00:10:10,110
what extent we're getting accurate

213
00:10:07,649 --> 00:10:12,569
bounce lighting and if I look at its

214
00:10:10,110 --> 00:10:15,480
like it you know it seems somewhat

215
00:10:12,570 --> 00:10:19,680
plausible right like I'm not seeing a

216
00:10:15,480 --> 00:10:23,940
lot of of weirdness there it seems seems

217
00:10:19,679 --> 00:10:26,129
fairly reasonable and so so I just don't

218
00:10:23,940 --> 00:10:28,650
think there's much left to debug in just

219
00:10:26,129 --> 00:10:30,960
that one in this that one aspect of it

220
00:10:28,649 --> 00:10:34,259
so I think we do want to now move on to

221
00:10:30,960 --> 00:10:36,000
just like let's take a look at the power

222
00:10:34,259 --> 00:10:39,419
distributions here

223
00:10:36,000 --> 00:10:40,740
and how those are working we also

224
00:10:39,419 --> 00:10:45,750
there's some things we could do to

225
00:10:40,740 --> 00:10:48,029
reduce the flicker and I think we

226
00:10:45,750 --> 00:10:53,190
probably want to do them but it's it's

227
00:10:48,029 --> 00:10:55,589
kind of it's a little bit weird I

228
00:10:53,190 --> 00:10:57,330
thought of a pretty obvious way that you

229
00:10:55,590 --> 00:11:00,060
could substantially reduce the flicker

230
00:10:57,330 --> 00:11:01,410
and I just don't know if it's good or

231
00:11:00,059 --> 00:11:03,419
not so that's another thing that we

232
00:11:01,409 --> 00:11:05,490
could choose to do I don't know if we

233
00:11:03,419 --> 00:11:07,519
really want to do that yet though it

234
00:11:05,490 --> 00:11:13,169
seems like the flicker is fine for now

235
00:11:07,519 --> 00:11:15,000
because the flicker is not really it's

236
00:11:13,169 --> 00:11:17,459
not interfering with my ability to see

237
00:11:15,000 --> 00:11:18,929
what's going on it's just like a

238
00:11:17,460 --> 00:11:21,170
constant level of noise that's

239
00:11:18,929 --> 00:11:24,089
superimposed on top of the data and

240
00:11:21,169 --> 00:11:27,149
because there's really no harm in that I

241
00:11:24,090 --> 00:11:28,379
think I'll leave the denoising which I

242
00:11:27,149 --> 00:11:31,129
actually think I have a pretty good idea

243
00:11:28,379 --> 00:11:31,129
of how I want to do

244
00:11:35,360 --> 00:11:41,720
and I'll leave that for later

245
00:11:39,259 --> 00:11:44,980
so right now let's talk about how we

246
00:11:41,720 --> 00:11:48,528
manage the power level in these things

247
00:11:44,980 --> 00:11:52,100
so I think what we want to do is I want

248
00:11:48,528 --> 00:11:56,450
to talk about lights as having a

249
00:11:52,100 --> 00:11:58,159
particular amount of a flow coming out

250
00:11:56,450 --> 00:12:01,820
of them and this is the way that I liked

251
00:11:58,159 --> 00:12:03,919
to think about it before in terms of how

252
00:12:01,820 --> 00:12:06,320
I can go about creating a stable system

253
00:12:03,919 --> 00:12:08,269
or hope to create a stable system I'd

254
00:12:06,320 --> 00:12:10,879
like to think about lights as having a

255
00:12:08,269 --> 00:12:12,799
particular amount of like you know power

256
00:12:10,879 --> 00:12:15,828
that they're putting out into the world

257
00:12:12,799 --> 00:12:18,379
and what I want to do is I want to make

258
00:12:15,828 --> 00:12:22,299
it so that amount of power can bounce

259
00:12:18,379 --> 00:12:26,750
around the world without generating more

260
00:12:22,299 --> 00:12:31,629
so when you look at a particular place

261
00:12:26,750 --> 00:12:35,870
in the world it should be the case that

262
00:12:31,629 --> 00:12:38,899
you can never have any surface with more

263
00:12:35,870 --> 00:12:40,339
lights than the total power of the

264
00:12:38,899 --> 00:12:45,649
lights that are directly hitting it

265
00:12:40,339 --> 00:12:52,940
right and just to give some perspective

266
00:12:45,649 --> 00:12:56,389
on what that means and where I think

267
00:12:52,940 --> 00:12:59,050
we're kind of going wrong I'll do a

268
00:12:56,389 --> 00:12:59,049
little diagram here

269
00:13:18,528 --> 00:13:22,859
fundamentally what we'd like to do with

270
00:13:20,458 --> 00:13:27,928
this system is say well we know there

271
00:13:22,859 --> 00:13:29,579
are some lights in the world and we're

272
00:13:27,928 --> 00:13:31,769
going to say that each of these lights

273
00:13:29,578 --> 00:13:35,158
has a particular power associated with

274
00:13:31,769 --> 00:13:36,359
it or maybe for our purposes at the

275
00:13:35,158 --> 00:13:37,889
moment I'm just going to call that the

276
00:13:36,359 --> 00:13:39,629
amount of flow like how much flow is

277
00:13:37,889 --> 00:13:42,959
coming out of these so we might have an

278
00:13:39,629 --> 00:13:45,709
f0 and an f1 that's the amount of like

279
00:13:42,958 --> 00:13:49,348
flow that's coming out of the lights and

280
00:13:45,708 --> 00:13:53,158
this is in RG and B so they can be

281
00:13:49,349 --> 00:13:55,109
colored lights but I don't actually care

282
00:13:53,158 --> 00:13:57,479
about that right now because as far as

283
00:13:55,109 --> 00:13:59,729
I'm concerned each RG and B are

284
00:13:57,479 --> 00:14:01,379
basically separate light channels so

285
00:13:59,729 --> 00:14:03,569
weak it's sufficient to talk about any

286
00:14:01,379 --> 00:14:06,749
one of them we could just talk about the

287
00:14:03,568 --> 00:14:08,958
red channel and that's sufficient so if

288
00:14:06,749 --> 00:14:13,019
you think about what's gonna happen a

289
00:14:08,958 --> 00:14:16,888
surface in the world that's reflecting

290
00:14:13,019 --> 00:14:19,528
light if two light sources are both

291
00:14:16,889 --> 00:14:22,019
incident on this surface directly so

292
00:14:19,528 --> 00:14:26,609
this surface can hit both light sources

293
00:14:22,019 --> 00:14:35,938
I want to have no more than f0 + f1

294
00:14:26,609 --> 00:14:37,859
reflected off okay so this should be the

295
00:14:35,938 --> 00:14:40,858
maximum possible if this surface is

296
00:14:37,859 --> 00:14:44,908
somehow set to 1.0 reflectivity a mirror

297
00:14:40,859 --> 00:14:46,319
basically the perfect mirror it should

298
00:14:44,908 --> 00:14:51,048
never be able to achieve a value

299
00:14:46,318 --> 00:14:51,048
fundamentally higher than that zooming

300
00:14:51,078 --> 00:14:59,488
and so what we need to do is figure out

301
00:14:57,149 --> 00:15:01,649
how to ensure that through all of our

302
00:14:59,489 --> 00:15:03,418
light sampling this cannot be violated

303
00:15:01,649 --> 00:15:06,328
and right now we basically know that it

304
00:15:03,418 --> 00:15:10,788
can be so what we're seeing right now is

305
00:15:06,328 --> 00:15:14,758
something like this we have a light

306
00:15:10,788 --> 00:15:16,678
reflector and then maybe we have I don't

307
00:15:14,759 --> 00:15:18,509
know say another reflector over here and

308
00:15:16,678 --> 00:15:20,728
what we're seeing is that somehow you

309
00:15:18,509 --> 00:15:22,109
know we reflect light in this way so we

310
00:15:20,729 --> 00:15:23,999
have two light sources they're both

311
00:15:22,109 --> 00:15:27,538
incident from this and incident on this

312
00:15:23,999 --> 00:15:29,180
and somehow this then gathers from here

313
00:15:27,538 --> 00:15:32,809
even more light

314
00:15:29,179 --> 00:15:34,909
so maybe this guy is is reflecting f0

315
00:15:32,809 --> 00:15:37,009
plus f1 at first and this one is

316
00:15:34,909 --> 00:15:39,199
reflecting f0 plus one at first but then

317
00:15:37,009 --> 00:15:41,090
it's like additive so it's it's taking

318
00:15:39,200 --> 00:15:42,350
this light and it's becoming now even

319
00:15:41,090 --> 00:15:45,139
this other thing where we're actually

320
00:15:42,350 --> 00:15:47,330
adding another term in here and we're

321
00:15:45,139 --> 00:15:52,669
getting brighter than our light sources

322
00:15:47,330 --> 00:15:55,220
and so what we need to do is go through

323
00:15:52,669 --> 00:15:57,009
how our light is being propagated and

324
00:15:55,220 --> 00:15:59,810
stop doing that

325
00:15:57,009 --> 00:16:01,250
what we need to do is look at the

326
00:15:59,809 --> 00:16:04,219
lighting that's incident on a surface

327
00:16:01,250 --> 00:16:07,309
and produce answers for say our lighting

328
00:16:04,220 --> 00:16:09,889
probes that make it impossible for you

329
00:16:07,309 --> 00:16:14,839
to generate more light than you were

330
00:16:09,889 --> 00:16:17,569
previously having since the way we

331
00:16:14,840 --> 00:16:20,570
currently do things is all we're doing

332
00:16:17,570 --> 00:16:23,330
is taking samples of what light is out

333
00:16:20,570 --> 00:16:25,430
in the world and averaging them I think

334
00:16:23,330 --> 00:16:28,460
I have a pretty good idea about where

335
00:16:25,429 --> 00:16:32,750
we're going wrong and where we're going

336
00:16:28,460 --> 00:16:34,129
wrong I think is in our diffuse blur so

337
00:16:32,750 --> 00:16:39,649
I think what's happening is that

338
00:16:34,129 --> 00:16:42,470
currently here in the diffuse wait Maps

339
00:16:39,649 --> 00:16:45,529
the problem that we have is we're taking

340
00:16:42,470 --> 00:16:49,720
a speck like a spectral light source and

341
00:16:45,529 --> 00:16:49,720
you can see here that we're summing

342
00:16:49,960 --> 00:16:55,180
basically like a over a hemisphere how

343
00:16:53,179 --> 00:16:59,559
much light is in coming and we're pre

344
00:16:55,179 --> 00:17:02,269
creating an energy value here right and

345
00:16:59,559 --> 00:17:05,119
the problem that we have is this is

346
00:17:02,269 --> 00:17:08,480
completely wrong this is basically

347
00:17:05,119 --> 00:17:09,349
saying look if I have to and you know

348
00:17:08,480 --> 00:17:10,759
what I don't know why I put the

349
00:17:09,349 --> 00:17:13,399
blackboard away I guess I just wanted to

350
00:17:10,759 --> 00:17:18,859
go to this real quick but we should talk

351
00:17:13,400 --> 00:17:20,660
about this on the actual blackboard so

352
00:17:18,859 --> 00:17:24,319
if you think about what this is doing we

353
00:17:20,660 --> 00:17:26,540
have an octahedral map which you know is

354
00:17:24,319 --> 00:17:29,299
basically a way of encoding the lighting

355
00:17:26,539 --> 00:17:31,700
on the sphere and so we're saying that

356
00:17:29,299 --> 00:17:33,409
for a particular location right we've

357
00:17:31,700 --> 00:17:35,240
got the sphere and we happen to be

358
00:17:33,410 --> 00:17:37,190
encoding it an octahedral map but that's

359
00:17:35,240 --> 00:17:39,259
really incidental it doesn't matter how

360
00:17:37,190 --> 00:17:40,730
we're encoding at the point is we have a

361
00:17:39,259 --> 00:17:42,589
collection of light samples on the

362
00:17:40,730 --> 00:17:43,160
sphere and what we're doing is we're

363
00:17:42,589 --> 00:17:45,799
saying well

364
00:17:43,160 --> 00:17:48,080
we produced specific samples in our

365
00:17:45,799 --> 00:17:52,099
specular encoding so we have a specular

366
00:17:48,079 --> 00:17:53,659
map and the specular map is what we

367
00:17:52,099 --> 00:17:57,379
actually encode so if we have a

368
00:17:53,660 --> 00:17:58,640
direction here in a direction here we

369
00:17:57,380 --> 00:18:01,070
know the lighting at these two

370
00:17:58,640 --> 00:18:05,240
directions but then what's happening is

371
00:18:01,069 --> 00:18:08,629
we're producing a diffuse map and the

372
00:18:05,240 --> 00:18:10,609
diffuse map is saying what yeah you know

373
00:18:08,630 --> 00:18:13,190
we don't really need a diffuse map for

374
00:18:10,609 --> 00:18:14,899
anything if there is an optimization we

375
00:18:13,190 --> 00:18:17,029
don't want to have to sample lots and

376
00:18:14,900 --> 00:18:18,860
lots and lots of points on the specular

377
00:18:17,029 --> 00:18:28,369
map to produce our lighting we want to

378
00:18:18,859 --> 00:18:30,529
just do one right and so what we want to

379
00:18:28,369 --> 00:18:33,079
do here is say look the diffuse map

380
00:18:30,529 --> 00:18:36,410
needs to produce what you would get if

381
00:18:33,079 --> 00:18:40,399
you actually summed the specular answers

382
00:18:36,410 --> 00:18:43,670
right and the problem that we have here

383
00:18:40,400 --> 00:18:44,600
is we didn't normalize our blend I think

384
00:18:43,670 --> 00:18:47,269
that's really all it is

385
00:18:44,599 --> 00:18:48,740
so we're taking these and we're adding

386
00:18:47,269 --> 00:18:51,889
them together and we're just multiplying

387
00:18:48,740 --> 00:18:54,200
by some stupid coefficient I don't know

388
00:18:51,890 --> 00:18:57,200
why we did this doesn't make any sense

389
00:18:54,200 --> 00:18:59,779
it's not energy preserving if you want

390
00:18:57,200 --> 00:19:01,819
to know how much light you would get

391
00:18:59,779 --> 00:19:03,170
during the diffuse sample well each of

392
00:19:01,819 --> 00:19:05,990
those samples that you would have taken

393
00:19:03,170 --> 00:19:08,150
weighted by the cosine of them you can't

394
00:19:05,990 --> 00:19:11,089
just add them together because you're

395
00:19:08,150 --> 00:19:12,880
trying to produce a sampling of all the

396
00:19:11,089 --> 00:19:15,079
different light rays you could have cast

397
00:19:12,880 --> 00:19:19,330
and so they're not necessarily going to

398
00:19:15,079 --> 00:19:19,329
sum together right that's that's not

399
00:19:21,099 --> 00:19:26,149
that's not realistic of how a surface

400
00:19:24,200 --> 00:19:28,490
works a surface when light bounces off

401
00:19:26,150 --> 00:19:31,280
it if it's going to bounce light in many

402
00:19:28,490 --> 00:19:35,930
directions it has to be able to bounce

403
00:19:31,279 --> 00:19:39,710
that light in the many directions I'm

404
00:19:35,930 --> 00:19:43,029
not trying to say this so suppose we

405
00:19:39,710 --> 00:19:43,029
have ten photons

406
00:19:44,500 --> 00:19:50,659
hitting our surface right so we know

407
00:19:47,659 --> 00:19:52,580
that incoming there are ten photons if

408
00:19:50,659 --> 00:19:54,200
we want to say that this surface is

409
00:19:52,579 --> 00:19:56,928
diffuse then fundamentally what we are

410
00:19:54,200 --> 00:20:01,970
saying is that it radiates light out in

411
00:19:56,929 --> 00:20:05,480
all directions when a light hits it from

412
00:20:01,970 --> 00:20:06,980
any direction so there are cosine

413
00:20:05,480 --> 00:20:10,579
weightings there that have to do with

414
00:20:06,980 --> 00:20:13,669
how the surface incidence affects how

415
00:20:10,579 --> 00:20:15,859
much flow there can be but fundamentally

416
00:20:13,669 --> 00:20:17,390
that's what we're saying and so if you

417
00:20:15,859 --> 00:20:20,479
look at the problem that you have here

418
00:20:17,390 --> 00:20:23,030
if ten photons hit the surface and you

419
00:20:20,480 --> 00:20:25,700
scatter ten photons in each of these

420
00:20:23,029 --> 00:20:28,308
directions well then what you've done is

421
00:20:25,700 --> 00:20:30,980
you've multiplied the total number of

422
00:20:28,308 --> 00:20:34,308
photons hitting in this case by four X

423
00:20:30,980 --> 00:20:35,900
right so when we're doing that diffuse

424
00:20:34,308 --> 00:20:38,480
plan what we're effectively doing is

425
00:20:35,900 --> 00:20:42,019
taking an accurate representation of how

426
00:20:38,480 --> 00:20:44,929
many photons were hitting our our our

427
00:20:42,019 --> 00:20:49,639
probe or we're passing through our probe

428
00:20:44,929 --> 00:20:51,620
in that case and we're multiplying them

429
00:20:49,640 --> 00:20:54,440
because the diffuse blur is effectively

430
00:20:51,619 --> 00:20:56,329
summing them without any waiting so what

431
00:20:54,440 --> 00:21:00,558
we actually need to do is say something

432
00:20:56,329 --> 00:21:03,019
closer to this if ten photons hit our

433
00:21:00,558 --> 00:21:05,990
surface and we want to scatter those

434
00:21:03,019 --> 00:21:08,480
photons in five directions we need to

435
00:21:05,990 --> 00:21:11,659
send two photons out of each of those

436
00:21:08,480 --> 00:21:13,610
directions now probably the way we need

437
00:21:11,659 --> 00:21:16,400
to do this is actually do the scattering

438
00:21:13,609 --> 00:21:17,959
weighted by the cosine like I said so

439
00:21:16,400 --> 00:21:20,000
you probably want to do something more

440
00:21:17,960 --> 00:21:22,909
like this where one photon scatter is

441
00:21:20,000 --> 00:21:24,140
out on either side and those two photons

442
00:21:22,909 --> 00:21:27,890
get added here so it's more like a

443
00:21:24,140 --> 00:21:29,419
four-to-one kind of a weighting right so

444
00:21:27,890 --> 00:21:31,909
we probably do want to wait by the

445
00:21:29,419 --> 00:21:34,730
incidence to capture that cosine curve

446
00:21:31,909 --> 00:21:38,000
which happens when light incident light

447
00:21:34,730 --> 00:21:40,730
hits a surface so we may want to do

448
00:21:38,000 --> 00:21:42,740
something like that to to try and get a

449
00:21:40,730 --> 00:21:44,779
cosine term in there and one way or the

450
00:21:42,740 --> 00:21:46,519
other but what we definitely don't want

451
00:21:44,779 --> 00:21:49,759
to do is take a certain amount of power

452
00:21:46,519 --> 00:21:52,849
of light coming in and scatter it out in

453
00:21:49,759 --> 00:21:54,558
a way that multiplies its intensity so

454
00:21:52,849 --> 00:21:56,539
I'm pretty sure although I don't know

455
00:21:54,558 --> 00:21:58,129
I'm pretty sure

456
00:21:56,539 --> 00:22:00,440
that's actually the source of our

457
00:21:58,130 --> 00:22:02,210
problems so what I'd like to do is take

458
00:22:00,440 --> 00:22:05,210
a look at this routine and figure out

459
00:22:02,210 --> 00:22:07,279
where we went wrong because I mean well

460
00:22:05,210 --> 00:22:08,930
we know how we went wrong how we went

461
00:22:07,279 --> 00:22:10,279
wrong is we didn't even discuss this

462
00:22:08,930 --> 00:22:11,900
talk about it or even think about it

463
00:22:10,279 --> 00:22:14,000
when we wrote this routine we literally

464
00:22:11,900 --> 00:22:16,190
just smeared the map right that's all we

465
00:22:14,000 --> 00:22:17,990
did so we weren't even trying to do a

466
00:22:16,190 --> 00:22:21,140
good job here and so really all we need

467
00:22:17,990 --> 00:22:22,819
to do I think now is actually try so

468
00:22:21,140 --> 00:22:24,890
when you take a look at what's going on

469
00:22:22,819 --> 00:22:27,019
you can see that there are two texels

470
00:22:24,890 --> 00:22:28,910
that are in play at any given time and

471
00:22:27,019 --> 00:22:30,799
what we're doing here is we're stepping

472
00:22:28,910 --> 00:22:33,050
through the destination so this is the

473
00:22:30,799 --> 00:22:35,750
diffuse this is where we're producing

474
00:22:33,049 --> 00:22:38,210
that blur and what we're doing is we're

475
00:22:35,750 --> 00:22:41,119
taking the specular map and we're

476
00:22:38,210 --> 00:22:44,569
smearing that specular map out into the

477
00:22:41,119 --> 00:22:45,769
diffuse map so here's where we are going

478
00:22:44,569 --> 00:22:48,829
to here's what we're going to write to

479
00:22:45,769 --> 00:22:51,740
the T X T y location of the diffuse map

480
00:22:48,829 --> 00:22:59,470
and then the inner loop is just summing

481
00:22:51,740 --> 00:23:02,589
over all of the all of the specular

482
00:22:59,470 --> 00:23:05,870
texels right so it's basically just

483
00:23:02,589 --> 00:23:14,569
picking specular texels writing them to

484
00:23:05,869 --> 00:23:17,449
diffuse and we did throw in a weight

485
00:23:14,569 --> 00:23:19,579
here and you can see we have it to do so

486
00:23:17,450 --> 00:23:23,360
it's not like we didn't know we were

487
00:23:19,579 --> 00:23:25,159
doing a bad job we did it's just knowing

488
00:23:23,359 --> 00:23:30,199
you did a bad job is the same as doing a

489
00:23:25,160 --> 00:23:32,180
bad job so now we need to fix it when we

490
00:23:30,200 --> 00:23:35,330
look at how our weighting is distributed

491
00:23:32,180 --> 00:23:37,279
you can see that we're using a cosine

492
00:23:35,329 --> 00:23:38,869
fall-off to weight the difference

493
00:23:37,279 --> 00:23:41,779
between the incoming and outgoing

494
00:23:38,869 --> 00:23:43,729
directions whether that's the best way

495
00:23:41,779 --> 00:23:45,710
to represent the physical behavior of

496
00:23:43,730 --> 00:23:47,960
light in this particular scenario for

497
00:23:45,710 --> 00:23:50,990
the performance constraints we have I'm

498
00:23:47,960 --> 00:23:53,480
not sure so we may want to eventually

499
00:23:50,990 --> 00:23:57,049
take a look at how to change how that

500
00:23:53,480 --> 00:24:01,190
weighting is working but what I will say

501
00:23:57,049 --> 00:24:03,230
is let's just leave that for now and say

502
00:24:01,190 --> 00:24:05,900
suppose that is the weighting we need

503
00:24:03,230 --> 00:24:07,430
because we know we will have some

504
00:24:05,900 --> 00:24:09,019
weighting that we want there suppose

505
00:24:07,430 --> 00:24:11,750
that is the weighting we want

506
00:24:09,019 --> 00:24:14,109
how would we then go about and ensure

507
00:24:11,750 --> 00:24:19,960
that the power that we then distribute

508
00:24:14,109 --> 00:24:25,339
doesn't produce some kind of doesn't

509
00:24:19,960 --> 00:24:29,630
multiply the total power that that we

510
00:24:25,339 --> 00:24:31,490
that we would have right and so the

511
00:24:29,630 --> 00:24:33,860
typical way we would do this is we would

512
00:24:31,490 --> 00:24:37,539
say well what if we just produce all of

513
00:24:33,859 --> 00:24:41,599
the weights that we're going to have and

514
00:24:37,539 --> 00:24:44,928
we then just normalize you know do a one

515
00:24:41,599 --> 00:24:46,159
normalization to say well now we want to

516
00:24:44,929 --> 00:24:47,809
make sure that this sums to the same

517
00:24:46,160 --> 00:24:49,040
amount of power that we had beforehand

518
00:24:47,808 --> 00:24:51,440
so we just take all the weights and we

519
00:24:49,039 --> 00:24:52,909
and we normalize them the problem that

520
00:24:51,440 --> 00:24:54,679
we're gonna have here is we never really

521
00:24:52,910 --> 00:24:57,790
produce all of the weights so it's not

522
00:24:54,679 --> 00:25:00,230
as simple as just summing them up

523
00:24:57,789 --> 00:25:04,700
because we don't actually know what they

524
00:25:00,230 --> 00:25:10,849
even are right but we do know for any

525
00:25:04,700 --> 00:25:12,620
given txt Y we do know the opposite

526
00:25:10,849 --> 00:25:17,389
thing right we have produced all the

527
00:25:12,619 --> 00:25:18,829
weights that would sum into it we just

528
00:25:17,390 --> 00:25:23,240
don't know what would some out of it but

529
00:25:18,829 --> 00:25:26,139
if we looked at the same slot right so

530
00:25:23,240 --> 00:25:29,870
if we looked at the same slot each time

531
00:25:26,140 --> 00:25:32,210
and summed up all of those weight so if

532
00:25:29,869 --> 00:25:36,259
we looked at you know here's the diffuse

533
00:25:32,210 --> 00:25:38,779
weight map right you can see it writing

534
00:25:36,259 --> 00:25:40,670
into the diffuse weight map here if we

535
00:25:38,779 --> 00:25:43,869
looked at the same slot in the diffuse

536
00:25:40,670 --> 00:25:49,279
weight map and just looked across all

537
00:25:43,869 --> 00:25:51,829
txt Y when we built it if we summed up

538
00:25:49,279 --> 00:25:54,980
those same slots that would give us the

539
00:25:51,829 --> 00:26:00,349
total amount of weight being pulled from

540
00:25:54,980 --> 00:26:04,308
that particular spec Texel and if we

541
00:26:00,349 --> 00:26:06,469
normalized that that should give us the

542
00:26:04,308 --> 00:26:09,139
correct energy distribution right

543
00:26:06,470 --> 00:26:12,670
because that would mean that we were

544
00:26:09,140 --> 00:26:16,070
spreading that particular energy source

545
00:26:12,670 --> 00:26:18,900
in such a way that it never summed to

546
00:26:16,069 --> 00:26:26,639
more than it was originally worth

547
00:26:18,900 --> 00:26:45,660
right so I think what that means is that

548
00:26:26,640 --> 00:26:47,790
in theory anyway I mean I think because

549
00:26:45,660 --> 00:26:51,390
I can't think of any reason why it

550
00:26:47,789 --> 00:26:55,558
wouldn't work let's suppose that we

551
00:26:51,390 --> 00:26:58,650
moved this out going into here I think

552
00:26:55,558 --> 00:27:01,740
if we just reorganize our loop because

553
00:26:58,650 --> 00:27:05,280
who cares it doesn't matter which order

554
00:27:01,740 --> 00:27:08,670
we do the loops in if the loop was in

555
00:27:05,279 --> 00:27:10,920
this order it should in theory mean that

556
00:27:08,670 --> 00:27:15,779
we can do the entire set of weights for

557
00:27:10,920 --> 00:27:19,490
one sy SX pair remember them and then

558
00:27:15,779 --> 00:27:22,139
normalize after the fact I think right

559
00:27:19,490 --> 00:27:31,140
so in theory what we should be able to

560
00:27:22,140 --> 00:27:35,220
do here is just some the weights like so

561
00:27:31,140 --> 00:27:40,320
and do one more loop afterward you know

562
00:27:35,220 --> 00:27:43,200
through to just to renormalize so we

563
00:27:40,319 --> 00:27:46,589
first loop over all of the destination

564
00:27:43,200 --> 00:27:49,190
texels affected by this source Texel we

565
00:27:46,589 --> 00:27:52,889
fill in what the weight there should be

566
00:27:49,190 --> 00:27:56,130
and off we go now we don't need to write

567
00:27:52,890 --> 00:28:01,530
the weight in this particular case we

568
00:27:56,130 --> 00:28:03,300
just need to sum right and we could even

569
00:28:01,529 --> 00:28:06,440
sort of pre compute this value because

570
00:28:03,299 --> 00:28:07,950
one of the things you can see is that

571
00:28:06,440 --> 00:28:09,690
well it doesn't matter

572
00:28:07,950 --> 00:28:10,799
we're putting the whole thing so I don't

573
00:28:09,690 --> 00:28:15,320
even know why it would go down that road

574
00:28:10,799 --> 00:28:18,178
right so again pretty straightforward

575
00:28:15,319 --> 00:28:21,359
how this would work we would then just

576
00:28:18,179 --> 00:28:24,240
say all right we go through here and we

577
00:28:21,359 --> 00:28:27,479
we do the same loop twice first time we

578
00:28:24,240 --> 00:28:31,519
just sum how much total weight we're

579
00:28:27,480 --> 00:28:34,250
going to have and I want us

580
00:28:31,519 --> 00:28:37,009
this value should probably I mean it

581
00:28:34,250 --> 00:28:38,859
might vary but this it almost seems like

582
00:28:37,009 --> 00:28:42,589
this would be the same for everybody

583
00:28:38,859 --> 00:28:45,529
right because it's sort of the same

584
00:28:42,589 --> 00:29:11,029
weight octahedral map each way I might

585
00:28:45,529 --> 00:29:12,920
put the thing in here that just says but

586
00:29:11,029 --> 00:29:14,839
since I don't really know if the

587
00:29:12,920 --> 00:29:16,820
octahedral map actually has that

588
00:29:14,839 --> 00:29:18,109
property I'm just not going to do it

589
00:29:16,819 --> 00:29:19,819
because I don't want to introduce that

590
00:29:18,109 --> 00:29:23,599
in here and we don't care because this

591
00:29:19,819 --> 00:29:25,789
only runs at startup anyway so when we

592
00:29:23,599 --> 00:29:28,549
go and now produce the actual final

593
00:29:25,789 --> 00:29:31,009
values all we would do is say well we'll

594
00:29:28,549 --> 00:29:32,389
just divide by the W total now so

595
00:29:31,009 --> 00:29:34,789
instead of writing out the weight by

596
00:29:32,390 --> 00:29:36,590
itself we write out the weight divided

597
00:29:34,789 --> 00:29:40,009
by the total weight for that particular

598
00:29:36,589 --> 00:29:41,779
Texel and now in theory we should have

599
00:29:40,009 --> 00:29:42,799
oops I didn't realize that was still

600
00:29:41,779 --> 00:29:47,029
running

601
00:29:42,799 --> 00:29:49,970
we should have a table that preserves

602
00:29:47,029 --> 00:29:52,430
the power of the original light that

603
00:29:49,970 --> 00:29:57,799
it's sampled rather than having a

604
00:29:52,430 --> 00:29:59,450
feedback loop right so now when we move

605
00:29:57,799 --> 00:30:00,919
around what we should see is like a lot

606
00:29:59,450 --> 00:30:02,779
less light than we were seeing which is

607
00:30:00,920 --> 00:30:04,730
totally fine because we don't have any

608
00:30:02,779 --> 00:30:07,369
idea of what these light powers actually

609
00:30:04,730 --> 00:30:10,430
are so the fact that they would be less

610
00:30:07,369 --> 00:30:12,319
is totally fine with us and we don't

611
00:30:10,430 --> 00:30:16,340
really know like what these light powers

612
00:30:12,319 --> 00:30:18,169
should really even represent so let's

613
00:30:16,339 --> 00:30:20,929
start adding some more light to the

614
00:30:18,170 --> 00:30:22,370
world at this point and we may like I

615
00:30:20,930 --> 00:30:25,610
said have to kind of think about how

616
00:30:22,369 --> 00:30:29,629
much light what the actual total amount

617
00:30:25,609 --> 00:30:31,399
of light would want to be so I'm going

618
00:30:29,630 --> 00:30:34,800
to go in here and put back in some of

619
00:30:31,400 --> 00:30:48,490
these lamps which

620
00:30:34,799 --> 00:30:55,899
like so okay and now what we need to do

621
00:30:48,490 --> 00:30:58,210
is Wow they don't even really bounce

622
00:30:55,900 --> 00:31:00,370
hardly any light which I guess is kind

623
00:30:58,210 --> 00:31:02,230
of good all right so now what we have to

624
00:31:00,369 --> 00:31:04,179
do is start to work on our scale and see

625
00:31:02,230 --> 00:31:07,079
I mean unless I introduce some kind of a

626
00:31:04,180 --> 00:31:09,009
really bad bug which I may have right

627
00:31:07,079 --> 00:31:10,629
but it doesn't look like it because you

628
00:31:09,009 --> 00:31:13,930
can see that this looks like a sanely

629
00:31:10,630 --> 00:31:15,580
behaved lighting source at that point so

630
00:31:13,930 --> 00:31:17,080
what I'd like to do now is just crank up

631
00:31:15,579 --> 00:31:19,269
the intensity of these lights to see

632
00:31:17,079 --> 00:31:21,189
what happens if we map them in a

633
00:31:19,269 --> 00:31:22,690
slightly different way and we have to

634
00:31:21,190 --> 00:31:24,070
start thinking about what we want our

635
00:31:22,690 --> 00:31:35,289
power curve to look like for lights

636
00:31:24,069 --> 00:31:38,349
anyway all right so now we've got again

637
00:31:35,289 --> 00:31:40,539
our light sources here and I don't know

638
00:31:38,349 --> 00:31:44,980
if that's a same amount of light or an

639
00:31:40,539 --> 00:31:46,240
insane amount of light looking at them

640
00:31:44,980 --> 00:31:47,500
and I'm just going to keep cranking up

641
00:31:46,240 --> 00:31:48,970
the power to see what happens because

642
00:31:47,500 --> 00:31:51,579
like I said we have no idea where on

643
00:31:48,970 --> 00:31:53,350
this curve we even are so for all we

644
00:31:51,579 --> 00:31:54,519
know this is like exactly correct

645
00:31:53,349 --> 00:32:03,099
lighting all of a sudden or something

646
00:31:54,519 --> 00:32:06,400
like this who knows so you can see at

647
00:32:03,099 --> 00:32:08,019
that point we kind of have a weird not

648
00:32:06,400 --> 00:32:11,740
sure what happens when we crank it up to

649
00:32:08,019 --> 00:32:13,119
that level of light and I'm not sure why

650
00:32:11,740 --> 00:32:15,279
exactly we would be getting that so it

651
00:32:13,119 --> 00:32:17,559
looks like we still have a bug because

652
00:32:15,279 --> 00:32:19,349
in theory it should still stay stable no

653
00:32:17,559 --> 00:32:21,909
matter what we crank the light up to I

654
00:32:19,349 --> 00:32:24,059
would think I could be wrong about that

655
00:32:21,910 --> 00:32:24,060
though

656
00:32:26,279 --> 00:32:30,329
right so no matter what I cranked the

657
00:32:28,799 --> 00:32:32,069
light levels up to we should have been

658
00:32:30,329 --> 00:32:34,470
seeing fairly stable light and we're

659
00:32:32,069 --> 00:32:36,960
totally not right so I'm guessing that

660
00:32:34,470 --> 00:32:38,960
that I still kind of have there's

661
00:32:36,960 --> 00:32:42,420
there's bugs in the propagation here

662
00:32:38,960 --> 00:32:47,029
that that are making it do kind of weird

663
00:32:42,420 --> 00:32:47,029
things right and

664
00:32:54,650 --> 00:33:02,100
it looks like I mean there's a couple of

665
00:33:00,329 --> 00:33:04,019
things that you have to remember first

666
00:33:02,099 --> 00:33:06,808
of all there's no ceilings which creates

667
00:33:04,019 --> 00:33:08,039
a incorrect light propagation so we

668
00:33:06,808 --> 00:33:09,779
should probably add those in as well

669
00:33:08,039 --> 00:33:14,700
before we start looking at light quality

670
00:33:09,779 --> 00:33:19,139
but on the whole I want to try and hop

671
00:33:14,700 --> 00:33:20,580
down here to the to the underground as

672
00:33:19,140 --> 00:33:27,990
well because there are ceilings here now

673
00:33:20,579 --> 00:33:29,189
right so if we take a look at just how

674
00:33:27,990 --> 00:33:30,569
the light propagation is working that

675
00:33:29,190 --> 00:33:32,279
just looks like it's not really

676
00:33:30,569 --> 00:33:32,609
propagating properly you know what I

677
00:33:32,279 --> 00:33:35,849
mean

678
00:33:32,609 --> 00:33:37,769
so I feel like we've got some bugs in

679
00:33:35,849 --> 00:33:41,219
there that we're gonna have to to look

680
00:33:37,769 --> 00:33:43,829
at and it's not always obvious though

681
00:33:41,220 --> 00:33:50,000
why like because if you take a look at

682
00:33:43,829 --> 00:33:50,000
how the if you take a look at how the

683
00:33:53,660 --> 00:34:02,940
how some of the lighting probes look

684
00:33:57,660 --> 00:34:06,919
they look fairly reasonable though so

685
00:34:02,940 --> 00:34:06,919
it's it is at least kind of confusing

686
00:34:12,250 --> 00:34:23,289
right I kind of want to look at the spec

687
00:34:18,489 --> 00:34:24,549
map first let me take a look at this

688
00:34:23,289 --> 00:34:28,509
routine I wrote and make sure that it's

689
00:34:24,550 --> 00:34:29,889
not stupid I mean I think it's really

690
00:34:28,510 --> 00:34:33,280
straightforward right you're just saying

691
00:34:29,889 --> 00:34:34,990
I want to produce a blurred version of

692
00:34:33,280 --> 00:34:37,690
this map that doesn't introduce any

693
00:34:34,989 --> 00:34:44,949
additional power and so you know I've

694
00:34:37,690 --> 00:34:46,780
put that in here the I guess I don't

695
00:34:44,949 --> 00:34:50,079
know if we really want the outgoing

696
00:34:46,780 --> 00:34:54,669
incoming part of this that parts a

697
00:34:50,079 --> 00:34:57,369
little bit a little bit harder to to

698
00:34:54,668 --> 00:34:59,769
determine because it may actually be

699
00:34:57,369 --> 00:35:05,740
that this doesn't make a whole lot of

700
00:34:59,769 --> 00:35:10,739
sense because if you think about it when

701
00:35:05,739 --> 00:35:10,739
you're sampling the light I'm not sure

702
00:35:14,130 --> 00:35:22,720
yeah I'm not sure how much that that

703
00:35:17,670 --> 00:35:25,809
cosine fall-off makes sense but if you

704
00:35:22,719 --> 00:35:27,279
assume that it does make sense then one

705
00:35:25,809 --> 00:35:30,389
of the thing that we probably also have

706
00:35:27,280 --> 00:35:33,640
to consider is that when we do like the

707
00:35:30,389 --> 00:35:36,190
raycast and we compute the outgoing

708
00:35:33,639 --> 00:35:41,469
values one of the weird things about it

709
00:35:36,190 --> 00:35:43,050
is that I feel like this probably

710
00:35:41,469 --> 00:35:51,519
doesn't make a whole lot of sense

711
00:35:43,050 --> 00:35:54,960
because you're you're kind of double

712
00:35:51,519 --> 00:36:00,519
counting it so I kind of feel like this

713
00:35:54,960 --> 00:36:02,260
this maybe is not a good thing right if

714
00:36:00,519 --> 00:36:03,759
we do leave it in there now again I

715
00:36:02,260 --> 00:36:05,230
don't really know to what extent that

716
00:36:03,760 --> 00:36:07,930
that has any effect I don't expect it

717
00:36:05,230 --> 00:36:09,659
would account for much right yeah like

718
00:36:07,929 --> 00:36:12,338
it kind of still looks roughly the same

719
00:36:09,659 --> 00:36:15,429
but I do think that like if we're going

720
00:36:12,338 --> 00:36:18,549
to have our probe itself include that

721
00:36:15,429 --> 00:36:20,769
then it seems like you wouldn't want to

722
00:36:18,550 --> 00:36:22,960
include it twice because if you're

723
00:36:20,769 --> 00:36:24,880
already doing cosine fall-off of the

724
00:36:22,960 --> 00:36:25,809
transmission in the diffuse map then you

725
00:36:24,880 --> 00:36:28,509
wouldn't

726
00:36:25,809 --> 00:36:30,189
that when you sample the map again right

727
00:36:28,509 --> 00:36:40,298
I mean that doesn't make a whole lot of

728
00:36:30,188 --> 00:36:43,469
sense to me yeah so as to why we're just

729
00:36:40,298 --> 00:36:43,469
not getting very good

730
00:36:49,659 --> 00:36:54,659
as to why we're not getting very good

731
00:36:52,139 --> 00:36:58,420
transmission there I really don't know

732
00:36:54,659 --> 00:37:02,289
and the no ceiling part of it here seems

733
00:36:58,420 --> 00:37:03,849
like it makes sense obviously but but

734
00:37:02,289 --> 00:37:06,039
when we go down I should probably just

735
00:37:03,849 --> 00:37:14,440
stick a roof on the orphanage so that we

736
00:37:06,039 --> 00:37:19,150
can have a ceiling but oh crap I know

737
00:37:14,440 --> 00:37:21,220
why I mean I don't know why but I did

738
00:37:19,150 --> 00:37:23,079
forget one very important thing the grid

739
00:37:21,219 --> 00:37:25,629
ray caster we have not quite fully

740
00:37:23,079 --> 00:37:28,630
enabled yet so one thing I forgot is

741
00:37:25,630 --> 00:37:31,200
that we don't do termination sampling

742
00:37:28,630 --> 00:37:33,940
anymore and we're probably gonna have to

743
00:37:31,199 --> 00:37:36,309
so what we want to do here is probably

744
00:37:33,940 --> 00:37:40,539
turn termination sampling back on and

745
00:37:36,309 --> 00:37:42,909
debug that first so that was all without

746
00:37:40,539 --> 00:37:44,829
termination sampling and we need

747
00:37:42,909 --> 00:37:50,019
termination sampling so we probably need

748
00:37:44,829 --> 00:37:52,059
to do that right so okay so let's let's

749
00:37:50,019 --> 00:37:53,559
take a look at this and and restart the

750
00:37:52,059 --> 00:37:57,639
debugging process with the grid ray

751
00:37:53,559 --> 00:37:58,029
caster actually yeah yep so that was the

752
00:37:57,639 --> 00:38:01,629
problem

753
00:37:58,030 --> 00:38:04,810
right so now let's take a look and see

754
00:38:01,630 --> 00:38:07,059
because I don't know what the what the

755
00:38:04,809 --> 00:38:10,599
total lighting values would have to be

756
00:38:07,059 --> 00:38:12,099
here in order to to make this work but

757
00:38:10,599 --> 00:38:14,049
they shouldn't have to be particularly

758
00:38:12,099 --> 00:38:18,819
high once you actually have transmission

759
00:38:14,050 --> 00:38:22,360
going there right so okay now the the

760
00:38:18,820 --> 00:38:24,430
the cube ray caster will propagate the

761
00:38:22,360 --> 00:38:26,470
light and in terms of how bright you

762
00:38:24,429 --> 00:38:28,089
need the lights to be we can't

763
00:38:26,469 --> 00:38:33,159
necessarily determine that there's a

764
00:38:28,090 --> 00:38:35,860
feedback loop without without doing a

765
00:38:33,159 --> 00:38:37,469
power visualization so there may or may

766
00:38:35,860 --> 00:38:40,539
not be feedback loops in it currently

767
00:38:37,469 --> 00:38:42,219
and we kind of have to find out so if

768
00:38:40,539 --> 00:38:43,440
you take a look at how this lighting is

769
00:38:42,219 --> 00:38:47,919
looking actually actually looking

770
00:38:43,440 --> 00:38:51,970
freaking great I'm I'm really liking

771
00:38:47,920 --> 00:38:53,789
this so what we now need to do is write

772
00:38:51,969 --> 00:38:56,139
some kind of visualization for the power

773
00:38:53,789 --> 00:38:58,630
because for example when it over braided

774
00:38:56,139 --> 00:39:00,739
there because we have 50 times we had a

775
00:38:58,630 --> 00:39:04,670
50 times powerful

776
00:39:00,739 --> 00:39:06,769
/ color light it could have just been

777
00:39:04,670 --> 00:39:09,980
the correct lighting right it would look

778
00:39:06,769 --> 00:39:12,289
ultimately bright right so I'm very

779
00:39:09,980 --> 00:39:15,230
curious to know essentially like what

780
00:39:12,289 --> 00:39:17,900
the total level of light ends up being

781
00:39:15,230 --> 00:39:19,940
in in terms of situations where a sample

782
00:39:17,900 --> 00:39:23,150
now one thing that I'm noticing is that

783
00:39:19,940 --> 00:39:24,440
when we when we use that termination

784
00:39:23,150 --> 00:39:26,750
based sampling though it does look like

785
00:39:24,440 --> 00:39:29,720
we're getting light leaking again right

786
00:39:26,750 --> 00:39:32,690
can see light leaking out here and I

787
00:39:29,719 --> 00:39:34,219
don't I don't care for that so we have

788
00:39:32,690 --> 00:39:35,358
to take a look at why we're getting that

789
00:39:34,219 --> 00:39:38,358
it could be that our termination

790
00:39:35,358 --> 00:39:41,380
sampling is is just a problem right but

791
00:39:38,358 --> 00:39:44,088
at least unless I'm misunderstanding

792
00:39:41,380 --> 00:39:46,130
when I when I was looking in here right

793
00:39:44,088 --> 00:39:52,159
it was able to get outside pretty easily

794
00:39:46,130 --> 00:39:54,170
like you see that so we have some issues

795
00:39:52,159 --> 00:39:55,519
in terms of how the light leaking is

796
00:39:54,170 --> 00:40:01,220
working we're gonna have to study why

797
00:39:55,519 --> 00:40:03,679
that's occurring but anyway you can see

798
00:40:01,219 --> 00:40:06,858
that the feedback loops are not nearly

799
00:40:03,679 --> 00:40:10,068
is it's not obvious that we even have

800
00:40:06,858 --> 00:40:13,789
them right so that's also kind of a good

801
00:40:10,068 --> 00:40:16,548
thing all right so let's make the debug

802
00:40:13,789 --> 00:40:18,710
light very powerful and remove these

803
00:40:16,548 --> 00:40:23,389
lights and start to work on specific

804
00:40:18,710 --> 00:40:26,838
cases now so that we can take a look so

805
00:40:23,389 --> 00:40:29,269
if I go into the world mode and I look

806
00:40:26,838 --> 00:40:33,349
at the push light call what I'm going to

807
00:40:29,269 --> 00:40:35,239
do is just increase the power of this

808
00:40:33,349 --> 00:40:37,190
debug light which I believe just

809
00:40:35,239 --> 00:40:39,578
requires me doing something like this

810
00:40:37,190 --> 00:40:41,990
right like I can't oops that's not good

811
00:40:39,579 --> 00:40:49,460
look I can just jack up the power of

812
00:40:41,989 --> 00:40:51,019
this light here and I can in theory just

813
00:40:49,460 --> 00:40:54,170
have my light be a super-bright light

814
00:40:51,019 --> 00:40:58,849
right and so now when I move around I

815
00:40:54,170 --> 00:41:01,400
will have a light that's this that's you

816
00:40:58,849 --> 00:41:02,568
know powerful enough to do bounces and

817
00:41:01,400 --> 00:41:06,139
you can kind of see that happening here

818
00:41:02,568 --> 00:41:10,279
right now the light again it

819
00:41:06,139 --> 00:41:12,568
we're artificially constraining bounce

820
00:41:10,280 --> 00:41:16,329
light to be

821
00:41:12,568 --> 00:41:17,279
redlight and non bounce light to be

822
00:41:16,329 --> 00:41:28,060
white light

823
00:41:17,280 --> 00:41:29,530
so here's with a light that's fairly

824
00:41:28,059 --> 00:41:33,549
powerful you can kind of see it being

825
00:41:29,530 --> 00:41:35,380
powerful and let's see what happens so

826
00:41:33,550 --> 00:41:40,289
you can see this is an example of the

827
00:41:35,380 --> 00:41:45,068
light leaking right and you can see that

828
00:41:40,289 --> 00:41:48,068
these are getting light now whereas they

829
00:41:45,068 --> 00:41:53,679
weren't getting light before and so I

830
00:41:48,068 --> 00:41:59,289
think what we need to do is take a look

831
00:41:53,679 --> 00:42:04,539
at how we're doing our termination when

832
00:41:59,289 --> 00:42:07,239
we do a T terminate I think the problem

833
00:42:04,539 --> 00:42:10,989
that we're having is we're sampling that

834
00:42:07,239 --> 00:42:15,549
probably the incorrect direction that's

835
00:42:10,989 --> 00:42:18,368
my guess or or the point is not quite at

836
00:42:15,550 --> 00:42:20,589
the right place because if you remember

837
00:42:18,369 --> 00:42:24,210
when we call compute voxel irradiance

838
00:42:20,588 --> 00:42:24,210
what we're doing is we're saying hey

839
00:42:25,739 --> 00:42:31,539
don't allow sampling from any probes

840
00:42:28,568 --> 00:42:34,409
that are on the wrong side of whatever

841
00:42:31,539 --> 00:42:37,358
it is that we quote-unquote hit right

842
00:42:34,409 --> 00:42:39,519
and I'm assuming that the problem that

843
00:42:37,358 --> 00:42:43,409
we're going to have now is that when you

844
00:42:39,519 --> 00:42:48,670
early terminate a grid raycast it's

845
00:42:43,409 --> 00:42:54,250
probably not correctly ignoring some of

846
00:42:48,670 --> 00:42:55,150
the light probes right so we I mean I'm

847
00:42:54,250 --> 00:42:56,710
guessing that's what it is because

848
00:42:55,150 --> 00:42:58,210
that's the only thing we changed right

849
00:42:56,710 --> 00:43:00,338
if you take a look at what's going on

850
00:42:58,210 --> 00:43:04,929
here you can see that there's really

851
00:43:00,338 --> 00:43:09,519
only two cases where we error out one is

852
00:43:04,929 --> 00:43:11,769
we err out on the apron and the other is

853
00:43:09,519 --> 00:43:14,530
that we have started not err out early

854
00:43:11,769 --> 00:43:18,159
out is we we stopped on the apron

855
00:43:14,530 --> 00:43:22,309
because we didn't hit anything and the

856
00:43:18,159 --> 00:43:25,399
other is that we did an early terminate

857
00:43:22,309 --> 00:43:28,099
the cost metric now one thing I might do

858
00:43:25,400 --> 00:43:34,119
here is actually put this path back in

859
00:43:28,099 --> 00:43:36,410
real quick with a sort of a fake thing

860
00:43:34,119 --> 00:43:39,410
in fact I guess I don't really need to

861
00:43:36,409 --> 00:43:41,469
put the path back in per se what I can

862
00:43:39,409 --> 00:43:43,608
do is just make a special if here and

863
00:43:41,469 --> 00:43:46,729
what I want to do is make sure that

864
00:43:43,608 --> 00:43:49,938
we're looking at only one case so inside

865
00:43:46,728 --> 00:43:52,489
here where we look at the spatial the

866
00:43:49,938 --> 00:43:55,159
node dot start index spatial grid node

867
00:43:52,489 --> 00:43:59,749
Terminator at that bit here what I want

868
00:43:55,159 --> 00:44:03,288
to do is put in a like debug do not some

869
00:43:59,748 --> 00:44:05,688
or something right or debug zero and

870
00:44:03,289 --> 00:44:07,549
we'll make that be false and what I want

871
00:44:05,688 --> 00:44:12,798
to do is I want to take this and just

872
00:44:07,548 --> 00:44:16,759
say debug zero equals that so if we

873
00:44:12,798 --> 00:44:20,119
happen to hit the Terminator and I don't

874
00:44:16,759 --> 00:44:22,938
mean Arnold Schwarzenegger if we happen

875
00:44:20,119 --> 00:44:26,900
to hit the Terminator I don't want to

876
00:44:22,938 --> 00:44:32,748
use the the result of that in the light

877
00:44:26,900 --> 00:44:36,108
spreading so when I run this now what I

878
00:44:32,748 --> 00:44:39,078
want to see is is it the apron or is it

879
00:44:36,108 --> 00:44:46,308
the Terminator that produces this

880
00:44:39,079 --> 00:44:48,199
problem and you know I can it seems like

881
00:44:46,309 --> 00:44:51,849
I can demonstrate pretty clearly here

882
00:44:48,199 --> 00:44:55,130
that it doesn't require the Terminator

883
00:44:51,849 --> 00:44:57,349
right because I think I turned that off

884
00:44:55,130 --> 00:45:01,789
and you can still see lighting coming

885
00:44:57,349 --> 00:45:05,239
from here so let's try the other way

886
00:45:01,789 --> 00:45:09,079
around so in here I'm going to set it to

887
00:45:05,239 --> 00:45:12,019
do when we hit the cost metric so now

888
00:45:09,079 --> 00:45:15,650
we're gonna do is we will allow the

889
00:45:12,018 --> 00:45:18,919
apron to transmit the light but we won't

890
00:45:15,650 --> 00:45:22,519
allow early outs to transmit the light

891
00:45:18,920 --> 00:45:24,798
and now again I just want to see if I

892
00:45:22,518 --> 00:45:29,598
can spread light outside the boundary in

893
00:45:24,798 --> 00:45:31,278
that in that case right and so before it

894
00:45:29,599 --> 00:45:33,609
seems like I was able to do it here and

895
00:45:31,278 --> 00:45:33,608
I'm not

896
00:45:36,739 --> 00:45:41,809
so that seems to me that our early

897
00:45:39,269 --> 00:45:45,420
termination code is not producing

898
00:45:41,809 --> 00:45:47,880
satisfactory results and so we need to

899
00:45:45,420 --> 00:45:50,039
figure out what we're passing

900
00:45:47,880 --> 00:45:52,858
incorrectly there right because

901
00:45:50,039 --> 00:45:55,139
something's busted and we need to figure

902
00:45:52,858 --> 00:45:58,588
out what that something is so that we

903
00:45:55,139 --> 00:46:02,460
can so that we can fix it all right so

904
00:45:58,588 --> 00:46:05,400
let's go ahead and take a look we now

905
00:46:02,460 --> 00:46:14,670
know what the specific case is that

906
00:46:05,400 --> 00:46:22,710
we're looking at and that specific case

907
00:46:14,670 --> 00:46:25,530
right here is you can see how we're

908
00:46:22,710 --> 00:46:29,280
generating this you can see that we're

909
00:46:25,530 --> 00:46:32,550
taking the t terminate and the Ray

910
00:46:29,280 --> 00:46:35,730
direction and that's how we're producing

911
00:46:32,550 --> 00:46:39,480
what we're going to sample so you can

912
00:46:35,730 --> 00:46:43,199
see that we're sampling you know the

913
00:46:39,480 --> 00:46:45,719
emission direction and the radius single

914
00:46:43,199 --> 00:46:47,909
law stuff I don't believe in Mission

915
00:46:45,719 --> 00:46:56,578
directions actually getting used I could

916
00:46:47,909 --> 00:46:58,679
be wrong about that yeah so even though

917
00:46:56,579 --> 00:47:00,210
in the future we may want to start using

918
00:46:58,679 --> 00:47:01,679
that we're not using it now so we're

919
00:47:00,210 --> 00:47:03,300
really just talking about these two

920
00:47:01,679 --> 00:47:08,519
things and you can see how they're used

921
00:47:03,300 --> 00:47:11,640
in here we use the sample P and the

922
00:47:08,519 --> 00:47:13,858
sample n to produce this table that

923
00:47:11,639 --> 00:47:16,828
prevents us from sampling from anything

924
00:47:13,858 --> 00:47:23,940
that's on the other side of the sample

925
00:47:16,829 --> 00:47:25,950
head now the probe ends single it's a

926
00:47:23,940 --> 00:47:30,358
little it's a little hard to know

927
00:47:25,949 --> 00:47:33,029
exactly what that should be pointing

928
00:47:30,358 --> 00:47:36,779
back in the direction of the Ray does

929
00:47:33,030 --> 00:47:39,769
seem totally fine but we have to be

930
00:47:36,780 --> 00:47:43,470
careful about what location we pick here

931
00:47:39,769 --> 00:47:46,059
so my assumption is that our t terminate

932
00:47:43,469 --> 00:47:49,689
value is not good

933
00:47:46,059 --> 00:47:52,299
if you look at how it works when we take

934
00:47:49,690 --> 00:47:57,880
a step we also accept the new t

935
00:47:52,300 --> 00:48:02,350
terminate value so if you look at

936
00:47:57,880 --> 00:48:07,059
computing the walk table the T terminate

937
00:48:02,349 --> 00:48:10,179
value that we write in has already taken

938
00:48:07,059 --> 00:48:13,239
its step forward and I would suspect

939
00:48:10,179 --> 00:48:15,609
that's probably the problem we're

940
00:48:13,239 --> 00:48:19,839
probably marching into the next grid

941
00:48:15,610 --> 00:48:21,400
Square and then taking the sample but

942
00:48:19,840 --> 00:48:22,960
what we want to do is stay in the

943
00:48:21,400 --> 00:48:25,840
previous grid square because if we're

944
00:48:22,960 --> 00:48:28,119
not going to process the grid square

945
00:48:25,840 --> 00:48:32,140
ahead of us we don't want to use that to

946
00:48:28,119 --> 00:48:34,960
terminate so I think we want this right

947
00:48:32,139 --> 00:48:37,989
we want something that only writes the T

948
00:48:34,960 --> 00:48:40,000
terminate for the previous step so that

949
00:48:37,989 --> 00:48:43,839
we'll never sample ahead of where we

950
00:48:40,000 --> 00:48:47,829
actually collision detected now I don't

951
00:48:43,840 --> 00:48:49,840
know that that was the problem but you

952
00:48:47,829 --> 00:48:51,699
know I would suspect it would be a

953
00:48:49,840 --> 00:48:56,250
problem it doesn't look like it really

954
00:48:51,699 --> 00:48:56,250
helped because like a look at that right

955
00:48:59,940 --> 00:49:04,740
yeah we're still obviously wrong here

956
00:49:06,719 --> 00:49:14,980
yeah I'm saying and you know there's

957
00:49:11,739 --> 00:49:17,649
there's ways we could be creating this

958
00:49:14,980 --> 00:49:20,500
problem pretty easily the fact that this

959
00:49:17,650 --> 00:49:22,630
isn't sealed you know it could be

960
00:49:20,500 --> 00:49:26,230
bouncing up here and then bouncing down

961
00:49:22,630 --> 00:49:28,119
so I don't necessarily know that we have

962
00:49:26,230 --> 00:49:31,809
a bug there in fact I suppose that's

963
00:49:28,119 --> 00:49:36,339
something that we probably need to

964
00:49:31,809 --> 00:49:38,199
figure out how to look we probably want

965
00:49:36,340 --> 00:49:43,030
the light occluders to be much higher

966
00:49:38,199 --> 00:49:49,449
than the walls right so let's just try

967
00:49:43,030 --> 00:49:53,400
that just to see so when we do a push

968
00:49:49,449 --> 00:49:53,399
occluder in the entity code

969
00:49:59,300 --> 00:50:07,100
this particular part of you know of the

970
00:50:02,780 --> 00:50:11,440
code here I I feel like we need to have

971
00:50:07,099 --> 00:50:14,449
two pieces of information when we push

972
00:50:11,440 --> 00:50:21,730
the cubes there so if we look at if you

973
00:50:14,449 --> 00:50:27,429
look at entity pieces so I feel like I

974
00:50:21,730 --> 00:50:33,530
feel like this code needs to have like

975
00:50:27,429 --> 00:50:35,149
an occluder size as well you know so you

976
00:50:33,530 --> 00:50:37,790
know we've got bitmap pieces and we've

977
00:50:35,150 --> 00:50:39,349
got you know we've got various things I

978
00:50:37,789 --> 00:50:49,940
feel like we need like an occluder size

979
00:50:39,349 --> 00:50:51,559
right and I guess that's a little bit

980
00:50:49,940 --> 00:50:53,570
easier said than done because at the

981
00:50:51,559 --> 00:50:58,329
moment you know it might just be that we

982
00:50:53,570 --> 00:51:00,500
should just add a clue to zazz pieces I

983
00:50:58,329 --> 00:51:02,989
think that might just be a better idea

984
00:51:00,500 --> 00:51:09,320
so it might be a better idea to just say

985
00:51:02,989 --> 00:51:11,059
look there's occluders that oops that's

986
00:51:09,320 --> 00:51:14,660
a flag

987
00:51:11,059 --> 00:51:19,210
why are those flags I guess we just we

988
00:51:14,659 --> 00:51:21,319
just roll the yeah all right who knows

989
00:51:19,210 --> 00:51:23,030
these don't need to be flex with our

990
00:51:21,320 --> 00:51:26,210
energy system is not really something

991
00:51:23,030 --> 00:51:28,970
yet right it's kind of just a zygote or

992
00:51:26,210 --> 00:51:31,119
something um and so maybe we just have

993
00:51:28,969 --> 00:51:34,449
occluders in there so we would do

994
00:51:31,119 --> 00:51:34,449
something like this

995
00:51:38,719 --> 00:51:45,529
um and then what we can do is say yeah

996
00:51:41,389 --> 00:51:49,608
that stuff just doesn't it's not how

997
00:51:45,530 --> 00:51:54,019
that works right we're gonna push

998
00:51:49,608 --> 00:51:56,358
occluders on here as a separate pass and

999
00:51:54,019 --> 00:52:00,980
so you know if we actually ran the code

1000
00:51:56,358 --> 00:52:02,598
now we would literally have nothing to

1001
00:52:00,980 --> 00:52:05,960
affect the lighting the lighting would

1002
00:52:02,599 --> 00:52:08,300
be completely random because there'd be

1003
00:52:05,960 --> 00:52:10,220
no walls whatsoever and then what we'll

1004
00:52:08,300 --> 00:52:22,220
do is we'll actually when we create

1005
00:52:10,219 --> 00:52:24,019
these whoa oops sorry about that typo so

1006
00:52:22,219 --> 00:52:27,348
now we just we won't have anything right

1007
00:52:24,019 --> 00:52:30,679
so the light can just spread wherever it

1008
00:52:27,349 --> 00:52:33,920
wants to spread right and it won't be

1009
00:52:30,679 --> 00:52:35,480
affected by walls whatsoever and so now

1010
00:52:33,920 --> 00:52:38,630
what I want to do is actually put

1011
00:52:35,480 --> 00:52:40,550
occluders in there and I'm gonna draw

1012
00:52:38,630 --> 00:52:42,910
the occluders for now so you can see

1013
00:52:40,550 --> 00:52:46,039
I've pushed a volume outline in there

1014
00:52:42,909 --> 00:52:48,588
and what I'm going to do is I'm going to

1015
00:52:46,039 --> 00:52:50,050
go into the room gencode and I'm just

1016
00:52:48,588 --> 00:52:53,570
going to look at how this is working

1017
00:52:50,050 --> 00:52:58,220
so you can see where like for example

1018
00:52:53,570 --> 00:53:01,430
this adds a light to something so I

1019
00:52:58,219 --> 00:53:04,189
don't really know how we want this code

1020
00:53:01,429 --> 00:53:15,169
to work overall but like for example

1021
00:53:04,190 --> 00:53:17,838
whenever we place walls in here you can

1022
00:53:15,170 --> 00:53:22,099
kind of see we've added a thing you know

1023
00:53:17,838 --> 00:53:23,269
we add we add tags to this where do we

1024
00:53:22,099 --> 00:53:26,720
actually create that entity it's right

1025
00:53:23,269 --> 00:53:30,199
here so we've added an entity and at

1026
00:53:26,719 --> 00:53:33,289
some point I guess we must add pieces to

1027
00:53:30,199 --> 00:53:36,319
the entity right yeah so you can see us

1028
00:53:33,289 --> 00:53:39,170
adding pieces here and what we want to

1029
00:53:36,320 --> 00:53:42,320
do now is we just add in addition to

1030
00:53:39,170 --> 00:53:49,329
that piece we'd want to also add like

1031
00:53:42,320 --> 00:53:49,330
the occluder so we'd say you know

1032
00:53:49,829 --> 00:54:00,250
whatever this thing is we'd add we'd

1033
00:53:58,239 --> 00:54:02,739
want one that didn't that didn't use the

1034
00:54:00,250 --> 00:54:06,190
asset category stuff so much so much

1035
00:54:02,739 --> 00:54:10,539
like the ad peace light call we'd want

1036
00:54:06,190 --> 00:54:14,099
like an ad piece occluder and this would

1037
00:54:10,539 --> 00:54:19,269
just be like wouldn't have a mission

1038
00:54:14,099 --> 00:54:24,280
this would just be like a you would have

1039
00:54:19,269 --> 00:54:28,509
a dimension here probably something like

1040
00:54:24,280 --> 00:54:32,280
this offset dimension color you know and

1041
00:54:28,510 --> 00:54:38,609
it would just say here's the dimension

1042
00:54:32,280 --> 00:54:38,609
here's the offset here's the color and

1043
00:54:41,608 --> 00:54:48,940
it's an occluder so that would allow me

1044
00:54:46,449 --> 00:54:50,889
to do like add peace occluder anywhere i

1045
00:54:48,940 --> 00:54:53,050
wanted to and you don't really need the

1046
00:54:50,889 --> 00:54:57,659
return values you wouldn't really modify

1047
00:54:53,050 --> 00:54:57,660
it and all you'd be doing is saying

1048
00:54:58,679 --> 00:55:17,019
here's the radius in the center and

1049
00:55:02,050 --> 00:55:19,750
there's the color sorry it's just be

1050
00:55:17,019 --> 00:55:23,730
three and so at that point I think we

1051
00:55:19,750 --> 00:55:26,130
then would be able to you know make the

1052
00:55:23,730 --> 00:55:32,409
we would be able to make it a taller

1053
00:55:26,130 --> 00:55:35,890
larger bounds right and so is it v3 from

1054
00:55:32,409 --> 00:55:37,559
how do you create a v3 from o that you

1055
00:55:35,889 --> 00:55:40,420
don't even need to it's just that I

1056
00:55:37,559 --> 00:55:44,529
don't know why I was thinking I'm just

1057
00:55:40,420 --> 00:55:47,470
out to lunch so at that point we should

1058
00:55:44,530 --> 00:55:51,220
be able to now see like occluders around

1059
00:55:47,469 --> 00:55:56,189
right and so there's all of our our

1060
00:55:51,219 --> 00:55:56,189
actual blocks and

1061
00:55:56,960 --> 00:56:01,130
I kind of forgot that we don't actually

1062
00:55:59,000 --> 00:56:03,460
put any geometry out here which is fine

1063
00:56:01,130 --> 00:56:05,660
we don't actually need any at the moment

1064
00:56:03,460 --> 00:56:10,849
but what I'd like to do now is start to

1065
00:56:05,659 --> 00:56:14,118
add occluders to that that go up to the

1066
00:56:10,849 --> 00:56:18,380
actual total height right so I want

1067
00:56:14,119 --> 00:56:20,720
these things to be taller so in order to

1068
00:56:18,380 --> 00:56:26,630
do that what I would need in this case

1069
00:56:20,719 --> 00:56:31,118
is I'd need some way of of knowing the

1070
00:56:26,630 --> 00:56:38,300
top bound of the area in question and

1071
00:56:31,119 --> 00:56:40,640
you can see here getting a volume we

1072
00:56:38,300 --> 00:56:43,670
have this sort of tile concept and it

1073
00:56:40,639 --> 00:56:46,429
can tell me that so what I'd like to do

1074
00:56:43,670 --> 00:56:49,460
is look at those calls because I think

1075
00:56:46,429 --> 00:56:52,879
we already sort of had an understanding

1076
00:56:49,460 --> 00:56:54,230
of how these things worked and we have

1077
00:56:52,880 --> 00:56:58,940
like a bunch of functions we can

1078
00:56:54,230 --> 00:57:02,059
actually use so if you look at like you

1079
00:56:58,940 --> 00:57:08,389
know these get room volumes get grid all

1080
00:57:02,059 --> 00:57:10,460
this stuff get volume from minimum Z is

1081
00:57:08,389 --> 00:57:12,469
basically saying like look if you passed

1082
00:57:10,460 --> 00:57:14,869
a height in here

1083
00:57:12,469 --> 00:57:17,088
what would you you know and you looked

1084
00:57:14,869 --> 00:57:21,470
at the the min or max Z or whatever

1085
00:57:17,088 --> 00:57:25,880
right if we said get total volume of the

1086
00:57:21,469 --> 00:57:28,189
tile that might be more what we want for

1087
00:57:25,880 --> 00:57:36,619
cases where we're actually adding a wall

1088
00:57:28,190 --> 00:57:40,970
right so I don't really know when we

1089
00:57:36,619 --> 00:57:45,050
choose to add walls but it looks like we

1090
00:57:40,969 --> 00:57:52,179
just have an on wall right so what we

1091
00:57:45,050 --> 00:57:52,180
could do is say well there's an occluder

1092
00:57:54,778 --> 00:57:59,889
and that's just gonna be the total

1093
00:57:57,068 --> 00:58:03,400
volume of this tile right

1094
00:57:59,889 --> 00:58:08,798
so whatever the tile is it's it's you

1095
00:58:03,400 --> 00:58:12,309
know it's that and then if we want to we

1096
00:58:08,798 --> 00:58:13,960
can say if we're not on a wall then we

1097
00:58:12,309 --> 00:58:25,960
can just say well you know we could even

1098
00:58:13,960 --> 00:58:29,048
do this right so this just allows us to

1099
00:58:25,960 --> 00:58:30,999
produce you know different occlusion

1100
00:58:29,048 --> 00:58:33,068
geometry from what we draw because we

1101
00:58:30,998 --> 00:58:36,669
want to draw walls at like half height

1102
00:58:33,068 --> 00:58:40,358
so the player can see but we want the

1103
00:58:36,670 --> 00:58:42,190
occluders to be larger which it looks

1104
00:58:40,358 --> 00:58:44,858
like we sort of did but the problem is

1105
00:58:42,190 --> 00:58:48,608
is it looks like it's not quite aligned

1106
00:58:44,858 --> 00:58:55,139
properly so when we get the total volume

1107
00:58:48,608 --> 00:58:55,139
here we're like producing an odd a

1108
00:58:56,338 --> 00:59:05,768
fairly odd version of what's going on so

1109
00:58:58,929 --> 00:59:16,649
let's take a look at why oh right we

1110
00:59:05,768 --> 00:59:18,998
would have to do a make relative okay

1111
00:59:16,650 --> 00:59:20,528
because right we need it to be relative

1112
00:59:18,998 --> 00:59:25,449
to whatever the position we're saying

1113
00:59:20,528 --> 00:59:28,659
the entity is okay so there we go and

1114
00:59:25,449 --> 00:59:32,259
now we've got actual blockers in place

1115
00:59:28,659 --> 00:59:34,598
and it does look to me like now we've

1116
00:59:32,259 --> 00:59:37,719
we've correctly like cracked down on

1117
00:59:34,599 --> 00:59:41,318
that light leakage problem right and

1118
00:59:37,719 --> 00:59:42,880
we'll see but yeah it does look like

1119
00:59:41,318 --> 00:59:45,940
that's significantly less now we're

1120
00:59:42,880 --> 00:59:48,099
still getting a little bit right and

1121
00:59:45,940 --> 00:59:50,019
again we kind of want to know where

1122
00:59:48,099 --> 00:59:52,930
that's coming from so I would like to

1123
00:59:50,018 --> 00:59:55,929
still kind of hunt that down it could be

1124
00:59:52,929 --> 00:59:57,788
coming from stuff that's you know even

1125
00:59:55,929 --> 01:00:00,368
further up and I suppose we could test

1126
00:59:57,789 --> 01:00:04,329
that I don't know to what extent that's

1127
01:00:00,369 --> 01:00:07,960
likely but we definitely could test that

1128
01:00:04,329 --> 01:00:13,749
just by putting caps putting a cap on

1129
01:00:07,960 --> 01:00:15,338
on the room as well right I really like

1130
01:00:13,748 --> 01:00:16,689
the idea of having the include errs be

1131
01:00:15,338 --> 01:00:18,880
totally separate because that allows me

1132
01:00:16,690 --> 01:00:21,338
to create real geometry for the lighting

1133
01:00:18,880 --> 01:00:22,930
which is what's happening here while

1134
01:00:21,338 --> 01:00:24,159
still creating fake geometry for

1135
01:00:22,929 --> 01:00:26,618
rendering because you typically don't

1136
01:00:24,159 --> 01:00:28,868
want to draw a completely sealed room

1137
01:00:26,619 --> 01:00:29,979
because the player can't see it and so

1138
01:00:28,869 --> 01:00:31,900
at the very least you need to do like

1139
01:00:29,978 --> 01:00:33,939
wall cutaways or something which you

1140
01:00:31,900 --> 01:00:36,579
could do with a render pass but you know

1141
01:00:33,940 --> 01:00:45,880
it's oftentimes just better to let it be

1142
01:00:36,579 --> 01:00:51,190
an artistic decision so that has some

1143
01:00:45,880 --> 01:00:52,269
pretty bad leaking there right so I

1144
01:00:51,190 --> 01:00:56,650
think that would be something we want to

1145
01:00:52,268 --> 01:00:58,118
take a look at and you know what this is

1146
01:00:56,650 --> 01:01:03,759
a good indication that we have a problem

1147
01:00:58,119 --> 01:01:05,588
because this is totally sealed right and

1148
01:01:03,759 --> 01:01:08,528
we're still getting samples so

1149
01:01:05,588 --> 01:01:12,778
something's up and I'm not sure what

1150
01:01:08,528 --> 01:01:12,778
like how is that getting samples

1151
01:01:17,349 --> 01:01:30,130
so let's take a look does that happen

1152
01:01:21,009 --> 01:01:33,039
right out of the gate it does right so

1153
01:01:30,130 --> 01:01:38,108
now let's go in and and see what happens

1154
01:01:33,039 --> 01:01:57,640
if we turn off the various parts of the

1155
01:01:38,108 --> 01:01:59,018
grid right caster so again I'm just

1156
01:01:57,639 --> 01:02:01,259
going to go down and do the same thing I

1157
01:01:59,018 --> 01:02:01,258
did before

1158
01:02:20,530 --> 01:02:25,430
so I guess I'm not sure exactly where I

1159
01:02:23,360 --> 01:02:26,750
want to do this but I think I just want

1160
01:02:25,429 --> 01:02:41,690
to do it right here is probably the

1161
01:02:26,750 --> 01:02:46,400
easiest place right so that would zero

1162
01:02:41,690 --> 01:02:48,409
it out and then I can look at what

1163
01:02:46,400 --> 01:03:00,170
happens in the various cases so this is

1164
01:02:48,409 --> 01:03:06,940
apron still flickering let's try an on

1165
01:03:00,170 --> 01:03:06,940
apron and then I'll just try it both

1166
01:03:17,639 --> 01:03:22,779
okay so that's proof positive that I'm

1167
01:03:21,010 --> 01:03:26,710
still screwing something up with the

1168
01:03:22,780 --> 01:03:32,260
termination right and you know that's

1169
01:03:26,710 --> 01:03:34,690
just a really weird I don't really even

1170
01:03:32,260 --> 01:03:37,750
know how that's possible something's

1171
01:03:34,690 --> 01:03:44,170
really busted there and the reason that

1172
01:03:37,750 --> 01:03:46,358
I say that is just because those those

1173
01:03:44,170 --> 01:03:49,420
cells that are getting light are not

1174
01:03:46,358 --> 01:03:51,690
even casting like where they would

1175
01:03:49,420 --> 01:03:57,430
terminate would be casts going downward

1176
01:03:51,690 --> 01:04:00,818
so how the heck right so something is

1177
01:03:57,429 --> 01:04:02,710
really busted for example with how we're

1178
01:04:00,818 --> 01:04:09,838
doing the probe probe sample piece

1179
01:04:02,710 --> 01:04:14,050
single something's just messed up right

1180
01:04:09,838 --> 01:04:18,309
and so when we fall out of this and and

1181
01:04:14,050 --> 01:04:19,839
we're going to hit this case you can see

1182
01:04:18,309 --> 01:04:24,539
us doing the sample here

1183
01:04:19,838 --> 01:04:24,539
I guess the reflect color foo

1184
01:04:43,199 --> 01:04:50,368
so the hit ref color in this case is

1185
01:04:47,210 --> 01:04:56,030
what exactly because we haven't hit

1186
01:04:50,369 --> 01:05:00,950
anything so the hit ref color is just

1187
01:04:56,030 --> 01:05:00,950
Fulbright it's just transmission

1188
01:05:09,760 --> 01:05:16,400
the emission level would be based on hit

1189
01:05:12,590 --> 01:05:24,050
emission which is nothing and that's

1190
01:05:16,400 --> 01:05:28,789
good so it's really strange so it seems

1191
01:05:24,050 --> 01:05:46,250
like this probe sample piece single must

1192
01:05:28,789 --> 01:05:52,340
be wrong maybe that one's really

1193
01:05:46,250 --> 01:06:02,409
interesting but you can see that you

1194
01:05:52,340 --> 01:06:02,410
know something's up here so T terminate

1195
01:06:03,519 --> 01:06:17,030
starts zero so in theory it just should

1196
01:06:10,699 --> 01:06:22,730
not it should not ever move you forward

1197
01:06:17,030 --> 01:06:27,760
in that way I think we're gonna have to

1198
01:06:22,730 --> 01:06:32,260
draw this because I'm not thinking of

1199
01:06:27,760 --> 01:06:32,260
I'm not thinking of how that's wrong

1200
01:07:25,019 --> 01:07:29,909
yeah that's a tricky one I just can't

1201
01:07:27,909 --> 01:07:32,710
figure out how you're getting samples

1202
01:07:29,909 --> 01:07:37,119
when you should never be hitting that

1203
01:07:32,710 --> 01:07:40,269
case unless you're casting away from

1204
01:07:37,119 --> 01:07:45,299
where the light is so how are you

1205
01:07:40,269 --> 01:07:45,300
picking up any light you know

1206
01:07:52,039 --> 01:07:59,309
like you can see that it's not picking

1207
01:07:54,539 --> 01:08:00,480
up any light without the you know when

1208
01:07:59,309 --> 01:08:06,019
it's when it's doing bucket-brigade

1209
01:08:00,480 --> 01:08:06,019
carrying and then if you take that out

1210
01:08:13,070 --> 01:08:19,048
it's definitely getting light you know

1211
01:08:15,989 --> 01:08:22,260
and what's more is it's getting light

1212
01:08:19,048 --> 01:08:27,060
from like below like it's getting light

1213
01:08:22,260 --> 01:08:30,630
from like down here right how there's

1214
01:08:27,060 --> 01:08:34,710
nothing down there to hit and none of

1215
01:08:30,630 --> 01:08:37,588
these things well I suppose it could be

1216
01:08:34,710 --> 01:08:41,699
a feedback where someone down here casts

1217
01:08:37,588 --> 01:08:43,798
upwards yeah so that's what could be

1218
01:08:41,699 --> 01:08:46,679
happening summoned down here casts

1219
01:08:43,798 --> 01:08:49,588
upwards there the termination sampling

1220
01:08:46,680 --> 01:08:57,450
is broken it samples something from up

1221
01:08:49,588 --> 01:09:00,359
here and that's and it picks up some of

1222
01:08:57,449 --> 01:09:04,909
that light so it could still be that

1223
01:09:00,359 --> 01:09:04,910
this that this is is just incorrect

1224
01:09:26,899 --> 01:09:36,629
so another thing well another thing I

1225
01:09:32,219 --> 01:09:38,759
suppose we could do is I guess when

1226
01:09:36,630 --> 01:09:40,440
you're looking in this direction so you

1227
01:09:38,759 --> 01:09:45,000
would start at the center of a cell and

1228
01:09:40,439 --> 01:09:47,250
you take one step forward and if you

1229
01:09:45,000 --> 01:09:50,189
didn't really terminate you take another

1230
01:09:47,250 --> 01:09:52,819
step and you would move from where you

1231
01:09:50,189 --> 01:09:55,829
were to the edge of the other cell and

1232
01:09:52,819 --> 01:09:59,489
no matter what your angle is I don't see

1233
01:09:55,829 --> 01:10:02,460
how that would ever possibly leak light

1234
01:09:59,488 --> 01:10:12,769
at that point I mean maybe it could but

1235
01:10:02,460 --> 01:10:12,770
it would seem pretty tough right I mean

1236
01:10:14,448 --> 01:10:20,359
it just doesn't it just doesn't seem

1237
01:10:17,908 --> 01:10:20,359
likely

1238
01:10:26,300 --> 01:10:31,400
I guess one thing we could do is let's

1239
01:10:28,939 --> 01:10:32,598
try to look at one of those that's the

1240
01:10:31,399 --> 01:10:34,670
only thing I can think to do at this

1241
01:10:32,599 --> 01:10:38,270
point I I'm sorry I just I don't have

1242
01:10:34,670 --> 01:10:40,130
any other ideas at the moment using the

1243
01:10:38,270 --> 01:10:42,380
debug zeroing we know that something's

1244
01:10:40,130 --> 01:10:44,739
wrong and so the question is just what

1245
01:10:42,380 --> 01:10:44,739
is it

1246
01:10:52,430 --> 01:11:01,560
okay so what I want to try and do here

1247
01:10:56,880 --> 01:11:08,960
is look for that particular look for

1248
01:11:01,560 --> 01:11:08,960
something that's down there so if I

1249
01:11:13,880 --> 01:11:23,579
that's gonna be a much lower value I

1250
01:11:16,560 --> 01:11:28,470
assumed should probably just cold set

1251
01:11:23,579 --> 01:11:30,720
this thing gonna take me forever to like

1252
01:11:28,470 --> 01:11:33,320
we don't have we don't have debug value

1253
01:11:30,720 --> 01:11:33,320
inputs here

1254
01:11:46,310 --> 01:12:03,740
so I'm gonna I'm gonna cold set that

1255
01:11:48,050 --> 01:12:06,860
value quite a bit lower so I'm gonna set

1256
01:12:03,739 --> 01:12:09,920
this down to like I don't know some much

1257
01:12:06,859 --> 01:12:12,229
lower number hmm I don't actually know

1258
01:12:09,920 --> 01:12:14,590
where we want to be for that lower grid

1259
01:12:12,229 --> 01:12:14,589
tier

1260
01:12:27,960 --> 01:12:38,550
all right so it's not horrible but it

1261
01:12:35,279 --> 01:12:41,329
looks like we're sort of a little too

1262
01:12:38,550 --> 01:12:41,329
low at that point

1263
01:13:03,880 --> 01:13:16,640
so I think that's still one too low for

1264
01:13:07,310 --> 01:13:18,020
looking at those oops alright so

1265
01:13:16,640 --> 01:13:19,970
hopefully this will give us something

1266
01:13:18,020 --> 01:13:28,190
where we can kind of take a look I don't

1267
01:13:19,970 --> 01:13:30,770
actually know should probably make a

1268
01:13:28,189 --> 01:13:32,509
better tester for this it's been enough

1269
01:13:30,770 --> 01:13:34,250
times of having to go through stuff that

1270
01:13:32,510 --> 01:13:37,850
would be nice to be able to just like

1271
01:13:34,250 --> 01:13:40,729
click on it and have it like compute

1272
01:13:37,850 --> 01:13:41,920
that which voxel we're talking about so

1273
01:13:40,729 --> 01:13:45,909
that looks good

1274
01:13:41,920 --> 01:13:45,909
we're basically right in there now

1275
01:13:54,279 --> 01:14:03,738
so this is an example of someone who's

1276
01:14:01,158 --> 01:14:09,559
getting that light and you can kind of

1277
01:14:03,738 --> 01:14:12,198
see I mean it looks about right in terms

1278
01:14:09,560 --> 01:14:16,369
of debug output right it's stopping on

1279
01:14:12,198 --> 01:14:21,979
this and it's it's doing that the point

1280
01:14:16,368 --> 01:14:23,750
back there so if I just scan through the

1281
01:14:21,979 --> 01:14:24,289
Rays here you can see like how they're

1282
01:14:23,750 --> 01:14:26,000
doing

1283
01:14:24,289 --> 01:14:30,760
I suppose what we kind of need to do is

1284
01:14:26,000 --> 01:14:35,539
say what it actually retrieved you know

1285
01:14:30,760 --> 01:14:38,060
or why that would be a thing I want to

1286
01:14:35,539 --> 01:14:55,760
probably I'll lock these in so it's 13

1287
01:14:38,060 --> 01:14:59,360
to 586 and 335 as an example I'd also

1288
01:14:55,760 --> 01:15:05,860
probably like to draw a little bit lower

1289
01:14:59,359 --> 01:15:12,109
so I'm gonna have like the debug dimmed

1290
01:15:05,859 --> 01:15:12,849
minzy I'm just gonna drop that oops

1291
01:15:12,109 --> 01:15:20,359
sorry

1292
01:15:12,850 --> 01:15:24,610
I'm gonna take the debug dim Z and just

1293
01:15:20,359 --> 01:15:26,000
add 2 to it so I get a I get a taller

1294
01:15:24,609 --> 01:15:27,799
stack

1295
01:15:26,000 --> 01:15:30,170
I might actually say let's add quite a

1296
01:15:27,800 --> 01:15:35,029
bit more to it just so we get like a

1297
01:15:30,170 --> 01:15:37,600
nice stack to look at there yeah I don't

1298
01:15:35,029 --> 01:15:37,599
care about that

1299
01:15:44,300 --> 01:15:54,010
all right yeah how is this thing working

1300
01:15:50,840 --> 01:15:54,010
[Music]

1301
01:15:57,510 --> 01:16:08,430
I don't know what this is suppose this

1302
01:16:00,119 --> 01:16:11,880
go this is terrible like what that's not

1303
01:16:08,430 --> 01:16:13,800
what you want so no no no this is right

1304
01:16:11,880 --> 01:16:15,539
so you have the total dimension right

1305
01:16:13,800 --> 01:16:18,630
and you subtract away the amount that

1306
01:16:15,539 --> 01:16:20,579
you were going to show right and this

1307
01:16:18,630 --> 01:16:22,890
leaves how much was left what you want

1308
01:16:20,579 --> 01:16:24,630
to do is go up by half of that right

1309
01:16:22,890 --> 01:16:27,119
that's how you'd actually Center what

1310
01:16:24,630 --> 01:16:28,890
you were doing I don't know what I know

1311
01:16:27,119 --> 01:16:33,720
what the heck we were writing there that

1312
01:16:28,890 --> 01:16:36,690
was that was some nonsense code if ever

1313
01:16:33,720 --> 01:16:39,030
I did see some all right so if if now we

1314
01:16:36,689 --> 01:16:43,109
run it what we should get is a taller

1315
01:16:39,029 --> 01:16:46,199
stack right so at least we can kind of

1316
01:16:43,109 --> 01:16:49,319
see like what's going on and you can

1317
01:16:46,199 --> 01:16:50,579
kind of see like all of these are

1318
01:16:49,319 --> 01:17:00,869
pointing down let's just get the

1319
01:16:50,579 --> 01:17:09,989
complete stack so this will just give us

1320
01:17:00,869 --> 01:17:23,189
like the whole thing that is we don't

1321
01:17:09,989 --> 01:17:25,829
run out of of debug lines first yeah we

1322
01:17:23,189 --> 01:17:33,899
need better we need better support for

1323
01:17:25,829 --> 01:17:37,350
our debug lines fine for sake of

1324
01:17:33,899 --> 01:17:40,189
argument we'll start this the voxel at

1325
01:17:37,350 --> 01:17:40,190
zero for now

1326
01:17:44,680 --> 01:18:01,579
okay so here's what we're looking at and

1327
01:17:59,319 --> 01:18:05,710
really it just it just doesn't make any

1328
01:18:01,579 --> 01:18:13,100
sense I don't understand right

1329
01:18:05,710 --> 01:18:14,270
I'm also not sure how the heck if that's

1330
01:18:13,100 --> 01:18:21,050
the minimum

1331
01:18:14,270 --> 01:18:23,480
I see it's because that's the minimum

1332
01:18:21,050 --> 01:18:28,760
that we would sample from but we can

1333
01:18:23,479 --> 01:18:32,389
still cast outside of it right to pick

1334
01:18:28,760 --> 01:18:35,560
up light sources I guess what was the

1335
01:18:32,390 --> 01:18:35,560
idea behind that

1336
01:18:41,469 --> 01:18:51,500
you know I don't think that makes any

1337
01:18:44,840 --> 01:19:01,969
sense to be completely honest with you

1338
01:18:51,500 --> 01:19:06,920
if if we think that through why would we

1339
01:19:01,969 --> 01:19:08,989
cast outs why did the voxel being wider

1340
01:19:06,920 --> 01:19:11,420
why would that ever help us because we

1341
01:19:08,988 --> 01:19:15,019
can't actually pick up anything other

1342
01:19:11,420 --> 01:19:16,670
than like pure light sources I guess we

1343
01:19:15,020 --> 01:19:18,770
just wanted to be able to transmit light

1344
01:19:16,670 --> 01:19:20,719
sources if we're gonna do that though we

1345
01:19:18,770 --> 01:19:22,820
don't need very much larger because

1346
01:19:20,719 --> 01:19:26,899
since we can't convict any light around

1347
01:19:22,819 --> 01:19:28,250
who the heck cares like you you it would

1348
01:19:26,899 --> 01:19:30,558
only work if there was an actual

1349
01:19:28,250 --> 01:19:31,789
physical light source there you it's not

1350
01:19:30,559 --> 01:19:33,529
gonna actually give you any bounce

1351
01:19:31,789 --> 01:19:36,109
lighting because we don't actually store

1352
01:19:33,529 --> 01:19:38,539
any any bounce lighting outside of it so

1353
01:19:36,109 --> 01:19:43,219
why the voxel itself is larger I don't

1354
01:19:38,539 --> 01:19:46,250
know it doesn't doesn't really make any

1355
01:19:43,219 --> 01:19:47,809
sense anyway fortunately though this

1356
01:19:46,250 --> 01:19:50,090
does tell me what I needed to know which

1357
01:19:47,809 --> 01:19:52,010
is you can see who's getting lighting

1358
01:19:50,090 --> 01:19:54,069
like and it does look like what's

1359
01:19:52,010 --> 01:19:56,840
happening is sort of what I feared

1360
01:19:54,069 --> 01:19:59,359
some folks down here who are casting

1361
01:19:56,840 --> 01:20:01,969
back up at the surface are casting up

1362
01:19:59,359 --> 01:20:06,529
and able to pick up a lighting sample

1363
01:20:01,969 --> 01:20:08,510
right so if we take a look at say this

1364
01:20:06,529 --> 01:20:09,920
person we should be able to see where

1365
01:20:08,510 --> 01:20:12,829
they're getting their light sample from

1366
01:20:09,920 --> 01:20:14,690
so let's take a look at that that's

1367
01:20:12,828 --> 01:20:19,118
literally on the ground floor so it

1368
01:20:14,689 --> 01:20:19,118
should be pretty easy to isolate

1369
01:20:24,619 --> 01:20:30,539
and in the meantime I should just shrink

1370
01:20:27,659 --> 01:20:33,000
that grid what's the point I have no

1371
01:20:30,539 --> 01:20:37,439
idea why I did that I think I didn't

1372
01:20:33,000 --> 01:20:41,579
think that through because like this

1373
01:20:37,439 --> 01:20:44,250
just doesn't it just doesn't make a lot

1374
01:20:41,579 --> 01:20:51,510
of sense I mean a very tiny apron is

1375
01:20:44,250 --> 01:20:53,010
probably fine but I don't know I don't

1376
01:20:51,510 --> 01:20:54,539
really think that makes a difference I'm

1377
01:20:53,010 --> 01:20:58,020
gonna get rid of that because I think

1378
01:20:54,539 --> 01:21:00,829
that's just a fool's a fool's errand you

1379
01:20:58,020 --> 01:21:10,890
pretty much have to have your your atlas

1380
01:21:00,829 --> 01:21:12,119
or it won't work so alright so what I'd

1381
01:21:10,890 --> 01:21:17,730
like to do is start to take a look at

1382
01:21:12,119 --> 01:21:19,920
that specifically and so I'm gonna go

1383
01:21:17,729 --> 01:21:26,819
ahead and grab the the debug slider here

1384
01:21:19,920 --> 01:21:28,560
and just try to pick that one out which

1385
01:21:26,819 --> 01:21:29,880
somehow I'm not seeing which doesn't

1386
01:21:28,560 --> 01:21:30,180
really make any sense cuz I should be

1387
01:21:29,880 --> 01:21:32,550
right

1388
01:21:30,180 --> 01:21:33,810
oh wait I'm still in the apron right so

1389
01:21:32,550 --> 01:21:38,390
I gotta get off the apron and then we'll

1390
01:21:33,810 --> 01:21:38,390
we should get right on there there we go

1391
01:21:47,329 --> 01:22:02,640
okay so this is someone who is getting

1392
01:21:54,270 --> 01:22:05,310
light from above somehow right and we

1393
01:22:02,640 --> 01:22:07,020
don't really know exactly what direction

1394
01:22:05,310 --> 01:22:09,900
we're getting laid from but we are

1395
01:22:07,020 --> 01:22:13,350
getting some and so I'm gonna just take

1396
01:22:09,899 --> 01:22:14,129
a look at at some ray indexes here to

1397
01:22:13,350 --> 01:22:19,050
see if I can

1398
01:22:14,130 --> 01:22:21,630
aha well that's an actual hit though

1399
01:22:19,050 --> 01:22:25,610
so that should pretty solidly eliminate

1400
01:22:21,630 --> 01:22:25,609
any sampling that comes from above it

1401
01:22:37,770 --> 01:22:41,890
I'm trying to figure out which direction

1402
01:22:40,000 --> 01:22:47,369
this is actually coming from right it

1403
01:22:41,890 --> 01:22:56,460
looks like it's kind of coming from that

1404
01:22:47,369 --> 01:22:56,460
direction right somehow and so

1405
01:23:05,449 --> 01:23:11,619
I guess yeah something like something

1406
01:23:09,439 --> 01:23:11,619
like that

1407
01:23:18,170 --> 01:23:27,529
so it looks like it's coming from over

1408
01:23:22,710 --> 01:23:30,810
there and I don't actually know how

1409
01:23:27,529 --> 01:23:32,340
that's happening like maybe it's coming

1410
01:23:30,810 --> 01:23:35,880
for their is that roughly the center

1411
01:23:32,340 --> 01:23:38,630
area or not now it's it's probably a

1412
01:23:35,880 --> 01:23:38,630
little bit more

1413
01:24:04,460 --> 01:24:13,279
so that's probably pretty close right I

1414
01:24:11,029 --> 01:24:18,050
mean it may not be the exact one but

1415
01:24:13,279 --> 01:24:20,559
that looks you know at least roughly

1416
01:24:18,050 --> 01:24:20,560
like

1417
01:24:41,908 --> 01:24:48,779
I think that's pretty sane right so

1418
01:24:45,779 --> 01:24:52,109
we're somehow getting light transmitted

1419
01:24:48,779 --> 01:24:53,009
from up here and I mean there's a couple

1420
01:24:52,109 --> 01:24:54,538
of different ways that could be

1421
01:24:53,010 --> 01:24:56,309
happening one is we could actually be

1422
01:24:54,538 --> 01:24:57,840
getting secondary bounce from this so it

1423
01:24:56,309 --> 01:25:00,570
could be that something up here actually

1424
01:24:57,840 --> 01:25:01,828
is creating light that's flowing through

1425
01:25:00,569 --> 01:25:20,009
so I guess we should probably look at

1426
01:25:01,828 --> 01:25:23,130
that this is what 7 1 7 5 3 1 and so

1427
01:25:20,010 --> 01:25:25,739
what I assume I want to do is just take

1428
01:25:23,130 --> 01:25:32,099
a look and see well okay so if that's

1429
01:25:25,738 --> 01:25:33,958
the actual cast back to here like where

1430
01:25:32,099 --> 01:25:37,349
is it what what is it actually picking

1431
01:25:33,958 --> 01:25:42,958
up over there so what I might do is is

1432
01:25:37,349 --> 01:25:46,139
lock the vox start x and y 2 also be in

1433
01:25:42,958 --> 01:25:49,078
the corner right and just see what

1434
01:25:46,139 --> 01:25:50,880
happens there cuz i I can't tell what

1435
01:25:49,078 --> 01:25:57,538
lighting is in that is in that area

1436
01:25:50,880 --> 01:25:59,099
right so if I move this stack I guess I

1437
01:25:57,538 --> 01:26:06,840
just want to move it over in X a little

1438
01:25:59,099 --> 01:26:09,139
bit so maybe I'll do something more like

1439
01:26:06,840 --> 01:26:09,139
this

1440
01:26:17,199 --> 01:26:22,829
and probably watched a little more than

1441
01:26:21,069 --> 01:26:29,529
that

1442
01:26:22,829 --> 01:26:31,269
oops that was the wrong way and so now I

1443
01:26:29,529 --> 01:26:32,619
should be able to look to see what are

1444
01:26:31,270 --> 01:26:34,750
the lighting values over there that it's

1445
01:26:32,619 --> 01:26:38,619
sampling from like is somebody in that

1446
01:26:34,750 --> 01:26:42,340
region creating light and is that who we

1447
01:26:38,619 --> 01:26:44,949
need to debug or is somehow this bug

1448
01:26:42,340 --> 01:26:47,829
yeah I mean you can sort of see that it

1449
01:26:44,949 --> 01:26:52,229
is actually these folks are getting

1450
01:26:47,829 --> 01:26:52,229
light from above them right

1451
01:26:57,298 --> 01:27:07,168
right you can see like that but I have

1452
01:27:01,708 --> 01:27:09,198
no idea how right because how the heck

1453
01:27:07,168 --> 01:27:11,698
are they getting through here right

1454
01:27:09,198 --> 01:27:13,738
again it's kind of a mystery now it's

1455
01:27:11,698 --> 01:27:15,868
true that there's no floor here so they

1456
01:27:13,738 --> 01:27:22,828
are free to cast straight up through

1457
01:27:15,868 --> 01:27:26,969
here and that's totally fine right but

1458
01:27:22,828 --> 01:27:33,058
again I want to know why right how are

1459
01:27:26,969 --> 01:27:34,349
all of these folks getting light when I

1460
01:27:33,059 --> 01:27:38,599
just don't see where that would really

1461
01:27:34,349 --> 01:27:38,599
be coming from right are they are they

1462
01:27:47,949 --> 01:27:56,050
I'm also very curious what that is

1463
01:27:49,810 --> 01:27:57,760
happening there so we're gonna have to

1464
01:27:56,050 --> 01:27:59,710
see what's up with that there's also

1465
01:27:57,760 --> 01:28:02,920
sort of a separate issue here that I'm

1466
01:27:59,710 --> 01:28:04,960
not sure I'm internalizing correctly I'm

1467
01:28:02,920 --> 01:28:10,869
not sure I always have these directions

1468
01:28:04,960 --> 01:28:15,399
proper like I think part of the problem

1469
01:28:10,869 --> 01:28:17,859
is when you're sampling in a direction

1470
01:28:15,399 --> 01:28:23,969
like that it's almost like I feel like

1471
01:28:17,859 --> 01:28:23,969
we have the normal backwards in a way

1472
01:28:34,460 --> 01:28:39,649
when you're sampling a surface that you

1473
01:28:37,260 --> 01:28:43,230
hit you sample in a different direction

1474
01:28:39,649 --> 01:28:48,869
right like then if you're sampling for

1475
01:28:43,229 --> 01:28:57,959
transmission and so I think I also think

1476
01:28:48,869 --> 01:29:01,260
I need this like I think we need two

1477
01:28:57,960 --> 01:29:05,630
separate things and when you're bouncing

1478
01:29:01,260 --> 01:29:07,739
off the surface they're the same but

1479
01:29:05,630 --> 01:29:08,340
when you're terminating they're

1480
01:29:07,739 --> 01:29:10,109
different

1481
01:29:08,340 --> 01:29:17,190
I don't know if that makes sense right

1482
01:29:10,109 --> 01:29:18,479
so basically like probably should have

1483
01:29:17,189 --> 01:29:18,869
used search and replaced there but it's

1484
01:29:18,479 --> 01:29:23,009
fine

1485
01:29:18,869 --> 01:29:26,569
I hate capslock with a passion

1486
01:29:23,010 --> 01:29:32,579
I want my editor just ignore it

1487
01:29:26,569 --> 01:29:37,259
anyway I think what we want here is we

1488
01:29:32,579 --> 01:29:40,100
want to say when we do a computer a

1489
01:29:37,260 --> 01:29:45,930
daeun sat in all of these circumstances

1490
01:29:40,100 --> 01:29:48,870
you know we're we're going to do probe

1491
01:29:45,930 --> 01:29:50,400
sample n signal and single and we're

1492
01:29:48,869 --> 01:29:52,800
going to pass the emission direction

1493
01:29:50,399 --> 01:29:57,500
here and those need to be different so

1494
01:29:52,800 --> 01:29:57,500
they'll be the same in

1495
01:30:04,020 --> 01:30:10,590
in some cases and they'll be different

1496
01:30:06,149 --> 01:30:13,349
in others so I think in this case where

1497
01:30:10,590 --> 01:30:14,760
you're bouncing off its emission

1498
01:30:13,350 --> 01:30:17,760
direction is not what it is it's the

1499
01:30:14,760 --> 01:30:20,280
occlusion direction right so in some

1500
01:30:17,760 --> 01:30:22,079
cases they're the same so in instead of

1501
01:30:20,279 --> 01:30:30,449
emission direction we're going to call

1502
01:30:22,079 --> 01:30:34,738
this occlusion and what we're gonna do

1503
01:30:30,449 --> 01:30:37,019
here is say that when we do a sample we

1504
01:30:34,738 --> 01:30:39,689
will sample in the direction we're

1505
01:30:37,020 --> 01:30:44,640
heading but we'll occlude in the reverse

1506
01:30:39,689 --> 01:30:47,639
direction right and then when we

1507
01:30:44,640 --> 01:30:49,350
actually hit something that one will be

1508
01:30:47,640 --> 01:30:52,619
slightly different so when we actually

1509
01:30:49,350 --> 01:30:56,100
hit something we will say that the

1510
01:30:52,619 --> 01:31:00,479
occlusion Direction is the same right we

1511
01:30:56,100 --> 01:31:04,260
want them both to be the same and then

1512
01:31:00,479 --> 01:31:05,669
an ABB raycast won't really matter which

1513
01:31:04,260 --> 01:31:06,960
one we do because we're probably gonna

1514
01:31:05,670 --> 01:31:11,190
get rid of this path eventually anyway

1515
01:31:06,960 --> 01:31:12,930
but that's the deal and so here we

1516
01:31:11,189 --> 01:31:14,339
passed the occlusion D and I think

1517
01:31:12,930 --> 01:31:16,650
that's important because before we were

1518
01:31:14,340 --> 01:31:19,800
sampling we were transmitting in a

1519
01:31:16,649 --> 01:31:22,189
bounce which is bad and I could see that

1520
01:31:19,800 --> 01:31:24,719
creating a lot of issues for us right so

1521
01:31:22,189 --> 01:31:28,319
let's take a quick look now at what's

1522
01:31:24,719 --> 01:31:30,210
happening down here yeah so do you see

1523
01:31:28,319 --> 01:31:32,399
how much quieter that is now they're

1524
01:31:30,210 --> 01:31:35,010
still probably some bugs in it but like

1525
01:31:32,399 --> 01:31:39,269
it's not doing a it's not irradiating

1526
01:31:35,010 --> 01:31:41,369
between terminators and I think that's

1527
01:31:39,270 --> 01:31:43,860
really important because that was

1528
01:31:41,369 --> 01:31:47,130
basically creating fake reflection but

1529
01:31:43,859 --> 01:31:50,429
didn't really exist and now we're not

1530
01:31:47,130 --> 01:31:53,390
we're just using transmission yeah look

1531
01:31:50,430 --> 01:31:57,719
at look at how much better that is right

1532
01:31:53,390 --> 01:32:01,250
that was crucial so so okay yeah that

1533
01:31:57,719 --> 01:32:01,250
was clearly a problem

1534
01:32:03,710 --> 01:32:09,980
so that seems quite good by comparison

1535
01:32:06,380 --> 01:32:15,350
to what it was right much much much much

1536
01:32:09,979 --> 01:32:16,669
better so yeah so I think we've got a

1537
01:32:15,350 --> 01:32:18,500
couple of things we're going to need an

1538
01:32:16,670 --> 01:32:20,480
exposure curve in here pretty soon

1539
01:32:18,500 --> 01:32:21,979
because we're you know in terms of

1540
01:32:20,479 --> 01:32:25,759
actually bouncing light around you can't

1541
01:32:21,979 --> 01:32:27,409
really use linear 0 to 1

1542
01:32:25,760 --> 01:32:29,860
lighting expect anything to happen I'm

1543
01:32:27,409 --> 01:32:32,899
gonna try doing some light over

1544
01:32:29,859 --> 01:32:35,119
floodings stuff and then we'll save the

1545
01:32:32,899 --> 01:32:38,869
the power curve stuff for for next time

1546
01:32:35,119 --> 01:32:43,130
around alright so if I go ahead and do

1547
01:32:38,869 --> 01:32:46,630
let's let's go ahead and jump to where

1548
01:32:43,130 --> 01:32:48,500
we're pushing that debug light on I

1549
01:32:46,630 --> 01:32:50,480
think then we're just about done for

1550
01:32:48,500 --> 01:32:53,260
today anyway and I'm gonna massively

1551
01:32:50,479 --> 01:32:53,259
over bright that light

1552
01:33:00,130 --> 01:33:03,529
and I just want to see what happens so

1553
01:33:02,208 --> 01:33:04,998
we still get a little light leaking

1554
01:33:03,529 --> 01:33:07,938
there right you can see some light

1555
01:33:04,998 --> 01:33:10,748
leaking happening it's actually fairly

1556
01:33:07,939 --> 01:33:14,360
stable but it's it's it's not great

1557
01:33:10,748 --> 01:33:15,648
let's see if I push it up to 30 I just

1558
01:33:14,359 --> 01:33:23,238
want to see where our breaking point is

1559
01:33:15,649 --> 01:33:24,739
now and this is just a good way of

1560
01:33:23,238 --> 01:33:26,509
testing like you can see like we're

1561
01:33:24,738 --> 01:33:29,569
getting some weird results so I think we

1562
01:33:26,510 --> 01:33:31,760
we can probably I think we've still got

1563
01:33:29,569 --> 01:33:34,458
some bugs in there like possibly that

1564
01:33:31,760 --> 01:33:37,909
that that may not be algorithm artifacts

1565
01:33:34,458 --> 01:33:39,618
that made that may just be bugs right so

1566
01:33:37,908 --> 01:33:44,658
we should probably do some testing for

1567
01:33:39,618 --> 01:33:46,938
just like to see if we can if we can use

1568
01:33:44,658 --> 01:33:50,988
like light over flooding to find any

1569
01:33:46,939 --> 01:33:54,918
more artifacts there right and and we'll

1570
01:33:50,988 --> 01:33:58,098
just we'll see at the moment however you

1571
01:33:54,918 --> 01:34:00,498
know not bad so I'm gonna go I'm going

1572
01:33:58,099 --> 01:34:10,909
to really quickly just restore this to

1573
01:34:00,498 --> 01:34:12,828
normal and just see what's up if I put

1574
01:34:10,908 --> 01:34:20,299
things back the way they were sort of

1575
01:34:12,828 --> 01:34:22,938
working before I'm just curious where

1576
01:34:20,300 --> 01:34:25,159
we're at because we're getting there but

1577
01:34:22,939 --> 01:34:26,389
we got to put in a curve now we got to

1578
01:34:25,158 --> 01:34:30,219
put in a power curve and then we got to

1579
01:34:26,389 --> 01:34:34,279
kind of find some debug there all right

1580
01:34:30,219 --> 01:34:37,880
so looking at the lighting from a high

1581
01:34:34,279 --> 01:34:41,029
level now I think the biggest problem we

1582
01:34:37,880 --> 01:34:42,828
have is just the actual power conserving

1583
01:34:41,029 --> 01:34:45,288
transmission doesn't spread the light as

1584
01:34:42,828 --> 01:34:47,840
far as I would like again I think power

1585
01:34:45,288 --> 01:34:50,800
curve may solve that problem so we'll

1586
01:34:47,840 --> 01:34:50,800
have to take a look at that

1587
01:35:01,208 --> 01:35:06,918
but starting to get some some promising

1588
01:35:03,828 --> 01:35:09,978
results right it's it's getting much

1589
01:35:06,918 --> 01:35:13,099
close much closer but but yeah again we

1590
01:35:09,979 --> 01:35:16,399
have to start we have to start looking

1591
01:35:13,099 --> 01:35:17,719
very carefully at power and trying to

1592
01:35:16,399 --> 01:35:19,128
figure out exactly how that should go

1593
01:35:17,719 --> 01:35:20,149
right because we're not getting enough

1594
01:35:19,128 --> 01:35:22,519
oh you know what else we should do while

1595
01:35:20,149 --> 01:35:25,159
we're at it since we can now let's add a

1596
01:35:22,519 --> 01:35:30,918
clue ders to two trees when we place a

1597
01:35:25,158 --> 01:35:33,259
tree because like there's a there was an

1598
01:35:30,918 --> 01:35:39,069
outside sort of thing we were doing that

1599
01:35:33,260 --> 01:35:39,070
wasn't very good and if we go over to

1600
01:35:42,729 --> 01:35:47,050
and actually know how we were even doing

1601
01:35:44,779 --> 01:35:47,050
this

1602
01:35:55,260 --> 01:36:01,170
I don't know where we were putting these

1603
01:35:59,399 --> 01:36:03,569
in this code is always so kind of weird

1604
01:36:01,170 --> 01:36:05,190
like we didn't haven't really ever made

1605
01:36:03,569 --> 01:36:08,460
this code good so I don't know where

1606
01:36:05,189 --> 01:36:10,768
we're putting tree here so place tree I

1607
01:36:08,460 --> 01:36:12,960
guess so

1608
01:36:10,769 --> 01:36:16,590
I think all I really want is to just

1609
01:36:12,960 --> 01:36:19,069
take that occluder code so this thing

1610
01:36:16,590 --> 01:36:19,069
here

1611
01:36:30,809 --> 01:36:35,179
if we're gonna place a tree I guess I

1612
01:36:32,908 --> 01:36:42,089
just make a larger occluder there right

1613
01:36:35,179 --> 01:36:45,649
so maybe it's just this I'm not sure if

1614
01:36:42,090 --> 01:36:45,650
that's all I need to do but it might be

1615
01:36:55,020 --> 01:37:04,440
and so if I head over here now to a tree

1616
01:36:58,529 --> 01:37:06,569
area I don't actually know but yeah so

1617
01:37:04,439 --> 01:37:07,769
like you can see the occluders are now

1618
01:37:06,569 --> 01:37:10,679
actually including like the light

1619
01:37:07,770 --> 01:37:13,880
doesn't spread outside there right so we

1620
01:37:10,680 --> 01:37:17,280
probably don't want as much occlusion

1621
01:37:13,880 --> 01:37:21,390
from trees so we probably don't want to

1622
01:37:17,279 --> 01:37:24,449
do you know this what what I literally

1623
01:37:21,390 --> 01:37:26,579
did so probably not going to quite do

1624
01:37:24,449 --> 01:37:29,510
that but what I might want to do is

1625
01:37:26,579 --> 01:37:29,510
something more like this

1626
01:37:29,630 --> 01:37:37,380
so if we are going to place a tree here

1627
01:37:32,550 --> 01:37:44,520
then what I would do is maybe make a

1628
01:37:37,380 --> 01:37:55,680
little tree ball thing and just say well

1629
01:37:44,520 --> 01:38:03,360
alright so the you know the tree ball is

1630
01:37:55,680 --> 01:38:09,690
going to be I don't know like the

1631
01:38:03,359 --> 01:38:18,299
original volume maybe with an add radius

1632
01:38:09,689 --> 01:38:19,439
to I guess I don't really want to start

1633
01:38:18,300 --> 01:38:22,070
with the original volume so I probably

1634
01:38:19,439 --> 01:38:22,069
want to do this

1635
01:38:24,949 --> 01:38:32,929
and then I probably want to do an ad

1636
01:38:26,630 --> 01:38:35,750
radius too I think I probably actually

1637
01:38:32,930 --> 01:38:39,079
also want to do a Minzy here to not have

1638
01:38:35,750 --> 01:38:42,319
it overflowed but I want to shrink this

1639
01:38:39,079 --> 01:38:45,229
in right so I kind of want to say well

1640
01:38:42,319 --> 01:38:57,049
the tree volume is is going to be you

1641
01:38:45,229 --> 01:39:00,349
know less by something right so you know

1642
01:38:57,050 --> 01:39:02,090
like we're just gonna shrink it down and

1643
01:39:00,350 --> 01:39:03,980
I you know I don't know well we'll we

1644
01:39:02,090 --> 01:39:05,690
actually need to go make our generator

1645
01:39:03,979 --> 01:39:07,459
code generate worlds that we actually

1646
01:39:05,689 --> 01:39:13,669
care about you know that's that's a game

1647
01:39:07,460 --> 01:39:14,930
play thing but I should probably still

1648
01:39:13,670 --> 01:39:17,000
be drawing those occluders too because I

1649
01:39:14,930 --> 01:39:19,640
have no idea what I've just created but

1650
01:39:17,000 --> 01:39:20,869
we want something that allows light to

1651
01:39:19,640 --> 01:39:22,250
kind of flow through there's a little

1652
01:39:20,869 --> 01:39:26,630
bit more so let me just let me just go

1653
01:39:22,250 --> 01:39:28,159
ahead and put in the the volume

1654
01:39:26,630 --> 01:39:30,760
outlining so that way we can at least

1655
01:39:28,159 --> 01:39:30,760
just see

1656
01:39:37,469 --> 01:39:44,219
all right so that didn't work at all ah

1657
01:39:54,300 --> 01:40:05,560
that's because I didn't actually use the

1658
01:39:57,819 --> 01:40:07,840
results all right so there we go that

1659
01:40:05,560 --> 01:40:10,870
thins out the trees a little but there's

1660
01:40:07,840 --> 01:40:14,199
still way too tall and also probably

1661
01:40:10,869 --> 01:40:20,519
still too fat so we probably want to do

1662
01:40:14,198 --> 01:40:20,519
this we probably want to tree Vall max Z

1663
01:40:21,270 --> 01:40:34,140
equals I don't even know so in terms of

1664
01:40:37,890 --> 01:40:43,329
in terms of like how we can ask about

1665
01:40:41,109 --> 01:40:46,259
these when we do the from Minzy thing

1666
01:40:43,329 --> 01:40:46,260
like what is

1667
01:40:59,539 --> 01:41:06,238
so it looks like get volume from Minzy

1668
01:41:03,390 --> 01:41:08,100
is like produces something from the

1669
01:41:06,238 --> 01:41:12,089
bottom of the tile up to a particular

1670
01:41:08,100 --> 01:41:21,539
place which doesn't really help us in

1671
01:41:12,090 --> 01:41:22,860
this case and like looking here like how

1672
01:41:21,539 --> 01:41:24,840
do we know where this thing actually

1673
01:41:22,859 --> 01:41:27,329
starts is that p00

1674
01:41:24,840 --> 01:41:31,920
is like where it actually is I have no

1675
01:41:27,329 --> 01:41:34,100
idea write this code sort of sucks and

1676
01:41:31,920 --> 01:41:44,190
it just makes it hard to create things

1677
01:41:34,100 --> 01:41:46,500
so let's do this maybe for now and we'll

1678
01:41:44,189 --> 01:41:50,000
like worry about creating actual tree

1679
01:41:46,500 --> 01:41:56,460
occluders that that aren't terrible and

1680
01:41:50,000 --> 01:41:59,479
when we actually do the room code and

1681
01:41:56,460 --> 01:42:11,969
that could probably stand to be a little

1682
01:41:59,479 --> 01:42:14,339
more yet okay so probably just call that

1683
01:42:11,969 --> 01:42:16,289
a day and we can go to QA is there a

1684
01:42:14,340 --> 01:42:21,300
reason why that doesn't seem to be

1685
01:42:16,289 --> 01:42:24,630
shrinking much in Z because that should

1686
01:42:21,300 --> 01:42:31,860
be a quite large Z contraction but I'm

1687
01:42:24,630 --> 01:42:34,859
not seeing that right is it just that Z

1688
01:42:31,859 --> 01:42:37,679
is much larger and so it doesn't look

1689
01:42:34,859 --> 01:42:40,829
like as much difficult action by

1690
01:42:37,680 --> 01:42:46,219
comparison or what's going on there yeah

1691
01:42:40,829 --> 01:42:51,679
I guess that was so there's some trees

1692
01:42:46,219 --> 01:42:54,090
maybe all right

1693
01:42:51,679 --> 01:42:55,408
so if we take a look now we should be

1694
01:42:54,090 --> 01:42:58,289
able to also get some bounce lighting

1695
01:42:55,408 --> 01:43:00,899
from trees I mean in theory right so

1696
01:42:58,289 --> 01:43:02,670
which now we do right and you can kind

1697
01:43:00,899 --> 01:43:04,439
of see that before we were getting

1698
01:43:02,670 --> 01:43:05,760
complete occlusion there and no bounce

1699
01:43:04,439 --> 01:43:08,189
but now we're actually getting some

1700
01:43:05,760 --> 01:43:10,560
bounce lighting so we're getting there

1701
01:43:08,189 --> 01:43:11,939
slowly but surely and so now I think our

1702
01:43:10,560 --> 01:43:15,929
biggest problem is just like we're not

1703
01:43:11,939 --> 01:43:19,769
getting as much light convection as we

1704
01:43:15,929 --> 01:43:22,800
would hope and so I kind of want to know

1705
01:43:19,770 --> 01:43:27,060
what's up with that right and we got to

1706
01:43:22,800 --> 01:43:29,159
start to analyze that it's especially

1707
01:43:27,060 --> 01:43:32,870
kind of strange because I think again

1708
01:43:29,158 --> 01:43:37,439
power curve is really the issue here

1709
01:43:32,869 --> 01:43:39,210
because you can kind of see like in fact

1710
01:43:37,439 --> 01:43:42,329
if I just go into the shader and turn

1711
01:43:39,210 --> 01:43:45,619
off the way that we were doing the light

1712
01:43:42,329 --> 01:43:57,210
flooring just for interpolation purposes

1713
01:43:45,619 --> 01:44:01,800
you can kind of see in here where is

1714
01:43:57,210 --> 01:44:03,929
that so you can see here where we do our

1715
01:44:01,800 --> 01:44:10,920
light floor value

1716
01:44:03,929 --> 01:44:14,039
right so the light floor value here if I

1717
01:44:10,920 --> 01:44:17,699
just turn off that which I don't

1718
01:44:14,039 --> 01:44:22,738
actually know if anyone's properly using

1719
01:44:17,698 --> 01:44:25,678
it in lighting yeah so we're not we're

1720
01:44:22,738 --> 01:44:27,509
not even using the light floor pack at

1721
01:44:25,679 --> 01:44:30,658
the moment like we're supposed to be but

1722
01:44:27,510 --> 01:44:33,150
we don't so if we just went to the light

1723
01:44:30,658 --> 01:44:37,920
floor value and we just set the light

1724
01:44:33,149 --> 01:44:39,238
floor value at the moment to be zero we

1725
01:44:37,920 --> 01:44:40,889
would see a lot more light in there as

1726
01:44:39,238 --> 01:44:44,459
well right because right now we're using

1727
01:44:40,889 --> 01:44:47,369
the light floor in the shader but not in

1728
01:44:44,460 --> 01:44:50,010
the actual lighting code right so here's

1729
01:44:47,369 --> 01:44:52,319
the lighting when you don't floor and

1730
01:44:50,010 --> 01:44:57,119
you can see there's a lot more light

1731
01:44:52,319 --> 01:44:58,889
right so you know it's just better right

1732
01:44:57,119 --> 01:45:00,630
and again that's just when I say we got

1733
01:44:58,889 --> 01:45:02,989
power curve issues we have to work out

1734
01:45:00,630 --> 01:45:06,139
that's what I mean

1735
01:45:02,988 --> 01:45:11,448
so we're really pretty close I think

1736
01:45:06,139 --> 01:45:15,078
we're we're getting we're getting we're

1737
01:45:11,448 --> 01:45:16,969
getting pretty darn close here because

1738
01:45:15,078 --> 01:45:19,578
we're also quite quite speedy at this

1739
01:45:16,969 --> 01:45:21,439
point we have a lot of debug drawing

1740
01:45:19,578 --> 01:45:25,038
happening in here but the actual amount

1741
01:45:21,439 --> 01:45:27,678
of light computation work is pretty

1742
01:45:25,038 --> 01:45:29,868
manageable at this point so I think if

1743
01:45:27,679 --> 01:45:33,078
we went ahead and and stopped doing all

1744
01:45:29,868 --> 01:45:34,368
of our debug drawing and and went from

1745
01:45:33,078 --> 01:45:36,698
there I think I think we're in pretty

1746
01:45:34,368 --> 01:45:39,229
good shape here it's looking really nice

1747
01:45:36,698 --> 01:45:43,488
and if I go ahead and turn off those

1748
01:45:39,229 --> 01:45:46,009
occluders again so me let me just turn

1749
01:45:43,488 --> 01:45:50,178
off the volume outlines and maybe we'll

1750
01:45:46,010 --> 01:45:54,829
turn off the debug draw octahedral

1751
01:45:50,179 --> 01:45:57,769
values as well so we can just kind of

1752
01:45:54,828 --> 01:46:06,078
look at the lighting as a sort of a

1753
01:45:57,769 --> 01:46:08,119
rough a rough state should probably get

1754
01:46:06,078 --> 01:46:12,710
rid of the drawing of light and bounds

1755
01:46:08,118 --> 01:46:16,248
as well it's it's really pretty darn

1756
01:46:12,710 --> 01:46:17,840
close so I don't think we've got I don't

1757
01:46:16,248 --> 01:46:20,420
think we've got far to go before we're

1758
01:46:17,840 --> 01:46:22,849
before we're basically like and I mean

1759
01:46:20,420 --> 01:46:24,828
it's really kind of cool too because you

1760
01:46:22,849 --> 01:46:26,748
can see as I hop in front of the doorway

1761
01:46:24,828 --> 01:46:29,630
so I move this light there you can

1762
01:46:26,748 --> 01:46:33,408
actually see the light starts to go out

1763
01:46:29,630 --> 01:46:35,359
into the outer area and when I'm behind

1764
01:46:33,408 --> 01:46:38,988
it it doesn't right so you get really

1765
01:46:35,359 --> 01:46:42,649
pretty cool lighting effects happening

1766
01:46:38,988 --> 01:46:47,029
now and so as we sort of dial in on the

1767
01:46:42,649 --> 01:46:50,229
final version we're really getting some

1768
01:46:47,029 --> 01:46:52,670
pretty good good results I don't know

1769
01:46:50,229 --> 01:46:55,058
these guys don't have their lights still

1770
01:46:52,670 --> 01:46:55,059
attached

1771
01:47:00,340 --> 01:47:04,640
we should probably centralize some of

1772
01:47:02,810 --> 01:47:06,740
this debug code into like a lighting

1773
01:47:04,640 --> 01:47:08,329
panel that we can turn on various debug

1774
01:47:06,739 --> 01:47:13,039
things without me have to go through the

1775
01:47:08,329 --> 01:47:28,760
code and constantly do all this crap but

1776
01:47:13,039 --> 01:47:30,619
you know so I thought there should be

1777
01:47:28,760 --> 01:47:33,980
lights on those guys and there are they

1778
01:47:30,619 --> 01:47:36,949
were just really dark so you know let's

1779
01:47:33,979 --> 01:47:41,299
add actual lights on those guys just for

1780
01:47:36,949 --> 01:47:43,880
fun and and I think now we can get sort

1781
01:47:41,300 --> 01:47:49,730
of a sense of after we do the the final

1782
01:47:43,880 --> 01:47:53,170
set of finishing work this is also

1783
01:47:49,729 --> 01:47:53,169
without any ambient at the moment

1784
01:48:03,868 --> 01:48:10,648
yeah so so I think we're gonna be really

1785
01:48:07,569 --> 01:48:16,090
pretty pretty darn good lighting I mean

1786
01:48:10,649 --> 01:48:17,739
we're only a few sessions away from

1787
01:48:16,090 --> 01:48:20,679
smoothing out some of these other rough

1788
01:48:17,738 --> 01:48:21,759
edges here adapting the power curve

1789
01:48:20,679 --> 01:48:23,800
getting the spreading a little better

1790
01:48:21,760 --> 01:48:26,079
and reducing the noise and then this is

1791
01:48:23,800 --> 01:48:29,939
going to be some really pretty freakin

1792
01:48:26,078 --> 01:48:29,938
baller lighting I mean zero

1793
01:48:32,488 --> 01:48:39,009
pre-computation I think it'll run at

1794
01:48:36,488 --> 01:48:41,978
60fps certainly on newer machines in

1795
01:48:39,010 --> 01:48:49,090
this one it definitely will doesn't even

1796
01:48:41,979 --> 01:48:52,510
use a GPU and we could move it to the

1797
01:48:49,090 --> 01:48:54,668
GPU at some point too I just don't know

1798
01:48:52,510 --> 01:48:56,679
how sensible that is because in terms of

1799
01:48:54,668 --> 01:48:59,078
which platforms we can run on and which

1800
01:48:56,679 --> 01:49:01,239
ones we can't I'm not sure we want to

1801
01:48:59,078 --> 01:49:03,299
stress the GPU even more because you

1802
01:49:01,238 --> 01:49:06,609
know we already want that for drawing

1803
01:49:03,300 --> 01:49:11,998
you know high res and such so I'm not

1804
01:49:06,609 --> 01:49:11,998
sure it makes sense to do that but yeah

1805
01:49:23,109 --> 01:49:26,819
all right any questions

1806
01:49:44,909 --> 01:49:48,720
in the diffuse map weighting divided

1807
01:49:46,920 --> 01:49:55,350
could you get a divide by zero no you

1808
01:49:48,720 --> 01:49:57,869
can't because there is no because you're

1809
01:49:55,350 --> 01:50:00,630
always summing over all the possible

1810
01:49:57,869 --> 01:50:01,199
light directions for the input and the

1811
01:50:00,630 --> 01:50:03,869
output

1812
01:50:01,199 --> 01:50:09,569
we know that the weights will always be

1813
01:50:03,869 --> 01:50:11,309
at least somewhere non zero so there's

1814
01:50:09,569 --> 01:50:13,469
no way you can have all of the

1815
01:50:11,310 --> 01:50:15,360
transmission so between every Texel

1816
01:50:13,470 --> 01:50:18,240
every speck Texel and every diffuse

1817
01:50:15,359 --> 01:50:21,719
Texel sorry for a particular speck Texel

1818
01:50:18,239 --> 01:50:24,149
we know that there cannot be literally

1819
01:50:21,720 --> 01:50:28,320
zero transfer from that speck Texel to

1820
01:50:24,149 --> 01:50:38,279
all the diffuse texels a speck Texel

1821
01:50:28,319 --> 01:50:40,500
will you know always do a speck Texel

1822
01:50:38,279 --> 01:50:42,889
will always have to affect some diffuse

1823
01:50:40,500 --> 01:50:42,890
texels

1824
01:51:04,819 --> 01:51:08,029
with this isn't a curry we do more

1825
01:51:06,470 --> 01:51:11,270
physically based rendering looking to

1826
01:51:08,029 --> 01:51:12,500
the light um so I'm not sure exactly

1827
01:51:11,270 --> 01:51:14,770
what you mean by that as far as

1828
01:51:12,500 --> 01:51:19,010
physically based rendering is concerned

1829
01:51:14,770 --> 01:51:20,690
there really isn't a plausible way to do

1830
01:51:19,010 --> 01:51:24,670
something like that with what we're

1831
01:51:20,689 --> 01:51:28,989
doing because we don't even have 3d

1832
01:51:24,670 --> 01:51:31,039
geometry for most of our stuff right and

1833
01:51:28,989 --> 01:51:32,809
we certainly don't have any material

1834
01:51:31,039 --> 01:51:36,949
parameters for it because it's just a

1835
01:51:32,810 --> 01:51:39,110
bitmap that an artist painted so there

1836
01:51:36,949 --> 01:51:42,500
isn't really a path towards physically

1837
01:51:39,109 --> 01:51:44,630
based rendering from here it there just

1838
01:51:42,500 --> 01:51:48,220
isn't right we just don't have we

1839
01:51:44,630 --> 01:51:51,739
fundamentally don't have the source data

1840
01:51:48,220 --> 01:51:53,539
to explore anything like that so we can

1841
01:51:51,739 --> 01:51:56,719
only really look at artistically based

1842
01:51:53,539 --> 01:51:58,670
lighting things like conserving the

1843
01:51:56,720 --> 01:52:02,240
power like I did in that diffuse map

1844
01:51:58,670 --> 01:52:06,590
spread that's an example of of using a

1845
01:52:02,239 --> 01:52:08,510
PBR style of of coding and I do think

1846
01:52:06,590 --> 01:52:11,029
you want that so you want to do some you

1847
01:52:08,510 --> 01:52:14,090
know sort of physical things like

1848
01:52:11,029 --> 01:52:15,769
conservation of energy and that's simply

1849
01:52:14,090 --> 01:52:18,170
for making the system well-behaved

1850
01:52:15,770 --> 01:52:20,060
but beyond that I don't really think

1851
01:52:18,170 --> 01:52:22,880
there's very much we can do

1852
01:52:20,060 --> 01:52:24,230
I just don't think there's much you can

1853
01:52:22,880 --> 01:52:31,239
do when you're just talking about flat

1854
01:52:24,229 --> 01:52:35,919
sprites you know that really have had no

1855
01:52:31,239 --> 01:52:38,000
they're just not constructed for this

1856
01:52:35,920 --> 01:52:41,029
does the fuse bounce use the albedo of

1857
01:52:38,000 --> 01:52:42,680
the materials yeah it already does

1858
01:52:41,029 --> 01:52:44,029
we don't actually look up into the

1859
01:52:42,680 --> 01:52:46,960
materials because that would be very

1860
01:52:44,029 --> 01:52:49,340
expensive so what we do is you just

1861
01:52:46,960 --> 01:52:52,189
state what you want the occluders bounce

1862
01:52:49,340 --> 01:52:53,600
to be so on things that are made of you

1863
01:52:52,189 --> 01:52:55,009
know reddish material you can set them

1864
01:52:53,600 --> 01:52:56,600
red or if you you know so it's it's

1865
01:52:55,010 --> 01:53:01,400
artistically controllable but we don't

1866
01:52:56,600 --> 01:53:03,770
actually sample the texture but yeah so

1867
01:53:01,399 --> 01:53:08,679
to give an example of that if you wanted

1868
01:53:03,770 --> 01:53:08,680
to write when we add the those occluders

1869
01:53:09,250 --> 01:53:13,180
let me just go ahead and do it

1870
01:53:14,890 --> 01:53:25,100
so in the code where we are is it at

1871
01:53:22,819 --> 01:53:31,039
peace occluder actually I guess I don't

1872
01:53:25,100 --> 01:53:34,640
really remember at peace occluder so

1873
01:53:31,039 --> 01:53:36,649
what we can do is in these sort of

1874
01:53:34,640 --> 01:53:39,770
different places here like let's suppose

1875
01:53:36,649 --> 01:53:41,779
you wanted and this is not correct but

1876
01:53:39,770 --> 01:53:48,170
let's suppose you wanted for some reason

1877
01:53:41,779 --> 01:53:55,279
trees to bounce green light right and

1878
01:53:48,170 --> 01:53:57,319
everything else to bounce blue light and

1879
01:53:55,279 --> 01:53:58,729
like I don't know why you would want

1880
01:53:57,319 --> 01:54:02,090
this but let's suppose that's what you

1881
01:53:58,729 --> 01:54:03,649
were doing what we can do is just change

1882
01:54:02,090 --> 01:54:06,770
which occluders we're adding there and

1883
01:54:03,649 --> 01:54:08,989
then what you can see hopefully is that

1884
01:54:06,770 --> 01:54:11,630
all of the secondary bounce lighting now

1885
01:54:08,989 --> 01:54:14,359
has a blue tinge to it and you can kind

1886
01:54:11,630 --> 01:54:18,170
of see it you know pretty pretty clearly

1887
01:54:14,359 --> 01:54:20,839
like in here and in here right and then

1888
01:54:18,170 --> 01:54:23,659
all of the trees would not like they'll

1889
01:54:20,840 --> 01:54:26,960
have an extra green bounce to them right

1890
01:54:23,659 --> 01:54:28,849
so you know I mean because our bounce

1891
01:54:26,960 --> 01:54:33,079
lighting is really muted right now it's

1892
01:54:28,850 --> 01:54:34,130
harder to see but that's you know that's

1893
01:54:33,079 --> 01:54:35,630
what that is

1894
01:54:34,130 --> 01:54:37,279
maybe I should make it red since

1895
01:54:35,630 --> 01:54:38,720
everything is green out there I'm not

1896
01:54:37,279 --> 01:54:41,539
sure you could really see the fact that

1897
01:54:38,720 --> 01:54:50,510
it was green but you get the idea I'll

1898
01:54:41,539 --> 01:54:53,779
make it yellow so we do use it but

1899
01:54:50,510 --> 01:54:57,650
because the diffuses are a lot more

1900
01:54:53,779 --> 01:54:59,420
muted than we would like you just don't

1901
01:54:57,649 --> 01:55:01,279
see it as much right and that's that's

1902
01:54:59,420 --> 01:55:04,159
why we need to start getting the light

1903
01:55:01,279 --> 01:55:07,899
power curve under control so you'd

1904
01:55:04,159 --> 01:55:10,519
actually get some of those effects and I

1905
01:55:07,899 --> 01:55:12,409
still can't really see much bounce

1906
01:55:10,520 --> 01:55:15,620
lighting which is sort of a problem out

1907
01:55:12,409 --> 01:55:17,930
here which is you know which is a bit of

1908
01:55:15,619 --> 01:55:19,699
an issue but obviously these will all

1909
01:55:17,930 --> 01:55:20,260
still be blue and you can see that they

1910
01:55:19,699 --> 01:55:23,239
are

1911
01:55:20,260 --> 01:55:26,480
but the bounce waiting it for these guys

1912
01:55:23,239 --> 01:55:31,219
I just don't see right it I like just

1913
01:55:26,479 --> 01:55:36,079
don't see it at all so I'm not sure

1914
01:55:31,220 --> 01:55:37,190
what's up with that we may just have to

1915
01:55:36,079 --> 01:55:46,699
look at it a little more carefully let

1916
01:55:37,189 --> 01:55:48,949
me try with read one of the problems

1917
01:55:46,699 --> 01:55:51,399
everything in that area is green so it's

1918
01:55:48,949 --> 01:55:53,989
kind of hard it's like already kind of

1919
01:55:51,399 --> 01:55:55,369
not something that bounces yet so you

1920
01:55:53,989 --> 01:55:59,840
can so you can sort of see it now right

1921
01:55:55,369 --> 01:56:02,149
you can see the red tinge so we are

1922
01:55:59,840 --> 01:56:03,500
using it it's just that because direct

1923
01:56:02,149 --> 01:56:05,989
lighting is so much brighter than our

1924
01:56:03,500 --> 01:56:09,170
indirect lighting right now which is

1925
01:56:05,989 --> 01:56:10,309
again I think because we're not we need

1926
01:56:09,170 --> 01:56:19,880
to start working on like the

1927
01:56:10,310 --> 01:56:21,170
transmission exposure levels I think

1928
01:56:19,880 --> 01:56:24,319
that one the problems we're gonna have

1929
01:56:21,170 --> 01:56:31,699
is just that until we do that you don't

1930
01:56:24,319 --> 01:56:34,389
see you really just don't see the bounce

1931
01:56:31,699 --> 01:56:34,389
something as much as you should

1932
01:56:39,140 --> 01:56:43,910
can you compare with the older raycast I

1933
01:56:44,600 --> 01:56:49,740
suppose we might be able to obviously

1934
01:56:48,239 --> 01:56:51,989
there are some issues with the older

1935
01:56:49,739 --> 01:57:03,300
raycast in terms of how it convex light

1936
01:56:51,989 --> 01:57:05,340
but we certainly can let me try the

1937
01:57:03,300 --> 01:57:06,840
older ray cast has ambient lighting and

1938
01:57:05,340 --> 01:57:09,390
we haven't put that into the new ray

1939
01:57:06,840 --> 01:57:11,989
cast yet so it would have a slightly

1940
01:57:09,390 --> 01:57:11,990
different effect

1941
01:57:25,279 --> 01:57:28,529
although you know what no it doesn't

1942
01:57:27,300 --> 01:57:31,789
because we turned it off so I guess

1943
01:57:28,529 --> 01:57:31,789
that's fine so no it doesn't

1944
01:57:41,560 --> 01:57:49,180
so yeah so in terms of actual light cost

1945
01:57:45,819 --> 01:57:51,340
we also can't really we haven't pulled

1946
01:57:49,180 --> 01:57:52,989
the debug code out of our grid rate

1947
01:57:51,340 --> 01:57:54,520
caster so we actually can't tell how

1948
01:57:52,988 --> 01:57:57,309
fast the grid rate caster is at the

1949
01:57:54,520 --> 01:57:58,660
moment either which is another thing so

1950
01:57:57,310 --> 01:58:00,969
it's hard to necessarily compare these

1951
01:57:58,659 --> 01:58:04,750
two and we also haven't tuned the grid

1952
01:58:00,969 --> 01:58:08,649
rate caster so it's a little premature

1953
01:58:04,750 --> 01:58:09,880
to do the comparison but there's

1954
01:58:08,649 --> 01:58:16,000
certainly nothing wrong with this rate

1955
01:58:09,880 --> 01:58:17,350
caster like it's fine I just don't think

1956
01:58:16,000 --> 01:58:19,060
at the end of the day we'll be able to

1957
01:58:17,350 --> 01:58:21,130
quite get it up as fast as I need it to

1958
01:58:19,060 --> 01:58:23,610
be whereas I think the other one I will

1959
01:58:21,130 --> 01:58:23,609
be able to

1960
01:58:34,920 --> 01:58:39,119
after the shader modification it appears

1961
01:58:37,210 --> 01:58:44,529
the light is still leaking why is that

1962
01:58:39,119 --> 01:58:47,680
so actually even before we were messing

1963
01:58:44,529 --> 01:58:51,729
with the shader at all we still have

1964
01:58:47,680 --> 01:58:53,230
some light leakage that I I demonstrated

1965
01:58:51,729 --> 01:58:55,718
early in this stream and if you remember

1966
01:58:53,229 --> 01:58:56,799
so we know it's there and we have to

1967
01:58:55,719 --> 01:59:00,239
look and see whether it's a natural

1968
01:58:56,800 --> 01:59:04,480
artifact of of what's going on or not

1969
01:59:00,238 --> 01:59:08,849
some light leakage well I guess this has

1970
01:59:04,479 --> 01:59:08,849
a ton of light leakage this is the wrong

1971
01:59:08,969 --> 01:59:19,390
caster hello again I'm not sure why

1972
01:59:14,319 --> 01:59:20,649
there's that much in there but yeah I'm

1973
01:59:19,390 --> 01:59:23,410
not sure about I'm not sure what was

1974
01:59:20,649 --> 01:59:24,759
going on there but if you take a look at

1975
01:59:23,409 --> 01:59:28,090
what's happening here there's actually

1976
01:59:24,760 --> 01:59:29,560
or at least there was and I'm pretty

1977
01:59:28,090 --> 01:59:31,170
sure Cecilia's let me just try and make

1978
01:59:29,560 --> 01:59:42,699
it happen again

1979
01:59:31,170 --> 01:59:45,190
some more obvious light leakage so I

1980
01:59:42,698 --> 01:59:49,750
can't make it happen just at the

1981
01:59:45,189 --> 01:59:52,089
immediate moment there was some obvious

1982
01:59:49,750 --> 01:59:53,829
light leakage happening earlier that I

1983
01:59:52,090 --> 01:59:58,420
wanted to take a closer look at it's

1984
01:59:53,829 --> 02:00:07,260
it's not happening now like that looks

1985
01:59:58,420 --> 02:00:15,489
it's quite solid actually so so I'm not

1986
02:00:07,260 --> 02:00:16,630
totally sure I think there's some still

1987
02:00:15,488 --> 02:00:18,218
light leakage thing we want looked at

1988
02:00:16,630 --> 02:00:19,719
for whatever reason I'm not able to

1989
02:00:18,219 --> 02:00:21,010
actually make it happen again so I don't

1990
02:00:19,719 --> 02:00:23,590
know maybe we accidentally fixed it

1991
02:00:21,010 --> 02:00:26,289
completely but I don't think we did so I

1992
02:00:23,590 --> 02:00:30,460
was going to look at at some more light

1993
02:00:26,289 --> 02:00:34,810
leakage issues later at the moment I

1994
02:00:30,460 --> 02:00:36,279
can't seem to get it to do any light

1995
02:00:34,810 --> 02:00:38,500
leakage at all which is great

1996
02:00:36,279 --> 02:00:46,719
I mean hey it's nice that I can't make

1997
02:00:38,500 --> 02:00:47,710
it do that but but I'm not sure why so

1998
02:00:46,719 --> 02:00:59,050
yeah

1999
02:00:47,710 --> 02:01:00,069
you know there's that yeah and I don't

2000
02:00:59,050 --> 02:01:01,659
know why I'm not seeing the light

2001
02:01:00,069 --> 02:01:04,840
leakage anymore I guess we fixed it hard

2002
02:01:01,659 --> 02:01:06,340
more than I thought we did because I

2003
02:01:04,840 --> 02:01:09,850
thought there was still some flickery

2004
02:01:06,340 --> 02:01:12,640
problems with certain folks about kind

2005
02:01:09,850 --> 02:01:14,410
of in the distance there so I don't know

2006
02:01:12,640 --> 02:01:16,450
at the very least when we did light

2007
02:01:14,409 --> 02:01:18,699
flooding so I mean at the very least

2008
02:01:16,449 --> 02:01:20,139
when we do light flooding we can see

2009
02:01:18,699 --> 02:01:23,819
that it eventually does bounce around I

2010
02:01:20,140 --> 02:01:27,520
thought unless I'm just misremembering

2011
02:01:23,819 --> 02:01:31,420
so if I go in and do a push light here

2012
02:01:27,520 --> 02:01:33,640
and I just like really over flood the

2013
02:01:31,420 --> 02:01:36,850
lighting I I think this leaks out right

2014
02:01:33,640 --> 02:01:45,400
and that was that was a fairly

2015
02:01:36,850 --> 02:01:47,590
conclusive see so eventually it does get

2016
02:01:45,399 --> 02:01:50,500
outside right

2017
02:01:47,590 --> 02:01:54,930
if you push enough power through it so

2018
02:01:50,500 --> 02:01:57,399
it's not perfectly sealed which again

2019
02:01:54,930 --> 02:01:59,170
there is no ceiling on this thing so

2020
02:01:57,399 --> 02:02:02,319
technically that could actually be

2021
02:01:59,170 --> 02:02:04,420
correct it could be the light that

2022
02:02:02,319 --> 02:02:05,949
strong in our system should propagate

2023
02:02:04,420 --> 02:02:08,529
outside because there is no sealed

2024
02:02:05,949 --> 02:02:10,119
ceiling if we actually put a sealed

2025
02:02:08,529 --> 02:02:11,800
ceiling on then obviously that shouldn't

2026
02:02:10,119 --> 02:02:13,149
happen so I don't really know and and

2027
02:02:11,800 --> 02:02:14,500
you know maybe one thing that we should

2028
02:02:13,149 --> 02:02:17,399
do is actually create that scene that

2029
02:02:14,500 --> 02:02:19,930
although our room Jen needs to be like

2030
02:02:17,399 --> 02:02:21,849
actually written hardcore so we can make

2031
02:02:19,930 --> 02:02:25,719
things easily with it and we're pretty

2032
02:02:21,850 --> 02:02:27,880
freaking far from that right now it

2033
02:02:25,719 --> 02:02:32,140
probably isn't the worst idea for me to

2034
02:02:27,880 --> 02:02:35,590
try and put occluders in on non wall

2035
02:02:32,140 --> 02:02:38,800
sections that are just the ceiling I

2036
02:02:35,590 --> 02:02:40,960
probably should do that so if we were

2037
02:02:38,800 --> 02:02:45,430
going to do that I guess what I would

2038
02:02:40,960 --> 02:02:49,840
need to do is say if there was into room

2039
02:02:45,430 --> 02:02:52,050
well I don't know exactly how we would

2040
02:02:49,840 --> 02:02:57,819
do this but it's probably something like

2041
02:02:52,050 --> 02:03:02,159
taking the max Z of the wall so like if

2042
02:02:57,819 --> 02:03:08,819
we're not on a wall

2043
02:03:02,158 --> 02:03:11,420
but we are inside I don't know what that

2044
02:03:08,819 --> 02:03:11,420
means

2045
02:03:12,139 --> 02:03:21,059
like how do we know if we're inside or

2046
02:03:18,210 --> 02:03:25,349
not so it's spec outdoors so I guess we

2047
02:03:21,059 --> 02:03:29,400
would say like if we're not on a wall

2048
02:03:25,349 --> 02:03:32,699
and we're not outdoors then we need to

2049
02:03:29,399 --> 02:03:33,689
add a ceiling tile right so we would say

2050
02:03:32,698 --> 02:03:48,598
like okay

2051
02:03:33,689 --> 02:03:51,109
like give me give me a ceiling and we

2052
02:03:48,599 --> 02:04:01,710
just need to know how do we create that

2053
02:03:51,109 --> 02:04:05,098
ceiling and so to to do this we would

2054
02:04:01,710 --> 02:04:10,679
need to presumably just take the whole

2055
02:04:05,099 --> 02:04:16,980
tile and then I guess we just say like

2056
02:04:10,679 --> 02:04:19,199
look the minzy equals the max Z and then

2057
02:04:16,979 --> 02:04:25,069
we just create a thickness you know

2058
02:04:19,198 --> 02:04:25,069
so minus some some very thin thing

2059
02:04:29,219 --> 02:04:34,649
so in terms of like trying to seal right

2060
02:04:32,639 --> 02:04:37,949
do you see what I did there so there

2061
02:04:34,649 --> 02:04:42,629
there's like this you know a set of

2062
02:04:37,948 --> 02:04:50,428
ceiling tiles now so that the light is

2063
02:04:42,630 --> 02:04:54,989
is inside only and you know at that

2064
02:04:50,429 --> 02:04:56,760
point I should be able to over dial that

2065
02:04:54,988 --> 02:04:58,348
light and it shouldn't be able to get

2066
02:04:56,760 --> 02:05:00,949
outside now I don't know if that will

2067
02:04:58,349 --> 02:05:00,949
actually happen

2068
02:05:01,639 --> 02:05:05,909
because I think we do have some light

2069
02:05:03,719 --> 02:05:08,698
leaking bugs still but that's now at

2070
02:05:05,908 --> 02:05:11,638
least we know that it's sealed inside

2071
02:05:08,698 --> 02:05:15,149
there right so now when you really like

2072
02:05:11,639 --> 02:05:16,498
push that light level you can see what

2073
02:05:15,149 --> 02:05:19,138
ends up happening and you can see that

2074
02:05:16,498 --> 02:05:24,179
it still does get out right so there is

2075
02:05:19,139 --> 02:05:27,630
some way that light eventually can get

2076
02:05:24,179 --> 02:05:29,760
out and again with an inexact algorithm

2077
02:05:27,630 --> 02:05:32,429
like this where we're trying to save a

2078
02:05:29,760 --> 02:05:35,940
lot of computation time by not doing a

2079
02:05:32,429 --> 02:05:38,460
whole slew of things that may be

2080
02:05:35,939 --> 02:05:40,228
unavoidable so I'm not really concerned

2081
02:05:38,460 --> 02:05:42,618
about that but I do want to do it as

2082
02:05:40,229 --> 02:05:45,809
testing if that makes sense

2083
02:05:42,618 --> 02:05:48,149
so that in the future we know

2084
02:05:45,809 --> 02:05:50,099
definitively whether there's additional

2085
02:05:48,149 --> 02:05:51,658
bug who's causing light leaking or

2086
02:05:50,099 --> 02:05:53,729
whether it's just an artifact of the

2087
02:05:51,658 --> 02:05:57,569
approximations of the algorithm that

2088
02:05:53,729 --> 02:05:59,639
makes the light leak either way I'm

2089
02:05:57,569 --> 02:06:01,408
happy that now we really don't have much

2090
02:05:59,639 --> 02:06:02,940
light leaking in the game proper right

2091
02:06:01,408 --> 02:06:04,078
like if you just look at the normal way

2092
02:06:02,939 --> 02:06:06,058
this would be played there's no light

2093
02:06:04,078 --> 02:06:09,649
leaking so it's mostly just quality

2094
02:06:06,059 --> 02:06:16,400
concerns that I want to increase the

2095
02:06:09,649 --> 02:06:18,359
just want to denoise and blur is

2096
02:06:16,399 --> 02:06:24,179
basically all we really need to do at

2097
02:06:18,359 --> 02:06:28,018
this point I think right but but it's

2098
02:06:24,179 --> 02:06:30,739
looking really nice so let me see what

2099
02:06:28,019 --> 02:06:30,739
other questions

2100
02:06:35,560 --> 02:06:39,740
is it possible to smooth out the

2101
02:06:37,550 --> 02:06:41,630
lighting oh yeah I mean I will smooth it

2102
02:06:39,739 --> 02:06:43,969
out I'm I probably will be able to get

2103
02:06:41,630 --> 02:06:45,770
it to where it's perfectly smooth would

2104
02:06:43,970 --> 02:06:49,159
be my guess I kind of have some ideas on

2105
02:06:45,770 --> 02:06:50,800
how I want to do that but but I'm just

2106
02:06:49,159 --> 02:06:54,050
not interested in that right now because

2107
02:06:50,800 --> 02:06:56,390
we still have like accuracy issues I can

2108
02:06:54,050 --> 02:06:57,800
look at a noisy solution and go is that

2109
02:06:56,390 --> 02:07:00,560
actually producing the crack solution I

2110
02:06:57,800 --> 02:07:03,409
can already sort of tell that we need a

2111
02:07:00,560 --> 02:07:05,240
power curve in there and we need to like

2112
02:07:03,409 --> 02:07:07,460
work on that transmission of stuff a

2113
02:07:05,239 --> 02:07:10,039
little bit better so we've we've got

2114
02:07:07,460 --> 02:07:15,050
things we need to do first before we

2115
02:07:10,039 --> 02:07:16,189
work on denoise from what I've perceived

2116
02:07:15,050 --> 02:07:17,480
watching handmade heroes lighting has

2117
02:07:16,189 --> 02:07:19,569
taken up a pretty sizable chunk of the

2118
02:07:17,479 --> 02:07:22,279
episodes is lighting inherently complex

2119
02:07:19,569 --> 02:07:23,659
yes lighting is by far the most

2120
02:07:22,279 --> 02:07:25,909
difficult thing you can do in graphics

2121
02:07:23,659 --> 02:07:29,500
period there's nothing even close to as

2122
02:07:25,909 --> 02:07:29,500
hard as lighting that I know of

2123
02:07:30,520 --> 02:07:38,690
literally anything you want to do in

2124
02:07:32,630 --> 02:07:40,520
graphics is easier than lighting photons

2125
02:07:38,689 --> 02:07:42,409
are the fastest moving things in the

2126
02:07:40,520 --> 02:07:43,840
known universe and they are the most

2127
02:07:42,409 --> 02:07:46,340
plentiful things in the known universe

2128
02:07:43,840 --> 02:07:48,050
so you are inherently simulating the

2129
02:07:46,340 --> 02:07:58,010
very hardest thing you possibly can

2130
02:07:48,050 --> 02:08:00,949
there's nothing as bad as lighting for

2131
02:07:58,010 --> 02:08:02,750
fixing the square interpolation that's

2132
02:08:00,949 --> 02:08:05,630
just because our samples are on a grid

2133
02:08:02,750 --> 02:08:08,029
so what we want to do there is just in

2134
02:08:05,630 --> 02:08:12,350
the shader where we sample it we just

2135
02:08:08,029 --> 02:08:14,029
want to blur those out right so really

2136
02:08:12,350 --> 02:08:17,960
it's just a sampling issue so it's the

2137
02:08:14,029 --> 02:08:21,099
question of what's the fastest that we

2138
02:08:17,960 --> 02:08:21,100
can do right

2139
02:08:24,050 --> 02:08:28,230
we'll be topics which we spend as much

2140
02:08:26,460 --> 02:08:30,239
time as light no there's there's nothing

2141
02:08:28,229 --> 02:08:32,369
as hard as lighting there I don't think

2142
02:08:30,238 --> 02:08:35,509
there's anything you can pick that would

2143
02:08:32,369 --> 02:08:35,510
take as much time as lighting

2144
02:08:47,170 --> 02:08:52,100
even fluid simulations such as plasma

2145
02:08:49,399 --> 02:08:54,079
yes so fluid simulation is significantly

2146
02:08:52,100 --> 02:08:56,900
easier than lighting much much easier

2147
02:08:54,079 --> 02:09:01,550
than lighting and the reason for that is

2148
02:08:56,899 --> 02:09:07,909
fluid simulation has so inherently all

2149
02:09:01,550 --> 02:09:09,880
physical phenomena have a propagation

2150
02:09:07,909 --> 02:09:13,220
rate is the way to think about it

2151
02:09:09,880 --> 02:09:15,710
so all physical phenomena that we saw

2152
02:09:13,220 --> 02:09:17,420
that we simulate in games are inherently

2153
02:09:15,710 --> 02:09:19,039
three-dimensional or you could think of

2154
02:09:17,420 --> 02:09:21,619
them as four-dimensional depending on

2155
02:09:19,039 --> 02:09:22,789
how you want to look at it right but

2156
02:09:21,619 --> 02:09:24,289
everything we simulate in games is

2157
02:09:22,789 --> 02:09:25,909
three-dimensional we sometimes make

2158
02:09:24,289 --> 02:09:30,739
two-dimensional versions of things or

2159
02:09:25,909 --> 02:09:32,359
whatever right but inherently everything

2160
02:09:30,739 --> 02:09:33,679
is a three-dimensional phenomena from

2161
02:09:32,359 --> 02:09:38,119
the real world that we're trying to do

2162
02:09:33,680 --> 02:09:41,470
in sight a game right and each one of

2163
02:09:38,119 --> 02:09:43,760
those physical phenomena have

2164
02:09:41,470 --> 02:09:46,430
propagation rates which determine how

2165
02:09:43,760 --> 02:09:50,270
much of the system they can affect and

2166
02:09:46,430 --> 02:09:52,640
how quickly lighting has the fastest

2167
02:09:50,270 --> 02:09:54,320
propagation rate it propagates bright

2168
02:09:52,640 --> 02:09:56,720
photons which are the fastest moving

2169
02:09:54,319 --> 02:09:59,389
things in the known universe there is no

2170
02:09:56,720 --> 02:10:03,440
phenomenon harder than that fluid

2171
02:09:59,390 --> 02:10:08,030
simulation usually can only propagate at

2172
02:10:03,439 --> 02:10:12,859
the speed of sound or worse so sound is

2173
02:10:08,029 --> 02:10:15,529
much slower than light and because all

2174
02:10:12,859 --> 02:10:17,750
physical phenomenon tend to happen at

2175
02:10:15,529 --> 02:10:20,479
the speed of sound not the speed of

2176
02:10:17,750 --> 02:10:23,270
light it's always easier the the region

2177
02:10:20,479 --> 02:10:26,209
you're trying to affect on every frame

2178
02:10:23,270 --> 02:10:30,320
of update is inherently contracted

2179
02:10:26,210 --> 02:10:33,319
dramatically whereas lighting could

2180
02:10:30,319 --> 02:10:41,439
literally affect the entire world pretty

2181
02:10:33,319 --> 02:10:41,439
much in one frame so

2182
02:10:41,560 --> 02:10:45,850
like game worlds are basically the size

2183
02:10:44,020 --> 02:10:53,050
that a photon could span in like one

2184
02:10:45,850 --> 02:10:56,079
frame right so so yeah fluid dynamics

2185
02:10:53,050 --> 02:10:58,930
much much easier than lighting now

2186
02:10:56,079 --> 02:11:01,869
neither are easy and the reason for that

2187
02:10:58,930 --> 02:11:07,210
is that it has the same sorts of

2188
02:11:01,869 --> 02:11:09,519
problems meaning that we can't possibly

2189
02:11:07,210 --> 02:11:16,079
hope to simulate the behavior of all of

2190
02:11:09,520 --> 02:11:16,080
these molecules so you know

2191
02:11:27,439 --> 02:11:34,529
networking is trivial compared to

2192
02:11:29,550 --> 02:11:38,310
lighting I wouldn't consider networking

2193
02:11:34,529 --> 02:11:41,569
even remotely in the same class of

2194
02:11:38,310 --> 02:11:46,469
problem difficulty as lighting to me I

2195
02:11:41,569 --> 02:11:47,819
mean they're they're not even there

2196
02:11:46,469 --> 02:11:51,739
they're not even a little bit scary to

2197
02:11:47,819 --> 02:11:51,738
me right so

2198
02:12:21,069 --> 02:12:26,960
hmm it seems like when you walk you drag

2199
02:12:25,609 --> 02:12:28,279
the light behind you with inertia more

2200
02:12:26,960 --> 02:12:30,409
like a liquid is that in purpose or an

2201
02:12:28,279 --> 02:12:32,630
effective combination no that's that's

2202
02:12:30,409 --> 02:12:36,800
specifically because there's no way for

2203
02:12:32,630 --> 02:12:38,840
us to do it fast enough right if we move

2204
02:12:36,800 --> 02:12:42,110
to a GPU if you know if we were saying

2205
02:12:38,840 --> 02:12:44,060
this is an RT X 2080 game always or

2206
02:12:42,109 --> 02:12:45,859
something we could have it be instant

2207
02:12:44,060 --> 02:12:51,710
and that's because our geometry is very

2208
02:12:45,859 --> 02:12:54,049
simple you know a triple a 3d game has

2209
02:12:51,710 --> 02:12:56,510
just dramatically more geometric

2210
02:12:54,050 --> 02:12:59,270
complexity than we do so they always

2211
02:12:56,510 --> 02:13:02,030
still have to have a few frames a few

2212
02:12:59,270 --> 02:13:03,530
frames of latency with their indirect

2213
02:13:02,029 --> 02:13:07,429
lighting there's nothing they can really

2214
02:13:03,529 --> 02:13:09,769
do about that but because we have such a

2215
02:13:07,430 --> 02:13:12,860
simplistic set of geometry if we wanted

2216
02:13:09,770 --> 02:13:15,380
to require very high-end 3d hardware for

2217
02:13:12,859 --> 02:13:17,509
this game we could make the lighting

2218
02:13:15,380 --> 02:13:20,779
instant probably so you wouldn't see

2219
02:13:17,510 --> 02:13:22,220
that lag but it is 100% an artifact of

2220
02:13:20,779 --> 02:13:23,989
of what I just said which is that

2221
02:13:22,220 --> 02:13:26,300
lighting is like the hardest thing and

2222
02:13:23,989 --> 02:13:28,809
you can't really do it right it's not

2223
02:13:26,300 --> 02:13:28,810
possible

2224
02:13:53,300 --> 02:13:57,150
so yeah I don't really want to argue

2225
02:13:55,229 --> 02:13:59,989
with people on the chat you're welcome

2226
02:13:57,149 --> 02:14:08,129
to think whatever you want is complex

2227
02:13:59,989 --> 02:14:13,349
I've been a programmer for almost so 35

2228
02:14:08,130 --> 02:14:14,699
years I know what is complex and what

2229
02:14:13,350 --> 02:14:20,280
it's not and what is difficult than what

2230
02:14:14,699 --> 02:14:23,340
it's not networking is it's it's not

2231
02:14:20,279 --> 02:14:25,859
trivial but compared to lighting it's

2232
02:14:23,340 --> 02:14:27,180
cakewalk period I mean and you're

2233
02:14:25,859 --> 02:14:28,739
welcome to disagree with me but I don't

2234
02:14:27,180 --> 02:14:30,630
really care because what you think is

2235
02:14:28,739 --> 02:14:35,519
hard you may think lots of things are

2236
02:14:30,630 --> 02:14:39,569
hard that I don't find hard right so you

2237
02:14:35,520 --> 02:14:40,890
know not really super relevant to me if

2238
02:14:39,569 --> 02:14:44,099
you have a hard prime programming game

2239
02:14:40,890 --> 02:14:47,550
networking then you know fine but I

2240
02:14:44,100 --> 02:14:52,020
don't so it's it's it's not something

2241
02:14:47,550 --> 02:14:53,400
that scares me right lighting scares me

2242
02:14:52,020 --> 02:14:56,520
a lot and the reason for that is because

2243
02:14:53,399 --> 02:14:59,639
it's so complex and so difficult to

2244
02:14:56,520 --> 02:15:02,340
approximate well and no one's ever done

2245
02:14:59,640 --> 02:15:04,650
it tons of people have network games

2246
02:15:02,340 --> 02:15:06,180
that work well tons of people have

2247
02:15:04,649 --> 02:15:07,529
network games will work poorly but tons

2248
02:15:06,180 --> 02:15:09,270
of people have things that work poorly

2249
02:15:07,529 --> 02:15:11,579
all the time

2250
02:15:09,270 --> 02:15:13,260
so you know lighting is a problem that

2251
02:15:11,579 --> 02:15:16,500
literally no one's ever shipped a good

2252
02:15:13,260 --> 02:15:18,840
solution for in history in real time

2253
02:15:16,500 --> 02:15:20,970
whereas tons of games have good

2254
02:15:18,840 --> 02:15:22,350
networking right just because some games

2255
02:15:20,970 --> 02:15:24,539
have really terrible networking doesn't

2256
02:15:22,350 --> 02:15:28,470
mean anything right people write crappy

2257
02:15:24,539 --> 02:15:29,970
stuff all the time but but literally no

2258
02:15:28,470 --> 02:15:32,520
one's ever shipped real time indirect

2259
02:15:29,970 --> 02:15:35,100
lighting ever in anything that actually

2260
02:15:32,520 --> 02:15:38,190
worked right doesn't doesn't happen so

2261
02:15:35,100 --> 02:15:40,800
we're always a few frames behind right

2262
02:15:38,189 --> 02:15:47,189
we're always doing weird approximations

2263
02:15:40,800 --> 02:15:49,650
and it's always kind of wrong so and

2264
02:15:47,189 --> 02:15:52,219
that's just that's just the way it is

2265
02:15:49,649 --> 02:15:52,219
right

2266
02:16:14,069 --> 02:16:17,729
what is so special in RTX well there's

2267
02:16:15,929 --> 02:16:20,969
nothing special in RTX it's just that

2268
02:16:17,729 --> 02:16:23,399
when you have hardware that can do

2269
02:16:20,969 --> 02:16:26,310
dramatically more ray casts per second

2270
02:16:23,399 --> 02:16:28,170
then it becomes much easier to do fast

2271
02:16:26,310 --> 02:16:31,320
lighting updates right because all of

2272
02:16:28,170 --> 02:16:32,849
our slowness that we don't really know

2273
02:16:31,319 --> 02:16:35,459
how to work around there's some the

2274
02:16:32,849 --> 02:16:37,079
diffuse blur we can work around and make

2275
02:16:35,459 --> 02:16:39,839
much faster probably then we're done we

2276
02:16:37,079 --> 02:16:41,429
have at the moment but the other half of

2277
02:16:39,840 --> 02:16:42,510
things is the ray casting and we'd

2278
02:16:41,429 --> 02:16:43,978
really just don't have ways of making

2279
02:16:42,510 --> 02:16:45,120
that dramatically faster than what we're

2280
02:16:43,978 --> 02:16:47,789
currently doing at least not that I know

2281
02:16:45,120 --> 02:16:49,469
of and so we're kind of always gated on

2282
02:16:47,790 --> 02:16:52,410
that whereas if you have special purpose

2283
02:16:49,468 --> 02:16:55,018
hardware that can do it way way more ray

2284
02:16:52,409 --> 02:16:59,989
casts way way faster which an RT X would

2285
02:16:55,019 --> 02:16:59,989
do that's just a really big deal right

2286
02:17:03,319 --> 02:17:06,779
is the difficulty of global illumination

2287
02:17:05,370 --> 02:17:09,059
part of the reason why you're doing it

2288
02:17:06,780 --> 02:17:11,250
sure I mean it's just it's mostly just

2289
02:17:09,058 --> 02:17:12,929
because you know it's something that if

2290
02:17:11,250 --> 02:17:15,329
you want to do a professional quality

2291
02:17:12,929 --> 02:17:17,069
engine you need to reckon with at some

2292
02:17:15,329 --> 02:17:18,478
point right so I feel like it's

2293
02:17:17,069 --> 02:17:23,189
something we should at least cover and

2294
02:17:18,478 --> 02:17:24,779
do a reasonable job of because it gives

2295
02:17:23,189 --> 02:17:30,210
you some perspective and just how hard

2296
02:17:24,780 --> 02:17:35,429
this problem is right so and maybe

2297
02:17:30,209 --> 02:17:37,888
someday and video will save us right you

2298
02:17:35,429 --> 02:17:41,030
know once you throw enough simulation

2299
02:17:37,888 --> 02:17:47,369
hardware at the problem you know maybe

2300
02:17:41,030 --> 02:17:51,019
we can just go away you know but at the

2301
02:17:47,370 --> 02:17:51,019
moment we're just kind of screwed right

2302
02:18:02,968 --> 02:18:07,569
yeah the r-tx version of Minecraft might

2303
02:18:05,920 --> 02:18:09,940
have noticeable light lag in it but

2304
02:18:07,569 --> 02:18:12,279
remember again they've probably got way

2305
02:18:09,940 --> 02:18:14,620
more geometry to worry about than we do

2306
02:18:12,280 --> 02:18:16,090
because even though we sort of look a

2307
02:18:14,620 --> 02:18:17,950
little minecraft II because we've got

2308
02:18:16,090 --> 02:18:21,760
like blocky things we're only looking

2309
02:18:17,950 --> 02:18:24,070
top-down at like a room minecraft you're

2310
02:18:21,760 --> 02:18:25,750
like looking out you know at the world

2311
02:18:24,069 --> 02:18:29,680
and there's just so much more geometry

2312
02:18:25,750 --> 02:18:31,540
there that like you know it's the ray

2313
02:18:29,680 --> 02:18:33,630
casting cost is proportional to the

2314
02:18:31,540 --> 02:18:35,950
geometric density of the scene right and

2315
02:18:33,629 --> 02:18:37,869
we have the ability to limit that

2316
02:18:35,950 --> 02:18:39,579
geometric density a lot more than a game

2317
02:18:37,870 --> 02:18:43,840
like Minecraft has the first-person

2318
02:18:39,579 --> 02:18:46,170
perspective so I guess that's what I

2319
02:18:43,840 --> 02:18:46,170
would say

2320
02:19:05,718 --> 02:19:11,039
if someone were making a different game

2321
02:19:08,370 --> 02:19:13,349
with much sparser scenes containing more

2322
02:19:11,040 --> 02:19:15,920
complex geometry well wait which are

2323
02:19:13,349 --> 02:19:19,439
they are they sparser or more complex I

2324
02:19:15,920 --> 02:19:20,939
guess they're sparse but complex we do

2325
02:19:19,439 --> 02:19:22,739
have an alternative prescription could

2326
02:19:20,939 --> 02:19:24,630
the probes be arranged in a sparse grid

2327
02:19:22,739 --> 02:19:32,549
or in-camera frustum space rather than

2328
02:19:24,629 --> 02:19:35,848
world space so a sparse arrangement of

2329
02:19:32,549 --> 02:19:36,688
probes would be difficult and the reason

2330
02:19:35,849 --> 02:19:38,728
is difficult

2331
02:19:36,689 --> 02:19:40,800
not because computation on it would be

2332
02:19:38,728 --> 02:19:44,608
much more difficult but because the

2333
02:19:40,799 --> 02:19:46,858
shader in the GPU used to look up the

2334
02:19:44,609 --> 02:19:51,000
lighting samples would be more expensive

2335
02:19:46,859 --> 02:19:52,439
and I'm not sure how far you want to go

2336
02:19:51,000 --> 02:19:56,520
down that route before it becomes

2337
02:19:52,439 --> 02:19:58,680
prohibitively expensive right arranging

2338
02:19:56,520 --> 02:20:00,359
them in a grid that isn't world space so

2339
02:19:58,680 --> 02:20:02,550
like I said camera for us in space that

2340
02:20:00,359 --> 02:20:05,818
seems more doable because as long as you

2341
02:20:02,549 --> 02:20:08,369
have some affine mapping from pixels to

2342
02:20:05,818 --> 02:20:12,269
whatever this space is I think that

2343
02:20:08,370 --> 02:20:17,100
would you know that would certainly be

2344
02:20:12,270 --> 02:20:18,870
feasible I don't know to what extent

2345
02:20:17,100 --> 02:20:20,340
people have tried that one of the

2346
02:20:18,870 --> 02:20:23,700
problems that you're going to often have

2347
02:20:20,340 --> 02:20:26,609
is that there's two things you're trying

2348
02:20:23,700 --> 02:20:27,899
to do here one is you like you correctly

2349
02:20:26,609 --> 02:20:29,760
identified you're trying to make sure

2350
02:20:27,898 --> 02:20:31,409
that you spend the most amount of time

2351
02:20:29,760 --> 02:20:33,420
computing lighting on things that are

2352
02:20:31,409 --> 02:20:35,639
that you can see on the screen so you

2353
02:20:33,420 --> 02:20:36,898
want things that are close to the camera

2354
02:20:35,639 --> 02:20:38,639
to have more time spent on them

2355
02:20:36,898 --> 02:20:41,340
certainly the things for our way the

2356
02:20:38,639 --> 02:20:44,309
problem is that light needs to be

2357
02:20:41,340 --> 02:20:46,380
simulated and it may be that a lot of

2358
02:20:44,309 --> 02:20:48,600
simulation time may be necessary to move

2359
02:20:46,379 --> 02:20:51,420
the light from something distant into a

2360
02:20:48,600 --> 02:20:53,068
way that just makes something distant

2361
02:20:51,420 --> 02:20:55,950
look brighter than it you know so that

2362
02:20:53,068 --> 02:20:58,500
you can see it so even though that's a

2363
02:20:55,950 --> 02:21:00,780
very small thing on the screen figuring

2364
02:20:58,500 --> 02:21:02,398
out that it should be lit is might cost

2365
02:21:00,780 --> 02:21:03,630
a lot because you needed to do a bunch

2366
02:21:02,398 --> 02:21:04,829
of crazy balance letting out that that's

2367
02:21:03,629 --> 02:21:07,108
why lighting is so hard

2368
02:21:04,829 --> 02:21:08,780
it doesn't really yield to those kind of

2369
02:21:07,109 --> 02:21:10,979
approximations as well as you would hope

2370
02:21:08,780 --> 02:21:12,930
which is why we introduced all these

2371
02:21:10,978 --> 02:21:14,760
other artistic approximations because at

2372
02:21:12,930 --> 02:21:17,100
the end of the day accurate lighting is

2373
02:21:14,760 --> 02:21:18,809
just sort of impossible and probably

2374
02:21:17,100 --> 02:21:21,000
always will be

2375
02:21:18,809 --> 02:21:24,809
so what we're going for is never

2376
02:21:21,000 --> 02:21:26,159
accurate lighting it's just approximate

2377
02:21:24,809 --> 02:21:27,809
lighting and when I say maybe in video

2378
02:21:26,159 --> 02:21:29,250
save us it's approximate lighting that

2379
02:21:27,809 --> 02:21:31,109
they'll be giving us but fast

2380
02:21:29,250 --> 02:21:37,021
approximate lighting accurate letting

2381
02:21:31,110 --> 02:21:38,880
forget it it's not possible when you

2382
02:21:37,021 --> 02:21:40,440
tested secondary bounces with red light

2383
02:21:38,879 --> 02:21:44,699
it seemed like it only worked in the

2384
02:21:40,440 --> 02:21:48,980
left and down directions so if it could

2385
02:21:44,700 --> 02:21:53,250
be the case that we have a bug there and

2386
02:21:48,979 --> 02:21:54,840
I'm not really sure if we do or don't

2387
02:21:53,250 --> 02:21:58,280
like I said we're still in the process

2388
02:21:54,840 --> 02:22:00,360
of kind trying to kind of like fix

2389
02:21:58,280 --> 02:22:04,829
everything in the lighting system and

2390
02:22:00,360 --> 02:22:09,271
make sure it all works well but I don't

2391
02:22:04,829 --> 02:22:12,389
actually know whether we've gotten to

2392
02:22:09,271 --> 02:22:16,440
that point yet because we're doing a lot

2393
02:22:12,389 --> 02:22:19,529
of crazy stuff like sampling the voxels

2394
02:22:16,440 --> 02:22:21,450
using occlusion it's entirely possible

2395
02:22:19,530 --> 02:22:33,060
that a bug in that inclusion code so for

2396
02:22:21,450 --> 02:22:37,740
example this code here if this code here

2397
02:22:33,059 --> 02:22:44,189
were broken that would be a pretty easy

2398
02:22:37,739 --> 02:22:46,920
way to get directional bias in how light

2399
02:22:44,190 --> 02:22:49,380
was spreading right because when you go

2400
02:22:46,920 --> 02:22:55,979
to sample a voxel it would be sampling

2401
02:22:49,379 --> 02:22:57,569
the voxel only in like a it would be

2402
02:22:55,979 --> 02:22:59,279
knocking out people who shouldn't have

2403
02:22:57,569 --> 02:23:01,409
been knocked out based on the occlusion

2404
02:22:59,280 --> 02:23:04,521
normal or something based on like an

2405
02:23:01,409 --> 02:23:04,521
error in this code right

2406
02:23:10,090 --> 02:23:17,710
I don't know one question I do have here

2407
02:23:15,819 --> 02:23:22,329
is did we ever stop to look to see

2408
02:23:17,709 --> 02:23:25,000
whether this is correct so this is

2409
02:23:22,329 --> 02:23:34,870
saying like isn't this the wrong way

2410
02:23:25,000 --> 02:23:38,200
round kind of like did we do we actually

2411
02:23:34,870 --> 02:23:39,670
look at this so um that's the point that

2412
02:23:38,200 --> 02:23:43,450
we're sampling from so we're basically

2413
02:23:39,670 --> 02:23:47,978
saying from the corner to the point

2414
02:23:43,450 --> 02:23:51,070
we're sampling from and then we're

2415
02:23:47,978 --> 02:23:53,799
looking at the normal so this is like

2416
02:23:51,069 --> 02:23:56,469
what direction we want it to be able to

2417
02:23:53,799 --> 02:23:58,090
go we're basically trying to say that

2418
02:23:56,469 --> 02:23:59,199
those need to be same sided we should

2419
02:23:58,090 --> 02:24:01,420
just really quickly make sure that's

2420
02:23:59,200 --> 02:24:03,210
true I suspect it probably would have

2421
02:24:01,420 --> 02:24:05,710
shown up as a very obvious error

2422
02:24:03,209 --> 02:24:10,179
especially with the light leaking but I

2423
02:24:05,709 --> 02:24:15,938
don't know let's just check so if you

2424
02:24:10,180 --> 02:24:19,780
imagine we have this and we're talking

2425
02:24:15,939 --> 02:24:21,520
about a particular uvw point here so if

2426
02:24:19,780 --> 02:24:23,050
we want to sample a particular direction

2427
02:24:21,520 --> 02:24:25,380
so let's say the particular direction

2428
02:24:23,049 --> 02:24:27,909
we're sampling in this case is this way

2429
02:24:25,379 --> 02:24:31,449
then what we want to do is we want to

2430
02:24:27,909 --> 02:24:35,039
imagine that there is a plane passing

2431
02:24:31,450 --> 02:24:37,390
through here and these will then be

2432
02:24:35,040 --> 02:24:39,189
disqualified from sampling because they

2433
02:24:37,389 --> 02:24:42,608
can't possibly have hit this and then

2434
02:24:39,189 --> 02:24:45,520
gone in that direction right so what we

2435
02:24:42,609 --> 02:24:47,439
would like to do is say is the direction

2436
02:24:45,520 --> 02:24:48,909
the same and it looks like it is looks

2437
02:24:47,439 --> 02:24:52,780
like we did do it correctly right so

2438
02:24:48,909 --> 02:24:54,398
we're subtracting UVW we're doing uvw

2439
02:24:52,780 --> 02:24:57,090
minus the corner and that is what we

2440
02:24:54,398 --> 02:24:59,170
want so yeah just just wanted to

2441
02:24:57,090 --> 02:25:00,819
reassure myself that that wasn't

2442
02:24:59,170 --> 02:25:02,500
obviously busted again I think it would

2443
02:25:00,819 --> 02:25:04,619
have shown up but you know somehow make

2444
02:25:02,500 --> 02:25:04,620
sure

2445
02:25:27,250 --> 02:25:31,760
how does an RTX occur to actually

2446
02:25:29,689 --> 02:25:33,648
perform a rate racing is it similar to

2447
02:25:31,760 --> 02:25:35,658
what the ps5 can provide which is

2448
02:25:33,648 --> 02:25:39,459
hardware to work on a BVH structure to

2449
02:25:35,658 --> 02:25:39,459
perform rate racing or is that different

2450
02:25:39,850 --> 02:25:46,430
so I guess what I would say is I don't

2451
02:25:43,309 --> 02:25:48,289
actually know much about what's on an RT

2452
02:25:46,430 --> 02:25:52,520
X card because I don't know that they've

2453
02:25:48,290 --> 02:25:54,850
ever told anyone I mean maybe they have

2454
02:25:52,520 --> 02:26:00,620
but I haven't followed it very closely

2455
02:25:54,850 --> 02:26:04,670
in general the I can I can tell you more

2456
02:26:00,620 --> 02:26:07,569
the reason why these hardware solutions

2457
02:26:04,670 --> 02:26:11,469
can get you better results than a CPU

2458
02:26:07,568 --> 02:26:14,600
the reason is because the primary work

2459
02:26:11,469 --> 02:26:18,139
involved in tracing array is actually

2460
02:26:14,600 --> 02:26:22,068
very simple there's not a lot to it as

2461
02:26:18,139 --> 02:26:24,349
you know testing whether a ray hits a

2462
02:26:22,068 --> 02:26:27,920
triangle doesn't really require a lot of

2463
02:26:24,350 --> 02:26:31,430
work the problem is that you're trying

2464
02:26:27,920 --> 02:26:33,738
to do lots of these tests and you know

2465
02:26:31,430 --> 02:26:37,370
usually you like you said use a bounding

2466
02:26:33,738 --> 02:26:39,379
volume hierarchy and what happens is as

2467
02:26:37,370 --> 02:26:43,819
you traverse you that bounding volume

2468
02:26:39,379 --> 02:26:46,028
hierarchy you're typically basically

2469
02:26:43,818 --> 02:26:50,148
creating completely unpredictable code

2470
02:26:46,029 --> 02:26:52,550
so every step the better you're bounding

2471
02:26:50,148 --> 02:26:55,010
volume hierarchy is the the more random

2472
02:26:52,549 --> 02:26:58,188
the walks through it will be because

2473
02:26:55,010 --> 02:27:00,469
each time each ray will be classified

2474
02:26:58,189 --> 02:27:02,750
very cleanly into the stuff that can and

2475
02:27:00,469 --> 02:27:04,938
can't hit and that just creates an

2476
02:27:02,750 --> 02:27:08,738
incredibly unpredictable path with

2477
02:27:04,939 --> 02:27:13,090
unpredictable cache usage through this

2478
02:27:08,738 --> 02:27:17,869
memory that you then have to upon and

2479
02:27:13,090 --> 02:27:22,568
modern CPUs are low core count

2480
02:27:17,870 --> 02:27:25,399
generally speaking high predictability

2481
02:27:22,568 --> 02:27:30,500
optimizing machines they really like

2482
02:27:25,398 --> 02:27:32,358
doing highly predictable things in a

2483
02:27:30,500 --> 02:27:34,850
small number of cores that's what they

2484
02:27:32,359 --> 02:27:36,590
tend to do and that's the exact opposite

2485
02:27:34,850 --> 02:27:41,809
of what a bounding volume hierarchy

2486
02:27:36,590 --> 02:27:44,630
traversal is so what custom hardware

2487
02:27:41,809 --> 02:27:46,459
does for graphics processing is they

2488
02:27:44,629 --> 02:27:49,670
typically kind of take an opposite

2489
02:27:46,459 --> 02:27:53,688
approach they will basically crank the

2490
02:27:49,670 --> 02:27:56,750
number of micro DH of I guess we call

2491
02:27:53,689 --> 02:27:57,949
them hyper threads on the CPU side but

2492
02:27:56,750 --> 02:28:00,260
basically what they'll do is they'll say

2493
02:27:57,949 --> 02:28:02,930
look let's just accept the fact that we

2494
02:28:00,260 --> 02:28:04,340
have no frickin clue how this thing is

2495
02:28:02,930 --> 02:28:06,889
going to want to walk through this

2496
02:28:04,340 --> 02:28:09,859
memory and what we'll do instead is

2497
02:28:06,889 --> 02:28:11,629
we'll just launch like a tremendous

2498
02:28:09,859 --> 02:28:16,670
number of rays at a time through the

2499
02:28:11,629 --> 02:28:18,738
system so while one ray is unpredictably

2500
02:28:16,670 --> 02:28:21,500
trying to fetch the stuff in the

2501
02:28:18,738 --> 02:28:24,408
bounding volume hierarchy that it's

2502
02:28:21,500 --> 02:28:26,478
going to need next we always have more

2503
02:28:24,408 --> 02:28:29,898
Ray's in the pipeline who can have

2504
02:28:26,478 --> 02:28:31,760
computations done on them so typically

2505
02:28:29,898 --> 02:28:33,829
what happens on a GPU that's very

2506
02:28:31,760 --> 02:28:37,579
different from a CPU is whereas a CPU

2507
02:28:33,829 --> 02:28:41,779
maybe has two hyper threads per core at

2508
02:28:37,579 --> 02:28:44,750
maximum a GPU might have dozens right it

2509
02:28:41,779 --> 02:28:46,670
might like just have tons and tons and

2510
02:28:44,750 --> 02:28:49,609
tons and tons of Ray bundles stacked up

2511
02:28:46,670 --> 02:28:51,469
waiting to flow through this pipeline so

2512
02:28:49,609 --> 02:28:52,970
even though you have no idea what memory

2513
02:28:51,469 --> 02:28:54,349
you're going to use next and it might

2514
02:28:52,969 --> 02:28:56,898
take you a while to go and fetch it

2515
02:28:54,350 --> 02:29:00,140
there's always somebody else ready to

2516
02:28:56,898 --> 02:29:03,349
use the hardware and so what ends up

2517
02:29:00,139 --> 02:29:05,420
happening is they can just stamp down

2518
02:29:03,350 --> 02:29:07,399
lots of units that have lots of hyper

2519
02:29:05,420 --> 02:29:09,079
threads and then just worry about

2520
02:29:07,398 --> 02:29:11,329
feeding those with tremendous amount of

2521
02:29:09,079 --> 02:29:13,939
memory bandwidth and even though they're

2522
02:29:11,329 --> 02:29:15,619
doing computations any individual

2523
02:29:13,939 --> 02:29:19,369
floating-point operation on say an

2524
02:29:15,619 --> 02:29:22,159
NVIDIA GPU is probably much slower than

2525
02:29:19,369 --> 02:29:25,520
a CPU it doesn't matter because the

2526
02:29:22,158 --> 02:29:28,629
actual total throughput is much much

2527
02:29:25,520 --> 02:29:34,010
higher right so they have more units

2528
02:29:28,629 --> 02:29:36,398
running more hyper threads and so even

2529
02:29:34,010 --> 02:29:38,449
though they are clocked lower typically

2530
02:29:36,398 --> 02:29:39,920
they can just get way way more

2531
02:29:38,449 --> 02:29:44,239
throughput for something like ray

2532
02:29:39,920 --> 02:29:46,068
tracing I don't know much about the PS 5

2533
02:29:44,238 --> 02:29:47,359
so I can't tell you if there's anything

2534
02:29:46,068 --> 02:29:48,478
special going on there but generally

2535
02:29:47,359 --> 02:29:50,789
speaking I would

2536
02:29:48,478 --> 02:29:52,920
fact that RTX or at PS 5 or anything

2537
02:29:50,789 --> 02:29:55,800
else I don't think there's any

2538
02:29:52,920 --> 02:30:00,420
particular secret sauce to it I think

2539
02:29:55,799 --> 02:30:02,519
it's mostly just look tons and tons of

2540
02:30:00,420 --> 02:30:04,738
hyper threads on lots and lots of little

2541
02:30:02,520 --> 02:30:08,960
micro cores is how you get good rate

2542
02:30:04,738 --> 02:30:08,959
racing performance and CPUs aren't that

2543
02:30:17,780 --> 02:30:22,200
are the pros in the wall still getting

2544
02:30:20,790 --> 02:30:26,250
cleared to zero

2545
02:30:22,200 --> 02:30:28,740
yes they well no I don't know that they

2546
02:30:26,250 --> 02:30:31,729
get cleared to zero they just aren't

2547
02:30:28,739 --> 02:30:31,729
allowed to cast

2548
02:30:47,810 --> 02:30:52,690
yeah and just to be clear so what I was

2549
02:30:50,390 --> 02:30:56,539
talking about was not Rea incoherence

2550
02:30:52,690 --> 02:30:59,300
actually so Rea incoherence is a

2551
02:30:56,540 --> 02:31:00,950
different phenomenon Rea incoherence is

2552
02:30:59,299 --> 02:31:03,049
when you're trying to trace a bundle of

2553
02:31:00,950 --> 02:31:04,730
say sixteen rays at a time because

2554
02:31:03,049 --> 02:31:07,729
you're using a wide vector unit to do

2555
02:31:04,729 --> 02:31:10,430
the computations what what the problem

2556
02:31:07,729 --> 02:31:14,840
you have there is that if you're rays if

2557
02:31:10,431 --> 02:31:16,730
one ray hits very early but another ray

2558
02:31:14,840 --> 02:31:19,390
takes quite a bit more computation to

2559
02:31:16,729 --> 02:31:23,119
generate the hit that it will produce

2560
02:31:19,390 --> 02:31:25,789
you end up spending as much time on all

2561
02:31:23,120 --> 02:31:29,061
the rays as the most expensive ray in

2562
02:31:25,790 --> 02:31:32,780
that bundle and that's just an artifact

2563
02:31:29,060 --> 02:31:35,449
of any sim D computation so obviously

2564
02:31:32,780 --> 02:31:37,840
there's a whole separate set of work

2565
02:31:35,450 --> 02:31:41,570
that goes into trying to limit that

2566
02:31:37,840 --> 02:31:45,739
extra cost but that's not the same as

2567
02:31:41,569 --> 02:31:48,409
the unpredictable walk problem which

2568
02:31:45,739 --> 02:31:51,739
even if you're only doing one ray still

2569
02:31:48,409 --> 02:31:54,200
occurs right the fact that you don't

2570
02:31:51,739 --> 02:31:56,449
know what part of the bounding volume

2571
02:31:54,200 --> 02:31:57,620
hierarchy you will need to load until

2572
02:31:56,450 --> 02:32:01,400
after you've already done your

2573
02:31:57,620 --> 02:32:03,740
computation makes cashing cash streaming

2574
02:32:01,399 --> 02:32:05,569
suck right

2575
02:32:03,739 --> 02:32:08,989
it makes the memory streaming suck and

2576
02:32:05,569 --> 02:32:12,560
so you can't walk through that bounding

2577
02:32:08,989 --> 02:32:14,000
volume hierarchy at anything close to

2578
02:32:12,560 --> 02:32:16,039
the same speed as you can actually

2579
02:32:14,000 --> 02:32:18,440
compute what to do so maybe it takes you

2580
02:32:16,040 --> 02:32:20,271
only a few cycles to determine which

2581
02:32:18,440 --> 02:32:23,030
side of the bounding volume hierarchy to

2582
02:32:20,271 --> 02:32:27,431
traverse it doesn't matter because you

2583
02:32:23,030 --> 02:32:34,550
can't possibly load it fast enough right

2584
02:32:27,431 --> 02:32:36,980
modern CPUs rely on so in order for a

2585
02:32:34,549 --> 02:32:39,289
modern CPU to get good performance it

2586
02:32:36,979 --> 02:32:42,409
has to be able to predict what memory

2587
02:32:39,290 --> 02:32:45,590
you will use before you use it if it

2588
02:32:42,409 --> 02:32:48,829
can't then your performance will be

2589
02:32:45,590 --> 02:32:51,590
horrible period that's just the end of

2590
02:32:48,829 --> 02:32:53,511
the story and the problem with the thing

2591
02:32:51,590 --> 02:32:55,280
like a bounding volume hierarchy is the

2592
02:32:53,511 --> 02:32:57,470
whole point of the bounding volume

2593
02:32:55,280 --> 02:32:59,750
Harkey is you don't know what part of it

2594
02:32:57,470 --> 02:33:01,239
you're going to end up in if you did you

2595
02:32:59,750 --> 02:33:04,601
wouldn't need the bounding

2596
02:33:01,239 --> 02:33:05,739
hierarchy so fundamentally speaking when

2597
02:33:04,601 --> 02:33:07,900
you're talking about something like

2598
02:33:05,739 --> 02:33:10,569
ray-tracing very geometrically dense

2599
02:33:07,899 --> 02:33:14,159
scenes the problem that you have and

2600
02:33:10,569 --> 02:33:16,750
have to surmount is that you need a

2601
02:33:14,159 --> 02:33:18,190
completely unpredictable traversal

2602
02:33:16,750 --> 02:33:20,159
through a bounding volume hierarchy but

2603
02:33:18,190 --> 02:33:23,620
you know that that is very slow so

2604
02:33:20,159 --> 02:33:25,750
typically what they will do like I said

2605
02:33:23,620 --> 02:33:27,700
to solve this problem is accept that

2606
02:33:25,750 --> 02:33:31,750
that will be slow and just do a ton of

2607
02:33:27,700 --> 02:33:33,670
them together so as one piece of memory

2608
02:33:31,750 --> 02:33:36,819
comes into the system we do the ops for

2609
02:33:33,670 --> 02:33:38,200
it we issue the fetch to get the next

2610
02:33:36,819 --> 02:33:40,181
part of the bounding value our key and

2611
02:33:38,200 --> 02:33:43,450
then we immediately switch to a new set

2612
02:33:40,181 --> 02:33:46,390
of rays you know I'm saying so basically

2613
02:33:43,450 --> 02:33:48,820
we can keep we just make that pipeline

2614
02:33:46,390 --> 02:33:50,979
deep enough that the memory that's

2615
02:33:48,819 --> 02:33:52,840
coming in even though it takes a

2616
02:33:50,979 --> 02:33:55,239
tremendous amount of latency to get that

2617
02:33:52,840 --> 02:33:58,569
memory it doesn't matter because we're

2618
02:33:55,239 --> 02:34:00,970
issuing so many different memory fetches

2619
02:33:58,569 --> 02:34:03,279
that one of them is always coming back

2620
02:34:00,970 --> 02:34:07,270
as we finish the computation for another

2621
02:34:03,280 --> 02:34:08,739
one right so we always keep it fed and

2622
02:34:07,271 --> 02:34:10,601
that's what I was talking about when I

2623
02:34:08,739 --> 02:34:13,601
was saying there unpredictability ray

2624
02:34:10,601 --> 02:34:16,540
incoherence is not that ray incoherence

2625
02:34:13,601 --> 02:34:19,271
is different and it has to do with

2626
02:34:16,540 --> 02:34:20,980
packing they're called warps in GPU

2627
02:34:19,271 --> 02:34:23,290
parlance but they're just seemed

2628
02:34:20,979 --> 02:34:25,090
elaine's it's when you pack multiple

2629
02:34:23,290 --> 02:34:26,710
rays because you need to be able to do

2630
02:34:25,090 --> 02:34:28,060
them together

2631
02:34:26,709 --> 02:34:29,709
and like I said there's other ways that

2632
02:34:28,060 --> 02:34:31,601
in our system we actually don't do that

2633
02:34:29,709 --> 02:34:34,569
right now what we do is multiple volumes

2634
02:34:31,601 --> 02:34:37,471
against one ray and you can you can pick

2635
02:34:34,569 --> 02:34:37,470
which one you're doing right

2636
02:34:45,520 --> 02:34:55,750
all right I think we're vet into the

2637
02:34:54,889 --> 02:35:02,989
questions

2638
02:34:55,750 --> 02:35:04,189
sounds like alright thank you everyone

2639
02:35:02,989 --> 02:35:05,360
for joining me from the episode of hand

2640
02:35:04,189 --> 02:35:07,639
made here it's been a pleasure coding

2641
02:35:05,360 --> 02:35:09,920
with you as always if you would like to

2642
02:35:07,639 --> 02:35:11,599
follow along theories at home you can

2643
02:35:09,920 --> 02:35:13,100
know is head over to hand made here org

2644
02:35:11,600 --> 02:35:14,479
and peer to the game it comes to the

2645
02:35:13,100 --> 02:35:18,050
source code so you can follow along with

2646
02:35:14,478 --> 02:35:21,170
it at home I will be back here next week

2647
02:35:18,049 --> 02:35:23,629
I believe is that true yes I'll be back

2648
02:35:21,170 --> 02:35:25,760
here next weekend to take a look at

2649
02:35:23,629 --> 02:35:28,509
improving the lighting quality I think

2650
02:35:25,760 --> 02:35:31,460
we've done some pretty good work here

2651
02:35:28,510 --> 02:35:32,960
but we now have to kind of smooth out

2652
02:35:31,459 --> 02:35:36,589
those rough edges we have to look at the

2653
02:35:32,959 --> 02:35:42,438
power curve of the lighting and we have

2654
02:35:36,590 --> 02:35:44,120
to look at the that interpolation

2655
02:35:42,439 --> 02:35:45,470
smoothing so there's a couple different

2656
02:35:44,120 --> 02:35:48,560
things you want to do that can really

2657
02:35:45,469 --> 02:35:50,119
you know dramatically improve how good

2658
02:35:48,559 --> 02:35:51,709
the lighting appears to be without

2659
02:35:50,120 --> 02:35:53,840
really even improving any of the

2660
02:35:51,709 --> 02:35:56,000
underlying like Ray casting or sampling

2661
02:35:53,840 --> 02:35:59,299
so that's what we're going to start

2662
02:35:56,000 --> 02:36:02,270
moving into over the next few weeks as

2663
02:35:59,299 --> 02:36:03,920
we go so hope see you back here for that

2664
02:36:02,270 --> 02:36:05,540
until then have fun program everyone and

2665
02:36:03,920 --> 02:36:07,780
I'll see you on the Internet take it

2666
02:36:05,540 --> 02:36:07,780
easy everybody

