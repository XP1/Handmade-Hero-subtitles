1
00:00:00,050 --> 00:00:04,439
there we go hello everyone welcome to

2
00:00:02,879 --> 00:00:06,599
handmade hero the show we code a

3
00:00:04,440 --> 00:00:10,320
complete game live on Twitch no

4
00:00:06,599 --> 00:00:12,480
library's no engines just us and a good

5
00:00:10,320 --> 00:00:15,960
in-depth look at every last little bit

6
00:00:12,480 --> 00:00:18,269
of how a game actually operates if you

7
00:00:15,960 --> 00:00:20,039
want to know how that happens you have

8
00:00:18,269 --> 00:00:22,948
come to the right place today we are

9
00:00:20,039 --> 00:00:24,600
looking at normal mapping which we set

10
00:00:22,949 --> 00:00:26,160
the stage for yesterday by doing the

11
00:00:24,600 --> 00:00:28,500
plumbing that's necessary to kind of get

12
00:00:26,160 --> 00:00:31,109
it in there and now today we are kind of

13
00:00:28,500 --> 00:00:33,090
gonna trust we're gonna start the the

14
00:00:31,109 --> 00:00:34,710
process well I guess what I should say

15
00:00:33,090 --> 00:00:37,050
is we're gonna implement the basic

16
00:00:34,710 --> 00:00:38,039
normal map operations but they're not

17
00:00:37,049 --> 00:00:39,689
going to do anything particularly useful

18
00:00:38,039 --> 00:00:41,609
for us because we don't really have much

19
00:00:39,689 --> 00:00:43,558
lighting information to work with so if

20
00:00:41,609 --> 00:00:45,030
we're going to centrally try to leave it

21
00:00:43,558 --> 00:00:47,038
today with the normal maps working so

22
00:00:45,030 --> 00:00:50,010
that next week we can kind of go on a

23
00:00:47,039 --> 00:00:52,410
little mini adventure to figure out how

24
00:00:50,009 --> 00:00:54,689
we're going to produce some kind of a

25
00:00:52,409 --> 00:00:57,000
usable light field that we can sample

26
00:00:54,689 --> 00:00:59,399
with the normal maps that where we're

27
00:00:57,000 --> 00:01:00,988
going to be using all right so if you

28
00:00:59,399 --> 00:01:02,489
want to follow along at home and you've

29
00:01:00,988 --> 00:01:06,599
pre-ordered the game on handmade hero

30
00:01:02,488 --> 00:01:08,429
org go ahead and download the source

31
00:01:06,599 --> 00:01:10,709
code and make sure that you unzip the

32
00:01:08,430 --> 00:01:14,189
source code today 97 because we're on

33
00:01:10,709 --> 00:01:18,209
day 98 today and also I will be cycling

34
00:01:14,188 --> 00:01:20,579
the the packs at day 100 so like day 99

35
00:01:18,209 --> 00:01:22,019
will be the last one Monday I guess will

36
00:01:20,579 --> 00:01:24,000
be the last one in this pack and then I

37
00:01:22,019 --> 00:01:26,759
make a new pack so that way you know it

38
00:01:24,000 --> 00:01:28,739
doesn't become infinitely huge archive

39
00:01:26,759 --> 00:01:31,709
since I include every day source code in

40
00:01:28,739 --> 00:01:33,060
there so be on the lookout for that

41
00:01:31,709 --> 00:01:34,589
eventually when you go to your link

42
00:01:33,060 --> 00:01:37,409
you'll see that you've got options to

43
00:01:34,590 --> 00:01:39,420
download multiple packs they'll be like

44
00:01:37,409 --> 00:01:42,359
a zero at a hundred pack and I'm sorry

45
00:01:39,420 --> 00:01:47,790
$0.99 pack and then 100 to 199 pack and

46
00:01:42,359 --> 00:01:49,709
so on all right off we go now I kind of

47
00:01:47,790 --> 00:01:51,210
you know I'll be honest with you I was

48
00:01:49,709 --> 00:01:54,030
kind of out of it yesterday it was not a

49
00:01:51,209 --> 00:01:55,500
good coding day not sure exactly what

50
00:01:54,030 --> 00:01:58,290
happened some days you're on some days

51
00:01:55,500 --> 00:02:01,019
are off maybe I don't know I think I

52
00:01:58,290 --> 00:02:01,310
didn't have any coffee yesterday and you

53
00:02:01,019 --> 00:02:05,599
know

54
00:02:01,310 --> 00:02:07,579
you don't have any coffee all day so it

55
00:02:05,599 --> 00:02:09,829
was it was a bit of scattershot you know

56
00:02:07,578 --> 00:02:11,750
I sometimes did get you're done with the

57
00:02:09,830 --> 00:02:13,190
stream and you're like wow I didn't

58
00:02:11,750 --> 00:02:14,840
explain anything very well and they're a

59
00:02:13,189 --> 00:02:17,780
bunch of typos yesterday it was just it

60
00:02:14,840 --> 00:02:18,950
was just kind of a lousy day so I don't

61
00:02:17,780 --> 00:02:20,509
expect that we're going to have a

62
00:02:18,949 --> 00:02:21,949
particularly smooth ride today while we

63
00:02:20,509 --> 00:02:24,409
try to work with that code I added

64
00:02:21,949 --> 00:02:26,179
because it was kind of in a daze and so

65
00:02:24,409 --> 00:02:28,789
we're gonna have to pay a little bit of

66
00:02:26,180 --> 00:02:30,439
attention here to what's going on just

67
00:02:28,789 --> 00:02:33,079
to try and make sure that we don't have

68
00:02:30,439 --> 00:02:34,909
any really stupid mistakes in here that

69
00:02:33,080 --> 00:02:36,890
are going to cause problems for us but

70
00:02:34,909 --> 00:02:38,629
anyway what we did yesterday is we added

71
00:02:36,889 --> 00:02:41,509
this sort of normal map branch in here

72
00:02:38,629 --> 00:02:43,549
that we're doing for every pixel again

73
00:02:41,509 --> 00:02:45,229
this is highly uh that we're doing here

74
00:02:43,549 --> 00:02:48,230
we're just trying to get all of the math

75
00:02:45,229 --> 00:02:50,810
worked out properly so we'll be able to

76
00:02:48,229 --> 00:02:53,238
see what we want to optimize when we do

77
00:02:50,810 --> 00:02:54,860
a sort of a more optimal version of it

78
00:02:53,239 --> 00:02:57,049
but basically what we've got here is got

79
00:02:54,860 --> 00:02:59,269
the normal map version which is

80
00:02:57,049 --> 00:03:00,709
happening per pixel and we wanted to

81
00:02:59,269 --> 00:03:02,689
kind of sample these environment maps

82
00:03:00,709 --> 00:03:03,890
that we have which we're sort of saying

83
00:03:02,689 --> 00:03:07,639
are the things that we'll sort of

84
00:03:03,889 --> 00:03:09,919
investigate next week to see what we can

85
00:03:07,639 --> 00:03:13,669
do to generate interesting lights light

86
00:03:09,919 --> 00:03:17,449
areas kind of sample from so what we

87
00:03:13,669 --> 00:03:19,969
want to do is we want to take these

88
00:03:17,449 --> 00:03:21,199
normal maps which we kind of had a

89
00:03:19,969 --> 00:03:23,539
little thing in here that would generate

90
00:03:21,199 --> 00:03:24,560
a fake spherical normal map for us we

91
00:03:23,539 --> 00:03:27,108
want to take those do wanna do that

92
00:03:24,560 --> 00:03:28,609
sampling now we never actually hooked

93
00:03:27,109 --> 00:03:30,700
this up so I think the first thing we

94
00:03:28,609 --> 00:03:33,650
want to do is actually cook up the

95
00:03:30,699 --> 00:03:35,869
sphere normal map maker and then we can

96
00:03:33,650 --> 00:03:38,719
try passing that's for a normal map in

97
00:03:35,870 --> 00:03:40,340
and we didn't actually do the sampling

98
00:03:38,719 --> 00:03:42,079
over here either we just sort of

99
00:03:40,340 --> 00:03:44,209
returned what the color in the normal

100
00:03:42,079 --> 00:03:46,670
map was and so I'm hoping that that will

101
00:03:44,209 --> 00:03:48,889
essentially give us a way to just first

102
00:03:46,669 --> 00:03:52,219
verify that our normal Maps look at all

103
00:03:48,889 --> 00:03:54,290
reasonable anyway all right so going

104
00:03:52,219 --> 00:03:55,400
from there here's our make sure normal

105
00:03:54,289 --> 00:03:57,769
map and basically what you do is you

106
00:03:55,400 --> 00:03:59,629
hand in a bitmap and you candid a

107
00:03:57,769 --> 00:04:00,829
roughness and again that roughness value

108
00:03:59,629 --> 00:04:03,349
is just a material parameter it's

109
00:04:00,829 --> 00:04:04,609
getting packed into the alpha value and

110
00:04:03,349 --> 00:04:07,009
like I discussed before we don't

111
00:04:04,609 --> 00:04:09,980
necessarily know for really want to

112
00:04:07,009 --> 00:04:11,539
store all three values of the normal map

113
00:04:09,979 --> 00:04:15,539
in here because at the end of the day

114
00:04:11,539 --> 00:04:17,430
it's unclear really what we want to do

115
00:04:15,539 --> 00:04:19,050
in terms of that on the GPU we'd

116
00:04:17,430 --> 00:04:20,879
probably only want to store two so maybe

117
00:04:19,050 --> 00:04:22,319
we do that on the CPU side as well

118
00:04:20,879 --> 00:04:24,240
because like I said our goal with the

119
00:04:22,319 --> 00:04:26,339
CPU render is not really to make sure

120
00:04:24,240 --> 00:04:28,259
that it's performant enough to run the

121
00:04:26,339 --> 00:04:30,299
game it's more just so that we can learn

122
00:04:28,259 --> 00:04:31,889
how everything works and show how to

123
00:04:30,300 --> 00:04:33,629
optimize it as well but at the end of

124
00:04:31,889 --> 00:04:35,729
the day CPUs really aren't made for

125
00:04:33,629 --> 00:04:37,740
rendering graphics well they are getting

126
00:04:35,730 --> 00:04:39,240
a little bit more with avx-512 when that

127
00:04:37,740 --> 00:04:41,129
comes out at the end of the area that

128
00:04:39,240 --> 00:04:42,269
was designed for graphics so you never

129
00:04:41,129 --> 00:04:44,790
know but point being

130
00:04:42,269 --> 00:04:47,069
for the most part CPUs have not been

131
00:04:44,790 --> 00:04:49,980
designed for rendering graphics and so

132
00:04:47,069 --> 00:04:51,420
we can't really expect to match what we

133
00:04:49,980 --> 00:04:53,490
were going to be able to on the GPU at

134
00:04:51,420 --> 00:04:56,699
any level of fidelity with the CPU

135
00:04:53,490 --> 00:04:59,129
anyway so let's start by saying alright

136
00:04:56,699 --> 00:05:01,560
we've got our normal map generator here

137
00:04:59,129 --> 00:05:03,659
I'm going to go in and when we do our

138
00:05:01,560 --> 00:05:05,790
load time stuff I'm going to have it

139
00:05:03,660 --> 00:05:08,430
sort of generate one for us that we can

140
00:05:05,790 --> 00:05:11,550
use just you know something that'll kind

141
00:05:08,430 --> 00:05:13,530
of be workable and we were we were using

142
00:05:11,550 --> 00:05:16,620
that tree I believe is what we were

143
00:05:13,529 --> 00:05:19,109
using as our bitmap to test with so I'm

144
00:05:16,620 --> 00:05:21,180
gonna go ahead and you know say that we

145
00:05:19,110 --> 00:05:23,819
had a tree normal map here even though

146
00:05:21,180 --> 00:05:25,319
we don't and then I'm gonna make it so

147
00:05:23,819 --> 00:05:26,610
that when we you know when we load this

148
00:05:25,319 --> 00:05:29,939
tree I'm basically going to make a

149
00:05:26,610 --> 00:05:31,680
bitmap that will will be the the tree

150
00:05:29,939 --> 00:05:35,490
normal map so I'm gonna say that we have

151
00:05:31,680 --> 00:05:37,439
that here and the roughness for this

152
00:05:35,490 --> 00:05:39,060
thing is gonna be 0 for now actually I

153
00:05:37,439 --> 00:05:42,060
guess technically we can might as well

154
00:05:39,060 --> 00:05:44,939
have the roughness be 1 which is to say

155
00:05:42,060 --> 00:05:45,990
that it is perfectly smooth we'll start

156
00:05:44,939 --> 00:05:47,519
with perfectly reflective that's the

157
00:05:45,990 --> 00:05:49,170
easier one to debug so start a throatily

158
00:05:47,519 --> 00:05:51,599
we'll start with one that's completely

159
00:05:49,170 --> 00:05:53,520
reflected so what we need to do first is

160
00:05:51,600 --> 00:05:55,350
we need to allocate space for this so

161
00:05:53,519 --> 00:05:56,969
I'm gonna do a make empty bitmap call

162
00:05:55,350 --> 00:06:00,780
since I think we already essentially

163
00:05:56,970 --> 00:06:03,480
have that ability here we needed to pass

164
00:06:00,779 --> 00:06:04,799
it in arena we need to pass it a width

165
00:06:03,480 --> 00:06:07,740
and a height and the width and the

166
00:06:04,800 --> 00:06:09,750
height are going to be off of whatever

167
00:06:07,740 --> 00:06:11,879
the trees width and height were right

168
00:06:09,750 --> 00:06:14,910
we're just kind of mirroring mirror near

169
00:06:11,879 --> 00:06:16,800
roaring that and we don't need it to be

170
00:06:14,910 --> 00:06:19,320
cleared to zero because we're gonna

171
00:06:16,800 --> 00:06:21,000
right into it directly now I guess when

172
00:06:19,319 --> 00:06:22,709
we do that I believe the way that we

173
00:06:21,000 --> 00:06:24,918
said that we were going to do these guys

174
00:06:22,709 --> 00:06:27,239
we we stored them in the transient array

175
00:06:24,918 --> 00:06:28,620
and we could keep doing that like that's

176
00:06:27,240 --> 00:06:30,689
where the ground buffers are

177
00:06:28,620 --> 00:06:32,430
and I suppose we can do that here as

178
00:06:30,689 --> 00:06:35,029
well right we can go ahead and say that

179
00:06:32,430 --> 00:06:38,850
the tree normal map comes out in here

180
00:06:35,029 --> 00:06:40,319
and that way you can use the same arena

181
00:06:38,850 --> 00:06:42,720
that everything's using for transient

182
00:06:40,319 --> 00:06:44,819
State so and then we'll go ahead and

183
00:06:42,720 --> 00:06:46,380
make that sphere normal map in there now

184
00:06:44,819 --> 00:06:47,790
I think that's all we really need to do

185
00:06:46,379 --> 00:06:50,459
to do that

186
00:06:47,790 --> 00:06:52,319
oops don't really need that arrow

187
00:06:50,459 --> 00:06:54,089
operator there I think that's all that

188
00:06:52,319 --> 00:06:57,389
we really need to do I can't quite

189
00:06:54,089 --> 00:07:00,149
remember if there's any other wacky

190
00:06:57,389 --> 00:07:02,189
misses let's see and that is also an

191
00:07:00,149 --> 00:07:03,839
address oh so that'll make that sphere

192
00:07:02,189 --> 00:07:06,719
normal map for us we can then start

193
00:07:03,839 --> 00:07:08,639
passing the sphere normal map along

194
00:07:06,720 --> 00:07:11,280
because we've got this thing here where

195
00:07:08,639 --> 00:07:13,289
we're actually you know about to use it

196
00:07:11,279 --> 00:07:16,169
so we can pass the tree no map in there

197
00:07:13,290 --> 00:07:18,360
and that should actually allow us to to

198
00:07:16,170 --> 00:07:20,580
sample from it now we have to now bounce

199
00:07:18,360 --> 00:07:22,020
back to the other routine there and

200
00:07:20,579 --> 00:07:28,680
actually do something reasonable with

201
00:07:22,019 --> 00:07:32,039
that okay and I believe we didn't finish

202
00:07:28,680 --> 00:07:34,199
doing any scaling on these either if I

203
00:07:32,040 --> 00:07:38,210
if I remember correctly so when we

204
00:07:34,199 --> 00:07:40,680
sample out of the normal map right here

205
00:07:38,209 --> 00:07:44,699
all we're doing is we're unpacking it so

206
00:07:40,680 --> 00:07:49,980
they're 255 they're like they're 0 to

207
00:07:44,699 --> 00:07:52,139
255 and 0 to 128 in and I guess you know

208
00:07:49,980 --> 00:07:56,970
I'd have to think about this but I guess

209
00:07:52,139 --> 00:07:59,819
we also wanted to to change the way this

210
00:07:56,970 --> 00:08:04,280
is packed this is not really correct

211
00:07:59,819 --> 00:08:07,740
right this is should actually be 128

212
00:08:04,279 --> 00:08:10,679
plus 127 normal Z right because it's

213
00:08:07,740 --> 00:08:12,120
always a positive value I mean

214
00:08:10,680 --> 00:08:14,250
technically we could just do it exactly

215
00:08:12,120 --> 00:08:16,199
this way in fact I don't know why we

216
00:08:14,250 --> 00:08:17,759
don't for uniformity sake

217
00:08:16,199 --> 00:08:19,620
right we should just be packing it

218
00:08:17,759 --> 00:08:22,769
everything the same way take whatever

219
00:08:19,620 --> 00:08:25,800
that that normal Z is add 1 to it

220
00:08:22,769 --> 00:08:28,109
and divide it by 0.5 multiply it out so

221
00:08:25,800 --> 00:08:30,389
that that seems like a smarter way to go

222
00:08:28,110 --> 00:08:32,009
that way everything is is in the same

223
00:08:30,389 --> 00:08:34,679
coordinate space so so let's pretend

224
00:08:32,009 --> 00:08:37,759
that never happened we'll just go ahead

225
00:08:34,679 --> 00:08:39,408
and and get back in here

226
00:08:37,759 --> 00:08:41,538
so now we've got this thing and like I

227
00:08:39,408 --> 00:08:45,078
said I don't think we're actually doing

228
00:08:41,538 --> 00:08:47,659
any real scaling of the values we just

229
00:08:45,078 --> 00:08:49,998
unpacked them and we linearly

230
00:08:47,659 --> 00:08:52,850
interpolated them but then once we have

231
00:08:49,999 --> 00:08:54,409
our normal we don't really know what any

232
00:08:52,850 --> 00:08:57,739
of it means right

233
00:08:54,409 --> 00:08:59,659
we haven't scaled down to to the proper

234
00:08:57,739 --> 00:09:01,278
range we haven't adjusted for positive

235
00:08:59,659 --> 00:09:03,048
negative any of that stuff

236
00:09:01,278 --> 00:09:06,139
so we kind of have to figure out what we

237
00:09:03,048 --> 00:09:09,169
want to do with that and what's a little

238
00:09:06,139 --> 00:09:10,639
bit confusing here and I feel like this

239
00:09:09,169 --> 00:09:13,969
is one of those things that's that's

240
00:09:10,639 --> 00:09:15,528
again it's part of the hacky nature of

241
00:09:13,970 --> 00:09:17,209
the problem that we're trying to solve

242
00:09:15,528 --> 00:09:19,970
where we're you know we're essentially

243
00:09:17,208 --> 00:09:22,068
trying to do some 3d things that are

244
00:09:19,970 --> 00:09:24,350
inherently 3d we're trying to do them in

245
00:09:22,068 --> 00:09:27,558
a 2d world you always run in to these

246
00:09:24,350 --> 00:09:28,999
kind of problematic barriers right but

247
00:09:27,558 --> 00:09:30,738
it's just happen to be aware of if you

248
00:09:28,999 --> 00:09:32,808
think about what we're drawing when we

249
00:09:30,739 --> 00:09:34,429
draw something and we've got you know

250
00:09:32,808 --> 00:09:35,688
like we drew that sphere in there and

251
00:09:34,428 --> 00:09:37,039
we've got things that are pointing like

252
00:09:35,688 --> 00:09:39,438
directly at us here we've got things

253
00:09:37,039 --> 00:09:40,789
that are pointing up sideways you know

254
00:09:39,438 --> 00:09:42,948
this sort of thing and they get smaller

255
00:09:40,789 --> 00:09:44,240
and smaller right what's important to

256
00:09:42,948 --> 00:09:46,938
note here is there's never anything

257
00:09:44,240 --> 00:09:48,499
that's pointing backwards in Z whatever

258
00:09:46,938 --> 00:09:50,419
the Z coordinate is relative to this

259
00:09:48,499 --> 00:09:52,100
like what we're talking about here we're

260
00:09:50,419 --> 00:09:54,159
never pointing back into the screen

261
00:09:52,100 --> 00:09:57,470
we're only pointing forwards right and

262
00:09:54,159 --> 00:10:00,379
so the meaning of these things is kind

263
00:09:57,470 --> 00:10:02,449
of hard for us to really into it but the

264
00:10:00,379 --> 00:10:04,459
meaning of our normals if we imagine

265
00:10:02,448 --> 00:10:06,708
this was a tree really what we're

266
00:10:04,458 --> 00:10:09,969
talking about is the x axis of our

267
00:10:06,708 --> 00:10:16,518
normals is the x axis of our world right

268
00:10:09,970 --> 00:10:21,798
and the y axis of our normals is really

269
00:10:16,519 --> 00:10:24,558
more like the z axis it's the thing that

270
00:10:21,798 --> 00:10:27,438
would blend between you know sky and

271
00:10:24,558 --> 00:10:30,409
ground and then that middle thing right

272
00:10:27,438 --> 00:10:34,248
so the top middle bottom that's really

273
00:10:30,409 --> 00:10:37,249
what the Y tells us and then that Z

274
00:10:34,249 --> 00:10:39,678
right the Z which is sort of saying the

275
00:10:37,249 --> 00:10:42,139
outwardness of this thing that's that's

276
00:10:39,678 --> 00:10:45,110
kind of saying you know where you are

277
00:10:42,139 --> 00:10:48,798
and here is really more telling us what

278
00:10:45,110 --> 00:10:49,590
direction in Y on the screen we would

279
00:10:48,798 --> 00:10:52,139
actually be go

280
00:10:49,590 --> 00:10:55,139
right and it makes sense if you think

281
00:10:52,139 --> 00:10:56,850
about it because really when you have an

282
00:10:55,139 --> 00:10:59,159
opaque tree like this that's facing us

283
00:10:56,850 --> 00:11:00,420
there's no way a normal could ever be

284
00:10:59,159 --> 00:11:03,179
pointing behind it

285
00:11:00,419 --> 00:11:06,029
that we would see so there's no way it

286
00:11:03,179 --> 00:11:07,409
would ever look upwards in y2 like you

287
00:11:06,029 --> 00:11:09,629
know if there's another tree behind it

288
00:11:07,409 --> 00:11:11,399
we'd never have a normal in this tree

289
00:11:09,629 --> 00:11:12,870
pointing at that tree that was actually

290
00:11:11,399 --> 00:11:16,649
visible on the front side of the tree

291
00:11:12,870 --> 00:11:18,450
it's not a thing right and so it kind of

292
00:11:16,649 --> 00:11:20,819
makes sense but really what it means is

293
00:11:18,450 --> 00:11:25,560
that the X Y Z's in terms of this

294
00:11:20,820 --> 00:11:28,640
texture map really map into this way

295
00:11:25,559 --> 00:11:39,779
right they really map into x y and z

296
00:11:28,639 --> 00:11:42,539
like so right for a tree now we might

297
00:11:39,779 --> 00:11:45,600
also have things like the ground right

298
00:11:42,539 --> 00:11:47,399
and the ground would have normals that

299
00:11:45,600 --> 00:11:50,220
would be you know pointing in some

300
00:11:47,399 --> 00:11:53,159
direction for the ground right for

301
00:11:50,220 --> 00:11:55,920
ground it's a little harder to say what

302
00:11:53,159 --> 00:11:59,069
actually we would do I mean you know if

303
00:11:55,919 --> 00:12:01,979
these are kind of bumpy they're kind of

304
00:11:59,070 --> 00:12:04,710
bumpy in all directions like the ground

305
00:12:01,980 --> 00:12:07,409
actually is flat so it could point in

306
00:12:04,710 --> 00:12:09,720
all the directions of the hemisphere so

307
00:12:07,409 --> 00:12:12,899
in some sense we have like two types of

308
00:12:09,720 --> 00:12:17,639
normal map right there's a front facing

309
00:12:12,899 --> 00:12:20,009
normal map and it looks like this and

310
00:12:17,639 --> 00:12:24,240
then there is an up facing normal map

311
00:12:20,009 --> 00:12:26,370
right and it actually has a real XY Z

312
00:12:24,240 --> 00:12:28,769
that actually means what it actually

313
00:12:26,370 --> 00:12:31,409
means the X is the wise and the Z's are

314
00:12:28,769 --> 00:12:33,329
all actually what they really are and so

315
00:12:31,409 --> 00:12:36,389
we probably have to have two different

316
00:12:33,330 --> 00:12:39,960
texture sampling paths one that handles

317
00:12:36,389 --> 00:12:41,279
these and one that handles these and we

318
00:12:39,960 --> 00:12:42,990
would switch between them based on

319
00:12:41,279 --> 00:12:46,529
whether we were drawing ground like

320
00:12:42,990 --> 00:12:49,529
things or sort of perspective sorts of

321
00:12:46,529 --> 00:12:51,720
things right I know that's a little

322
00:12:49,529 --> 00:12:54,600
confusing but that's kind of how that

323
00:12:51,720 --> 00:12:57,060
works and it's worth noting that that

324
00:12:54,600 --> 00:12:59,879
maybe isn't always the case here in

325
00:12:57,059 --> 00:13:01,969
terms of not being able to see behind

326
00:12:59,879 --> 00:13:05,028
you you could imagine in the

327
00:13:01,970 --> 00:13:07,310
weird case of like the top down dungeon

328
00:13:05,028 --> 00:13:09,679
a sort of perspective which I don't know

329
00:13:07,309 --> 00:13:12,559
that will necessarily clone but let's

330
00:13:09,679 --> 00:13:15,198
say that we did so here's like a Zelda e

331
00:13:12,559 --> 00:13:17,719
style room you know that you see pretty

332
00:13:15,198 --> 00:13:19,789
often in these sorts of games right

333
00:13:17,720 --> 00:13:22,759
that's got you know you some brick walls

334
00:13:19,789 --> 00:13:25,458
here and and you know that sort of thing

335
00:13:22,759 --> 00:13:28,188
and it's got a slime mold in it

336
00:13:25,458 --> 00:13:31,458
that's slamming around or whatever okay

337
00:13:28,188 --> 00:13:34,789
anyway point being you've got something

338
00:13:31,458 --> 00:13:36,979
like this these walls right do have

339
00:13:34,789 --> 00:13:39,409
normals that point in that direction so

340
00:13:36,980 --> 00:13:40,850
you know we it wouldn't it's not like

341
00:13:39,409 --> 00:13:44,269
we're throwing away a bunch of

342
00:13:40,850 --> 00:13:46,490
information in terms of here here it's

343
00:13:44,269 --> 00:13:47,659
just for the for things like trees they

344
00:13:46,490 --> 00:13:48,948
would never actually have normals

345
00:13:47,659 --> 00:13:51,110
pointing that direction but it's

346
00:13:48,948 --> 00:13:53,479
possible that we could have sprites who

347
00:13:51,110 --> 00:13:55,519
do want to have normals pointing in in

348
00:13:53,480 --> 00:14:05,060
those directions right that's it's it's

349
00:13:55,519 --> 00:14:07,879
plausible at least alright so off we go

350
00:14:05,059 --> 00:14:12,500
in fact let me let me just move us back

351
00:14:07,879 --> 00:14:13,970
up here see this there we go so for

352
00:14:12,500 --> 00:14:16,370
right now we're only gonna handle those

353
00:14:13,970 --> 00:14:19,069
front facing bitmaps for now we'll deal

354
00:14:16,370 --> 00:14:20,778
with the ground a little bit later in

355
00:14:19,068 --> 00:14:22,969
having separate paths so assuming that

356
00:14:20,778 --> 00:14:25,338
we've got our sphere packed in here when

357
00:14:22,970 --> 00:14:27,649
we grab this stuff out what we want to

358
00:14:25,339 --> 00:14:30,800
do here is take our normal and we want

359
00:14:27,649 --> 00:14:33,889
to produce those scaled values right

360
00:14:30,799 --> 00:14:36,649
so we want to take our X of our normal

361
00:14:33,889 --> 00:14:39,198
and our X of our normal I guess we could

362
00:14:36,649 --> 00:14:41,929
we could just sort of say that this is a

363
00:14:39,198 --> 00:14:44,628
unpack normal here right so we have a

364
00:14:41,929 --> 00:14:48,318
like an unpack or it's not really

365
00:14:44,629 --> 00:14:52,430
unpacked but it's a scale and bias or

366
00:14:48,318 --> 00:14:54,708
unscaled bias normal something that

367
00:14:52,429 --> 00:14:56,688
we'll take in our normal for us and it

368
00:14:54,708 --> 00:15:02,659
will give us out a reasonable value

369
00:14:56,688 --> 00:15:05,149
right and that I guess I could even do

370
00:15:02,659 --> 00:15:06,409
that per component I'm not sure what I

371
00:15:05,149 --> 00:15:09,889
want to do there so we'll just leave it

372
00:15:06,409 --> 00:15:12,360
like this so off we go that's one of

373
00:15:09,889 --> 00:15:16,769
these guys like so

374
00:15:12,360 --> 00:15:20,519
so this will return that v4 it'll do the

375
00:15:16,769 --> 00:15:22,709
unskilled biased normal here like so and

376
00:15:20,519 --> 00:15:25,470
what we want to do is we want to produce

377
00:15:22,708 --> 00:15:29,008
that result which basically takes the

378
00:15:25,470 --> 00:15:32,069
normal X it's going to it's it's right

379
00:15:29,009 --> 00:15:34,230
now packed from 0 to 255 what we want to

380
00:15:32,068 --> 00:15:37,198
do is we first want to change that to

381
00:15:34,230 --> 00:15:39,028
the range of 0 to 1 right so we kind of

382
00:15:37,198 --> 00:15:42,719
have we've got one of these inverters

383
00:15:39,028 --> 00:15:47,100
again right so you want to do in 255 and

384
00:15:42,720 --> 00:15:49,920
then we want to change that but from 0

385
00:15:47,100 --> 00:15:52,170
to 1 to negative 1 to 1 right so what

386
00:15:49,919 --> 00:15:56,328
we'd like to do is start at negative 1

387
00:15:52,169 --> 00:15:59,878
and we'd like to go from there you know

388
00:15:56,328 --> 00:16:02,998
twice the range of the 0 to 1 value and

389
00:15:59,879 --> 00:16:04,920
that is just going to happen for all of

390
00:16:02,999 --> 00:16:07,409
our components since they're all packed

391
00:16:04,919 --> 00:16:09,298
uniformly at the moment the W which is

392
00:16:07,409 --> 00:16:10,948
the roughness value is literally just a

393
00:16:09,298 --> 00:16:12,328
value that goes from 0 to 1 so we don't

394
00:16:10,948 --> 00:16:14,128
have to do anything special there we

395
00:16:12,328 --> 00:16:16,078
just convert it like we were converting

396
00:16:14,129 --> 00:16:18,269
a color value an old school color value

397
00:16:16,078 --> 00:16:19,859
that wasn't using the linear packing or

398
00:16:18,269 --> 00:16:23,548
any of that stuff I'm sorry the srgb

399
00:16:19,860 --> 00:16:25,970
packing so doing that would will produce

400
00:16:23,548 --> 00:16:28,289
at least properly scaled normals now

401
00:16:25,970 --> 00:16:32,639
although that doesn't look particularly

402
00:16:28,289 --> 00:16:35,099
good that's did I did I make some kind

403
00:16:32,639 --> 00:16:38,399
of mistake there I believe that's right

404
00:16:35,100 --> 00:16:41,999
you take the normal x y&amp;z we produce a

405
00:16:38,399 --> 00:16:44,009
range of 0 to 1 to 1 we then start from

406
00:16:41,999 --> 00:16:47,879
negative 1 and we add twice that range

407
00:16:44,009 --> 00:16:49,619
in I think that's right I would have

408
00:16:47,879 --> 00:16:51,480
expected half the tree to look that way

409
00:16:49,619 --> 00:16:53,459
but I wasn't expecting the other half to

410
00:16:51,480 --> 00:16:55,079
look that way that's that's a little

411
00:16:53,458 --> 00:16:56,338
it's a little suspicious to say the

412
00:16:55,078 --> 00:16:58,708
least

413
00:16:56,339 --> 00:17:00,360
all right so coming back down in here

414
00:16:58,708 --> 00:17:02,998
let me just finish the part we were

415
00:17:00,360 --> 00:17:06,899
doing so after we do the lerp of the

416
00:17:02,999 --> 00:17:09,088
normal which I believe is still probably

417
00:17:06,898 --> 00:17:10,678
fine I have to think about whether

418
00:17:09,088 --> 00:17:13,588
there's consequences to the fact that

419
00:17:10,679 --> 00:17:15,480
we're using 0 255 to encode that range

420
00:17:13,588 --> 00:17:16,379
but I think we could probably lurk and

421
00:17:15,480 --> 00:17:19,889
then unscaled

422
00:17:16,380 --> 00:17:22,559
and emboss it into real normal range

423
00:17:19,888 --> 00:17:25,078
first but then we have our thing here

424
00:17:22,558 --> 00:17:25,558
where we're doing a sample environment

425
00:17:25,078 --> 00:17:27,359
which I thought

426
00:17:25,558 --> 00:17:29,339
was going to just draw the normal as a

427
00:17:27,359 --> 00:17:32,148
color in fact what I couldn't do here

428
00:17:29,339 --> 00:17:35,999
just to start with let me go ahead and

429
00:17:32,148 --> 00:17:41,308
draw literally just that normal so the

430
00:17:35,999 --> 00:17:44,129
Texel equals the normal and like so and

431
00:17:41,308 --> 00:17:47,428
we could also force the Texel a to be

432
00:17:44,128 --> 00:17:47,819
1.0 so that there's no frisking so there

433
00:17:47,429 --> 00:17:50,820
we go

434
00:17:47,819 --> 00:17:53,220
so our color is always black so we've

435
00:17:50,819 --> 00:17:55,200
got something nasty going on there so

436
00:17:53,220 --> 00:17:58,618
I'm gonna go ahead and like I said since

437
00:17:55,200 --> 00:18:00,419
I'm since it's been a little it's been a

438
00:17:58,618 --> 00:18:03,388
little wishy-washy in here lately

439
00:18:00,419 --> 00:18:06,119
I would like to step in and just verify

440
00:18:03,388 --> 00:18:08,548
that all of my stuff is happening the

441
00:18:06,118 --> 00:18:11,099
way that I think it's happening because

442
00:18:08,548 --> 00:18:12,720
you know I don't have a hundred percent

443
00:18:11,099 --> 00:18:13,888
confidence and especially the code they

444
00:18:12,720 --> 00:18:16,079
got written yesterday but we're still

445
00:18:13,888 --> 00:18:18,388
coming off of it today so you know how

446
00:18:16,079 --> 00:18:20,189
it is alright so I want to step in here

447
00:18:18,388 --> 00:18:22,288
and see what sorts of stuff we're

448
00:18:20,190 --> 00:18:24,330
actually getting when we sample the

449
00:18:22,288 --> 00:18:25,528
normal map because like I said we don't

450
00:18:24,329 --> 00:18:28,648
really know what we're getting out of

451
00:18:25,528 --> 00:18:36,480
that so I want to see it so here's our

452
00:18:28,648 --> 00:18:38,668
normal a B C and D D so when we unpack

453
00:18:36,480 --> 00:18:41,038
those I'm just gonna take a look at what

454
00:18:38,669 --> 00:18:42,659
we've actually got in there so I don't

455
00:18:41,038 --> 00:18:45,378
understand why all of those would be

456
00:18:42,659 --> 00:18:51,059
zero that doesn't seem reasonable to me

457
00:18:45,378 --> 00:18:55,319
so I kind of feel like that is well you

458
00:18:51,058 --> 00:18:56,548
know I suppose that could be no I don't

459
00:18:55,319 --> 00:18:58,288
really know why that could be I feel

460
00:18:56,548 --> 00:19:01,378
like there should be no places in our

461
00:18:58,288 --> 00:19:02,878
texture map except like like they should

462
00:19:01,378 --> 00:19:06,209
always be normal right so I feel like

463
00:19:02,878 --> 00:19:08,548
that's just that's that suits somewhat

464
00:19:06,210 --> 00:19:10,350
implausible to me so I want to know why

465
00:19:08,548 --> 00:19:12,990
that is the case I'm gonna go ahead and

466
00:19:10,349 --> 00:19:20,459
look at the normal map directly I'm just

467
00:19:12,990 --> 00:19:22,798
gonna take a look at no no this is

468
00:19:20,460 --> 00:19:26,490
exactly what I was afraid of look at

469
00:19:22,798 --> 00:19:31,288
this cut and paste yesterday did not

470
00:19:26,490 --> 00:19:33,720
even change the normal map we were still

471
00:19:31,288 --> 00:19:35,548
sampling out of the texture it's just

472
00:19:33,720 --> 00:19:37,558
ridiculous I mean how does that help you

473
00:19:35,548 --> 00:19:41,368
not at all right all right so we found

474
00:19:37,558 --> 00:19:43,618
problem one let's let's go back there

475
00:19:41,368 --> 00:19:46,079
now okay

476
00:19:43,618 --> 00:19:52,609
so let's take a look at what our normals

477
00:19:46,079 --> 00:19:59,398
look like now our normal B is zero

478
00:19:52,609 --> 00:20:03,209
our normalcy or normal D our normals B

479
00:19:59,398 --> 00:20:07,398
and D which are the ones that are one

480
00:20:03,210 --> 00:20:12,000
away look like they're totally wrong

481
00:20:07,398 --> 00:20:16,319
so that is not reassuring to say the

482
00:20:12,000 --> 00:20:21,868
least I'm not sure why that is these

483
00:20:16,319 --> 00:20:27,388
guys look not right either because

484
00:20:21,868 --> 00:20:30,178
that's not a normal one one zero is not

485
00:20:27,388 --> 00:20:34,079
is not actually a normal day oh so it

486
00:20:30,179 --> 00:20:35,730
looks like we're still pretty janky in

487
00:20:34,079 --> 00:20:38,548
here so I'm gonna go ahead and take a

488
00:20:35,730 --> 00:20:41,220
look at what that normal map actually

489
00:20:38,548 --> 00:20:43,288
has in it what did I just do all right

490
00:20:41,220 --> 00:20:45,778
bad key combination there I invoked the

491
00:20:43,288 --> 00:20:48,359
will of Visual Studio which really you

492
00:20:45,778 --> 00:20:51,319
just never want to do never a good thing

493
00:20:48,359 --> 00:20:54,449
if Visual Studio starts doing this thing

494
00:20:51,319 --> 00:20:56,689
just always bad alright so if we take a

495
00:20:54,450 --> 00:21:00,359
look at the memory here I'm going to

496
00:20:56,690 --> 00:21:07,649
look at this as an int unsigned and so I

497
00:21:00,358 --> 00:21:09,750
can sort start to see what's in there so

498
00:21:07,648 --> 00:21:13,349
that actually looks like a fairly

499
00:21:09,750 --> 00:21:15,569
reasonable value by comparison to what

500
00:21:13,349 --> 00:21:19,548
we were getting let's take a look at

501
00:21:15,569 --> 00:21:22,939
some set of those values that does not

502
00:21:19,548 --> 00:21:25,879
look useful to me

503
00:21:22,940 --> 00:21:27,740
yeah all right so I'm gonna step out a

504
00:21:25,880 --> 00:21:31,640
bit here I'm going to take a look at

505
00:21:27,740 --> 00:21:33,470
what happens when we call make oops

506
00:21:31,640 --> 00:21:36,470
come on here I'm gonna take a look at

507
00:21:33,470 --> 00:21:39,680
what happens when we call our our sort

508
00:21:36,470 --> 00:21:42,350
of sphere bitmap generator which is in

509
00:21:39,680 --> 00:21:47,060
here I just want to see what that's

510
00:21:42,349 --> 00:21:51,589
doing Oh awesome yeah I was right to be

511
00:21:47,059 --> 00:21:54,619
to be leery let's say of yesterday's

512
00:21:51,589 --> 00:21:57,109
code it was just not good right I mean

513
00:21:54,619 --> 00:21:59,869
how many times are we gonna write to

514
00:21:57,109 --> 00:22:01,789
this pixel the answer is we're gonna

515
00:21:59,869 --> 00:22:04,449
write to the same pixel width number of

516
00:22:01,789 --> 00:22:06,349
times doesn't seem particularly useful

517
00:22:04,450 --> 00:22:10,640
usually you want to go ahead and move to

518
00:22:06,349 --> 00:22:12,939
the next pixel when you write one yeah

519
00:22:10,640 --> 00:22:15,890
just just a thought

520
00:22:12,940 --> 00:22:17,600
all right so checking you look at this

521
00:22:15,890 --> 00:22:21,470
guy here let's also just check this math

522
00:22:17,599 --> 00:22:22,819
real quickly if I remember correctly I

523
00:22:21,470 --> 00:22:24,440
was totally out to lunch in the math as

524
00:22:22,819 --> 00:22:25,460
well in fact I think of pseudonym 73

525
00:22:24,440 --> 00:22:27,980
hasn't stepped in it would have been a

526
00:22:25,460 --> 00:22:30,319
complete disaster let's go ahead and

527
00:22:27,980 --> 00:22:32,690
generate this app properly so we've got

528
00:22:30,319 --> 00:22:34,490
our bitmap UV which is just where we are

529
00:22:32,690 --> 00:22:37,279
in the bitmap right that's going to be

530
00:22:34,490 --> 00:22:41,480
the X divided by the width and so that's

531
00:22:37,279 --> 00:22:45,500
fine and we want that to yeah to

532
00:22:41,480 --> 00:22:49,700
generate a nice value there for our X

533
00:22:45,500 --> 00:22:53,329
and our Y so this is going to be our NX

534
00:22:49,700 --> 00:22:56,450
and our my I guess right and so then our

535
00:22:53,329 --> 00:22:58,129
NZ as we were saying before that should

536
00:22:56,450 --> 00:23:00,680
actually just be Pythagorean theorem

537
00:22:58,130 --> 00:23:05,780
squared with a grain theorem solved

538
00:23:00,680 --> 00:23:08,990
right so if we just say you know this is

539
00:23:05,779 --> 00:23:11,149
the sphere situation if we just say all

540
00:23:08,990 --> 00:23:13,160
right we've got a sphere so this is

541
00:23:11,150 --> 00:23:16,810
actually you know this is actually one

542
00:23:13,160 --> 00:23:20,420
of those three-dimensional fancy spheres

543
00:23:16,809 --> 00:23:22,279
if we've got a sphere and we're looking

544
00:23:20,420 --> 00:23:24,019
at this fear from above so we're looking

545
00:23:22,279 --> 00:23:27,589
at it downward right and so we just see

546
00:23:24,019 --> 00:23:30,889
a circle then at any point here we could

547
00:23:27,589 --> 00:23:32,089
figure out we know that the you know

548
00:23:30,890 --> 00:23:33,200
this is an orthographic kind of

549
00:23:32,089 --> 00:23:36,449
projection so we're looking straight

550
00:23:33,200 --> 00:23:38,340
down on the sphere we know what the X&amp;Y

551
00:23:36,450 --> 00:23:40,109
because that's just whatever our our

552
00:23:38,339 --> 00:23:42,058
bitmap you know wherever our coordinate

553
00:23:40,108 --> 00:23:44,278
coordinate in the bitmap is it right and

554
00:23:42,058 --> 00:23:47,308
so if that's the X&amp;Y

555
00:23:44,278 --> 00:23:49,919
we know that that represents some point

556
00:23:47,308 --> 00:23:52,678
on the sphere right where it's taking

557
00:23:49,919 --> 00:23:55,230
the x coordinate right and the y

558
00:23:52,679 --> 00:23:57,028
coordinate of this of this thing in

559
00:23:55,230 --> 00:23:59,460
order to know what that Z coordinate is

560
00:23:57,028 --> 00:24:01,169
we know that the sphere is supposed to

561
00:23:59,460 --> 00:24:03,419
be unit length right so we know that the

562
00:24:01,169 --> 00:24:06,480
radius here we know that the R is

563
00:24:03,419 --> 00:24:09,359
supposed to be one right so we know that

564
00:24:06,480 --> 00:24:12,298
x squared plus y squared plus Z squared

565
00:24:09,358 --> 00:24:15,808
is supposed to equal one right that's

566
00:24:12,298 --> 00:24:18,329
what we want to have be true so what we

567
00:24:15,808 --> 00:24:19,980
need to do is solve that equation so

568
00:24:18,329 --> 00:24:23,928
that we can figure out what the Z is so

569
00:24:19,980 --> 00:24:26,339
squaring both sides right we get this

570
00:24:23,929 --> 00:24:27,659
and if we want to know what the Z is we

571
00:24:26,339 --> 00:24:30,868
just have to move the X and the y to the

572
00:24:27,659 --> 00:24:34,590
other side right so it's that equals Z

573
00:24:30,868 --> 00:24:37,648
squared right so then it's just Z equals

574
00:24:34,589 --> 00:24:42,480
square root of 1 minus x squared minus y

575
00:24:37,648 --> 00:24:45,508
squared right and yeah I believe suited

576
00:24:42,480 --> 00:24:47,308
him probably did that yesterday for us

577
00:24:45,509 --> 00:24:49,259
but since I was out to lunch it's good

578
00:24:47,308 --> 00:24:53,128
to have know someone's got your back but

579
00:24:49,259 --> 00:24:56,628
point being when I'm actually present I

580
00:24:53,128 --> 00:24:58,648
would be able to think of such things

581
00:24:56,628 --> 00:25:01,579
and there you go so we've got

582
00:24:58,648 --> 00:25:04,798
essentially this happening oops

583
00:25:01,579 --> 00:25:06,949
- and - right

584
00:25:04,798 --> 00:25:09,929
just we want to square root one minus

585
00:25:06,950 --> 00:25:12,450
the the square of the X minus square of

586
00:25:09,929 --> 00:25:16,169
the Y that's our NZ so then we've got

587
00:25:12,450 --> 00:25:20,100
our normal and we know that our normal

588
00:25:16,169 --> 00:25:22,109
is just NX + y + Z all right so now

589
00:25:20,099 --> 00:25:24,689
those values all range from negative 1

590
00:25:22,108 --> 00:25:26,099
to 1 obviously our NZ never points

591
00:25:24,690 --> 00:25:27,330
backwards because like we said we don't

592
00:25:26,099 --> 00:25:28,980
ever really point backwards so

593
00:25:27,329 --> 00:25:30,618
technically and only red ranges from 0

594
00:25:28,980 --> 00:25:33,720
to 1 but we're kind of ignoring that

595
00:25:30,618 --> 00:25:35,668
aspect at the moment so then we got to

596
00:25:33,720 --> 00:25:37,379
pack those in here we pack those in here

597
00:25:35,669 --> 00:25:39,090
by first changing them into the range of

598
00:25:37,378 --> 00:25:40,949
0 to 1 and then multiplying by 255 which

599
00:25:39,089 --> 00:25:43,499
should do the trick and then we go ahead

600
00:25:40,950 --> 00:25:47,129
and and put that roughness value in

601
00:25:43,499 --> 00:25:50,019
there at the end that should just about

602
00:25:47,128 --> 00:25:53,019
do it we do the truncation and

603
00:25:50,019 --> 00:25:54,879
shifting to put the ALF at the top which

604
00:25:53,019 --> 00:25:57,129
is really our roughness and then we have

605
00:25:54,880 --> 00:26:01,240
the our G's and B's value now that

606
00:25:57,130 --> 00:26:04,540
packing is not probably what we really

607
00:26:01,240 --> 00:26:08,079
want to see right you know if we think

608
00:26:04,539 --> 00:26:09,940
about this when we do our unpack it's

609
00:26:08,079 --> 00:26:11,829
gonna unpack is that I'm gonna unpack

610
00:26:09,940 --> 00:26:21,789
into the proper order just want to make

611
00:26:11,829 --> 00:26:26,169
sure here where's our unpack unpack that

612
00:26:21,789 --> 00:26:27,819
unpack is is actually reproducing it

613
00:26:26,170 --> 00:26:30,160
properly so that's that's okay so we're

614
00:26:27,819 --> 00:26:31,659
good so that's fine so let's see if

615
00:26:30,160 --> 00:26:34,240
we're getting any closer to having

616
00:26:31,660 --> 00:26:37,330
actual normals coming out here that are

617
00:26:34,240 --> 00:26:38,920
actually usable I hope I still have yeah

618
00:26:37,329 --> 00:26:40,808
okay I hope I still have my break points

619
00:26:38,920 --> 00:26:44,320
out there so let's see what these

620
00:26:40,808 --> 00:26:46,029
normals are let's see what these normals

621
00:26:44,319 --> 00:26:48,970
are I still like two to five two five

622
00:26:46,029 --> 00:26:51,308
zero why are we having that as our

623
00:26:48,970 --> 00:26:53,860
values that doesn't make a whole lot of

624
00:26:51,308 --> 00:26:55,690
sense to me oh right

625
00:26:53,859 --> 00:26:57,419
that is one other thing we that that's

626
00:26:55,690 --> 00:27:01,840
the other problem that we had before

627
00:26:57,420 --> 00:27:02,890
which is that we have to sort of take

628
00:27:01,839 --> 00:27:05,349
into account the fact that we're

629
00:27:02,890 --> 00:27:07,540
sometimes off the sphere so you know

630
00:27:05,349 --> 00:27:08,919
when we're drawing this guy since we're

631
00:27:07,539 --> 00:27:10,720
filling the whole bitmap we're gonna be

632
00:27:08,920 --> 00:27:14,230
filling values in that are actually over

633
00:27:10,720 --> 00:27:16,299
here so we're probably gonna want to

634
00:27:14,230 --> 00:27:19,058
make up something reasonable for these

635
00:27:16,299 --> 00:27:21,279
guys what we could do is say anything in

636
00:27:19,058 --> 00:27:22,690
here just points like straight up or

637
00:27:21,279 --> 00:27:26,379
something right

638
00:27:22,690 --> 00:27:28,029
so it's zero zero one let's say again

639
00:27:26,380 --> 00:27:29,230
there's really not I mean I guess you

640
00:27:28,029 --> 00:27:30,789
know what the other thing we could do is

641
00:27:29,230 --> 00:27:33,220
just say it's just whatever the closest

642
00:27:30,789 --> 00:27:35,879
value was on the sphere right that's the

643
00:27:33,220 --> 00:27:38,259
other thing we could do that seems

644
00:27:35,880 --> 00:27:41,710
somewhat reasonable so what we can do is

645
00:27:38,259 --> 00:27:44,490
say oh you know what let's take this and

646
00:27:41,710 --> 00:27:47,620
we'll say this is our root term right

647
00:27:44,490 --> 00:27:49,900
and so there's our root term and so you

648
00:27:47,619 --> 00:27:54,189
know once this gets up to the point

649
00:27:49,900 --> 00:27:56,970
where it's going to be greater than than

650
00:27:54,190 --> 00:28:00,980
one so the root term goes negative right

651
00:27:56,970 --> 00:28:09,430
so you know the case where

652
00:28:00,980 --> 00:28:09,430
the case where MZ will say if root term

653
00:28:10,089 --> 00:28:16,809
is greater than or equal to zero then we

654
00:28:12,650 --> 00:28:16,810
can actually do this properly right

655
00:28:22,660 --> 00:28:27,820
because the square root will actually be

656
00:28:24,799 --> 00:28:27,819
somewhat defined

657
00:28:27,940 --> 00:28:33,710
but once we get to to the place where it

658
00:28:32,359 --> 00:28:34,969
would go negative we would be in

659
00:28:33,710 --> 00:28:38,269
imaginary numbers which would not be

660
00:28:34,970 --> 00:28:40,850
good so what we want to do is is replace

661
00:28:38,269 --> 00:28:42,379
it with something more useful and in

662
00:28:40,849 --> 00:28:44,750
fact that I might actually argue that

663
00:28:42,380 --> 00:28:48,170
what I what I should do I guess we'll do

664
00:28:44,750 --> 00:28:50,480
it like this first but we might do

665
00:28:48,170 --> 00:28:52,789
something a little bit fancier later so

666
00:28:50,480 --> 00:28:55,460
there so basically what we do is we say

667
00:28:52,789 --> 00:28:57,200
all right we'll compute this using the

668
00:28:55,460 --> 00:28:58,400
square root method assuming that we're

669
00:28:57,200 --> 00:28:59,690
on the sphere if we're not on the sphere

670
00:28:58,400 --> 00:29:01,910
we'll just assume that it just points up

671
00:28:59,690 --> 00:29:03,110
for now but we probably want to do a

672
00:29:01,910 --> 00:29:05,750
little something different later if we

673
00:29:03,109 --> 00:29:07,459
ever wanted to use these four things so

674
00:29:05,750 --> 00:29:09,589
let's go ahead and see if that helped at

675
00:29:07,460 --> 00:29:11,059
all in terms of dealing with they're out

676
00:29:09,589 --> 00:29:13,189
of bounds and there we go those are much

677
00:29:11,059 --> 00:29:14,359
more reasonable so those are zero zero

678
00:29:13,190 --> 00:29:16,970
one which is exactly what I would have

679
00:29:14,359 --> 00:29:18,319
expected them to be at that point when

680
00:29:16,970 --> 00:29:19,640
we do the lerp we should get a

681
00:29:18,319 --> 00:29:20,629
reasonable result back course these are

682
00:29:19,640 --> 00:29:23,420
all the same so you should have done the

683
00:29:20,630 --> 00:29:25,910
same thing back and then when we take

684
00:29:23,420 --> 00:29:27,650
our normal and we unbias and scale it

685
00:29:25,910 --> 00:29:29,180
hopefully it will produce what we think

686
00:29:27,650 --> 00:29:32,090
it will should produce which is zero

687
00:29:29,180 --> 00:29:36,200
zero one which is roughly what it did so

688
00:29:32,089 --> 00:29:40,839
that's good although I wonder why we've

689
00:29:36,200 --> 00:29:43,910
kind of want 128 to map exactly to that

690
00:29:40,839 --> 00:29:47,509
so we should probably take a look at

691
00:29:43,910 --> 00:29:50,509
that I think anyway let's take a look at

692
00:29:47,509 --> 00:29:52,109
what that looks like first just for for

693
00:29:50,509 --> 00:30:00,390
starters here

694
00:29:52,109 --> 00:30:01,889
oops there we go so that's not though so

695
00:30:00,390 --> 00:30:05,809
now we're still we're getting basically

696
00:30:01,890 --> 00:30:08,700
nothing is ever inside for some reason

697
00:30:05,808 --> 00:30:12,240
which is a little bit odd like why are

698
00:30:08,700 --> 00:30:14,278
we we're never getting any any

699
00:30:12,240 --> 00:30:15,720
reasonable values in there we're just

700
00:30:14,278 --> 00:30:17,819
getting pointing straight up right

701
00:30:15,720 --> 00:30:19,500
that's all we're ever singing which

702
00:30:17,819 --> 00:30:22,009
seems odd to me I'm not sure why we're

703
00:30:19,500 --> 00:30:26,519
we're always filling in that same value

704
00:30:22,009 --> 00:30:28,558
we do do the root term here where we're

705
00:30:26,519 --> 00:30:30,599
saying 1.0 minus an x + y a-- that

706
00:30:28,558 --> 00:30:33,298
should be you know that should be

707
00:30:30,599 --> 00:30:40,019
computing that at least sometimes let's

708
00:30:33,298 --> 00:30:43,038
take a look at why that is yeah so we're

709
00:30:40,019 --> 00:30:48,769
never actually getting that value okay

710
00:30:43,038 --> 00:30:48,769
let's let's switch back in there

711
00:30:53,950 --> 00:31:05,980
all right could we run please thank you

712
00:30:58,829 --> 00:31:09,189
so taking a look at these values n x and

713
00:31:05,980 --> 00:31:11,380
y both negative 1 that's what I would

714
00:31:09,190 --> 00:31:14,460
expect totally reasonable

715
00:31:11,380 --> 00:31:20,130
let's bitmap you V should be 0 0 right

716
00:31:14,460 --> 00:31:20,130
and it is so as we walk through here

717
00:31:23,970 --> 00:31:41,730
what that doesn't make any sense to me

718
00:31:36,509 --> 00:31:45,099
why is that negative man

719
00:31:41,730 --> 00:31:46,599
yesterday's code was awful I feel like

720
00:31:45,099 --> 00:31:48,459
this should have been shown this should

721
00:31:46,599 --> 00:31:50,859
have been like on the stream this the

722
00:31:48,460 --> 00:31:52,419
entire time yesterday just like it

723
00:31:50,859 --> 00:31:55,058
should have been it should have been the

724
00:31:52,419 --> 00:31:57,940
owl sitting there the entire time

725
00:31:55,058 --> 00:32:00,970
Howie this is just ridiculous that's not

726
00:31:57,940 --> 00:32:05,110
okay like how did that get there this

727
00:32:00,970 --> 00:32:08,230
should be that right I mean that doesn't

728
00:32:05,109 --> 00:32:09,579
make any sense that man when you're when

729
00:32:08,230 --> 00:32:12,519
you're not with it you're not with it

730
00:32:09,579 --> 00:32:15,490
that's just absurd alright let's try

731
00:32:12,519 --> 00:32:18,069
that one more time okay that looks a lot

732
00:32:15,490 --> 00:32:20,970
more like a normal map so I think we're

733
00:32:18,069 --> 00:32:23,470
we're getting back into a more

734
00:32:20,970 --> 00:32:25,210
reasonable space here if you will

735
00:32:23,470 --> 00:32:28,440
looks a little janky so I think we've

736
00:32:25,210 --> 00:32:31,690
probably got some stuff we still need to

737
00:32:28,440 --> 00:32:35,230
work out but point being we're at least

738
00:32:31,690 --> 00:32:39,429
in in you know territory that's not

739
00:32:35,230 --> 00:32:43,659
totally absurd so that's good so you

740
00:32:39,429 --> 00:32:45,429
know it's baby steps anyway so there's

741
00:32:43,659 --> 00:32:46,539
are they're sort of our known weapon and

742
00:32:45,429 --> 00:32:50,169
this is what we would expect to see

743
00:32:46,538 --> 00:32:52,210
right in fact we we probably we could

744
00:32:50,169 --> 00:32:56,169
just for the sake of drawing it we could

745
00:32:52,210 --> 00:32:58,360
actually rebuy us and scale it you know

746
00:32:56,169 --> 00:33:00,940
if you will inside the render group

747
00:32:58,359 --> 00:33:03,219
where we're outputting it as the color

748
00:33:00,940 --> 00:33:04,179
we could actually view something where

749
00:33:03,220 --> 00:33:06,710
we say all right

750
00:33:04,179 --> 00:33:09,210
don't actually

751
00:33:06,710 --> 00:33:12,120
you know don't actually draw it in the

752
00:33:09,210 --> 00:33:17,370
negative one to one range boost it up a

753
00:33:12,119 --> 00:33:23,729
bit so multiply this by by you know 2.0

754
00:33:17,369 --> 00:33:26,758
and and add one to it I'm sorry by 0.5

755
00:33:23,730 --> 00:33:29,720
and add 0.5 to it just to get it back

756
00:33:26,759 --> 00:33:31,740
into the valid range of colors so

757
00:33:29,720 --> 00:33:33,450
basically we can see that you know in

758
00:33:31,740 --> 00:33:35,730
and out where we're actually getting the

759
00:33:33,450 --> 00:33:38,278
the proper stuff right and and that

760
00:33:35,730 --> 00:33:40,259
looks about right so you can kind of see

761
00:33:38,278 --> 00:33:44,250
how you get like the amount of red

762
00:33:40,259 --> 00:33:47,190
increases as you come over this way the

763
00:33:44,250 --> 00:33:51,298
amount of green increases as you come

764
00:33:47,190 --> 00:33:53,820
down and so on and you know that's just

765
00:33:51,298 --> 00:33:55,470
that's just more of a sensical that's

766
00:33:53,819 --> 00:33:59,548
that's more of a sensible thing you can

767
00:33:55,470 --> 00:34:01,558
kind of see how it looks like either our

768
00:33:59,548 --> 00:34:04,408
lerp is not quite right or something

769
00:34:01,558 --> 00:34:06,388
we're getting some weird like like it it

770
00:34:04,409 --> 00:34:10,559
feels like we've done something slightly

771
00:34:06,388 --> 00:34:13,409
incorrect somewhere in here and I'm not

772
00:34:10,559 --> 00:34:15,750
exactly sure where so I feel like we

773
00:34:13,409 --> 00:34:16,800
kind of want to take a look at what's

774
00:34:15,750 --> 00:34:18,510
going on in there a little bit more

775
00:34:16,800 --> 00:34:21,329
careful okay like we shouldn't be having

776
00:34:18,510 --> 00:34:24,329
so much Genki 'no stare now if I turn

777
00:34:21,329 --> 00:34:27,659
off the normal mapping if I just get rid

778
00:34:24,329 --> 00:34:29,818
of this entirely you know my tree I

779
00:34:27,659 --> 00:34:33,088
guess it might be hard to see if the

780
00:34:29,818 --> 00:34:35,159
tree was janky right because I mean it's

781
00:34:33,088 --> 00:34:37,739
not as clean as this is so maybe

782
00:34:35,159 --> 00:34:39,929
wouldn't necessarily show maybe what we

783
00:34:37,739 --> 00:34:41,368
should do is instead of using that tree

784
00:34:39,929 --> 00:34:44,220
maybe we should use something that's a

785
00:34:41,369 --> 00:34:45,690
very well-defined shape for testing

786
00:34:44,219 --> 00:34:48,418
purposes that seems like a very

787
00:34:45,690 --> 00:34:51,358
plausible thing to do just somethin

788
00:34:48,418 --> 00:34:54,769
think about but I'm kind of interested

789
00:34:51,358 --> 00:34:56,940
to know like is it well you know what

790
00:34:54,769 --> 00:35:00,329
one thing I could do pretty pretty

791
00:34:56,940 --> 00:35:04,530
trivially here right is if I go back in

792
00:35:00,329 --> 00:35:08,300
here and I say all right we've got the

793
00:35:04,530 --> 00:35:11,730
tree if I was to just say draw the tree

794
00:35:08,300 --> 00:35:13,560
normal without you know just pretend as

795
00:35:11,730 --> 00:35:18,119
a texture map what does that look like

796
00:35:13,559 --> 00:35:19,460
right and so here's what that looks like

797
00:35:18,119 --> 00:35:24,108
and

798
00:35:19,460 --> 00:35:26,568
yeah I mean even looking at obviously

799
00:35:24,108 --> 00:35:28,880
it's doing sRGB weirdness stuff I'm not

800
00:35:26,568 --> 00:35:31,550
sure why this would be yellow exactly I

801
00:35:28,880 --> 00:35:33,890
have to think about that oh because it's

802
00:35:31,550 --> 00:35:36,230
it's 128 is the is the zero value but

803
00:35:33,889 --> 00:35:41,239
you can see that the edges are not all

804
00:35:36,230 --> 00:35:44,690
janky as well so I'm just I'm curious as

805
00:35:41,239 --> 00:35:47,118
to what why our sampling was so weird on

806
00:35:44,690 --> 00:35:50,480
the normal map I feel like it should

807
00:35:47,119 --> 00:35:53,210
have not been so not been so odd right

808
00:35:50,480 --> 00:35:55,130
so I feel like we've got to maybe do a

809
00:35:53,210 --> 00:35:56,960
little looking at that coach to make

810
00:35:55,130 --> 00:35:59,150
sure there isn't something really

811
00:35:56,960 --> 00:36:02,990
strange happening as to why it looks so

812
00:35:59,150 --> 00:36:05,389
weirdly banded like that basically so

813
00:36:02,989 --> 00:36:08,149
when we do our lookups here we're doing

814
00:36:05,389 --> 00:36:11,719
the lookups in the normal map the exact

815
00:36:08,150 --> 00:36:15,200
same way that we're doing them in in

816
00:36:11,719 --> 00:36:17,118
sort of the for further regular texels

817
00:36:15,199 --> 00:36:20,000
right I mean there's really nothing this

818
00:36:17,119 --> 00:36:24,740
is the exact same code right ah there we

819
00:36:20,000 --> 00:36:26,269
go again Scott basically today is just

820
00:36:24,739 --> 00:36:29,419
fixing all of the bugs that were in

821
00:36:26,269 --> 00:36:31,039
yesterday's code so hey big surprise you

822
00:36:29,420 --> 00:36:33,019
get the pitch wrong you sample out of

823
00:36:31,039 --> 00:36:34,608
the wrong place in the texture so there

824
00:36:33,019 --> 00:36:37,219
we go there's our normal map and that's

825
00:36:34,608 --> 00:36:38,808
better and we could actually we could

826
00:36:37,219 --> 00:36:39,889
probably turn this into a function to

827
00:36:38,809 --> 00:36:42,500
just to make it a little less

828
00:36:39,889 --> 00:36:47,150
error-prone right we could say okay

829
00:36:42,500 --> 00:36:49,338
we've got an inline gear which is you

830
00:36:47,150 --> 00:36:52,160
know something that takes a bilinear

831
00:36:49,338 --> 00:36:56,179
sample so it's like you know bilinear

832
00:36:52,159 --> 00:36:59,118
sample from one of these loaded bitmaps

833
00:36:56,179 --> 00:37:02,269
right so we have a loaded bitmap that

834
00:36:59,119 --> 00:37:06,980
you pass in and that's the texture and

835
00:37:02,269 --> 00:37:09,759
then we have you know an x and a y right

836
00:37:06,980 --> 00:37:13,338
x and y that you wanted to sample that

837
00:37:09,760 --> 00:37:15,770
we can then do all of these samples

838
00:37:13,338 --> 00:37:17,808
together and we could just return those

839
00:37:15,769 --> 00:37:23,150
you know in a little struct that was

840
00:37:17,809 --> 00:37:26,210
like a bilinear sample right like so

841
00:37:23,150 --> 00:37:30,440
and so we could just say ABCD like we

842
00:37:26,210 --> 00:37:36,309
did before and we'll just do this result

843
00:37:30,440 --> 00:37:44,510
that a result dot B result dot C so

844
00:37:36,309 --> 00:37:50,000
you'll be returned results so that is

845
00:37:44,510 --> 00:37:50,330
that so let's take a look there there we

846
00:37:50,000 --> 00:37:51,980
go

847
00:37:50,329 --> 00:37:54,559
I'm gonna go ahead and change these guys

848
00:37:51,980 --> 00:38:04,119
over to that so I'll do bilinear sample

849
00:37:54,559 --> 00:38:04,119
Texel sample something like that no no

850
00:38:06,280 --> 00:38:14,930
yeah call it by Texel or now Texas

851
00:38:13,070 --> 00:38:17,269
samples good alright so we'll do Texas

852
00:38:14,929 --> 00:38:19,969
sample we want to do that

853
00:38:17,269 --> 00:38:23,480
by linear sample of the texture X and

854
00:38:19,969 --> 00:38:25,159
the y like so and then in theory we

855
00:38:23,480 --> 00:38:30,880
should just now be able to do Texel

856
00:38:25,159 --> 00:38:34,699
sample a textile sample B Texas sample C

857
00:38:30,880 --> 00:38:38,869
like so sample D right everything's good

858
00:38:34,699 --> 00:38:41,839
and then we can do that here as well so

859
00:38:38,869 --> 00:38:44,599
we got by linear sample normal sample by

860
00:38:41,840 --> 00:38:48,410
winning your sample grab that oops

861
00:38:44,599 --> 00:38:51,849
grab that normal map out go ahead and

862
00:38:48,409 --> 00:38:55,909
get the X and the y same thing and that

863
00:38:51,849 --> 00:39:04,429
should be it right just do a normal

864
00:38:55,909 --> 00:39:10,309
sample a normal sample B from a sample C

865
00:39:04,429 --> 00:39:13,849
and normal sample D ok so now we are

866
00:39:10,309 --> 00:39:16,369
back to reasonable here I think at least

867
00:39:13,849 --> 00:39:18,980
somewhat reasonable it does kind of look

868
00:39:16,369 --> 00:39:21,619
a little odd like it feels like it's a

869
00:39:18,980 --> 00:39:23,929
little clip to potentially so something

870
00:39:21,619 --> 00:39:26,230
else I don't know if we want to look at

871
00:39:23,929 --> 00:39:32,149
a little more carefully but point being

872
00:39:26,230 --> 00:39:36,230
so if we now go ahead and switch back to

873
00:39:32,150 --> 00:39:37,970
this path we would see our sort of

874
00:39:36,230 --> 00:39:40,608
normal map kind of color stuff

875
00:39:37,969 --> 00:39:41,929
modulating against the tree so we know

876
00:39:40,608 --> 00:39:44,750
that both of them are getting sampled

877
00:39:41,929 --> 00:39:46,279
relatively correctly so that's good all

878
00:39:44,750 --> 00:39:47,719
right so I think we're in better shape

879
00:39:46,280 --> 00:39:50,630
now we can actually start to do

880
00:39:47,719 --> 00:39:52,069
something here so the next thing that we

881
00:39:50,630 --> 00:39:53,630
kind of need to figure out is what we're

882
00:39:52,070 --> 00:39:56,300
gonna do with these environment maps

883
00:39:53,630 --> 00:39:59,030
right because we need to pass something

884
00:39:56,300 --> 00:40:01,310
in there so that we could sample them

885
00:39:59,030 --> 00:40:03,590
right and we also have to kind of figure

886
00:40:01,309 --> 00:40:05,869
out how we want to modulate them in

887
00:40:03,590 --> 00:40:08,480
right we have to decide what we want to

888
00:40:05,869 --> 00:40:10,340
do in terms of actually producing the

889
00:40:08,480 --> 00:40:13,039
colors here now what we could do is just

890
00:40:10,340 --> 00:40:15,108
say that we add them together and that

891
00:40:13,039 --> 00:40:16,909
might be reasonable I don't know I mean

892
00:40:15,108 --> 00:40:18,380
we you know we could say this sort of

893
00:40:16,909 --> 00:40:22,699
thing we just add however much life

894
00:40:18,380 --> 00:40:25,608
there is to whatever's there you know at

895
00:40:22,699 --> 00:40:27,379
the moment and obviously you know we

896
00:40:25,608 --> 00:40:30,858
would want to make it so it would not

897
00:40:27,380 --> 00:40:33,260
overflow so for a lot of these we'd have

898
00:40:30,858 --> 00:40:35,719
to actually clamp them right we'd have

899
00:40:33,260 --> 00:40:38,330
to go ahead and take after we were done

900
00:40:35,719 --> 00:40:42,079
we'd have to to clamp all of the values

901
00:40:38,329 --> 00:40:50,509
right so our our would have to be

902
00:40:42,079 --> 00:40:52,250
clamped zero to one so there we go so if

903
00:40:50,510 --> 00:40:54,890
we add the light in you know that's

904
00:40:52,250 --> 00:40:59,150
that's what we're looking at also

905
00:40:54,889 --> 00:41:01,849
obviously we well actually I guess so we

906
00:40:59,150 --> 00:41:04,039
have another problem here which is that

907
00:41:01,849 --> 00:41:06,409
the light color this is all

908
00:41:04,039 --> 00:41:08,210
premultiplied alpha so our light color

909
00:41:06,409 --> 00:41:11,329
whatever we grab out of the light color

910
00:41:08,210 --> 00:41:14,809
is going to have to be multiplied by the

911
00:41:11,329 --> 00:41:17,029
texels a value right because the texels

912
00:41:14,809 --> 00:41:19,429
a value is what actually we're expecting

913
00:41:17,030 --> 00:41:23,109
everything to be pre x so that's one

914
00:41:19,429 --> 00:41:26,089
more thing that we have to do right so

915
00:41:23,108 --> 00:41:28,250
now we have our thing which is lit by

916
00:41:26,090 --> 00:41:29,900
our normal map but our normal maps not

917
00:41:28,250 --> 00:41:31,670
actually gathering any light values so

918
00:41:29,900 --> 00:41:36,440
we're literally just using the values

919
00:41:31,670 --> 00:41:38,269
that are in that that normal map itself

920
00:41:36,440 --> 00:41:41,240
to do the lighting which is pretty

921
00:41:38,269 --> 00:41:43,009
useless right to say the very least so

922
00:41:41,239 --> 00:41:45,559
we want to do now is we want to go ahead

923
00:41:43,010 --> 00:41:49,160
and actually try to grab that lighting

924
00:41:45,559 --> 00:41:51,500
out of something right

925
00:41:49,159 --> 00:41:53,480
so so we got to start tackling our map

926
00:41:51,500 --> 00:41:55,369
stuff let's take a look at here that's

927
00:41:53,480 --> 00:42:02,199
sort of what we had yesterday we did the

928
00:41:55,369 --> 00:42:08,329
unscalable enormo so that's all good hmm

929
00:42:02,199 --> 00:42:10,339
excuse me we then we're saying we're

930
00:42:08,329 --> 00:42:12,559
gonna see which n vac we were using by

931
00:42:10,340 --> 00:42:14,960
grabbing the normal Z but like I say

932
00:42:12,559 --> 00:42:18,469
it's really the normal Y that we want to

933
00:42:14,960 --> 00:42:20,210
use for that not the normal Z the normal

934
00:42:18,469 --> 00:42:22,489
Y is what tells us where we are and now

935
00:42:20,210 --> 00:42:25,250
of course the normal Y actually goes

936
00:42:22,489 --> 00:42:28,189
between negative 1 and 1 and so this

937
00:42:25,250 --> 00:42:32,539
testing is not actually at all what we

938
00:42:28,190 --> 00:42:34,849
would want it to be I think right we

939
00:42:32,539 --> 00:42:36,710
probably want something more like this

940
00:42:34,849 --> 00:42:38,839
again this is yesterday's code which is

941
00:42:36,710 --> 00:42:41,119
all awful that's the that's what we've

942
00:42:38,840 --> 00:42:42,970
pretty much learned so we want to do is

943
00:42:41,119 --> 00:42:45,049
say you know whatever the the actual

944
00:42:42,969 --> 00:42:46,339
pointing value is that we choose to use

945
00:42:45,050 --> 00:42:47,690
and like I said we'll probably have

946
00:42:46,340 --> 00:42:50,300
multiple modes that pick from different

947
00:42:47,690 --> 00:42:53,119
values here but whatever we choose to

948
00:42:50,300 --> 00:42:57,110
use we say okay we've got the T and map

949
00:42:53,119 --> 00:42:59,359
if that's less than then then the

950
00:42:57,110 --> 00:43:04,519
negative 0.5 then we're going to sample

951
00:42:59,360 --> 00:43:06,440
from that bottom map and if it's if it's

952
00:43:04,519 --> 00:43:08,090
greater than 0.5 then we're gonna step

953
00:43:06,440 --> 00:43:10,550
it from that top map we then need to

954
00:43:08,090 --> 00:43:14,870
produce how much we want to blend in

955
00:43:10,550 --> 00:43:16,250
that top map and an bottom map so for

956
00:43:14,869 --> 00:43:17,989
the bottom map if it's less than

957
00:43:16,250 --> 00:43:23,119
negative 0.5 that means it's ranging

958
00:43:17,989 --> 00:43:24,589
from 1.0 to 0.5 right so in order to

959
00:43:23,119 --> 00:43:28,099
figure out what we actually want to do

960
00:43:24,590 --> 00:43:31,820
we need to take the M map and we need to

961
00:43:28,099 --> 00:43:35,329
you know base it off of that bottom

962
00:43:31,820 --> 00:43:38,440
value that negative 1.0 value right so

963
00:43:35,329 --> 00:43:41,630
it's subtracting negative 0.1 or adding

964
00:43:38,440 --> 00:43:43,970
1.0 and then we need to divide it by its

965
00:43:41,630 --> 00:43:47,119
total range which is just the the 0.5

966
00:43:43,969 --> 00:43:50,689
right so that way like I said if it's

967
00:43:47,119 --> 00:43:52,609
negative 1 we just end up with 0 if it's

968
00:43:50,690 --> 00:43:57,019
negative 0.5 which is the maximum it

969
00:43:52,610 --> 00:43:57,760
could be then it'll just be 1 the T for

970
00:43:57,019 --> 00:44:01,119
our map will be

971
00:43:57,760 --> 00:44:04,640
so similar we come and cured a TM map

972
00:44:01,119 --> 00:44:07,130
greater than 0.5 so again same exact

973
00:44:04,639 --> 00:44:10,250
math right we want to subtract where it

974
00:44:07,130 --> 00:44:13,519
starts from essentially from it so now

975
00:44:10,250 --> 00:44:15,880
it's ranging from 0 to 0.5 and then we

976
00:44:13,519 --> 00:44:21,019
just again divide by that point 5 right

977
00:44:15,880 --> 00:44:24,710
so that should be it I would think of

978
00:44:21,019 --> 00:44:28,699
course dividing by 0.5 is the same as

979
00:44:24,710 --> 00:44:32,869
multiplying by 2 so we could just save

980
00:44:28,699 --> 00:44:36,108
ourselves trouble right and do it this

981
00:44:32,869 --> 00:44:37,550
way but that should give us that should

982
00:44:36,108 --> 00:44:39,980
give us what we want right that should

983
00:44:37,550 --> 00:44:42,410
give us what we're looking for we then

984
00:44:39,980 --> 00:44:45,079
go ahead and do our sampling and we

985
00:44:42,409 --> 00:44:46,759
sample at least one of these guys if we

986
00:44:45,079 --> 00:44:48,409
ended up picking one of these far Maps

987
00:44:46,760 --> 00:44:50,450
the top or the bottom that we want to

988
00:44:48,409 --> 00:44:52,670
contribute in there then we go ahead and

989
00:44:50,449 --> 00:44:56,838
do our sampling for that as well right

990
00:44:52,670 --> 00:45:01,180
so to do that sampling we were passing

991
00:44:56,838 --> 00:45:06,500
the normal X Y Z it's a little unclear

992
00:45:01,179 --> 00:45:07,730
if that's really what we want we kind of

993
00:45:06,500 --> 00:45:11,150
have to think about this a little bit

994
00:45:07,730 --> 00:45:13,099
because again like the X the Y and the Z

995
00:45:11,150 --> 00:45:14,838
what do they really mean I guess we can

996
00:45:13,099 --> 00:45:16,760
pass into the sample environment map

997
00:45:14,838 --> 00:45:19,900
this way and have sample environment map

998
00:45:16,760 --> 00:45:21,910
kind of know what they mean but

999
00:45:19,900 --> 00:45:26,320
it's just one of those things where it's

1000
00:45:21,909 --> 00:45:27,670
a little confusing right so let's think

1001
00:45:26,320 --> 00:45:31,090
about this for a second because now we

1002
00:45:27,670 --> 00:45:36,880
actually have to do this math here what

1003
00:45:31,090 --> 00:45:39,220
we essentially have is we have we have a

1004
00:45:36,880 --> 00:45:42,369
circumstance where we're looking at a

1005
00:45:39,219 --> 00:45:43,779
point in the world and we've essentially

1006
00:45:42,369 --> 00:45:45,759
turned these into barycentric

1007
00:45:43,780 --> 00:45:49,769
coordinates right we're essentially

1008
00:45:45,760 --> 00:45:53,200
looking at something because I wanted

1009
00:45:49,769 --> 00:45:56,050
we've got our screen space UV which is

1010
00:45:53,199 --> 00:45:58,389
sort of telling a you know it's it's

1011
00:45:56,050 --> 00:46:00,519
telling us where we are versus our

1012
00:45:58,389 --> 00:46:03,190
environment Maps right so it's kind of

1013
00:46:00,519 --> 00:46:06,699
telling us like okay you know if it was

1014
00:46:03,190 --> 00:46:10,059
here then maybe that's a point too right

1015
00:46:06,699 --> 00:46:11,529
maybe this is 0.2 and that's like 0.8 or

1016
00:46:10,059 --> 00:46:13,090
something right

1017
00:46:11,530 --> 00:46:14,980
that's the screen space view screen

1018
00:46:13,090 --> 00:46:17,710
space V so we know we're like here and

1019
00:46:14,980 --> 00:46:21,369
then we have some normal which is

1020
00:46:17,710 --> 00:46:23,050
telling us you know in this sandwich you

1021
00:46:21,369 --> 00:46:26,829
know this is like the lowest layer of

1022
00:46:23,050 --> 00:46:28,210
our sandwich right let's say well I

1023
00:46:26,829 --> 00:46:32,860
guess it's really not it's the middle

1024
00:46:28,210 --> 00:46:34,659
layer right we've got here here so from

1025
00:46:32,860 --> 00:46:36,190
this point we then have a normal and

1026
00:46:34,659 --> 00:46:38,649
that normal is you know pointing in some

1027
00:46:36,190 --> 00:46:39,849
direction and so now what we need to do

1028
00:46:38,650 --> 00:46:41,650
is say okay

1029
00:46:39,849 --> 00:46:43,839
for the normal pointing in that

1030
00:46:41,650 --> 00:46:46,840
direction we need to figure out how we

1031
00:46:43,840 --> 00:46:49,360
want to do the intersection like we need

1032
00:46:46,840 --> 00:46:51,519
to figure out how to pick the point

1033
00:46:49,360 --> 00:46:53,289
where we were where we are looking at

1034
00:46:51,519 --> 00:46:55,900
you know in our environment map right

1035
00:46:53,289 --> 00:46:58,059
and essentially what I said before is

1036
00:46:55,900 --> 00:47:01,210
that maybe 0.5 we're basically choosing

1037
00:46:58,059 --> 00:47:05,199
a 45-degree I think well I guess that's

1038
00:47:01,210 --> 00:47:07,000
not entirely true if it's 0.5 then yeah

1039
00:47:05,199 --> 00:47:09,789
I mean basically what we're saying is

1040
00:47:07,000 --> 00:47:11,920
the deflection off of the Z is not going

1041
00:47:09,789 --> 00:47:14,110
to be more than 0.5 what to think about

1042
00:47:11,920 --> 00:47:16,420
what that actually is cone wise but

1043
00:47:14,110 --> 00:47:19,180
point being we sort of got a cone that

1044
00:47:16,420 --> 00:47:21,010
we're looking up in and a cone that

1045
00:47:19,179 --> 00:47:23,829
we're looking down in and we want to

1046
00:47:21,010 --> 00:47:25,990
produce like which pixel on the map we

1047
00:47:23,829 --> 00:47:27,849
would hit for each of the normal values

1048
00:47:25,989 --> 00:47:31,349
inside there and then when it comes out

1049
00:47:27,849 --> 00:47:33,929
and it's more a lateral we then are no

1050
00:47:31,349 --> 00:47:35,849
looking in that we are looking strictly

1051
00:47:33,929 --> 00:47:37,799
in this sort of middle plane where which

1052
00:47:35,849 --> 00:47:38,940
is kind of the problematic plane the one

1053
00:47:37,800 --> 00:47:41,280
where we don't really know what we're

1054
00:47:38,940 --> 00:47:42,510
gonna do about it so we've got to

1055
00:47:41,280 --> 00:47:43,769
environment types we've got the

1056
00:47:42,510 --> 00:47:45,600
environment type up here we've got the

1057
00:47:43,769 --> 00:47:46,860
umberto type down here we've got two of

1058
00:47:45,599 --> 00:47:48,659
those that are probably more

1059
00:47:46,860 --> 00:47:49,950
straightforward to answer and then the

1060
00:47:48,659 --> 00:47:55,799
one that's we don't really know we're in

1061
00:47:49,949 --> 00:47:58,769
deal with right so I think if I'm not

1062
00:47:55,800 --> 00:48:00,960
mistaken this middle sample here we

1063
00:47:58,769 --> 00:48:03,809
could just say for now if that middle

1064
00:48:00,960 --> 00:48:06,090
sample we know is is not happening right

1065
00:48:03,809 --> 00:48:08,070
we know that's not happening so assuming

1066
00:48:06,090 --> 00:48:11,940
that we actually have one of these farm

1067
00:48:08,070 --> 00:48:13,530
apps then we'll sample the farm app with

1068
00:48:11,940 --> 00:48:15,420
that and of course again since it's

1069
00:48:13,530 --> 00:48:16,920
yesterday's code it was garbage and it

1070
00:48:15,420 --> 00:48:19,769
wasn't even passing the actual map that

1071
00:48:16,920 --> 00:48:21,360
we picked but now it is and so we grab

1072
00:48:19,769 --> 00:48:24,800
that farm app out and then we actually

1073
00:48:21,360 --> 00:48:28,230
lurk between the colors based on on that

1074
00:48:24,800 --> 00:48:33,810
so what we need to do is make sample

1075
00:48:28,230 --> 00:48:35,610
environment map actually produce some

1076
00:48:33,809 --> 00:48:38,429
kind of value that we can use here right

1077
00:48:35,610 --> 00:48:40,650
so this up here so sample environment

1078
00:48:38,429 --> 00:48:42,559
map is going to produce it's going to

1079
00:48:40,650 --> 00:48:46,590
give us hopefully what we want

1080
00:48:42,559 --> 00:48:47,940
given some map that we have the first

1081
00:48:46,590 --> 00:48:49,500
thing I think we're going to do is take

1082
00:48:47,940 --> 00:48:52,320
the roughness out of the equation so

1083
00:48:49,500 --> 00:48:54,059
we'll say that we have logs here I'm

1084
00:48:52,320 --> 00:48:56,550
gonna get rid of this wit pipe power of

1085
00:48:54,059 --> 00:48:57,900
two stuff for now because we don't

1086
00:48:56,550 --> 00:49:00,180
actually care about it at the moment and

1087
00:48:57,900 --> 00:49:02,700
we'll just say that we have some number

1088
00:49:00,179 --> 00:49:04,889
of level of details here what I'm gonna

1089
00:49:02,699 --> 00:49:07,379
do is say okay whatever the roughness

1090
00:49:04,889 --> 00:49:09,659
level is that's what picks in into our

1091
00:49:07,380 --> 00:49:11,340
log levels and what we'll do is we'll

1092
00:49:09,659 --> 00:49:13,139
just set all the lot of levels to point

1093
00:49:11,340 --> 00:49:15,000
to the same bitmap at first so we kind

1094
00:49:13,139 --> 00:49:17,609
of take roughness out of the equation

1095
00:49:15,000 --> 00:49:20,610
right but it's pretty straightforward we

1096
00:49:17,610 --> 00:49:24,210
just say okay however many of those we

1097
00:49:20,610 --> 00:49:28,230
have write whatever this value is here

1098
00:49:24,210 --> 00:49:30,530
so the the map blog however many of

1099
00:49:28,230 --> 00:49:33,929
those we have we just want to

1100
00:49:30,530 --> 00:49:37,590
essentially quantize this this roughness

1101
00:49:33,929 --> 00:49:41,779
value to fall into one of those buckets

1102
00:49:37,590 --> 00:49:44,710
right and so what we're gonna do is say

1103
00:49:41,780 --> 00:49:46,960
and later we could

1104
00:49:44,710 --> 00:49:48,730
you know we could actually try to blend

1105
00:49:46,960 --> 00:49:49,630
between them if we if we really wanted

1106
00:49:48,730 --> 00:49:51,940
to as well

1107
00:49:49,630 --> 00:49:54,550
but anyway so what we want to do here is

1108
00:49:51,940 --> 00:49:56,530
say all right we take that roughness we

1109
00:49:54,550 --> 00:49:58,869
multiply it by the array count which

1110
00:49:56,530 --> 00:50:00,940
will give us back a number between you

1111
00:49:58,869 --> 00:50:02,950
know zero and whatever that level is

1112
00:50:00,940 --> 00:50:05,769
we'll do the rounding on it like before

1113
00:50:02,949 --> 00:50:08,858
right and we'll come up with you know an

1114
00:50:05,769 --> 00:50:10,858
integer roughness level here right so

1115
00:50:08,858 --> 00:50:14,348
this is our this is our roughness

1116
00:50:10,858 --> 00:50:16,750
integer right and or I guess we could

1117
00:50:14,349 --> 00:50:19,059
say our roughness index maybe are a lot

1118
00:50:16,750 --> 00:50:21,849
but it's called out a lot index right so

1119
00:50:19,059 --> 00:50:23,589
we do this and then we want to to cast

1120
00:50:21,849 --> 00:50:25,690
this guy down right so we want to say

1121
00:50:23,588 --> 00:50:28,210
whatever this guy was we are now going

1122
00:50:25,690 --> 00:50:30,639
to cast him down into the lot index and

1123
00:50:28,210 --> 00:50:33,849
then we can assert in here as well that

1124
00:50:30,639 --> 00:50:36,098
the lot index is always less than

1125
00:50:33,849 --> 00:50:37,539
whatever that array count was right so

1126
00:50:36,099 --> 00:50:42,039
we shouldn't ever be able to fetch

1127
00:50:37,539 --> 00:50:44,019
outside the array actually now that I

1128
00:50:42,039 --> 00:50:46,058
think about it this is actually supposed

1129
00:50:44,019 --> 00:50:53,889
to be array count minus 1 right because

1130
00:50:46,059 --> 00:50:58,750
we want produce 0 1 2 3 so ya think we

1131
00:50:53,889 --> 00:51:00,639
actually want to save that right makes

1132
00:50:58,750 --> 00:51:02,650
sense

1133
00:51:00,639 --> 00:51:05,588
so that gives us our lot index back and

1134
00:51:02,650 --> 00:51:07,510
then from there we can go ahead and grab

1135
00:51:05,588 --> 00:51:09,460
the law that we actually want so now

1136
00:51:07,510 --> 00:51:14,470
we've got a loaded bitmap and this is

1137
00:51:09,460 --> 00:51:18,720
our LOD so that's our map would be LOD

1138
00:51:14,469 --> 00:51:22,058
index oops so once we have that out

1139
00:51:18,719 --> 00:51:25,719
mm-hmm we can go ahead and take a

1140
00:51:22,059 --> 00:51:29,140
bilinear sample of that value right and

1141
00:51:25,719 --> 00:51:30,879
then actually compute whatever that

1142
00:51:29,139 --> 00:51:33,608
should be right so we can go ahead and

1143
00:51:30,880 --> 00:51:35,318
say you know we've got our LOD and so

1144
00:51:33,608 --> 00:51:38,199
now we just need to figure out what are

1145
00:51:35,318 --> 00:51:43,358
our texts our x and y coordinates will

1146
00:51:38,199 --> 00:51:44,558
be in the L in the map you know we can

1147
00:51:43,358 --> 00:51:46,328
take that bilinear sample

1148
00:51:44,559 --> 00:51:48,970
and once we have the sample then we can

1149
00:51:46,329 --> 00:51:50,980
actually do the loop on it right and

1150
00:51:48,969 --> 00:51:52,598
what we could do to here is say that you

1151
00:51:50,980 --> 00:51:53,230
know since we already know how all this

1152
00:51:52,599 --> 00:51:55,269
stuff works

1153
00:51:53,230 --> 00:51:57,519
we could also smack this down into a

1154
00:51:55,269 --> 00:51:58,389
thing which is that bilinear sample

1155
00:51:57,519 --> 00:51:59,860
could then

1156
00:51:58,389 --> 00:52:03,009
have a function that was like bilinear

1157
00:51:59,860 --> 00:52:06,130
blend so we could just say as well

1158
00:52:03,010 --> 00:52:08,470
bilinear blend here and then we just

1159
00:52:06,130 --> 00:52:12,610
kind of grab all this stuff up and say

1160
00:52:08,469 --> 00:52:18,849
that our textile sample can do that sRGB

1161
00:52:12,610 --> 00:52:22,390
bilinear blend let's say right that and

1162
00:52:18,849 --> 00:52:25,809
this will basically do srgb bilinear

1163
00:52:22,389 --> 00:52:27,489
blend that'll take a textile sample and

1164
00:52:25,809 --> 00:52:31,029
basically do all of the stuff it needs

1165
00:52:27,489 --> 00:52:32,139
to do to do the alert right so that's

1166
00:52:31,030 --> 00:52:44,200
kind of cool because then we can just

1167
00:52:32,139 --> 00:52:47,349
say bilinear sample sample so and right

1168
00:52:44,199 --> 00:52:50,349
we need the to the F X F Y values so

1169
00:52:47,349 --> 00:52:59,110
those are the percentage off that you

1170
00:52:50,349 --> 00:53:04,210
are so we need the FX and FY now we're

1171
00:52:59,110 --> 00:53:05,800
back to this so when we do this again we

1172
00:53:04,210 --> 00:53:08,139
would have to do to produce the actual

1173
00:53:05,800 --> 00:53:11,050
color in fact I guess I get rid of that

1174
00:53:08,139 --> 00:53:14,170
and say that the result it's going to be

1175
00:53:11,050 --> 00:53:16,930
equal to that srgb bilinear blend of

1176
00:53:14,170 --> 00:53:18,940
course it's only it's only part of it we

1177
00:53:16,929 --> 00:53:22,799
don't actually use the Alpha component

1178
00:53:18,940 --> 00:53:26,650
rank so it's really just that much of it

1179
00:53:22,800 --> 00:53:28,390
but there's our sample and so really all

1180
00:53:26,650 --> 00:53:30,309
we need to do is actually do that

1181
00:53:28,389 --> 00:53:33,250
intersection math now right we actually

1182
00:53:30,309 --> 00:53:36,219
need to figure out how we're going to to

1183
00:53:33,250 --> 00:53:38,530
intersect it once we do that we should

1184
00:53:36,219 --> 00:53:41,669
be just about done this guy has to

1185
00:53:38,530 --> 00:53:44,650
actually take the FX FY as well right

1186
00:53:41,670 --> 00:53:47,980
and let's see this stuff can all be

1187
00:53:44,650 --> 00:53:54,010
probably collapse down into functions as

1188
00:53:47,980 --> 00:53:57,610
well here yeah because this is all this

1189
00:53:54,010 --> 00:54:01,150
is all the same as what we would use to

1190
00:53:57,610 --> 00:54:04,269
sample the that bitmap as well right we

1191
00:54:01,150 --> 00:54:06,820
take the U and the V and we expand them

1192
00:54:04,269 --> 00:54:08,500
out I'll have to think about this a

1193
00:54:06,820 --> 00:54:09,250
little bit more to think about this a

1194
00:54:08,500 --> 00:54:10,809
little bit more

1195
00:54:09,250 --> 00:54:13,059
this stuff is all the same

1196
00:54:10,809 --> 00:54:15,009
as well I'll copy it for now but I think

1197
00:54:13,059 --> 00:54:17,139
maybe we probably just want to condense

1198
00:54:15,010 --> 00:54:20,890
that down all right so we're in here

1199
00:54:17,139 --> 00:54:21,789
I'll rename these to the this sort of

1200
00:54:20,889 --> 00:54:26,379
the stuff that we were using before

1201
00:54:21,789 --> 00:54:29,019
we'll call this XY so and so now we

1202
00:54:26,380 --> 00:54:30,730
really just need to know what those

1203
00:54:29,019 --> 00:54:32,800
values actually are

1204
00:54:30,730 --> 00:54:35,500
I think we're basically that time we

1205
00:54:32,800 --> 00:54:36,700
only have about two minutes left so I

1206
00:54:35,500 --> 00:54:38,139
don't think I'll have time to cover the

1207
00:54:36,699 --> 00:54:40,509
intersection math today we're just about

1208
00:54:38,139 --> 00:54:43,179
to push it till Monday which I suppose

1209
00:54:40,510 --> 00:54:45,070
is fine because that will put us into

1210
00:54:43,179 --> 00:54:46,389
when we're supposed to actually working

1211
00:54:45,070 --> 00:54:48,250
on the light stuff that we'd be sampling

1212
00:54:46,389 --> 00:54:50,829
anyway let me double check that we've

1213
00:54:48,250 --> 00:54:53,070
got everything here so here is our our

1214
00:54:50,829 --> 00:54:58,029
map right width and height

1215
00:54:53,070 --> 00:55:00,039
oops sorry our LOD like so and I think

1216
00:54:58,030 --> 00:55:05,910
all this stuff is fine so we'll just say

1217
00:55:00,039 --> 00:55:08,909
for now px and py or nothing like so

1218
00:55:05,909 --> 00:55:08,909
oops

1219
00:55:09,090 --> 00:55:16,660
turn salt there we go

1220
00:55:14,010 --> 00:55:19,840
and this should crash us I would think

1221
00:55:16,659 --> 00:55:22,809
um to be honest with you I do not know

1222
00:55:19,840 --> 00:55:26,890
why it did not because we aren't passing

1223
00:55:22,809 --> 00:55:29,049
valid environment maps oh I guess

1224
00:55:26,889 --> 00:55:31,539
because we do test it here so we do test

1225
00:55:29,050 --> 00:55:33,580
to see if our map actually is valid so I

1226
00:55:31,539 --> 00:55:35,050
guess it won't crash us all right so

1227
00:55:33,579 --> 00:55:36,699
we're all good we just need to actually

1228
00:55:35,050 --> 00:55:38,680
generate those maps now which is what

1229
00:55:36,699 --> 00:55:41,529
we'll do next week and do a little bit

1230
00:55:38,679 --> 00:55:46,769
of an exception math right here do

1231
00:55:41,530 --> 00:55:52,269
intersection math to determine where we

1232
00:55:46,769 --> 00:55:58,030
should be right so that's all good so I

1233
00:55:52,269 --> 00:55:59,409
think we're getting closer it's just a

1234
00:55:58,030 --> 00:56:00,730
lot of work to do here to get all this

1235
00:55:59,409 --> 00:56:01,980
stuff working but yeah I think we're

1236
00:56:00,730 --> 00:56:04,480
getting closer really we've got

1237
00:56:01,980 --> 00:56:05,710
everything that we need in place but we

1238
00:56:04,480 --> 00:56:07,599
need to do the intersection math to

1239
00:56:05,710 --> 00:56:10,920
figure out where those things should hit

1240
00:56:07,599 --> 00:56:14,469
and then we also need to go ahead and do

1241
00:56:10,920 --> 00:56:16,750
you know the production of you know

1242
00:56:14,469 --> 00:56:20,109
basically getting the ground and the sky

1243
00:56:16,750 --> 00:56:22,750
into things that we sample from if that

1244
00:56:20,110 --> 00:56:24,120
makes sense so we've still got a ways to

1245
00:56:22,750 --> 00:56:25,260
go it's true

1246
00:56:24,119 --> 00:56:26,219
you know next week should be pretty

1247
00:56:25,260 --> 00:56:29,130
interesting we should be able to get a

1248
00:56:26,219 --> 00:56:40,099
fair bit of stuff there so let's go

1249
00:56:29,130 --> 00:56:44,010
ahead and go to the Q&amp;A right and I

1250
00:56:40,099 --> 00:56:45,569
really like I really like whoever said

1251
00:56:44,010 --> 00:56:48,060
this should crash us never crashes

1252
00:56:45,570 --> 00:56:50,700
ambition work always crashes it's true

1253
00:56:48,059 --> 00:56:53,489
right it's it's like the computer

1254
00:56:50,699 --> 00:56:55,829
doesn't want to agree with you it's like

1255
00:56:53,489 --> 00:56:57,539
if you say that something's gonna be

1256
00:56:55,829 --> 00:56:59,699
okay then it wants to make sure that you

1257
00:56:57,539 --> 00:57:01,199
know that that's not true and if you say

1258
00:56:59,699 --> 00:57:02,759
that well it won't be able to handle

1259
00:57:01,199 --> 00:57:06,089
this then it wants to prove you wrong

1260
00:57:02,760 --> 00:57:09,000
and be like oh no it does it totally

1261
00:57:06,090 --> 00:57:12,090
works but yeah I forgot that we were

1262
00:57:09,000 --> 00:57:14,309
already checking for that normally you

1263
00:57:12,090 --> 00:57:16,289
know when we actually go to optimize

1264
00:57:14,309 --> 00:57:18,150
this stuff out there won't be lots of

1265
00:57:16,289 --> 00:57:22,009
ifs in here so look normally it would

1266
00:57:18,150 --> 00:57:22,010
crash us right but

1267
00:57:37,440 --> 00:57:44,820
do we have any questions again most of

1268
00:57:43,349 --> 00:57:47,219
today was I guess just kind of cleaning

1269
00:57:44,820 --> 00:57:50,070
up everything and fixing what we typed

1270
00:57:47,219 --> 00:57:52,019
in wrong yesterday and we again did some

1271
00:57:50,070 --> 00:57:53,610
nice collapsing here just to get this

1272
00:57:52,019 --> 00:57:55,829
stuff out and you know we'll probably

1273
00:57:53,610 --> 00:57:57,720
actually honestly have to uncollapse a

1274
00:57:55,829 --> 00:57:59,279
lot of this stuff in macro style or

1275
00:57:57,719 --> 00:58:01,230
whatever when we do the optimization but

1276
00:57:59,280 --> 00:58:04,500
while we're getting stuff working it's

1277
00:58:01,230 --> 00:58:05,699
usually nice to be able to pull stuff

1278
00:58:04,500 --> 00:58:07,679
out into functions that you know work

1279
00:58:05,699 --> 00:58:11,210
because that way you don't make typos

1280
00:58:07,679 --> 00:58:14,539
that cause you lots of pain you know

1281
00:58:11,210 --> 00:58:14,539
that makes sense

1282
00:58:21,050 --> 00:58:25,050
let's see I'm sorry when you lurk to

1283
00:58:23,820 --> 00:58:26,550
normals you probably won't get a

1284
00:58:25,050 --> 00:58:28,140
normalized vector there are a few things

1285
00:58:26,550 --> 00:58:30,360
you can do about that would you briefly

1286
00:58:28,139 --> 00:58:31,190
comment on your thoughts about this yeah

1287
00:58:30,360 --> 00:58:36,210
sure

1288
00:58:31,190 --> 00:58:37,769
so I about this a little bit I don't

1289
00:58:36,210 --> 00:58:41,760
know if was yesterday I think it was

1290
00:58:37,769 --> 00:58:43,650
yesterday you if you remember on the

1291
00:58:41,760 --> 00:58:45,290
blackboard actually it's it's up here

1292
00:58:43,650 --> 00:58:53,450
somewhere

1293
00:58:45,289 --> 00:58:53,449
that's where did it go where did it go

1294
00:58:53,989 --> 00:59:04,619
this is lighting normal Maps normal Maps

1295
00:59:01,789 --> 00:59:06,599
normal Maps there it is

1296
00:59:04,619 --> 00:59:07,949
this was the diagram where us talking

1297
00:59:06,599 --> 00:59:08,880
about it right I was like when you lurk

1298
00:59:07,949 --> 00:59:10,799
between them

1299
00:59:08,880 --> 00:59:13,410
you get like a stumpy one which is not

1300
00:59:10,800 --> 00:59:15,180
really normal and if you remember what I

1301
00:59:13,409 --> 00:59:16,589
said back when I was doing that I was

1302
00:59:15,179 --> 00:59:17,879
like well we don't really need to think

1303
00:59:16,590 --> 00:59:18,930
about that right now because we don't

1304
00:59:17,880 --> 00:59:23,400
know what we're actually gonna do

1305
00:59:18,929 --> 00:59:25,169
sampling wise and that is true so if you

1306
00:59:23,400 --> 00:59:26,789
take a look at what happens here this is

1307
00:59:25,170 --> 00:59:29,340
the slurp is the thing that might

1308
00:59:26,789 --> 00:59:33,840
produce the incorrect normal the

1309
00:59:29,340 --> 00:59:37,350
unscalable is well do we have to correct

1310
00:59:33,840 --> 00:59:38,970
for that and so what I'm guessing and I

1311
00:59:37,349 --> 00:59:40,440
could be wrong about this but what I'm

1312
00:59:38,969 --> 00:59:42,179
guessing is that when we do the math

1313
00:59:40,440 --> 00:59:44,940
here because we're actually doing an

1314
00:59:42,179 --> 00:59:47,819
intersection we will be able to do it

1315
00:59:44,940 --> 00:59:49,650
with a non normalized normal and just

1316
00:59:47,820 --> 00:59:53,519
bake that normalization into the divide

1317
00:59:49,650 --> 00:59:56,400
I think don't quote me on that but I

1318
00:59:53,519 --> 01:00:00,780
suspect we'll be able to do that so

1319
00:59:56,400 --> 01:00:05,340
we'll see if you can't do that and you

1320
01:00:00,780 --> 01:00:07,260
actually need an actual normal then yeah

1321
01:00:05,340 --> 01:00:10,680
then you've got problems now one thing

1322
01:00:07,260 --> 01:00:12,840
that we aren't doing properly here is

1323
01:00:10,679 --> 01:00:17,789
we're not doing the this selection

1324
01:00:12,840 --> 01:00:20,250
correctly right this is the blend and so

1325
01:00:17,789 --> 01:00:22,079
the lerp normal will get the wrong blend

1326
01:00:20,250 --> 01:00:27,239
amount there because we're just using

1327
01:00:22,079 --> 01:00:29,819
the normal Y directly and so you know I

1328
01:00:27,239 --> 01:00:31,739
I could put to do here you know and we

1329
01:00:29,820 --> 01:00:34,039
could also just say you know we want to

1330
01:00:31,739 --> 01:00:38,000
be totally correct for now and

1331
01:00:34,039 --> 01:00:40,519
you know do we really need to do this

1332
01:00:38,000 --> 01:00:42,679
and but we could do ok just always

1333
01:00:40,519 --> 01:00:48,130
normalize you know the normal that comes

1334
01:00:42,679 --> 01:00:50,059
in right and that's totally fine right

1335
01:00:48,130 --> 01:00:51,710
because like I said this is the slow

1336
01:00:50,059 --> 01:00:52,940
path right now we're just doing it for

1337
01:00:51,710 --> 01:00:55,820
correctness so we could just always

1338
01:00:52,940 --> 01:00:58,130
normalize right after you come out in

1339
01:00:55,820 --> 01:01:01,580
hardware nowadays especially if you're

1340
01:00:58,130 --> 01:01:03,769
on a PC like on a desktop part usually

1341
01:01:01,579 --> 01:01:07,130
they've got fast inverse square root and

1342
01:01:03,769 --> 01:01:10,130
so you will you almost always don't even

1343
01:01:07,130 --> 01:01:13,910
you don't even store both coordinates

1344
01:01:10,130 --> 01:01:16,340
you store just the X and the y and you

1345
01:01:13,909 --> 01:01:18,259
normalize out to get the Z so like this

1346
01:01:16,340 --> 01:01:22,640
thing that that we did that you in fact

1347
01:01:18,260 --> 01:01:25,310
recommended yesterday is actually you

1348
01:01:22,639 --> 01:01:27,859
just do it in the shader right so you

1349
01:01:25,309 --> 01:01:30,500
never actually you never actually do

1350
01:01:27,860 --> 01:01:33,760
this Z computation you just compute it

1351
01:01:30,500 --> 01:01:33,760
in here right

1352
01:01:41,380 --> 01:01:45,800
criminal dragon how are we going to

1353
01:01:44,179 --> 01:01:47,119
sample lights when calculating the pixel

1354
01:01:45,800 --> 01:01:48,590
values for each bright will there be a

1355
01:01:47,119 --> 01:01:50,150
list of all the lights or will that be a

1356
01:01:48,590 --> 01:01:52,250
parameter of some sort no it's in a

1357
01:01:50,150 --> 01:01:53,599
texture that's what I was saying that's

1358
01:01:52,250 --> 01:01:55,070
what the environment maps are the

1359
01:01:53,599 --> 01:01:56,989
environment Maps we're going to write

1360
01:01:55,070 --> 01:01:58,730
all our lights into environment Maps and

1361
01:01:56,989 --> 01:01:59,809
then pull them out that way so we don't

1362
01:01:58,730 --> 01:02:01,579
have a list of lights we just have a

1363
01:01:59,809 --> 01:02:02,809
texture that way it doesn't matter how

1364
01:02:01,579 --> 01:02:04,309
many lights we have we could have like a

1365
01:02:02,809 --> 01:02:09,019
thousand lights and it doesn't cost any

1366
01:02:04,309 --> 01:02:11,960
more right it's just one way of sort of

1367
01:02:09,019 --> 01:02:13,579
simplifying things in genera whatever

1368
01:02:11,960 --> 01:02:15,050
happened to your almond milk I was

1369
01:02:13,579 --> 01:02:17,659
drinking it today I just didn't put it

1370
01:02:15,050 --> 01:02:18,980
in one of those bottles I need a bottle

1371
01:02:17,659 --> 01:02:20,509
brush those bottles are getting kind of

1372
01:02:18,980 --> 01:02:21,320
nasty and I don't like drinking out of

1373
01:02:20,510 --> 01:02:28,160
them anymore

1374
01:02:21,320 --> 01:02:29,630
so I need a way to like scrub them in so

1375
01:02:28,159 --> 01:02:32,619
first well yank should be making normal

1376
01:02:29,630 --> 01:02:37,099
maps for the art now - I may generate

1377
01:02:32,619 --> 01:02:38,659
the normal maps as using offline some

1378
01:02:37,099 --> 01:02:40,699
kind of offline processing so I don't

1379
01:02:38,659 --> 01:02:42,170
know that she'll actually make them but

1380
01:02:40,699 --> 01:02:44,389
yeah we're going to basically try to

1381
01:02:42,170 --> 01:02:46,670
have normal maps included with the art

1382
01:02:44,389 --> 01:02:53,150
set but how they get created I'm not

1383
01:02:46,670 --> 01:02:55,280
sure yet will you cover more advanced

1384
01:02:53,150 --> 01:02:59,059
brdf or just simple Phong like lighting

1385
01:02:55,280 --> 01:03:03,980
equations uh I don't know that there's

1386
01:02:59,059 --> 01:03:05,840
so like brdf are not really all that

1387
01:03:03,980 --> 01:03:08,030
useful if we don't if we're already

1388
01:03:05,840 --> 01:03:12,440
totally hacked lighting like you know

1389
01:03:08,030 --> 01:03:14,390
brdf you don't really see much you don't

1390
01:03:12,440 --> 01:03:16,400
see much of that until you have really

1391
01:03:14,389 --> 01:03:18,769
obvious stuff happening right you've got

1392
01:03:16,400 --> 01:03:20,720
to have like real lighting a really much

1393
01:03:18,769 --> 01:03:22,809
more complex lighting environment to

1394
01:03:20,719 --> 01:03:27,739
really start to see the results of those

1395
01:03:22,809 --> 01:03:30,529
so covering up having a brdf inside a

1396
01:03:27,739 --> 01:03:32,389
completely hacked lighting model doesn't

1397
01:03:30,530 --> 01:03:34,250
seem like a particularly productive

1398
01:03:32,389 --> 01:03:35,539
thing to do right it seems like you're

1399
01:03:34,250 --> 01:03:38,659
just totally throwing cycles away at

1400
01:03:35,539 --> 01:03:41,210
that point but I mean again it's really

1401
01:03:38,659 --> 01:03:44,899
pretty simple if you have a notion of

1402
01:03:41,210 --> 01:03:46,099
what the incoming light is you certainly

1403
01:03:44,900 --> 01:03:47,809
could go ahead and do some line

1404
01:03:46,099 --> 01:03:50,329
combination we're not doing even Phong

1405
01:03:47,809 --> 01:03:51,268
here right yet all we're doing we're not

1406
01:03:50,329 --> 01:03:55,348
even accounting for the

1407
01:03:51,268 --> 01:03:56,668
viewing angle yet so you know if it's

1408
01:03:55,349 --> 01:03:58,229
something that people want to see we

1409
01:03:56,668 --> 01:04:04,108
could do something here where we're like

1410
01:03:58,228 --> 01:04:07,648
okay I actually do a lighting model

1411
01:04:04,108 --> 01:04:09,298
computation here to basically attenuate

1412
01:04:07,648 --> 01:04:13,978
that light based on the viewing angle

1413
01:04:09,298 --> 01:04:15,449
and so yeah you know we could totally do

1414
01:04:13,978 --> 01:04:22,198
something like that because right now

1415
01:04:15,449 --> 01:04:27,028
and and we also here actually compute a

1416
01:04:22,199 --> 01:04:28,499
bounce based on the viewer direction

1417
01:04:27,028 --> 01:04:33,449
right there so there's a bunch of stuff

1418
01:04:28,498 --> 01:04:35,038
that we're just not doing and I don't

1419
01:04:33,449 --> 01:04:35,639
really know if you want to actually do

1420
01:04:35,039 --> 01:04:36,989
those things

1421
01:04:35,639 --> 01:04:39,358
I'll put two dudes there in case we want

1422
01:04:36,989 --> 01:04:41,219
to talk about them but again I'm not

1423
01:04:39,358 --> 01:04:43,139
sure how useful that is when everything

1424
01:04:41,219 --> 01:04:49,380
is totally hacked to try and like fit it

1425
01:04:43,139 --> 01:04:52,078
into the 2d scheme hmm what if I don't

1426
01:04:49,380 --> 01:04:54,599
want my game to be just normal are there

1427
01:04:52,079 --> 01:04:59,309
other kinds of maps I can use to make my

1428
01:04:54,599 --> 01:05:03,838
game more unique so yes you can use

1429
01:04:59,309 --> 01:05:05,759
abnormal maps and abnormal maps so

1430
01:05:03,838 --> 01:05:13,018
basically like where that term comes

1431
01:05:05,759 --> 01:05:16,248
from is is essentially there's a so

1432
01:05:13,018 --> 01:05:18,748
there's a thing called an a/b normal map

1433
01:05:16,248 --> 01:05:20,518
right

1434
01:05:18,748 --> 01:05:24,478
short for and they're shortened to

1435
01:05:20,518 --> 01:05:27,629
abnormal Maps right and basically what

1436
01:05:24,478 --> 01:05:30,568
an a/b normal map is is it's essentially

1437
01:05:27,630 --> 01:05:33,358
like you take whatever you know mapping

1438
01:05:30,568 --> 01:05:35,759
that you wanted to do right

1439
01:05:33,358 --> 01:05:39,389
so you maybe take an oral mapping right

1440
01:05:35,759 --> 01:05:42,449
and what you do is you make up two other

1441
01:05:39,389 --> 01:05:43,769
textures an A and a B well actually to

1442
01:05:42,449 --> 01:05:47,249
draw them properly you'd put them on

1443
01:05:43,768 --> 01:05:49,318
this side right and a and a B and you

1444
01:05:47,248 --> 01:05:51,958
introduce operators between the maps

1445
01:05:49,318 --> 01:05:53,429
which basically totally ruin the good

1446
01:05:51,958 --> 01:05:55,288
calculations that you were doing over

1447
01:05:53,429 --> 01:05:58,409
here but get you a completely unique

1448
01:05:55,289 --> 01:06:00,630
result out this side right so one thing

1449
01:05:58,409 --> 01:06:02,999
for example you might do here these

1450
01:06:00,630 --> 01:06:04,769
could be convolutions for example they

1451
01:06:02,998 --> 01:06:06,599
could also just be straight ahead

1452
01:06:04,769 --> 01:06:08,250
like ads or multiplies so like

1453
01:06:06,599 --> 01:06:10,799
oftentimes one thing that you might do

1454
01:06:08,250 --> 01:06:12,599
is like an a times would be times the

1455
01:06:10,800 --> 01:06:14,310
normal map would be another one that you

1456
01:06:12,599 --> 01:06:16,380
could do and that's how you can produce

1457
01:06:14,309 --> 01:06:20,869
one of these abnormal maps and then then

1458
01:06:16,380 --> 01:06:20,869
your game looks very unique and awful

1459
01:06:25,429 --> 01:06:28,289
kronole dragons some games use a bump

1460
01:06:27,809 --> 01:06:30,150
map

1461
01:06:28,289 --> 01:06:31,949
in addition or instead of a normal map

1462
01:06:30,150 --> 01:06:34,220
what is the difference between these and

1463
01:06:31,949 --> 01:06:38,460
what are the advantages or disadvantages

1464
01:06:34,219 --> 01:06:41,519
well probably no one's using a bump map

1465
01:06:38,460 --> 01:06:45,599
for lighting instead of a normal map

1466
01:06:41,519 --> 01:06:47,400
these days I would think if you're if

1467
01:06:45,599 --> 01:06:50,789
you're using a bump map nowadays like

1468
01:06:47,400 --> 01:06:52,650
actually using a bump map then either

1469
01:06:50,789 --> 01:06:55,409
you're just trying to compress your

1470
01:06:52,650 --> 01:06:57,389
normal map more than you could otherwise

1471
01:06:55,409 --> 01:06:59,489
and so you're trying to reproduce

1472
01:06:57,389 --> 01:07:02,549
normals from the bump values you know

1473
01:06:59,489 --> 01:07:05,729
what I mean or you're trying to use

1474
01:07:02,550 --> 01:07:09,000
actual displacements or other kinds of

1475
01:07:05,730 --> 01:07:11,130
like occlusion in the map so like other

1476
01:07:09,000 --> 01:07:13,050
effects besides lighting you know what

1477
01:07:11,130 --> 01:07:14,820
I'm saying

1478
01:07:13,050 --> 01:07:16,710
but the relationship between these is

1479
01:07:14,820 --> 01:07:18,960
pretty straightforward right so a bump

1480
01:07:16,710 --> 01:07:20,639
map and this is not a joke like this was

1481
01:07:18,960 --> 01:07:26,159
this is actually serious so a bump map

1482
01:07:20,639 --> 01:07:29,029
and a normal map right what happens is

1483
01:07:26,159 --> 01:07:35,819
the bump map basically says height and

1484
01:07:29,030 --> 01:07:36,869
this says surface direction right so if

1485
01:07:35,820 --> 01:07:39,240
you look at what these actually

1486
01:07:36,869 --> 01:07:40,619
represent you know if I take a 1d

1487
01:07:39,239 --> 01:07:42,839
cross-section of it like a height map

1488
01:07:40,619 --> 01:07:45,210
let's say the surface goes like this a

1489
01:07:42,840 --> 01:07:48,059
height map is just that every Texel you

1490
01:07:45,210 --> 01:07:54,210
just store how high it was right so

1491
01:07:48,059 --> 01:07:55,710
that's a bump map a normal map on the

1492
01:07:54,210 --> 01:07:58,108
other hand for the exact same surface

1493
01:07:55,710 --> 01:07:59,608
right so these these Heights actually

1494
01:07:58,108 --> 01:08:02,579
you know just to make it totally

1495
01:07:59,608 --> 01:08:05,250
concrete it's this distance right that's

1496
01:08:02,579 --> 01:08:08,130
what gets stored into this map the

1497
01:08:05,250 --> 01:08:12,659
actual normal to the surface at that

1498
01:08:08,130 --> 01:08:15,300
point right is what gets stored into

1499
01:08:12,659 --> 01:08:15,989
this map so that is what gets stored in

1500
01:08:15,300 --> 01:08:18,900
here

1501
01:08:15,989 --> 01:08:20,548
now pretty much you never really want

1502
01:08:18,899 --> 01:08:21,750
one of these unless you're trying to do

1503
01:08:20,548 --> 01:08:22,710
something else with it like I said

1504
01:08:21,750 --> 01:08:24,060
unless you're trying to go for a better

1505
01:08:22,710 --> 01:08:26,759
compression because hey this only has

1506
01:08:24,060 --> 01:08:28,319
store one value which is that height or

1507
01:08:26,759 --> 01:08:29,670
you're trying to occlusion so you need

1508
01:08:28,319 --> 01:08:30,870
to know what the height was because

1509
01:08:29,670 --> 01:08:32,338
you're trying to do stuff like if you

1510
01:08:30,869 --> 01:08:34,439
view it from this angle you can't see

1511
01:08:32,338 --> 01:08:36,630
this pixel because this pixel occluded

1512
01:08:34,439 --> 01:08:40,199
it stuff like that there are schemes

1513
01:08:36,630 --> 01:08:42,480
that do stuff like this that's for 3d

1514
01:08:40,199 --> 01:08:44,099
that wouldn't help you in 2d but in a 3d

1515
01:08:42,479 --> 01:08:45,988
game like a texture like a brick wall

1516
01:08:44,100 --> 01:08:47,548
that had like little mortar you know in

1517
01:08:45,988 --> 01:08:53,278
skews mortar things that kind of stuff

1518
01:08:47,548 --> 01:08:56,338
so what what's going on there is

1519
01:08:53,279 --> 01:08:59,160
basically the surface Direction is

1520
01:08:56,338 --> 01:09:01,528
always a much higher quality way to

1521
01:08:59,159 --> 01:09:03,960
store this information than the bump and

1522
01:09:01,529 --> 01:09:06,210
the reason for that is a surface

1523
01:09:03,960 --> 01:09:11,250
Direction can store anything including a

1524
01:09:06,210 --> 01:09:12,719
perfectly a full on hard edge here it

1525
01:09:11,250 --> 01:09:15,140
can store like things that point

1526
01:09:12,719 --> 01:09:17,579
directly that way or anything else

1527
01:09:15,140 --> 01:09:19,650
whereas the bump map can never really

1528
01:09:17,579 --> 01:09:21,869
capture that information because the

1529
01:09:19,649 --> 01:09:23,519
bump map is not storing an orientation

1530
01:09:21,869 --> 01:09:24,988
it's storing like a delta it's sorting

1531
01:09:23,520 --> 01:09:26,700
like a height that you then have to look

1532
01:09:24,988 --> 01:09:28,769
at the difference between to compute the

1533
01:09:26,699 --> 01:09:30,329
lighting right because height doesn't

1534
01:09:28,770 --> 01:09:33,089
tell me anything that I that I need to

1535
01:09:30,329 --> 01:09:34,380
tight doesn't tell me what the lighting

1536
01:09:33,088 --> 01:09:36,059
calculation should be because remember I

1537
01:09:34,380 --> 01:09:38,069
need the tangent plane to do the

1538
01:09:36,060 --> 01:09:40,920
lighting calculation so what I have to

1539
01:09:38,069 --> 01:09:43,380
do for a bump map is I have to look at

1540
01:09:40,920 --> 01:09:45,899
what the surrounding values are and try

1541
01:09:43,380 --> 01:09:49,140
to decide based on those roughly what

1542
01:09:45,899 --> 01:09:51,059
the normal would have been whereas the

1543
01:09:49,140 --> 01:09:53,730
normal map just gives me exactly that so

1544
01:09:51,060 --> 01:09:56,460
the normal maps always superior if you

1545
01:09:53,729 --> 01:09:58,859
can swing it a bump maps usually if

1546
01:09:56,460 --> 01:10:00,210
either you need to save space so you

1547
01:09:58,859 --> 01:10:01,979
don't want to take up as much space as a

1548
01:10:00,210 --> 01:10:04,140
normal map might take up or you're

1549
01:10:01,979 --> 01:10:06,809
trying to get more bang for the buck by

1550
01:10:04,140 --> 01:10:08,369
getting other schemes out of it so

1551
01:10:06,810 --> 01:10:11,039
typically what you might think of is the

1552
01:10:08,369 --> 01:10:12,960
normal map is sort of like storing the

1553
01:10:11,039 --> 01:10:16,829
derivative of the bump map like if the

1554
01:10:12,960 --> 01:10:22,199
bump map is is this then this is is like

1555
01:10:16,829 --> 01:10:24,059
you know that and more technically at

1556
01:10:22,199 --> 01:10:26,670
the risk of getting ridiculous at this

1557
01:10:24,060 --> 01:10:29,460
point it's really this it's really the

1558
01:10:26,670 --> 01:10:32,730
gradient of the bump map right

1559
01:10:29,460 --> 01:10:36,449
which is to say that it's creating a

1560
01:10:32,729 --> 01:10:39,839
vector that says what direction the bump

1561
01:10:36,449 --> 01:10:42,510
map was changing in if that makes sense

1562
01:10:39,840 --> 01:10:44,220
and it's it's even a little it's even

1563
01:10:42,510 --> 01:10:47,940
not quite that because that actually

1564
01:10:44,220 --> 01:10:50,310
would point that would give you if I'm

1565
01:10:47,939 --> 01:10:53,309
not mistaken because this is explicit

1566
01:10:50,310 --> 01:10:55,289
function and soon m73 can can either

1567
01:10:53,310 --> 01:10:56,789
corroborate or deny this basically

1568
01:10:55,289 --> 01:10:59,279
you've got a function that's the height

1569
01:10:56,789 --> 01:11:00,779
right and technically I believe since

1570
01:10:59,279 --> 01:11:03,409
it's an explicit function like you've

1571
01:11:00,779 --> 01:11:06,059
got F of UV and it's outputting this

1572
01:11:03,409 --> 01:11:07,529
function I believe technically you take

1573
01:11:06,060 --> 01:11:11,190
the gradient and you'll actually get

1574
01:11:07,529 --> 01:11:14,609
this tangent right and you want the

1575
01:11:11,189 --> 01:11:17,339
perpendicular one of that so I think

1576
01:11:14,609 --> 01:11:20,130
actually timely it's not even really the

1577
01:11:17,340 --> 01:11:25,470
gradient what it is is it's the cross

1578
01:11:20,130 --> 01:11:27,420
product right of the gradient versus the

1579
01:11:25,470 --> 01:11:31,470
function right so it's it's it's that

1580
01:11:27,420 --> 01:11:32,909
weird it's like I don't know what I

1581
01:11:31,470 --> 01:11:36,600
don't even know what that's called curl

1582
01:11:32,909 --> 01:11:39,680
I don't even I don't even know but it's

1583
01:11:36,600 --> 01:11:42,870
like the cross product of of that

1584
01:11:39,680 --> 01:11:45,060
original gradient that you'd get but

1585
01:11:42,869 --> 01:11:50,550
that's what you actually want in terms

1586
01:11:45,060 --> 01:11:52,170
of you know in terms of taking the bump

1587
01:11:50,550 --> 01:11:54,750
map and turning it into one of these so

1588
01:11:52,170 --> 01:11:56,430
so they are related it's just that this

1589
01:11:54,750 --> 01:11:58,319
is a much more expressive version

1590
01:11:56,430 --> 01:11:59,700
because you'd have to in order to

1591
01:11:58,319 --> 01:12:01,229
express all the things you could express

1592
01:11:59,699 --> 01:12:03,359
with this you'd have to be able to have

1593
01:12:01,229 --> 01:12:05,579
like essentially infinite changes in

1594
01:12:03,359 --> 01:12:06,769
height to sort of say what the normal

1595
01:12:05,579 --> 01:12:10,079
should end up being at that point

1596
01:12:06,770 --> 01:12:11,100
because you can't really you know since

1597
01:12:10,079 --> 01:12:13,199
these are fixed

1598
01:12:11,100 --> 01:12:15,180
you can't ever represent the fact that

1599
01:12:13,199 --> 01:12:17,159
the surface did things like this right

1600
01:12:15,180 --> 01:12:20,130
because you can't put two sample points

1601
01:12:17,159 --> 01:12:22,019
at the same area right so we will always

1602
01:12:20,130 --> 01:12:23,670
think that if you showed if that would

1603
01:12:22,020 --> 01:12:26,870
always think it was this but really

1604
01:12:23,670 --> 01:12:28,590
maybe it was more like this right I

1605
01:12:26,869 --> 01:12:31,609
don't know if that makes any sense

1606
01:12:28,590 --> 01:12:31,610
hopefully it does

1607
01:12:37,649 --> 01:12:42,369
well the effect end up like a bump map

1608
01:12:40,060 --> 01:12:45,070
effect yes so it's basically normal maps

1609
01:12:42,369 --> 01:12:47,890
are basically the more powerful version

1610
01:12:45,069 --> 01:12:49,689
of a bump map right a bump map is like a

1611
01:12:47,890 --> 01:12:51,960
worse version of a normal map if that

1612
01:12:49,689 --> 01:12:51,960
makes sense

1613
01:12:54,988 --> 01:12:58,869
could we do reflections by using our

1614
01:12:57,369 --> 01:13:01,539
frame buffer as an environment map when

1615
01:12:58,869 --> 01:13:03,369
drawing the bitmap yes that actually is

1616
01:13:01,539 --> 01:13:04,810
what we'll be doing so that's basically

1617
01:13:03,369 --> 01:13:06,699
how we'll have things sort of reflect

1618
01:13:04,810 --> 01:13:08,260
the ground and that sort of thing again

1619
01:13:06,699 --> 01:13:09,329
I'm not sure how it'll work out but

1620
01:13:08,260 --> 01:13:17,860
that's just what we're going for

1621
01:13:09,329 --> 01:13:19,449
that's like what we're trying right if

1622
01:13:17,859 --> 01:13:20,859
you imagine the surface as an implicit

1623
01:13:19,449 --> 01:13:25,389
function it's the grating of that

1624
01:13:20,859 --> 01:13:28,630
function yes exactly like if we actually

1625
01:13:25,390 --> 01:13:32,079
had a function that instead of being

1626
01:13:28,630 --> 01:13:34,869
explicit so it's not this but it's like

1627
01:13:32,079 --> 01:13:35,890
an explicit function which I'm sorry if

1628
01:13:34,869 --> 01:13:38,559
it's an implicit function so you

1629
01:13:35,890 --> 01:13:40,300
actually have a value for it everywhere

1630
01:13:38,560 --> 01:13:44,890
and you're looking for the iso contour

1631
01:13:40,300 --> 01:13:47,289
then it's the gradient yes but but we

1632
01:13:44,890 --> 01:13:51,190
don't a bump map isn't that a bump map

1633
01:13:47,289 --> 01:13:54,430
is it's explicit so yeah you kind of

1634
01:13:51,189 --> 01:13:57,129
have to do the you kind of have to take

1635
01:13:54,430 --> 01:13:59,260
this guy you have to take the tangents

1636
01:13:57,130 --> 01:14:00,789
the actual tangents of these guys and

1637
01:13:59,260 --> 01:14:03,239
you have to take their cross-product

1638
01:14:00,789 --> 01:14:10,810
right so you know if you looked at it

1639
01:14:03,238 --> 01:14:13,299
this way it's like okay so we have for

1640
01:14:10,810 --> 01:14:14,920
any point we have a tangent for the U

1641
01:14:13,300 --> 01:14:17,230
direction and a tangent for the V

1642
01:14:14,920 --> 01:14:19,359
Direction right so we've got these and

1643
01:14:17,229 --> 01:14:23,439
we have to cross them to get that normal

1644
01:14:19,359 --> 01:14:25,059
right we haven't covered cross products

1645
01:14:23,439 --> 01:14:27,099
and we won't because it's a 3d thing

1646
01:14:25,060 --> 01:14:29,219
really that we probably won't ever need

1647
01:14:27,100 --> 01:14:33,190
to cover maybe we would eventually but

1648
01:14:29,219 --> 01:14:35,770
you know a cross product yeah so it

1649
01:14:33,189 --> 01:14:37,449
would be a gradient or it's sort of like

1650
01:14:35,770 --> 01:14:38,530
a gradient but unfortunately we can

1651
01:14:37,449 --> 01:14:40,238
actually do it that way because the bump

1652
01:14:38,529 --> 01:14:43,469
map is is again it's explicit not

1653
01:14:40,238 --> 01:14:43,468
implicit unfortunately

1654
01:14:44,890 --> 01:14:50,260
alright looks like we have come to the

1655
01:14:47,420 --> 01:14:50,260
end of the questions

1656
01:15:00,130 --> 01:15:17,090
alright yeah looks like we're done

1657
01:15:03,460 --> 01:15:23,359
lovely lovely okay so let me go ahead

1658
01:15:17,090 --> 01:15:29,210
and close everything down here and I

1659
01:15:23,359 --> 01:15:30,380
saved this right double check okay all

1660
01:15:29,210 --> 01:15:31,579
right thank you everyone for joining me

1661
01:15:30,380 --> 01:15:32,930
for another episode of hand made here oh

1662
01:15:31,579 --> 01:15:33,439
it's been a pleasure coding with you as

1663
01:15:32,930 --> 01:15:35,539
always

1664
01:15:33,439 --> 01:15:38,329
I think we're basically finished with

1665
01:15:35,539 --> 01:15:39,529
the with the sort of normal map cleanup

1666
01:15:38,329 --> 01:15:41,809
stuff there it looks like everything is

1667
01:15:39,529 --> 01:15:43,550
working properly now so next week what

1668
01:15:41,810 --> 01:15:45,740
we should be able to do hopefully you

1669
01:15:43,550 --> 01:15:47,510
start to build those lighting sample

1670
01:15:45,739 --> 01:15:49,519
buffers and then actually sample out of

1671
01:15:47,510 --> 01:15:53,239
them using our normal maps that are

1672
01:15:49,520 --> 01:15:55,340
being passed through properly now it's

1673
01:15:53,239 --> 01:15:56,989
gonna be a little experimental next week

1674
01:15:55,340 --> 01:15:59,449
because we really don't know exactly how

1675
01:15:56,989 --> 01:16:00,979
you know exactly what would be good ways

1676
01:15:59,449 --> 01:16:04,309
to do all the stuff that we kind of want

1677
01:16:00,979 --> 01:16:06,559
to do here so yeah it's a little it's a

1678
01:16:04,310 --> 01:16:08,720
little wonky but you know we'll do the

1679
01:16:06,560 --> 01:16:11,090
best that we can anything with lighting

1680
01:16:08,720 --> 01:16:11,869
even in a 3d environment it's always a

1681
01:16:11,090 --> 01:16:14,119
hack

1682
01:16:11,869 --> 01:16:15,769
because simulating lighting correctly is

1683
01:16:14,119 --> 01:16:16,970
too difficult and so you're always

1684
01:16:15,770 --> 01:16:19,730
coming up with sort of these

1685
01:16:16,970 --> 01:16:21,920
approximations that are sort of what

1686
01:16:19,729 --> 01:16:24,199
you're doing because you don't have time

1687
01:16:21,920 --> 01:16:26,480
to do a full light transport solution on

1688
01:16:24,199 --> 01:16:29,720
your scene obviously you know oftentimes

1689
01:16:26,479 --> 01:16:30,859
those take minutes to do even today so

1690
01:16:29,720 --> 01:16:33,350
you kind of have this situation where

1691
01:16:30,859 --> 01:16:35,149
yeah we're not really at the point where

1692
01:16:33,350 --> 01:16:36,590
we can do real lighting transports so

1693
01:16:35,149 --> 01:16:39,289
it's always an approximation and that's

1694
01:16:36,590 --> 01:16:42,739
okay that's just where we're at and so

1695
01:16:39,289 --> 01:16:45,229
we will play with those approximations

1696
01:16:42,739 --> 01:16:46,670
next week until we get something or

1697
01:16:45,229 --> 01:16:47,629
maybe even for two weeks who knows how

1698
01:16:46,670 --> 01:16:48,829
long it will take us but we'll keep

1699
01:16:47,630 --> 01:16:51,590
playing with them until we get something

1700
01:16:48,829 --> 01:16:55,340
that we feel like we can use as sort of

1701
01:16:51,590 --> 01:16:57,260
the basis for our render setup right so

1702
01:16:55,340 --> 01:16:58,039
I hope you'll join me for that same time

1703
01:16:57,260 --> 01:17:00,020
same place on

1704
01:16:58,039 --> 01:17:01,100
Monday I believe although definitely

1705
01:17:00,020 --> 01:17:02,600
always check the Twitter for the

1706
01:17:01,100 --> 01:17:04,789
scheduled I believe it should be 5 p.m.

1707
01:17:02,600 --> 01:17:07,760
on Monday same time same places was

1708
01:17:04,789 --> 01:17:09,289
today so yeah thanks for joining me if

1709
01:17:07,760 --> 01:17:10,850
you would like to follow along at home

1710
01:17:09,289 --> 01:17:12,560
and want to access to the source code

1711
01:17:10,850 --> 01:17:15,289
you can pre-order it on handmade hero

1712
01:17:12,560 --> 01:17:16,490
ductwork and use the little pre-order

1713
01:17:15,289 --> 01:17:17,539
button that'll get you access to the

1714
01:17:16,489 --> 01:17:19,489
source code if you want to follow along

1715
01:17:17,539 --> 01:17:20,989
at home there's also a patreon page if

1716
01:17:19,489 --> 01:17:23,149
you want to subscribe and support the

1717
01:17:20,989 --> 01:17:24,920
video series it's much appreciated we

1718
01:17:23,149 --> 01:17:27,859
also have a forums site where you can

1719
01:17:24,920 --> 01:17:29,420
ask questions you can also look at ports

1720
01:17:27,859 --> 01:17:31,039
to Mac to Mac and Linux that the

1721
01:17:29,420 --> 01:17:33,079
community's done there you can also look

1722
01:17:31,039 --> 01:17:35,060
at the anti depe sewed guide which is

1723
01:17:33,079 --> 01:17:36,590
pretty awesome and we have a tweet bot

1724
01:17:35,060 --> 01:17:38,480
as well which tweets the schedule at you

1725
01:17:36,590 --> 01:17:40,430
so if you'd like to check that out

1726
01:17:38,479 --> 01:17:43,609
that's a good thing to subscribe to sue

1727
01:17:40,430 --> 01:17:45,380
but you know when essentially the this

1728
01:17:43,609 --> 01:17:47,539
shows gonna be live so thanks to him for

1729
01:17:45,380 --> 01:17:49,460
joining me hope see you next week have a

1730
01:17:47,539 --> 01:17:53,109
wonderful weekend and we will pick up

1731
01:17:49,460 --> 01:17:53,109
where we left off on Monday

