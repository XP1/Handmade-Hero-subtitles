1
00:00:02,540 --> 00:00:07,108
hello everyone and welcome to handmade

2
00:00:04,950 --> 00:00:09,030
Hero show recode a complete-game live on

3
00:00:07,108 --> 00:00:11,699
stream we are going to take a look at

4
00:00:09,029 --> 00:00:15,509
our octahedral light Maps today which

5
00:00:11,699 --> 00:00:18,239
yesterday we debugged the encoding of

6
00:00:15,509 --> 00:00:20,189
them and I think we I mean I I guess I

7
00:00:18,239 --> 00:00:23,309
don't know but I think we did that

8
00:00:20,189 --> 00:00:26,189
pretty well we looked at the results and

9
00:00:23,309 --> 00:00:28,500
they seemed pretty coherent we had

10
00:00:26,189 --> 00:00:30,089
definitely had some bugs in there and we

11
00:00:28,500 --> 00:00:32,668
fixed them and now it's looking pretty

12
00:00:30,089 --> 00:00:35,840
good so if you take a look at where we

13
00:00:32,668 --> 00:00:40,289
are at at the moment we can go ahead and

14
00:00:35,840 --> 00:00:43,379
jump in here to the handmade hero build

15
00:00:40,289 --> 00:00:45,359
and you can see that if I draw which in

16
00:00:43,378 --> 00:00:47,429
here and here this is the death maps

17
00:00:45,359 --> 00:00:49,049
which we're not computing it and

18
00:00:47,429 --> 00:00:50,429
actually haven't really decided how

19
00:00:49,049 --> 00:00:52,769
we're gonna use what we've got them in

20
00:00:50,429 --> 00:00:55,140
there just because we wanted them as

21
00:00:52,770 --> 00:00:57,239
placeholders if you look in here you can

22
00:00:55,140 --> 00:00:59,340
see the light map and as I move from

23
00:00:57,238 --> 00:01:01,198
side to side you can kind of see the

24
00:00:59,340 --> 00:01:03,809
light that moves with me is moving side

25
00:01:01,198 --> 00:01:06,658
to side on the map as we might expect it

26
00:01:03,808 --> 00:01:09,209
to in the octahedron we tested out the

27
00:01:06,659 --> 00:01:11,790
channels using structured art they seem

28
00:01:09,209 --> 00:01:14,188
to be right we don't know exactly that

29
00:01:11,790 --> 00:01:16,680
they're correct I mean we did some

30
00:01:14,188 --> 00:01:18,508
fairly reasonable validation that it

31
00:01:16,680 --> 00:01:20,700
seems to be unwrapping them properly but

32
00:01:18,509 --> 00:01:24,359
you know it's hard to definitely

33
00:01:20,700 --> 00:01:26,340
definitively say so I don't want to you

34
00:01:24,359 --> 00:01:30,750
know say that we've totally nailed it or

35
00:01:26,340 --> 00:01:32,520
anything but we do sort of have a fair

36
00:01:30,750 --> 00:01:34,969
reason to believe that it's that it's

37
00:01:32,519 --> 00:01:38,219
operating at least somewhat reasonably

38
00:01:34,969 --> 00:01:40,679
so from there I think what we want to do

39
00:01:38,219 --> 00:01:42,420
is twofold one we want to actually

40
00:01:40,680 --> 00:01:44,399
introduce the part of this you know what

41
00:01:42,420 --> 00:01:47,599
this is too low we're gonna we're gonna

42
00:01:44,399 --> 00:01:47,599
lift up this microphone a little bit

43
00:01:49,980 --> 00:01:59,880
Oh mic stands you're always so hard to

44
00:01:55,349 --> 00:02:03,569
work with there we go so anyway we want

45
00:01:59,879 --> 00:02:05,640
to make sure that this is able to be

46
00:02:03,569 --> 00:02:07,109
sampled inside our shader reasonably so

47
00:02:05,640 --> 00:02:09,270
that's the part that we really want to

48
00:02:07,109 --> 00:02:11,490
focus on but we also if you look in here

49
00:02:09,270 --> 00:02:13,290
if i zoom this in a little you can see

50
00:02:11,490 --> 00:02:15,300
that at the moment we're also not

51
00:02:13,289 --> 00:02:17,340
filling in that there's sort of like a

52
00:02:15,300 --> 00:02:21,180
separate little piece here where we're

53
00:02:17,340 --> 00:02:24,420
not actually filling in the in-between

54
00:02:21,180 --> 00:02:25,920
areas so I don't know if you can let me

55
00:02:24,419 --> 00:02:28,619
try and get into a position where you

56
00:02:25,919 --> 00:02:30,780
can really kind of see that better so if

57
00:02:28,620 --> 00:02:32,849
you look like in between here there's a

58
00:02:30,780 --> 00:02:35,969
gutter all the way around these there's

59
00:02:32,849 --> 00:02:39,239
a two pixel gutter everywhere and that's

60
00:02:35,969 --> 00:02:41,310
so that there's a one pixel ring that we

61
00:02:39,240 --> 00:02:44,219
can put around each one where we just

62
00:02:41,310 --> 00:02:47,300
copy whatever the proper part of the

63
00:02:44,219 --> 00:02:50,789
octagon is I'm sorry the of the

64
00:02:47,300 --> 00:02:53,430
octahedron is so that we make sure that

65
00:02:50,789 --> 00:02:55,799
when we sample towards the edge of our

66
00:02:53,430 --> 00:02:57,659
octahedral map it smoothly wraps around

67
00:02:55,800 --> 00:03:00,360
to the other side and that's to avoid

68
00:02:57,659 --> 00:03:02,009
like obvious pops in our lighting when

69
00:03:00,360 --> 00:03:05,489
you go from you know when you happen to

70
00:03:02,009 --> 00:03:08,099
go around the cracks where we chose to

71
00:03:05,489 --> 00:03:11,909
cut the octahedron and unwrap it so

72
00:03:08,099 --> 00:03:14,009
that's basically everywhere that so if

73
00:03:11,909 --> 00:03:16,560
you imagine the octahedron has the top

74
00:03:14,009 --> 00:03:19,199
and the bottom parts so that bottom part

75
00:03:16,560 --> 00:03:23,310
of the hemisphere it's basically all the

76
00:03:19,199 --> 00:03:25,259
cuts in that are unwrapped so just to be

77
00:03:23,310 --> 00:03:27,090
concrete about that so that people who

78
00:03:25,259 --> 00:03:30,329
are maybe still having a little bit of

79
00:03:27,090 --> 00:03:32,189
trouble you know what can me there we go

80
00:03:30,330 --> 00:03:34,340
maybe people who are having a little bit

81
00:03:32,189 --> 00:03:36,389
of trouble with the octahedron

82
00:03:34,340 --> 00:03:39,750
understanding exactly what it's doing so

83
00:03:36,389 --> 00:03:42,000
for people who are not 100% clear on

84
00:03:39,750 --> 00:03:45,569
what's going on there if you take a look

85
00:03:42,000 --> 00:03:47,610
inside the original paper this is the

86
00:03:45,569 --> 00:03:49,579
diagram in question that we've been

87
00:03:47,610 --> 00:03:54,360
referring to it's very clear it's good

88
00:03:49,580 --> 00:03:57,360
and if you look when we unwrap you can

89
00:03:54,360 --> 00:03:59,850
see that the top part of the sphere maps

90
00:03:57,360 --> 00:04:02,519
to the top part of the octahedron which

91
00:03:59,849 --> 00:04:03,849
unwraps cleanly with no cuts so

92
00:04:02,519 --> 00:04:05,950
basically anything

93
00:04:03,849 --> 00:04:09,159
in the upward-facing part of the

94
00:04:05,949 --> 00:04:11,560
lighting will be fine the downward part

95
00:04:09,159 --> 00:04:15,460
of the lighting as you can see has cuts

96
00:04:11,560 --> 00:04:21,100
and it cuts everywhere so each seam here

97
00:04:15,460 --> 00:04:23,710
is a cut so there there there and there

98
00:04:21,100 --> 00:04:26,890
are all cuts in the octahedron and the

99
00:04:23,709 --> 00:04:28,539
unfold right these are unfolded pieces

100
00:04:26,889 --> 00:04:32,009
that when they fold back together you

101
00:04:28,540 --> 00:04:35,830
know meet back up so in order to

102
00:04:32,009 --> 00:04:37,839
consuming prevent cuts there we would

103
00:04:35,829 --> 00:04:39,609
have to fix that now one of the things

104
00:04:37,839 --> 00:04:42,879
that I would point out when you're

105
00:04:39,610 --> 00:04:44,139
looking at this lighting there's a lot

106
00:04:42,879 --> 00:04:46,689
of things that we might want to think

107
00:04:44,139 --> 00:04:50,379
about here and we don't really know yet

108
00:04:46,689 --> 00:04:52,300
which side of the hemisphere which which

109
00:04:50,379 --> 00:04:55,870
hemisphere or which side of the sphere

110
00:04:52,300 --> 00:04:58,120
we want to be most important you could

111
00:04:55,870 --> 00:05:01,769
imagine if you were to place these light

112
00:04:58,120 --> 00:05:04,899
probes or align the voxel I should say

113
00:05:01,769 --> 00:05:07,389
if you imagined aligning the voxels so

114
00:05:04,899 --> 00:05:10,389
that it was always above the player like

115
00:05:07,389 --> 00:05:12,430
it or right in line with the player you

116
00:05:10,389 --> 00:05:15,219
could imagine wanting to do the opposite

117
00:05:12,430 --> 00:05:17,290
kind of unwrapping so if we were always

118
00:05:15,220 --> 00:05:20,380
talking about these lights being like

119
00:05:17,290 --> 00:05:22,870
mostly up above the scenery then you

120
00:05:20,379 --> 00:05:24,819
probably would want the bottom to map to

121
00:05:22,870 --> 00:05:27,910
the continuous tik Lluis region and cut

122
00:05:24,819 --> 00:05:29,469
the top right and that's a trivial

123
00:05:27,910 --> 00:05:31,420
change for us to make it would be

124
00:05:29,470 --> 00:05:33,460
trivial for us to change our octahedral

125
00:05:31,420 --> 00:05:36,850
unwrapping so that we flipped which Z

126
00:05:33,459 --> 00:05:39,279
got cut and which one didn't I

127
00:05:36,850 --> 00:05:41,379
so in fact you could just negate the Z

128
00:05:39,279 --> 00:05:43,000
on the way in to both routines and that

129
00:05:41,379 --> 00:05:46,000
would do it right negated on the way in

130
00:05:43,000 --> 00:05:48,519
negate on the way out and off you go so

131
00:05:46,000 --> 00:05:52,050
if we wanted to we could also change the

132
00:05:48,519 --> 00:05:55,180
bias and so if we find that we want to

133
00:05:52,050 --> 00:05:57,069
have the bottom you know if mostly

134
00:05:55,180 --> 00:05:59,199
lighting is getting sampled most from

135
00:05:57,069 --> 00:06:01,870
the bottom and less from the top of our

136
00:05:59,199 --> 00:06:03,459
hemispheres that would be a change to

137
00:06:01,870 --> 00:06:05,019
consider and again it's totally within

138
00:06:03,459 --> 00:06:08,319
our power to do so right it's pretty

139
00:06:05,019 --> 00:06:12,939
easy so basically all we want to do now

140
00:06:08,319 --> 00:06:15,699
is do that film and start sampling back

141
00:06:12,939 --> 00:06:17,019
to he'd run inside our shaders and in

142
00:06:15,699 --> 00:06:17,649
order to do that there's a couple things

143
00:06:17,019 --> 00:06:20,019
you want to do

144
00:06:17,649 --> 00:06:22,149
we also probably want to get the

145
00:06:20,019 --> 00:06:23,379
lighting distance factored in here a

146
00:06:22,149 --> 00:06:25,959
little bit we're not really doing that

147
00:06:23,379 --> 00:06:28,180
at all I don't think at the moment so

148
00:06:25,959 --> 00:06:30,370
let's take a look at all of that and and

149
00:06:28,180 --> 00:06:34,090
just try to get ourselves into a good

150
00:06:30,370 --> 00:06:35,500
position going forwards where we

151
00:06:34,089 --> 00:06:37,029
basically just have like some some

152
00:06:35,500 --> 00:06:39,970
semblance of the lighting working in a

153
00:06:37,029 --> 00:06:41,529
way that we understand so all right if I

154
00:06:39,970 --> 00:06:43,570
jump over to lighting you can kind of

155
00:06:41,529 --> 00:06:47,888
see down at the bottom where we actually

156
00:06:43,569 --> 00:06:50,168
fill this stuff out so we've got our

157
00:06:47,889 --> 00:06:52,300
routine here in the the test light

158
00:06:50,168 --> 00:06:55,149
sphere which is put filling in the

159
00:06:52,300 --> 00:06:56,918
sphere at the moment that's not really

160
00:06:55,149 --> 00:07:00,879
gonna do much distance attenuation I

161
00:06:56,918 --> 00:07:02,859
don't think is it oh it does so here we

162
00:07:00,879 --> 00:07:04,659
do distance attending to attenuation so

163
00:07:02,860 --> 00:07:06,580
we've got distance attenuation

164
00:07:04,660 --> 00:07:09,880
we've got angular attenuation in here

165
00:07:06,579 --> 00:07:14,259
right so we should generally be able to

166
00:07:09,879 --> 00:07:16,750
make this lighting look reasonable just

167
00:07:14,259 --> 00:07:18,728
from what we've got here so let's go

168
00:07:16,750 --> 00:07:20,800
ahead and try to put that into our

169
00:07:18,728 --> 00:07:29,848
shader like we were talking about before

170
00:07:20,800 --> 00:07:29,848
and we'll just see how it goes excuse me

171
00:07:32,220 --> 00:07:37,840
allergy season is coming up as you know

172
00:07:35,250 --> 00:07:39,339
so what we want to do here is we want to

173
00:07:37,839 --> 00:07:42,638
get our sampling working and then we

174
00:07:39,339 --> 00:07:45,219
also want after this process here to

175
00:07:42,639 --> 00:07:49,300
fill in those cracks so that it's a nice

176
00:07:45,220 --> 00:07:51,120
contiguous sampling all around and we'll

177
00:07:49,300 --> 00:07:53,470
do both of these things today hopefully

178
00:07:51,120 --> 00:07:55,750
although I don't know if we'll be able

179
00:07:53,470 --> 00:07:58,990
to debug them completely before the end

180
00:07:55,750 --> 00:08:01,269
of the stream so here's the fragment

181
00:07:58,990 --> 00:08:03,340
shader and you can see inside the

182
00:08:01,269 --> 00:08:05,589
fragment shader that we've sort of

183
00:08:03,339 --> 00:08:08,529
implemented the the first part of things

184
00:08:05,589 --> 00:08:11,408
we sketched out how this would go we we

185
00:08:08,529 --> 00:08:14,259
do the octahedral unwrap we call sample

186
00:08:11,408 --> 00:08:16,509
lighting for each of the voxel elements

187
00:08:14,259 --> 00:08:20,829
and then we blend by however far through

188
00:08:16,509 --> 00:08:26,728
the voxel we actually are and what you

189
00:08:20,829 --> 00:08:26,728
can sort of see here is that there's a

190
00:08:27,389 --> 00:08:31,329
there's sort of a way we could debug

191
00:08:30,038 --> 00:08:34,569
this already right

192
00:08:31,329 --> 00:08:38,439
we could start debugging the voxel

193
00:08:34,570 --> 00:08:41,919
interpolation by using these as actual

194
00:08:38,440 --> 00:08:45,040
colors and looking at what we get so for

195
00:08:41,918 --> 00:08:54,879
example if we wanted to we could write

196
00:08:45,039 --> 00:08:58,120
something more like this right and so

197
00:08:54,879 --> 00:09:00,338
now when we go up here into the sample

198
00:08:58,120 --> 00:09:02,950
lighting call which actually don't know

199
00:09:00,339 --> 00:09:07,360
where that is right there it is where

200
00:09:02,950 --> 00:09:11,040
we've got a box offset and a box you

201
00:09:07,360 --> 00:09:15,310
know so a fox I in a box oh maybe right

202
00:09:11,039 --> 00:09:18,969
I oh I don't know something like that or

203
00:09:15,309 --> 00:09:20,889
D Vox I maybe if we've got these two

204
00:09:18,970 --> 00:09:24,160
what we can do is say oh well you know

205
00:09:20,889 --> 00:09:30,338
what why don't we just output as the

206
00:09:24,159 --> 00:09:33,759
color the actual offset value right and

207
00:09:30,339 --> 00:09:36,339
if we did that if we if we change that

208
00:09:33,759 --> 00:09:41,259
aspect of the shader what we should see

209
00:09:36,339 --> 00:09:43,000
now is our as we move as we well we

210
00:09:41,259 --> 00:09:47,379
don't have to move as we look through

211
00:09:43,000 --> 00:09:49,929
the world we should see color gradients

212
00:09:47,379 --> 00:09:53,620
that represent where you are in the

213
00:09:49,929 --> 00:09:55,000
voxels right and we kind of do so you

214
00:09:53,620 --> 00:09:58,509
know you can kind of see that at least

215
00:09:55,000 --> 00:10:02,019
the voxel interpolation isn't total crap

216
00:09:58,509 --> 00:10:04,179
you can see that as you go up you hit

217
00:10:02,019 --> 00:10:05,889
voxel boundaries here like there's the

218
00:10:04,179 --> 00:10:07,719
blue and then it resets and there's the

219
00:10:05,889 --> 00:10:10,028
next one you can see here that we've a

220
00:10:07,720 --> 00:10:11,500
lot of oxalá aligned with the grid

221
00:10:10,028 --> 00:10:16,120
squares which is something we wanted

222
00:10:11,500 --> 00:10:18,070
right and so you know we know that the

223
00:10:16,120 --> 00:10:19,240
voxel interpolation is at least not

224
00:10:18,070 --> 00:10:22,510
completely borked

225
00:10:19,240 --> 00:10:24,730
it looks pretty reasonable right and so

226
00:10:22,509 --> 00:10:27,970
that's just one way again of trying to

227
00:10:24,730 --> 00:10:33,000
eliminate the number of things that

228
00:10:27,970 --> 00:10:35,110
could be wrong here insofar as the

229
00:10:33,000 --> 00:10:37,799
interpolation of the voxels go that's

230
00:10:35,110 --> 00:10:41,019
one way we can sort of you know try to

231
00:10:37,799 --> 00:10:42,250
try to eliminate failure cases right try

232
00:10:41,019 --> 00:10:44,549
to eliminate the things that that might

233
00:10:42,250 --> 00:10:44,549
be bad

234
00:10:44,710 --> 00:10:49,600
so alright so given that's what we're

235
00:10:47,379 --> 00:10:51,460
doing here when we actually go to sample

236
00:10:49,600 --> 00:10:52,779
this lining we kind of need now to start

237
00:10:51,460 --> 00:10:55,000
filling this routine because we've got

238
00:10:52,779 --> 00:10:56,860
everything else we figured out the

239
00:10:55,000 --> 00:10:58,240
direction we want to sample it's this we

240
00:10:56,860 --> 00:11:00,519
figured out the locations we want to

241
00:10:58,240 --> 00:11:02,769
sample it's these we're calling and

242
00:11:00,519 --> 00:11:05,559
requesting those samples and so the only

243
00:11:02,769 --> 00:11:09,610
thing we're really not doing is actually

244
00:11:05,559 --> 00:11:11,529
taking the sample and if we were just

245
00:11:09,610 --> 00:11:13,539
sampling into one light map this would

246
00:11:11,529 --> 00:11:16,959
be pretty easy all we would have to do

247
00:11:13,539 --> 00:11:19,059
is use this acht X this is like a UV

248
00:11:16,960 --> 00:11:21,009
coordinate basically to look up into the

249
00:11:19,059 --> 00:11:22,509
texture and that would be the answer

250
00:11:21,009 --> 00:11:27,309
that we were actually looking for right

251
00:11:22,509 --> 00:11:29,620
so it'd be quite simple the problem is

252
00:11:27,309 --> 00:11:32,199
because we're using an unwrapped texture

253
00:11:29,620 --> 00:11:34,360
atlas we actually have to figure out

254
00:11:32,200 --> 00:11:37,090
where in the texture we're even going to

255
00:11:34,360 --> 00:11:40,149
sample from and we need to use use the

256
00:11:37,090 --> 00:11:42,940
vox ID vox i part of things to even

257
00:11:40,149 --> 00:11:45,819
figure out where that happens right we

258
00:11:42,940 --> 00:11:48,460
have no idea how where this actually

259
00:11:45,820 --> 00:11:51,010
would be so we don't know how to

260
00:11:48,460 --> 00:11:53,280
interpret this UV coordinate at all we

261
00:11:51,009 --> 00:11:55,750
just have a UV that's handed to us and

262
00:11:53,279 --> 00:11:58,269
we don't know where in that texture to

263
00:11:55,750 --> 00:12:00,789
sample so remember it's this giant

264
00:11:58,269 --> 00:12:03,100
texture this is a small subset of a

265
00:12:00,789 --> 00:12:04,870
giant texture right that has all of

266
00:12:03,100 --> 00:12:08,019
these little light maps and the acht

267
00:12:04,870 --> 00:12:11,590
Bart tells us we're in this little 2d

268
00:12:08,019 --> 00:12:13,120
box we want a sample so in order to make

269
00:12:11,590 --> 00:12:15,460
any use of it we've got to figure out

270
00:12:13,120 --> 00:12:17,139
well where is the box right we've got to

271
00:12:15,460 --> 00:12:20,019
figure out this the the actual

272
00:12:17,139 --> 00:12:23,289
dimensions and location of that box

273
00:12:20,019 --> 00:12:28,090
inside the texture so that we can apply

274
00:12:23,289 --> 00:12:30,129
this oft to that as an offset right so

275
00:12:28,090 --> 00:12:33,070
fundamentally what we need to do here is

276
00:12:30,129 --> 00:12:34,480
we need to take a texture sample and we

277
00:12:33,070 --> 00:12:36,010
kind of want to take two of them even

278
00:12:34,480 --> 00:12:38,170
though we don't really need to take two

279
00:12:36,009 --> 00:12:40,960
of them quite yet because we don't have

280
00:12:38,169 --> 00:12:42,339
anything in the depth channel that we

281
00:12:40,960 --> 00:12:44,080
cared about but eventually we're going

282
00:12:42,340 --> 00:12:47,320
to so we'd like to support that just as

283
00:12:44,080 --> 00:12:48,910
an optional feature as we go but if we

284
00:12:47,320 --> 00:12:50,950
go through here and say all right we've

285
00:12:48,909 --> 00:12:53,139
got two samplers we've got a light color

286
00:12:50,950 --> 00:12:54,220
sampler and a depth color sampler we

287
00:12:53,139 --> 00:12:56,679
know we're going to want to take a

288
00:12:54,220 --> 00:12:58,019
texture sampler here a texture sample we

289
00:12:56,679 --> 00:13:02,008
know we want it to be by

290
00:12:58,019 --> 00:13:05,009
linear and we want to have like a sample

291
00:13:02,009 --> 00:13:06,480
UV that we're going to use so we know

292
00:13:05,009 --> 00:13:10,589
that it's going to look something like

293
00:13:06,480 --> 00:13:12,629
this where we take a sample UV we feed

294
00:13:10,589 --> 00:13:15,389
it to the texture sampler we get back

295
00:13:12,629 --> 00:13:18,298
some results and then we know we have a

296
00:13:15,389 --> 00:13:21,329
result that we're going to return right

297
00:13:18,298 --> 00:13:23,039
and the result X Y Z is going to come

298
00:13:21,328 --> 00:13:30,868
from the light color and the result

299
00:13:23,039 --> 00:13:35,578
depth is going to come from the from the

300
00:13:30,869 --> 00:13:37,980
depth map right now we could also just

301
00:13:35,578 --> 00:13:39,899
pack all these together and honestly you

302
00:13:37,980 --> 00:13:42,449
know trying to think through in my head

303
00:13:39,899 --> 00:13:52,048
I don't actually know why we didn't do

304
00:13:42,448 --> 00:14:00,048
that does anybody know why we didn't

305
00:13:52,048 --> 00:14:00,048
just make a four-channel texture anyone

306
00:14:00,379 --> 00:14:05,329
were we just really dumb I mean when I

307
00:14:03,720 --> 00:14:09,480
get to this point in the code I'm like

308
00:14:05,328 --> 00:14:11,609
why the heck are we using to texture

309
00:14:09,480 --> 00:14:17,938
samplers where we could have just used

310
00:14:11,610 --> 00:14:21,089
one texture is am I just am I am I just

311
00:14:17,938 --> 00:14:26,219
did we just not think of it I mean there

312
00:14:21,089 --> 00:14:28,199
are some really esoteric reasons why we

313
00:14:26,220 --> 00:14:30,089
might not like for example if we wanted

314
00:14:28,198 --> 00:14:37,649
to use 16 bits for storing the depth

315
00:14:30,089 --> 00:14:40,139
sample or something so maybe that's it

316
00:14:37,649 --> 00:14:42,119
let's try to make ourselves feel better

317
00:14:40,139 --> 00:14:44,129
and say that the reason we did that is

318
00:14:42,119 --> 00:14:47,970
because we really wanted to be able to

319
00:14:44,129 --> 00:14:51,869
store 16-bit or 32-bit depth buffer for

320
00:14:47,970 --> 00:14:54,839
this lighting let's just say that it's

321
00:14:51,869 --> 00:14:59,369
probably not true probably totally false

322
00:14:54,839 --> 00:15:00,449
but let's just say that but I have a

323
00:14:59,369 --> 00:15:01,949
feeling we're probably gonna end up

324
00:15:00,448 --> 00:15:05,609
switching this because that just looks

325
00:15:01,948 --> 00:15:06,298
stupid so that's really stupid oops but

326
00:15:05,610 --> 00:15:08,699
there we go

327
00:15:06,298 --> 00:15:11,039
so this is what it's going to look like

328
00:15:08,698 --> 00:15:12,028
so eventually we'll probably just take

329
00:15:11,039 --> 00:15:15,500
one section

330
00:15:12,028 --> 00:15:19,799
and we'll roll these all into one right

331
00:15:15,500 --> 00:15:21,778
so you know because we don't need the

332
00:15:19,799 --> 00:15:23,609
depth to be super precise right it

333
00:15:21,778 --> 00:15:27,688
probably could be stored as 0 to 255

334
00:15:23,610 --> 00:15:30,889
just fine so it's just frustrating

335
00:15:27,688 --> 00:15:33,120
anyway it doesn't matter point being

336
00:15:30,889 --> 00:15:34,860
we'll do whatever we do it's fine

337
00:15:33,120 --> 00:15:37,049
everyone's happy we'll figure something

338
00:15:34,860 --> 00:15:39,000
out later and you know maybe this wants

339
00:15:37,049 --> 00:15:40,528
to be more HDR as well maybe we want 16

340
00:15:39,000 --> 00:15:42,120
you know I probably want one texture

341
00:15:40,528 --> 00:15:42,480
that's 16 bits per channel it doesn't

342
00:15:42,120 --> 00:15:44,549
matter

343
00:15:42,480 --> 00:15:46,110
forget about it we do stupid things

344
00:15:44,549 --> 00:15:46,789
sometimes everyone makes mistakes it's

345
00:15:46,110 --> 00:15:51,209
okay

346
00:15:46,789 --> 00:15:53,669
sample lighting needs to have this UV

347
00:15:51,208 --> 00:15:56,338
that's the part that we don't know right

348
00:15:53,669 --> 00:15:57,838
so we've set everything up we're passing

349
00:15:56,339 --> 00:16:00,000
in all the information what we don't

350
00:15:57,839 --> 00:16:02,339
know is what the sample UV is so

351
00:16:00,000 --> 00:16:04,379
fundamentally our job today is to figure

352
00:16:02,339 --> 00:16:06,300
out what this sample UV should actually

353
00:16:04,379 --> 00:16:08,339
be so we can figure out what the

354
00:16:06,299 --> 00:16:11,370
lighting actually needs to be at that

355
00:16:08,339 --> 00:16:15,000
point and if you look through here where

356
00:16:11,370 --> 00:16:19,679
we've got this sort of using the diffuse

357
00:16:15,000 --> 00:16:21,839
color and so on that part we may want to

358
00:16:19,679 --> 00:16:24,750
roll in here but I'm gonna assume now I

359
00:16:21,839 --> 00:16:26,990
don't know but I'm gonna assume that it

360
00:16:24,750 --> 00:16:32,458
would be probably the right call

361
00:16:26,990 --> 00:16:36,600
efficiency wise to do our lips first so

362
00:16:32,458 --> 00:16:38,188
get our light values lerp down for the

363
00:16:36,600 --> 00:16:41,220
light coming from that direction first

364
00:16:38,188 --> 00:16:43,409
and then anything that we want to do for

365
00:16:41,220 --> 00:16:46,439
light computations would kind of come in

366
00:16:43,409 --> 00:16:50,759
here right so I'm assuming we would lurk

367
00:16:46,438 --> 00:16:53,068
first and then do it but I don't know so

368
00:16:50,759 --> 00:16:55,350
if we want to get fancier later I mean

369
00:16:53,068 --> 00:16:58,919
we could go ahead and have something in

370
00:16:55,350 --> 00:17:00,870
here where we say Oh like okay we

371
00:16:58,919 --> 00:17:04,408
actually do some kind of light blending

372
00:17:00,870 --> 00:17:07,470
in here I don't know so I guess I

373
00:17:04,409 --> 00:17:10,799
couldn't really say I don't have a I

374
00:17:07,470 --> 00:17:12,150
don't have a real solid understanding of

375
00:17:10,798 --> 00:17:13,349
how we're gonna integrate these yet

376
00:17:12,150 --> 00:17:15,480
that's going to come a little bit later

377
00:17:13,349 --> 00:17:17,849
for right now let's just say we're gonna

378
00:17:15,480 --> 00:17:20,250
blend all of the lighting first and then

379
00:17:17,849 --> 00:17:23,250
modulate or do a reflection vector or

380
00:17:20,250 --> 00:17:24,689
whatever we want after that so we're

381
00:17:23,250 --> 00:17:25,220
just gonna we're just going to take the

382
00:17:24,689 --> 00:17:27,380
raw

383
00:17:25,220 --> 00:17:30,110
action vector and look it up in the

384
00:17:27,380 --> 00:17:32,299
light map blend that together as a voxel

385
00:17:30,109 --> 00:17:35,408
blend and then do any modulation or

386
00:17:32,298 --> 00:17:39,460
anything we're not going to do on each

387
00:17:35,409 --> 00:17:41,929
individual lookup a separate sort of

388
00:17:39,460 --> 00:17:44,990
modulation or specular or anything like

389
00:17:41,929 --> 00:17:46,880
that right so we may want to switch that

390
00:17:44,990 --> 00:17:48,620
may not be what we want to do in the

391
00:17:46,880 --> 00:17:52,340
long run but it's sort of what we're

392
00:17:48,619 --> 00:17:54,079
doing here right okay so when we sample

393
00:17:52,339 --> 00:17:56,808
the lighting we're gonna go ahead and do

394
00:17:54,079 --> 00:18:00,319
this and we just need to figure out what

395
00:17:56,808 --> 00:18:02,899
the sample UV is so the acht is kind of

396
00:18:00,319 --> 00:18:05,808
a known quantity that's the offset

397
00:18:02,900 --> 00:18:08,990
inside the Texel square that we actually

398
00:18:05,808 --> 00:18:13,220
need to use and so we kind of know that

399
00:18:08,990 --> 00:18:16,159
dimension upfront I would argue right we

400
00:18:13,220 --> 00:18:17,630
kind of know that we've got a constant

401
00:18:16,159 --> 00:18:20,900
it's in other words it's never gonna

402
00:18:17,630 --> 00:18:24,950
vary that's just the UV span like the

403
00:18:20,900 --> 00:18:28,580
this the region in UV space taken up by

404
00:18:24,950 --> 00:18:31,069
an 8 by 8 right so an 8 pixel by 8 pixel

405
00:18:28,579 --> 00:18:37,029
area in this thing we know that we've

406
00:18:31,069 --> 00:18:39,470
got a like an acht map dim value here

407
00:18:37,029 --> 00:18:42,259
that we're gonna measure this by and

408
00:18:39,470 --> 00:18:44,960
this is a 2d multiplier this is a hat

409
00:18:42,259 --> 00:18:47,960
amarte product here the Ox map dim

410
00:18:44,960 --> 00:18:49,490
itself is going to be different in U and

411
00:18:47,960 --> 00:18:52,360
V and the reason for that is we're

412
00:18:49,490 --> 00:18:55,460
looking up using actual UV coordinates

413
00:18:52,359 --> 00:19:00,649
not pixel coordinates although you know

414
00:18:55,460 --> 00:19:02,990
I wonder if we should be using because

415
00:19:00,650 --> 00:19:05,538
you might not I don't I don't know if

416
00:19:02,990 --> 00:19:07,640
you're able to do by linear with

417
00:19:05,538 --> 00:19:08,869
straight pixel though do you have to you

418
00:19:07,640 --> 00:19:10,280
may have to pass you views for that so

419
00:19:08,869 --> 00:19:11,750
we're gonna we'll stick with you these

420
00:19:10,279 --> 00:19:14,690
for next it doesn't really matter which

421
00:19:11,750 --> 00:19:16,970
one we use to be honest anyway so the

422
00:19:14,690 --> 00:19:19,220
octave is going to be different it's

423
00:19:16,970 --> 00:19:21,470
going to be a different height and with

424
00:19:19,220 --> 00:19:23,569
the they're not the same so this is an

425
00:19:21,470 --> 00:19:26,179
actual to D value it's not a single

426
00:19:23,569 --> 00:19:27,619
scalar that multiplies the size of this

427
00:19:26,179 --> 00:19:29,840
thing it's two different scalars because

428
00:19:27,619 --> 00:19:33,829
it stretches it since we know that our

429
00:19:29,839 --> 00:19:35,058
texture is non-uniform so even though

430
00:19:33,829 --> 00:19:37,939
it's a square these are two different

431
00:19:35,058 --> 00:19:39,019
values we then need to do an offset and

432
00:19:37,940 --> 00:19:41,240
the offset

433
00:19:39,019 --> 00:19:43,639
needs to put us at the base so we need

434
00:19:41,240 --> 00:19:46,059
to say like what's the acht map you know

435
00:19:43,640 --> 00:19:48,890
min P basically what's the minimum

436
00:19:46,059 --> 00:19:51,409
position of this thing and and I guess

437
00:19:48,890 --> 00:19:53,780
we could say maybe UV right and this is

438
00:19:51,410 --> 00:19:55,370
a UV dim like these are both in UV

439
00:19:53,779 --> 00:19:58,329
coordinates in UV space we're not

440
00:19:55,369 --> 00:20:01,969
talking about pixels or texels here and

441
00:19:58,329 --> 00:20:03,859
so this opt map min UV that's the main

442
00:20:01,970 --> 00:20:07,430
thing we're going to have to compute and

443
00:20:03,859 --> 00:20:11,299
this acht map UV dim is actually we kind

444
00:20:07,430 --> 00:20:14,090
of need two of these right we need a you

445
00:20:11,299 --> 00:20:16,309
know we need an interior right so the

446
00:20:14,089 --> 00:20:18,859
the 8x8 part were actually that we're

447
00:20:16,309 --> 00:20:20,720
actually using for sampling and then

448
00:20:18,859 --> 00:20:25,039
there's the wider part that has that

449
00:20:20,720 --> 00:20:27,049
gutter right and so the acht map menu v

450
00:20:25,039 --> 00:20:29,269
is going to be based on a different

451
00:20:27,049 --> 00:20:32,329
value right that's going to be based on

452
00:20:29,269 --> 00:20:37,210
the Vox I plus the DeVos I right that

453
00:20:32,329 --> 00:20:41,269
that combination there gives us a

454
00:20:37,210 --> 00:20:42,860
numerical index that and in fact you

455
00:20:41,269 --> 00:20:46,940
know what we got it because these are 3d

456
00:20:42,859 --> 00:20:49,279
we got to actually do the unpacking so

457
00:20:46,940 --> 00:20:51,799
we're gonna get an absolute indexing

458
00:20:49,279 --> 00:20:54,740
here right and then we have to

459
00:20:51,799 --> 00:20:58,009
essentially emulate this gigantic mess

460
00:20:54,740 --> 00:21:01,460
right because we now have to figure out

461
00:20:58,009 --> 00:21:02,150
okay exactly which pixel are we talking

462
00:21:01,460 --> 00:21:04,610
about here

463
00:21:02,150 --> 00:21:08,000
right and in order to do that I'm gonna

464
00:21:04,609 --> 00:21:09,439
take the octave part of this I think for

465
00:21:08,000 --> 00:21:14,210
the most part we're gonna try and make

466
00:21:09,440 --> 00:21:16,400
this we're gonna try and make this basis

467
00:21:14,210 --> 00:21:17,750
make a little bit more sense but you can

468
00:21:16,400 --> 00:21:20,690
see that it's basically gonna be the

469
00:21:17,750 --> 00:21:27,170
same exact equation so if we come in

470
00:21:20,690 --> 00:21:30,350
here we've got this oops I'll leave this

471
00:21:27,170 --> 00:21:32,390
like this for now if we're trying to

472
00:21:30,349 --> 00:21:35,149
look up these in U and V s we have to do

473
00:21:32,390 --> 00:21:38,270
the U and the V separately right so if

474
00:21:35,150 --> 00:21:41,360
you take a look at the Z the Z is just a

475
00:21:38,269 --> 00:21:45,079
u value right so this right here would

476
00:21:41,359 --> 00:21:49,250
be just a u value for the Z I'm sorry

477
00:21:45,079 --> 00:21:51,778
the V value for the Z and for the Y it

478
00:21:49,250 --> 00:21:55,138
would be just a V value

479
00:21:51,778 --> 00:21:56,608
right so if we look at the I'm sorry

480
00:21:55,138 --> 00:22:01,678
just a you value right so this is just

481
00:21:56,608 --> 00:22:04,558
just X and this is just Y now TX and T

482
00:22:01,679 --> 00:22:06,059
why we don't care about right because

483
00:22:04,558 --> 00:22:08,700
and the reason we don't care about them

484
00:22:06,058 --> 00:22:11,999
is those are actually coming from here

485
00:22:08,700 --> 00:22:14,190
right the TX and the tyr the interior

486
00:22:11,999 --> 00:22:20,489
look up and so this is just the part for

487
00:22:14,190 --> 00:22:22,679
getting us the base the Y says this is

488
00:22:20,489 --> 00:22:25,858
just the the equation we need for

489
00:22:22,679 --> 00:22:28,559
getting us the min corner right so we

490
00:22:25,858 --> 00:22:31,949
know we have the Z it's that we know we

491
00:22:28,558 --> 00:22:34,038
have the y oops it's that we know we

492
00:22:31,950 --> 00:22:38,098
have the X it's that they all came from

493
00:22:34,038 --> 00:22:41,009
Vox I Plus D Vox I so we have an index

494
00:22:38,098 --> 00:22:43,829
that we can use we then also have the V

495
00:22:41,009 --> 00:22:47,308
and the you now if we knew what to

496
00:22:43,829 --> 00:22:50,038
multiply these by right so we know we

497
00:22:47,308 --> 00:22:51,898
need a hot dim squared and öktem squared

498
00:22:50,038 --> 00:22:54,690
right and we know we need these we know

499
00:22:51,898 --> 00:23:01,978
we need those and we need them in UV so

500
00:22:54,690 --> 00:23:04,499
we need this right as a UV span so we

501
00:23:01,979 --> 00:23:09,989
kind of need something that's like I

502
00:23:04,499 --> 00:23:19,409
don't know how we would say this this is

503
00:23:09,989 --> 00:23:24,088
a Z span right that that seems good

504
00:23:19,409 --> 00:23:25,559
right that is how many pixels across we

505
00:23:24,088 --> 00:23:27,329
would have to go I've said that's how

506
00:23:25,558 --> 00:23:30,148
high pixels down we go for a Z span

507
00:23:27,329 --> 00:23:32,819
right and if we look at what's gonna

508
00:23:30,148 --> 00:23:36,598
happen here since we're actually doing

509
00:23:32,819 --> 00:23:41,009
lookups in Z we don't actually need the

510
00:23:36,598 --> 00:23:44,968
öktem that we don't need the X part of

511
00:23:41,009 --> 00:23:46,858
this right so if you think about how big

512
00:23:44,969 --> 00:23:48,838
a Z spans actually going to be that

513
00:23:46,858 --> 00:23:50,519
part's already taken care of because the

514
00:23:48,838 --> 00:23:52,378
texture sampler is gonna do that offset

515
00:23:50,519 --> 00:23:55,288
we were doing it manually but actually

516
00:23:52,378 --> 00:23:59,608
Sam's gonna do that so the acht exterior

517
00:23:55,288 --> 00:24:02,700
dim like this right moving by one octave

518
00:23:59,608 --> 00:24:06,108
C rear dim is all we actually need and

519
00:24:02,700 --> 00:24:06,109
we need it in UV space

520
00:24:06,220 --> 00:24:12,380
right so that's fine so that's how we

521
00:24:10,130 --> 00:24:15,260
would get our Z span but then we also

522
00:24:12,380 --> 00:24:18,110
need here we need a way to Spezza to

523
00:24:15,259 --> 00:24:22,099
move around for our eye and so we've got

524
00:24:18,109 --> 00:24:27,099
our atlas wise man and that's actually

525
00:24:22,099 --> 00:24:30,619
going to be you know this value oops

526
00:24:27,099 --> 00:24:33,199
so it's an ox exterior and I guess this

527
00:24:30,619 --> 00:24:39,679
is a should say V dim right we have an

528
00:24:33,200 --> 00:24:43,009
ox exterior vdm here or UV dim dot Y

529
00:24:39,680 --> 00:24:47,299
rather and then we have an ox exterior

530
00:24:43,009 --> 00:24:49,460
UV dim dot X here and then we need the

531
00:24:47,299 --> 00:24:53,409
number of these things that we've

532
00:24:49,460 --> 00:24:55,970
actually got right so whatever the the

533
00:24:53,410 --> 00:24:58,759
voxel like this is however many there

534
00:24:55,970 --> 00:25:02,930
are for the you know this is light

535
00:24:58,759 --> 00:25:05,180
lookup voxel dim right however many

536
00:25:02,930 --> 00:25:08,000
there are times whatever the exterior

537
00:25:05,180 --> 00:25:12,009
dimension is right and that's the why

538
00:25:08,000 --> 00:25:16,430
span so we would have atlas Z span here

539
00:25:12,009 --> 00:25:18,079
we would have atlas Y span here and then

540
00:25:16,430 --> 00:25:20,570
finally we would just need the Atlas

541
00:25:18,079 --> 00:25:30,639
expand and that is again just a single

542
00:25:20,569 --> 00:25:33,619
one right so those are the actual

543
00:25:30,640 --> 00:25:35,120
multipliers that we need and you can

544
00:25:33,619 --> 00:25:39,589
kind of see that these are the same

545
00:25:35,119 --> 00:25:42,769
multiplier right and so if we wanted to

546
00:25:39,589 --> 00:25:45,589
we probably could simplify this down a

547
00:25:42,769 --> 00:25:49,250
little bit by just saying like oh well

548
00:25:45,589 --> 00:25:52,609
this is actually just that if we

549
00:25:49,250 --> 00:25:56,059
pre-multiply this thing right so if this

550
00:25:52,609 --> 00:25:59,689
was light lookup voxel dim x iy right

551
00:25:56,059 --> 00:26:03,289
plus I dot X then we could just multiply

552
00:25:59,690 --> 00:26:06,380
the whole thing by the X fan which is

553
00:26:03,289 --> 00:26:09,500
this right and then we know that the Z

554
00:26:06,380 --> 00:26:14,680
is just moving by the Z span which is

555
00:26:09,500 --> 00:26:16,470
this and then we've got our equations

556
00:26:14,680 --> 00:26:18,360
right

557
00:26:16,470 --> 00:26:22,650
finally we know that this is actually

558
00:26:18,359 --> 00:26:26,699
the min UV that we actually want right

559
00:26:22,650 --> 00:26:29,370
so this we can create just on the fly

560
00:26:26,700 --> 00:26:46,650
here by saying it's a V to you and the

561
00:26:29,369 --> 00:26:49,259
values are that and that right so at

562
00:26:46,650 --> 00:26:52,890
that point we've got you know I don't

563
00:26:49,259 --> 00:26:54,629
know a reasonable argument for what we

564
00:26:52,890 --> 00:26:57,060
would want to set up here to do our

565
00:26:54,630 --> 00:26:59,780
voxel sampling we would get the menu we

566
00:26:57,059 --> 00:27:02,359
would sample it except for one problem

567
00:26:59,779 --> 00:27:04,649
this will put us at the minimum corner

568
00:27:02,359 --> 00:27:07,879
but it won't account for the border

569
00:27:04,650 --> 00:27:12,480
right so we need to move ourselves in

570
00:27:07,880 --> 00:27:16,140
one pixel right so we need one more

571
00:27:12,480 --> 00:27:21,420
value here which is the Ox exterior to

572
00:27:16,140 --> 00:27:26,730
interior step right we need you know we

573
00:27:21,420 --> 00:27:28,680
need one pixel one texel in X&amp;Y to get

574
00:27:26,730 --> 00:27:31,200
us from the border region into the

575
00:27:28,680 --> 00:27:35,549
interior part where the UV lookup will

576
00:27:31,200 --> 00:27:37,920
actually occur so I think this is how we

577
00:27:35,549 --> 00:27:39,809
place ourselves into the correct voxel

578
00:27:37,920 --> 00:27:42,539
and you can see that there's a bunch of

579
00:27:39,809 --> 00:27:45,179
things we need to actually specify here

580
00:27:42,539 --> 00:27:47,940
right we need a bunch of values to be

581
00:27:45,180 --> 00:27:50,310
specified in this thing and those values

582
00:27:47,940 --> 00:27:53,070
specifically are the light lookup voxel

583
00:27:50,309 --> 00:27:59,730
dim which we already have then we need

584
00:27:53,069 --> 00:28:04,619
the octa-core UV dim in X&amp;Y right and

585
00:27:59,730 --> 00:28:09,210
then we need the acht exterior to

586
00:28:04,619 --> 00:28:13,939
interior step oops and then we need the

587
00:28:09,210 --> 00:28:13,940
Octomom inter UV dim right

588
00:28:15,529 --> 00:28:21,899
so we essentially need to make three

589
00:28:18,029 --> 00:28:24,149
different values its these they are 2d

590
00:28:21,900 --> 00:28:26,519
values so in each case we need to

591
00:28:24,150 --> 00:28:44,820
actually define some floating point

592
00:28:26,519 --> 00:28:47,400
stuff here right and off we go now we

593
00:28:44,819 --> 00:28:49,950
can also sort of to be honest we don't

594
00:28:47,400 --> 00:28:51,690
have to actually compute these ourselves

595
00:28:49,950 --> 00:28:53,519
here we could actually just let the

596
00:28:51,690 --> 00:28:56,460
shader compute them for us which we

597
00:28:53,519 --> 00:28:58,680
might want to do because all of these

598
00:28:56,460 --> 00:29:00,690
things are going to actually just be

599
00:28:58,680 --> 00:29:03,990
based off of the total dimension of the

600
00:29:00,690 --> 00:29:06,269
texture right and we kind of know what

601
00:29:03,990 --> 00:29:08,039
that actually is if we get one more

602
00:29:06,269 --> 00:29:10,529
value so if we take a look at where the

603
00:29:08,039 --> 00:29:12,509
light lookup Fox will dim actually is we

604
00:29:10,529 --> 00:29:14,039
note that we've got the other thing here

605
00:29:12,509 --> 00:29:16,859
which is the light color lookup square

606
00:29:14,039 --> 00:29:19,009
dim right and that's all we really need

607
00:29:16,859 --> 00:29:21,599
to do to find that UV coordinate

608
00:29:19,009 --> 00:29:28,410
fortunately for us I think

609
00:29:21,599 --> 00:29:30,389
I think these UV coordinates because we

610
00:29:28,410 --> 00:29:32,910
know they're they're always going to be

611
00:29:30,390 --> 00:29:35,040
the same I think I think it just divides

612
00:29:32,910 --> 00:29:37,710
out because if you think about it no

613
00:29:35,039 --> 00:29:40,379
matter what the square dimension is it

614
00:29:37,710 --> 00:29:42,269
should just always work well no that's

615
00:29:40,380 --> 00:29:49,620
not true because of the 1 pixel extra

616
00:29:42,269 --> 00:29:54,619
thing so yeah I mean I think in this

617
00:29:49,619 --> 00:29:57,329
case we may we may need to do a little

618
00:29:54,619 --> 00:30:02,009
we may need to do a little thinking here

619
00:29:57,329 --> 00:30:03,750
about to what extent we want this

620
00:30:02,009 --> 00:30:05,309
sampling be uniform because as I'm

621
00:30:03,750 --> 00:30:08,490
thinking about it the sampling is gonna

622
00:30:05,309 --> 00:30:12,000
be different if we allow these two

623
00:30:08,490 --> 00:30:13,799
lookups to be different sizes right so I

624
00:30:12,000 --> 00:30:15,150
do wonder if maybe we just want to call

625
00:30:13,799 --> 00:30:17,309
it ahead of time to say look we're not

626
00:30:15,150 --> 00:30:19,440
gonna we're not going to do two

627
00:30:17,309 --> 00:30:21,450
different dimensions the only reason I'm

628
00:30:19,440 --> 00:30:25,559
hesitant to do that is because when you

629
00:30:21,450 --> 00:30:28,049
look back at the at the original paper

630
00:30:25,559 --> 00:30:28,829
they use two different resolutions right

631
00:30:28,049 --> 00:30:31,799
so

632
00:30:28,829 --> 00:30:38,750
if you go not that paper if you look at

633
00:30:31,799 --> 00:30:38,750
this paper right my recollection is that

634
00:30:42,049 --> 00:30:55,109
here we go so here's the resolution of

635
00:30:50,309 --> 00:30:57,720
the depth map here's the resolution of

636
00:30:55,109 --> 00:31:07,099
the light map and I believe they're

637
00:30:57,720 --> 00:31:12,779
different let's see do they actually say

638
00:31:07,099 --> 00:31:16,649
anywhere I don't actually know if they

639
00:31:12,779 --> 00:31:18,149
do I'm looking I thought it said

640
00:31:16,650 --> 00:31:19,530
somewhere in here what the resolutions

641
00:31:18,150 --> 00:31:21,690
were I just it's hard to read papers

642
00:31:19,529 --> 00:31:25,920
online I apologize it's definitely the

643
00:31:21,690 --> 00:31:27,390
case that it's it's one of those things

644
00:31:25,920 --> 00:31:31,080
that's easy to do offline but hard to do

645
00:31:27,390 --> 00:31:38,520
online let's see

646
00:31:31,079 --> 00:31:42,059
resolution we encode a circular

647
00:31:38,519 --> 00:31:46,769
irradiance in 8 byte octahedral and 16

648
00:31:42,059 --> 00:31:48,899
by 16 octahedral for depth right so they

649
00:31:46,769 --> 00:31:54,569
very specifically double the depth

650
00:31:48,900 --> 00:31:56,009
resolution and so I you can see and they

651
00:31:54,569 --> 00:32:01,109
duplicate the butter gutter regions of

652
00:31:56,009 --> 00:32:02,789
both so like I really don't want to have

653
00:32:01,109 --> 00:32:04,139
to do that because you can kind of see

654
00:32:02,789 --> 00:32:07,829
why right we have to compute a

655
00:32:04,140 --> 00:32:09,390
completely different look up in if we

656
00:32:07,829 --> 00:32:10,949
want to have different resolutions if

657
00:32:09,390 --> 00:32:13,470
they're the same resolution we can just

658
00:32:10,950 --> 00:32:15,779
use one UV coordinate to look up into

659
00:32:13,470 --> 00:32:19,319
both maps or even combine the maps

660
00:32:15,779 --> 00:32:23,420
together and so I really would have

661
00:32:19,319 --> 00:32:26,490
wanted to not do that if I could have

662
00:32:23,420 --> 00:32:28,140
but I'm guessing that in their mind they

663
00:32:26,490 --> 00:32:29,970
were like look the computation is

664
00:32:28,140 --> 00:32:32,280
cheaper than the texture lookups on any

665
00:32:29,970 --> 00:32:34,440
of our high-end parts anyway so we'd

666
00:32:32,279 --> 00:32:36,750
rather just get more resolution for the

667
00:32:34,440 --> 00:32:40,179
depth map than

668
00:32:36,750 --> 00:32:41,798
then blow out the XP either have less

669
00:32:40,179 --> 00:32:43,419
resolution on the death map or more

670
00:32:41,798 --> 00:32:45,519
resolution on the color which would then

671
00:32:43,419 --> 00:32:47,020
lead to slower sampling times because we

672
00:32:45,519 --> 00:32:50,379
don't have the texture cache as

673
00:32:47,019 --> 00:32:52,269
frequently and bla bla bla right so I

674
00:32:50,380 --> 00:32:53,770
guess I don't know but my assumption is

675
00:32:52,269 --> 00:32:55,089
they were making those trade-offs and

676
00:32:53,769 --> 00:32:57,400
just decided that an extra computation

677
00:32:55,089 --> 00:32:59,379
in terms of how to do the lookup is not

678
00:32:57,400 --> 00:33:07,230
really a bad thing but I'm pretty sure

679
00:32:59,380 --> 00:33:10,090
that you do have to do it that way and

680
00:33:07,230 --> 00:33:13,120
again the reason for that is because the

681
00:33:10,089 --> 00:33:15,789
16 by 16 is not saying now there is one

682
00:33:13,119 --> 00:33:19,389
way you could do it if you used a 2

683
00:33:15,789 --> 00:33:22,808
pixel gutter instead of a 1 pixel gutter

684
00:33:19,390 --> 00:33:26,230
on the 16 by 16 s that would make the UV

685
00:33:22,808 --> 00:33:28,240
coordinates work the same right I mean

686
00:33:26,230 --> 00:33:29,529
I'm pretty sure because then the steps

687
00:33:28,240 --> 00:33:31,870
are the same you have a double the

688
00:33:29,529 --> 00:33:33,668
resolution so the UVs divide out cleanly

689
00:33:31,869 --> 00:33:36,308
there's no difference I don't think at

690
00:33:33,669 --> 00:33:38,380
that point so I'm pretty sure that would

691
00:33:36,308 --> 00:33:40,240
actually work and so maybe you would do

692
00:33:38,380 --> 00:33:43,540
that maybe that's what you would do you

693
00:33:40,240 --> 00:33:47,400
would do 16 times 4 in I was 16 plus 4

694
00:33:43,539 --> 00:33:50,409
instead of 8 plus 2 or 16 plus 2 and

695
00:33:47,400 --> 00:33:53,048
that that would allow you to use the

696
00:33:50,410 --> 00:33:55,179
same one so maybe we'll just say that

697
00:33:53,048 --> 00:34:00,250
that's what we would do if we had to if

698
00:33:55,179 --> 00:34:01,570
we had to make that version work and

699
00:34:00,250 --> 00:34:04,419
we'll just say look there's only gonna

700
00:34:01,569 --> 00:34:06,308
be one lookup in here right all right

701
00:34:04,419 --> 00:34:08,500
and so in this case we need one more

702
00:34:06,308 --> 00:34:12,668
thing here we're gonna want the the

703
00:34:08,500 --> 00:34:14,858
light the light lookup square dim and

704
00:34:12,668 --> 00:34:17,829
this is just going to be whatever the

705
00:34:14,858 --> 00:34:19,960
dimension of the square is versus the

706
00:34:17,829 --> 00:34:21,579
dimension of the voxel and again I'm

707
00:34:19,960 --> 00:34:25,418
trying to figure out does that just

708
00:34:21,579 --> 00:34:27,489
divide out and I don't really know I'm

709
00:34:25,418 --> 00:34:29,500
thinking it might in fact let's just do

710
00:34:27,489 --> 00:34:31,569
these on the whiteboard to see if it

711
00:34:29,500 --> 00:34:33,668
does because I'm thinking that it should

712
00:34:31,570 --> 00:34:35,320
because if I know that I could sample

713
00:34:33,668 --> 00:34:37,989
two different textures with two

714
00:34:35,320 --> 00:34:39,369
different size squares as long as the

715
00:34:37,989 --> 00:34:41,108
voxel dimension is the same that

716
00:34:39,369 --> 00:34:43,030
suggests that it must divide out so my

717
00:34:41,108 --> 00:34:45,659
intuition is telling me it should let's

718
00:34:43,030 --> 00:34:45,659
find out if that's true

719
00:34:57,900 --> 00:35:11,800
day five 579 voxel Atlas you v's so

720
00:35:09,010 --> 00:35:15,880
let's just work one through so I know

721
00:35:11,800 --> 00:35:19,269
that I have a dimension value that is

722
00:35:15,880 --> 00:35:25,390
the voxel dem so we've effectively got a

723
00:35:19,269 --> 00:35:27,309
you know a V like a vdm value and this

724
00:35:25,389 --> 00:35:30,250
is the same for all dimensions

725
00:35:27,309 --> 00:35:31,599
it's like 32 you know maybe it'll be 64

726
00:35:30,250 --> 00:35:35,590
someday but it's something like that

727
00:35:31,599 --> 00:35:38,940
right we know that we have an octahedral

728
00:35:35,590 --> 00:35:43,840
dimension and we know that that is eight

729
00:35:38,940 --> 00:35:46,929
at the moment right and we also have a

730
00:35:43,840 --> 00:35:55,809
like padded dimension let's say and

731
00:35:46,929 --> 00:35:58,239
that's 10 right or OD + 2 right so this

732
00:35:55,809 --> 00:36:00,159
is what we've got currently and we know

733
00:35:58,239 --> 00:36:02,919
that the way that we're doing these is

734
00:36:00,159 --> 00:36:05,289
we're putting them into an atlas that

735
00:36:02,920 --> 00:36:09,840
looks like this it is and I'll just

736
00:36:05,289 --> 00:36:13,719
simplify these two like V o and P right

737
00:36:09,840 --> 00:36:17,380
so we know that we've got a dimension

738
00:36:13,719 --> 00:36:20,139
this way of our texture is V squared

739
00:36:17,380 --> 00:36:26,559
because we're storing an XY sheet across

740
00:36:20,139 --> 00:36:29,049
right it's V squared times R oh right

741
00:36:26,559 --> 00:36:30,460
because we also need I'm sorry RP

742
00:36:29,050 --> 00:36:34,890
because we also need the padding right

743
00:36:30,460 --> 00:36:44,409
there and then we know similarly that

744
00:36:34,889 --> 00:36:46,389
our our vertical is V times P right so

745
00:36:44,409 --> 00:36:50,049
we've got V squared times P this way

746
00:36:46,389 --> 00:36:53,799
we've got V times P this way and that is

747
00:36:50,050 --> 00:36:56,940
the dimension of our texture so if we

748
00:36:53,800 --> 00:37:03,400
now want to talk about something like

749
00:36:56,940 --> 00:37:06,460
how far does you know what's the UV

750
00:37:03,400 --> 00:37:11,170
dimension for one of the for an oh right

751
00:37:06,460 --> 00:37:16,269
I want to know what the value is for

752
00:37:11,170 --> 00:37:19,450
over V squared P right that's the amount

753
00:37:16,269 --> 00:37:24,940
of movement inside texture space that I

754
00:37:19,449 --> 00:37:28,118
would need to have right so if I

755
00:37:24,940 --> 00:37:30,909
actually multiply this out I would get

756
00:37:28,119 --> 00:37:36,130
something like this I would have o over

757
00:37:30,909 --> 00:37:42,338
V squared times P but we know that P is

758
00:37:36,130 --> 00:37:46,390
actually o plus 2 right so I would end

759
00:37:42,338 --> 00:37:58,048
up with like V 2 times o plus V 2 or

760
00:37:46,389 --> 00:38:02,469
sorry - V - right so you know we have a

761
00:37:58,048 --> 00:38:03,599
problem where we have a V here I mean

762
00:38:02,469 --> 00:38:06,909
other way to do it would be to not

763
00:38:03,599 --> 00:38:13,329
expand it out but you would just have V

764
00:38:06,909 --> 00:38:16,719
squared x o+ - right and so in this case

765
00:38:13,329 --> 00:38:21,309
we have another sort of way of looking

766
00:38:16,719 --> 00:38:24,848
at what this value is going to be its V

767
00:38:21,309 --> 00:38:28,690
squared over oh oh plus 2 right so

768
00:38:24,849 --> 00:38:31,200
there's like a ratio here it's au over o

769
00:38:28,690 --> 00:38:36,010
plus 2 V squared

770
00:38:31,199 --> 00:38:39,029
you know I'm saying so we do know to a

771
00:38:36,010 --> 00:38:41,200
certain extent if we multiply this by 2

772
00:38:39,030 --> 00:38:46,329
everything in here would be multiplied

773
00:38:41,199 --> 00:38:49,149
by 2 right because if we double the

774
00:38:46,329 --> 00:38:51,700
padding double the Oh double the V right

775
00:38:49,150 --> 00:38:53,530
if all of those things got doubled they

776
00:38:51,699 --> 00:38:57,759
would all cancel each other out nicely

777
00:38:53,530 --> 00:38:59,589
right so I do think it's true that we

778
00:38:57,760 --> 00:39:04,450
can compute this without knowing the

779
00:38:59,588 --> 00:39:08,969
specifics here in a some sense right but

780
00:39:04,449 --> 00:39:17,199
the problem that we would have is we

781
00:39:08,969 --> 00:39:20,019
yeah like I'm sorry you know that's that

782
00:39:17,199 --> 00:39:22,139
I don't know why the V squares on the

783
00:39:20,019 --> 00:39:22,139
bottom

784
00:39:22,150 --> 00:39:26,559
so the one over V squared is the primary

785
00:39:25,000 --> 00:39:29,320
thing that we're looking at here and the

786
00:39:26,559 --> 00:39:31,389
oh / o plus two you can see it's almost

787
00:39:29,320 --> 00:39:33,130
1 right so it almost doesn't do anything

788
00:39:31,389 --> 00:39:36,099
but it's just to account for that

789
00:39:33,130 --> 00:39:37,599
padding so if we didn't have the padding

790
00:39:36,099 --> 00:39:39,969
this is why I kept saying the padding

791
00:39:37,599 --> 00:39:41,559
the padding right if we didn't have the

792
00:39:39,969 --> 00:39:46,809
padding we wouldn't need this thing

793
00:39:41,559 --> 00:39:50,829
right so what that means is to find the

794
00:39:46,809 --> 00:39:53,289
min point we're fine so the min point

795
00:39:50,829 --> 00:39:55,719
would just be you know all we needed for

796
00:39:53,289 --> 00:39:57,820
that was the padded dimension so that's

797
00:39:55,719 --> 00:40:01,329
just going to work out to be the padded

798
00:39:57,820 --> 00:40:04,900
part right so in order to find I guess

799
00:40:01,329 --> 00:40:08,289
what I'm saying is in order to find the

800
00:40:04,900 --> 00:40:10,480
a few of these things we don't have to

801
00:40:08,289 --> 00:40:12,789
care what their values are because for

802
00:40:10,480 --> 00:40:15,750
example two step two

803
00:40:12,789 --> 00:40:19,809
whatever the square part is the acht

804
00:40:15,750 --> 00:40:22,570
exterior UV dim this is just always 1

805
00:40:19,809 --> 00:40:25,150
over V squared right and the reason for

806
00:40:22,570 --> 00:40:29,220
that is if we we want to step by this

807
00:40:25,150 --> 00:40:33,369
much well if I want to say I'm going P

808
00:40:29,219 --> 00:40:37,750
over one of these values like V squared

809
00:40:33,369 --> 00:40:40,539
times P right the P's just cancel I

810
00:40:37,750 --> 00:40:43,030
always get 1 over V squared right so the

811
00:40:40,539 --> 00:40:53,369
octet steerer map is really easy it's

812
00:40:43,030 --> 00:40:53,370
just 1 over the this right

813
00:40:54,380 --> 00:41:00,780
and the only difference between the two

814
00:40:57,840 --> 00:41:04,650
values is we know that going across we

815
00:41:00,780 --> 00:41:07,560
have to square it right so the exterior

816
00:41:04,650 --> 00:41:09,420
UV dim is really pretty straightforward

817
00:41:07,559 --> 00:41:18,360
it's just the square do we have square

818
00:41:09,420 --> 00:41:20,460
in here yeah we do so producing that

819
00:41:18,360 --> 00:41:23,460
exterior UV dim is trivial and does not

820
00:41:20,460 --> 00:41:27,000
depend on the square itself it's just

821
00:41:23,460 --> 00:41:29,340
going to be and straight forward offset

822
00:41:27,000 --> 00:41:31,230
so what that tells me is maybe I don't

823
00:41:29,340 --> 00:41:33,329
have to panic as much if we look at

824
00:41:31,230 --> 00:41:35,849
what's happening here you can see that

825
00:41:33,329 --> 00:41:37,619
basically that part is going to be the

826
00:41:35,849 --> 00:41:40,469
same so this part is going to be the

827
00:41:37,619 --> 00:41:43,590
same this is the part that would change

828
00:41:40,469 --> 00:41:47,009
so the interior UV dim and the exterior

829
00:41:43,590 --> 00:41:50,400
to UV to interior UV step are the parts

830
00:41:47,010 --> 00:41:54,540
that might change however even this one

831
00:41:50,400 --> 00:42:01,950
I think wouldn't change cuz it's just

832
00:41:54,539 --> 00:42:07,259
one over well no that's not true I think

833
00:42:01,949 --> 00:42:10,980
this one does change because the the

834
00:42:07,260 --> 00:42:14,040
size of one pixel relative in either

835
00:42:10,980 --> 00:42:16,920
case is going to be proportional to how

836
00:42:14,039 --> 00:42:19,289
whatever the dimension was so this part

837
00:42:16,920 --> 00:42:22,260
we do have to change so the acht you

838
00:42:19,289 --> 00:42:24,480
know if we look at this we've got if we

839
00:42:22,260 --> 00:42:29,550
were sampling from two maps so we've got

840
00:42:24,480 --> 00:42:32,849
a sample D in a sample C right the

841
00:42:29,550 --> 00:42:35,550
octant earier to UV step C and D and C

842
00:42:32,849 --> 00:42:38,819
and D these the interior UV Jim and the

843
00:42:35,550 --> 00:42:43,859
interior UV step those actually do have

844
00:42:38,820 --> 00:42:46,170
to be changed I think we'll see but I'm

845
00:42:43,858 --> 00:42:48,630
pretty sure that's the case so when we

846
00:42:46,170 --> 00:42:51,930
actually do these here now these have to

847
00:42:48,630 --> 00:42:58,680
be done double right so we've got the

848
00:42:51,929 --> 00:43:03,089
exterior to interior step UV step how

849
00:42:58,679 --> 00:43:04,190
did I break those yep season these at

850
00:43:03,090 --> 00:43:07,800
the end

851
00:43:04,190 --> 00:43:11,760
so we've got the color one and the depth

852
00:43:07,800 --> 00:43:14,519
one and then these two now have to be

853
00:43:11,760 --> 00:43:20,550
based on two different values so we do

854
00:43:14,519 --> 00:43:32,579
have to know like look we do have to

855
00:43:20,550 --> 00:43:35,550
know both of these like so so we're

856
00:43:32,579 --> 00:43:39,929
gonna define them both and so in here

857
00:43:35,550 --> 00:43:42,510
we've got the light lookup voxel dim and

858
00:43:39,929 --> 00:43:44,789
in here we want to say all right we've

859
00:43:42,510 --> 00:43:49,020
got the light lookup voxel sorry the

860
00:43:44,789 --> 00:43:52,099
light color lookup square dim and the

861
00:43:49,019 --> 00:43:55,409
light depth lookup square damn right and

862
00:43:52,099 --> 00:43:58,860
we kind of want these we probably need

863
00:43:55,409 --> 00:44:02,909
to know for lack of a better term here

864
00:43:58,860 --> 00:44:07,500
we need to know the padding separate

865
00:44:02,909 --> 00:44:11,460
from the dim right so in some sense we

866
00:44:07,500 --> 00:44:14,340
kind of want this to be the padded bit

867
00:44:11,460 --> 00:44:16,139
right I mean I don't know we can just

868
00:44:14,340 --> 00:44:17,190
take the padding out I suppose but you

869
00:44:16,139 --> 00:44:20,909
see what I'm saying look it's a little

870
00:44:17,190 --> 00:44:22,559
bit confusing there but anyway let's go

871
00:44:20,909 --> 00:44:25,469
here let's go ahead and try to define

872
00:44:22,559 --> 00:44:27,539
these so the exterior to interior UV

873
00:44:25,469 --> 00:44:29,489
step see is pretty straightforward it's

874
00:44:27,539 --> 00:44:33,059
just 1 over the total dimension in each

875
00:44:29,489 --> 00:44:37,189
case right so it's one over and one over

876
00:44:33,059 --> 00:44:39,389
here and in this case we've got a square

877
00:44:37,190 --> 00:44:41,220
and square and you know what I'll be

878
00:44:39,389 --> 00:44:42,779
honest now I'm looking at this I'm

879
00:44:41,219 --> 00:44:44,669
thinking this doesn't everything you

880
00:44:42,780 --> 00:44:46,620
know all we needed was actually that I

881
00:44:44,670 --> 00:44:48,690
can just put these in the routine as

882
00:44:46,619 --> 00:44:51,089
long as they're constant the compiler

883
00:44:48,690 --> 00:44:53,119
will take care of it for me right so I

884
00:44:51,090 --> 00:44:56,510
can come in here and just say alright

885
00:44:53,119 --> 00:45:04,049
here's these values that we actually

886
00:44:56,510 --> 00:45:08,530
needed to have right

887
00:45:04,050 --> 00:45:14,470
and so if I go through here and just say

888
00:45:08,530 --> 00:45:17,320
alright here's all these constant

889
00:45:14,469 --> 00:45:22,419
vectors that I need to define so I've

890
00:45:17,320 --> 00:45:24,340
got 1 V 2 that's the you know sort of

891
00:45:22,420 --> 00:45:26,349
the the exterior dim that's always

892
00:45:24,340 --> 00:45:30,450
constant we only need one of them

893
00:45:26,349 --> 00:45:39,599
then I've got essentially all of these

894
00:45:30,449 --> 00:45:42,460
loops and the interior step versions are

895
00:45:39,599 --> 00:45:44,500
again pretty simple they're just one

896
00:45:42,460 --> 00:45:48,099
pixel over the total dimension of the

897
00:45:44,500 --> 00:45:50,110
texture so let's go ahead and compute

898
00:45:48,099 --> 00:45:54,309
that so the total dimension of the

899
00:45:50,110 --> 00:45:56,950
texture in in our case is going to be

900
00:45:54,309 --> 00:46:05,289
the square of the light lookup voxel dim

901
00:45:56,949 --> 00:46:06,819
and going XY z-- it's the square cuz

902
00:46:05,289 --> 00:46:11,440
that's somebody there are and then I

903
00:46:06,820 --> 00:46:15,070
have to multiply by however big the

904
00:46:11,440 --> 00:46:18,550
light voxels the lookup themselves is

905
00:46:15,070 --> 00:46:21,220
right so the color square in this case

906
00:46:18,550 --> 00:46:22,990
and then in this one it would be very

907
00:46:21,219 --> 00:46:24,939
similar only it's not squared so it's

908
00:46:22,989 --> 00:46:28,269
just the light lookup voxel dim times

909
00:46:24,940 --> 00:46:30,369
the light color right because there's

910
00:46:28,269 --> 00:46:32,679
voxel dims worth of them and they're

911
00:46:30,369 --> 00:46:35,199
this long so I believe that's the

912
00:46:32,679 --> 00:46:37,719
correct inverse look up there then in

913
00:46:35,199 --> 00:46:41,259
here we've got the interior step 4d

914
00:46:37,719 --> 00:46:43,689
again same exact equation the only

915
00:46:41,260 --> 00:46:47,820
difference now is instead of color we

916
00:46:43,690 --> 00:46:47,820
would change it to depth right

917
00:46:50,809 --> 00:46:56,099
so that's almost everything now we just

918
00:46:53,940 --> 00:47:02,190
need the interior versions of these and

919
00:46:56,099 --> 00:47:04,170
again same equation more or less the

920
00:47:02,190 --> 00:47:09,750
only difference now is that in addition

921
00:47:04,170 --> 00:47:11,070
to doing the interior UV the only

922
00:47:09,750 --> 00:47:14,099
difference now is instead of just going

923
00:47:11,070 --> 00:47:16,620
one we're going to go however big the

924
00:47:14,099 --> 00:47:19,199
interior part is so that's the light

925
00:47:16,619 --> 00:47:23,400
color lookup square dim and it's going

926
00:47:19,199 --> 00:47:27,000
to be minus two in this case because

927
00:47:23,400 --> 00:47:29,789
we're removing the padding and that's

928
00:47:27,000 --> 00:47:31,980
how big the interior would be now I

929
00:47:29,789 --> 00:47:34,380
think we've got the complete lookup for

930
00:47:31,980 --> 00:47:37,110
both that produces an actual light

931
00:47:34,380 --> 00:47:38,579
sample we probably are buggy here so

932
00:47:37,110 --> 00:47:41,280
it's probably not going to work

933
00:47:38,579 --> 00:47:44,069
and we gotta fix the compiler errors but

934
00:47:41,280 --> 00:47:45,990
I think that's actually it so once we do

935
00:47:44,070 --> 00:47:48,180
these computations which remember these

936
00:47:45,989 --> 00:47:49,969
are all free they're dis constants so it

937
00:47:48,179 --> 00:47:52,500
can do those when it compiles the shader

938
00:47:49,969 --> 00:47:55,739
and we shouldn't have to pay for them so

939
00:47:52,500 --> 00:47:59,190
all we're doing is this one ad we're

940
00:47:55,739 --> 00:48:02,069
doing these small ads and multiplies

941
00:47:59,190 --> 00:48:06,000
here so a couple F Mads and then one

942
00:48:02,070 --> 00:48:08,550
more sort of F mad and an addition here

943
00:48:06,000 --> 00:48:10,800
to get us to where we need to be for

944
00:48:08,550 --> 00:48:12,960
each sample and it's really not that

945
00:48:10,800 --> 00:48:15,120
expensive so doing two's not hugely

946
00:48:12,960 --> 00:48:16,920
problematic I mean that's not gonna I'm

947
00:48:15,119 --> 00:48:17,849
not gonna lose sleep over that compared

948
00:48:16,920 --> 00:48:20,130
to the other stuff we're doing in here

949
00:48:17,849 --> 00:48:22,199
so I'm gonna go ahead and say let's try

950
00:48:20,130 --> 00:48:24,180
and get this to sort of start working at

951
00:48:22,199 --> 00:48:26,549
all so I'm gonna see if we've got any

952
00:48:24,179 --> 00:48:28,949
compiler errors here I mean that's is

953
00:48:26,550 --> 00:48:30,840
that even a question of course we do and

954
00:48:28,949 --> 00:48:33,029
we're gonna go ahead and fix those so

955
00:48:30,840 --> 00:48:36,809
let's take a look at the fragment errors

956
00:48:33,030 --> 00:48:42,210
that we've got implicit narrowing of

957
00:48:36,809 --> 00:48:45,929
type from Veck for so we need to see

958
00:48:42,210 --> 00:48:47,929
what that is oh I thought oh I I'm

959
00:48:45,929 --> 00:48:51,949
behind in our movie I thought remedy

960
00:48:47,929 --> 00:48:54,899
displayed text nicer than that normally

961
00:48:51,949 --> 00:48:57,239
I thought it gave a little like

962
00:48:54,900 --> 00:48:59,809
scrolling window here I don't know when

963
00:48:57,239 --> 00:48:59,809
that stopped

964
00:49:01,469 --> 00:49:08,049
George did that go away

965
00:49:03,750 --> 00:49:10,960
Thomas stir thank you George yeah uh

966
00:49:08,050 --> 00:49:12,820
yeah that's what I'm looking for so you

967
00:49:10,960 --> 00:49:14,289
can see this really nice printout that I

968
00:49:12,820 --> 00:49:18,370
new remedy had it I just didn't remember

969
00:49:14,289 --> 00:49:21,099
how to get it so if you look here you

970
00:49:18,369 --> 00:49:23,019
can see we've got a problem where we

971
00:49:21,099 --> 00:49:25,719
were taking effect for and turning it

972
00:49:23,019 --> 00:49:27,579
into avec three I guess so I don't know

973
00:49:25,719 --> 00:49:35,919
where that's happening let's take a look

974
00:49:27,579 --> 00:49:39,840
and see oh it's right here top that

975
00:49:35,920 --> 00:49:41,740
should be an R so we're basing the

976
00:49:39,840 --> 00:49:54,880
red-green-blue channels and then the red

977
00:49:41,739 --> 00:49:56,859
channel of those textures sir alright so

978
00:49:54,880 --> 00:49:58,539
now in theory we're sampling lighting

979
00:49:56,860 --> 00:50:00,130
and I'll be honest this is actually

980
00:49:58,539 --> 00:50:02,619
closer than I thought we were going to

981
00:50:00,130 --> 00:50:04,510
get if you look at what we've got it

982
00:50:02,619 --> 00:50:06,130
sort of actually is doing some lighting

983
00:50:04,510 --> 00:50:08,890
it's clearly very buggy like you can see

984
00:50:06,130 --> 00:50:10,900
for whatever reason on this half of the

985
00:50:08,889 --> 00:50:12,759
screen it looks like any normals that

986
00:50:10,900 --> 00:50:14,619
are pointing in a particular direction

987
00:50:12,760 --> 00:50:16,390
or something or wrong or I don't know

988
00:50:14,619 --> 00:50:18,429
exactly what's happening there but you

989
00:50:16,389 --> 00:50:20,440
can see that's it's actually sort of

990
00:50:18,429 --> 00:50:23,859
doing some lighting and it actually is

991
00:50:20,440 --> 00:50:28,090
following the light as it moves so we're

992
00:50:23,860 --> 00:50:30,700
not totally screwed up here but we're

993
00:50:28,090 --> 00:50:35,620
not right like you can tell we've got

994
00:50:30,699 --> 00:50:37,750
obvious issues and they somehow seem to

995
00:50:35,619 --> 00:50:40,929
be screen related in some ways so that

996
00:50:37,750 --> 00:50:42,579
part is kind of confusing that's gonna

997
00:50:40,929 --> 00:50:43,989
because of the reflection vector and in

998
00:50:42,579 --> 00:50:45,250
fact I can prove that see how I move

999
00:50:43,989 --> 00:50:48,250
around that's gonna because of the

1000
00:50:45,250 --> 00:50:52,480
reflection vector so we've got some

1001
00:50:48,250 --> 00:50:55,000
issues there let's do some quick just

1002
00:50:52,480 --> 00:50:58,710
spot checking of the code and then what

1003
00:50:55,000 --> 00:51:00,880
I'd like to do is go ahead and move from

1004
00:50:58,710 --> 00:51:08,679
spot checking the code to trying to

1005
00:51:00,880 --> 00:51:10,599
figure out if we can maybe in addition

1006
00:51:08,679 --> 00:51:13,119
to spot check in the code I want to have

1007
00:51:10,599 --> 00:51:13,670
some way oh crap you know I just

1008
00:51:13,119 --> 00:51:16,730
realized

1009
00:51:13,670 --> 00:51:20,358
I keep making this mistake the

1010
00:51:16,730 --> 00:51:23,809
octahedral unwrapping gives us negative

1011
00:51:20,358 --> 00:51:29,289
one to one so we actually just want to

1012
00:51:23,809 --> 00:51:29,290
be in the Centers of these things which

1013
00:51:40,880 --> 00:51:51,869
actually so that's pretty cool so if we

1014
00:51:45,210 --> 00:51:58,289
use the center instead that also

1015
00:51:51,869 --> 00:52:01,230
eliminates one calculation right that's

1016
00:51:58,289 --> 00:52:04,920
interesting so if we go from the center

1017
00:52:01,230 --> 00:52:09,260
outward instead of from the corner then

1018
00:52:04,920 --> 00:52:11,818
you actually save one computation

1019
00:52:09,260 --> 00:52:25,740
because you don't care how big the

1020
00:52:11,818 --> 00:52:29,250
border was right this if you just don't

1021
00:52:25,739 --> 00:52:32,539
do that right then everything works

1022
00:52:29,250 --> 00:52:41,849
right so if you get rid of this and just

1023
00:52:32,539 --> 00:52:45,929
say up opt map Center UV then you don't

1024
00:52:41,849 --> 00:52:50,119
care how what the dimension of the thing

1025
00:52:45,929 --> 00:52:54,358
is because the span is always half of

1026
00:52:50,119 --> 00:52:56,338
whatever the total step size was right

1027
00:52:54,358 --> 00:52:59,549
so it's always just going to be the

1028
00:52:56,338 --> 00:53:02,578
light the voxel dim point five hmm I

1029
00:52:59,550 --> 00:53:03,750
know I'm not explaining this well but

1030
00:53:02,579 --> 00:53:05,760
just hear me out

1031
00:53:03,750 --> 00:53:07,530
I believe what I'm saying is true we'll

1032
00:53:05,760 --> 00:53:10,740
see in a second so you can see this

1033
00:53:07,530 --> 00:53:13,470
exterior to interior step UV see

1034
00:53:10,739 --> 00:53:15,509
nonsense we have here but actually we

1035
00:53:13,469 --> 00:53:19,049
don't need to do that because whatever

1036
00:53:15,510 --> 00:53:21,450
the acht exterior UV dim is that value

1037
00:53:19,050 --> 00:53:23,310
you can see how that value divided out

1038
00:53:21,449 --> 00:53:25,559
the size of the square it's always just

1039
00:53:23,309 --> 00:53:27,838
going to be one over however many

1040
00:53:25,559 --> 00:53:31,769
whatever the dimension was minus the

1041
00:53:27,838 --> 00:53:38,068
square size if we just do the octet ste

1042
00:53:31,769 --> 00:53:40,670
riyer UV dim by half so if we just say

1043
00:53:38,068 --> 00:53:40,670
go half

1044
00:53:49,259 --> 00:53:54,940
that always gets us to the center and

1045
00:53:51,969 --> 00:53:57,248
since we know the exterior you dim is

1046
00:53:54,940 --> 00:53:59,559
not dependent on what we decided the

1047
00:53:57,248 --> 00:54:03,248
square resolution was it should just

1048
00:53:59,559 --> 00:54:07,269
work so that gets rid of this nonsense

1049
00:54:03,248 --> 00:54:10,449
entirely right now I can see why they

1050
00:54:07,268 --> 00:54:11,828
were measuring from the center smart

1051
00:54:10,449 --> 00:54:13,118
people wrote this paper I said that

1052
00:54:11,829 --> 00:54:15,818
before and I meant it

1053
00:54:13,119 --> 00:54:17,890
right that's clever because now it

1054
00:54:15,818 --> 00:54:21,130
doesn't matter what the resolution is so

1055
00:54:17,889 --> 00:54:25,629
the only part that we have to care about

1056
00:54:21,130 --> 00:54:26,818
now is the span here and the span is

1057
00:54:25,630 --> 00:54:30,608
[Music]

1058
00:54:26,818 --> 00:54:32,650
going it's gonna have to be halved but

1059
00:54:30,608 --> 00:54:45,509
other than that it's fine

1060
00:54:32,650 --> 00:54:49,858
right right am I am I missing anything

1061
00:54:45,509 --> 00:54:49,858
so I want to say you can just do this

1062
00:54:49,889 --> 00:54:55,449
what we've got here and and you're good

1063
00:54:53,440 --> 00:55:00,159
to go

1064
00:54:55,449 --> 00:55:07,449
I don't think you can get rid of this

1065
00:55:00,159 --> 00:55:08,288
though I'm trying to think I can't think

1066
00:55:07,449 --> 00:55:10,689
of any way get rid of it and that's

1067
00:55:08,289 --> 00:55:13,809
again because the padding the ratio of

1068
00:55:10,690 --> 00:55:17,858
the padding to the size of the square if

1069
00:55:13,809 --> 00:55:21,489
that changes I think yeah I don't think

1070
00:55:17,858 --> 00:55:28,440
it's anything to do right that's my

1071
00:55:21,489 --> 00:55:28,440
thinking so let's see och map Center UV

1072
00:55:30,059 --> 00:55:38,489
is just a nominal a change so we should

1073
00:55:35,679 --> 00:55:38,489
be good to go here

1074
00:55:45,260 --> 00:55:53,960
so again like better but still wrong I

1075
00:55:51,599 --> 00:55:57,509
guess is how I would describe it right

1076
00:55:53,960 --> 00:56:00,480
we're getting there but from the looks

1077
00:55:57,510 --> 00:56:03,360
of it there's still a reflection vector

1078
00:56:00,480 --> 00:56:05,460
lookup error of some kind because there

1079
00:56:03,360 --> 00:56:08,309
shouldn't be discontinuities as we

1080
00:56:05,460 --> 00:56:10,500
rotate around there now one could argue

1081
00:56:08,309 --> 00:56:12,360
that there would be discontinuities

1082
00:56:10,500 --> 00:56:15,570
because we're not copying the border

1083
00:56:12,360 --> 00:56:20,099
pixels so that's true but they shouldn't

1084
00:56:15,570 --> 00:56:25,110
be as hard as that I don't think I mean

1085
00:56:20,099 --> 00:56:27,809
maybe I guess we should do the copy

1086
00:56:25,110 --> 00:56:30,630
first just to make sure that's not an

1087
00:56:27,809 --> 00:56:33,269
artifact of the sphere cut that we're

1088
00:56:30,630 --> 00:56:36,840
seeing there so cuz the bilinear filter

1089
00:56:33,269 --> 00:56:39,989
cause that I mean I just my intuition

1090
00:56:36,840 --> 00:56:42,090
says that that's a harder edge than the

1091
00:56:39,989 --> 00:56:46,229
bilinear filter off set could have been

1092
00:56:42,090 --> 00:56:47,820
causing but I don't know so I'm not

1093
00:56:46,230 --> 00:56:52,769
willing to necessarily say that that's

1094
00:56:47,820 --> 00:56:55,050
100% the truth yet right but still in

1095
00:56:52,769 --> 00:56:57,449
very encouraging because like I said it

1096
00:56:55,050 --> 00:57:01,410
for a first stab at it that's actually

1097
00:56:57,449 --> 00:57:03,179
remarkably good and you know if we look

1098
00:57:01,409 --> 00:57:07,489
at what we're getting for lighting here

1099
00:57:03,179 --> 00:57:07,489
I'm pretty happy about that right like

1100
00:57:12,829 --> 00:57:24,559
I mean that's a pretty good diffuse

1101
00:57:16,099 --> 00:57:26,420
lighting scenario there yeah so you know

1102
00:57:24,559 --> 00:57:29,090
again looking at what we're getting here

1103
00:57:26,420 --> 00:57:30,889
it looks like those to me look like sine

1104
00:57:29,090 --> 00:57:32,420
quadrant changes so when I look at that

1105
00:57:30,889 --> 00:57:34,219
I say okay that's right down the middle

1106
00:57:32,420 --> 00:57:36,619
of the screen fourth because we're using

1107
00:57:34,219 --> 00:57:38,599
a reflection vector here that's gonna be

1108
00:57:36,619 --> 00:57:40,730
when the X goes from positive to

1109
00:57:38,599 --> 00:57:42,589
negative so we're getting an error in

1110
00:57:40,730 --> 00:57:45,889
flipping the sign from positive negative

1111
00:57:42,590 --> 00:57:48,680
again I don't know let's do the copy I

1112
00:57:45,889 --> 00:57:50,509
mean why not we have to do it let's go

1113
00:57:48,679 --> 00:57:55,099
do the copy and try to get that copy

1114
00:57:50,510 --> 00:57:57,140
correct and and then we'll come back to

1115
00:57:55,099 --> 00:57:59,659
this because it's sort of working it's

1116
00:57:57,139 --> 00:58:01,519
not right there's some bugs I don't want

1117
00:57:59,659 --> 00:58:03,289
to debug something that I don't know if

1118
00:58:01,519 --> 00:58:05,239
there's just an artifact in it already

1119
00:58:03,289 --> 00:58:08,179
because of the fact that we're not doing

1120
00:58:05,239 --> 00:58:11,089
the seams properly and so I don't want

1121
00:58:08,179 --> 00:58:14,359
to I don't want to say for sure that

1122
00:58:11,090 --> 00:58:15,650
that is a problem one thing I could do

1123
00:58:14,360 --> 00:58:17,809
to sort of give us a little bit of

1124
00:58:15,650 --> 00:58:21,380
perspective on when that whether that is

1125
00:58:17,809 --> 00:58:24,320
a problem or not is when we actually do

1126
00:58:21,380 --> 00:58:26,510
the UV dim see UV dim D here so when we

1127
00:58:24,320 --> 00:58:30,350
couldn't compute these values where we

1128
00:58:26,510 --> 00:58:32,960
take the square Jim you know and we

1129
00:58:30,349 --> 00:58:35,569
divide it out what I could do is take

1130
00:58:32,960 --> 00:58:38,389
out an additional part of the span so I

1131
00:58:35,570 --> 00:58:41,500
could say like oh let's go narrower on

1132
00:58:38,389 --> 00:58:44,659
that let's let's actually divide it down

1133
00:58:41,500 --> 00:58:48,099
even a little bit more and see if that

1134
00:58:44,659 --> 00:58:51,349
produces less of an artifact right and

1135
00:58:48,099 --> 00:58:55,279
what I'm seeing here to me it's like no

1136
00:58:51,349 --> 00:59:03,409
it really doesn't right so to me I think

1137
00:58:55,280 --> 00:59:05,600
that's a pretty clear indication well

1138
00:59:03,409 --> 00:59:09,379
you know what no I I really I just look

1139
00:59:05,599 --> 00:59:10,639
and I couldn't tell you oops I just

1140
00:59:09,380 --> 00:59:13,640
can't I just can't make a call

1141
00:59:10,639 --> 00:59:16,369
sorry I don't think it's this but I just

1142
00:59:13,639 --> 00:59:19,460
I can't be sure I'm sorry so let's go

1143
00:59:16,369 --> 00:59:20,449
ahead and do the copy and maybe that'll

1144
00:59:19,460 --> 00:59:21,800
be the last thing you do today I don't

1145
00:59:20,449 --> 00:59:23,299
know if or you'll have time because we

1146
00:59:21,800 --> 00:59:25,210
have what do we have like well I you

1147
00:59:23,300 --> 00:59:27,109
know we got an hour

1148
00:59:25,210 --> 00:59:33,949
more or less

1149
00:59:27,108 --> 00:59:36,318
we have an hour I don't know maybe we

1150
00:59:33,949 --> 00:59:39,468
have an hour so maybe we will be able to

1151
00:59:36,318 --> 00:59:42,170
finish it and then go back to the shader

1152
00:59:39,469 --> 00:59:44,028
but I don't know the point is when we're

1153
00:59:42,170 --> 00:59:47,170
actually doing our copies here so you

1154
00:59:44,028 --> 00:59:49,880
can see us out putting our voxels here

1155
00:59:47,170 --> 00:59:52,219
but what we need to do after we do the

1156
00:59:49,880 --> 00:59:54,890
output is we need to actually do a

1157
00:59:52,219 --> 00:59:56,900
separate pass to do the copy so

1158
00:59:54,889 --> 01:00:00,048
effectively what we would get here is

1159
00:59:56,900 --> 01:00:11,329
one of these again basically this exact

1160
01:00:00,048 --> 01:00:13,088
same loop right and not sure what this

1161
01:00:11,329 --> 01:00:15,829
is about

1162
01:00:13,088 --> 01:00:17,328
hot corner and light amount yeah we

1163
01:00:15,829 --> 01:00:19,489
don't we're gonna we're not gonna do any

1164
01:00:17,329 --> 01:00:25,180
of the same or I don't think actually so

1165
01:00:19,489 --> 01:00:25,179
we're just gonna nerf this goodbye oops

1166
01:00:28,568 --> 01:00:33,259
alright so what I want to do now is I

1167
01:00:31,940 --> 01:00:34,999
want to go through and we're gonna do

1168
01:00:33,259 --> 01:00:39,409
another one of these which goes over

1169
01:00:34,998 --> 01:00:41,899
each voxel square but unlike the other

1170
01:00:39,409 --> 01:00:44,058
ones instead of iterating over the

1171
01:00:41,900 --> 01:00:47,180
square we're actually going to iterate

1172
01:00:44,059 --> 01:00:49,278
over the outside right so we're gonna

1173
01:00:47,179 --> 01:00:50,719
have a thing that looks something like

1174
01:00:49,278 --> 01:00:51,650
this it's not gonna look exactly like

1175
01:00:50,719 --> 01:00:53,269
this because we're only gonna probably

1176
01:00:51,650 --> 01:00:55,910
do half of it because each half is gonna

1177
01:00:53,268 --> 01:00:56,808
do its own thing but it's gonna look

1178
01:00:55,909 --> 01:01:00,018
something like this

1179
01:00:56,809 --> 01:01:03,380
right and we're gonna have the T Y copy

1180
01:01:00,018 --> 01:01:05,868
and the T X copy we have to decide which

1181
01:01:03,380 --> 01:01:08,329
one is gonna handle the corners I mean I

1182
01:01:05,869 --> 01:01:13,309
don't know but let's just say that it's

1183
01:01:08,329 --> 01:01:18,339
gonna be this one I think it would be

1184
01:01:13,309 --> 01:01:20,599
that way is that right yeah so the T Y

1185
01:01:18,338 --> 01:01:23,298
side will copy the whole thing with y

1186
01:01:20,599 --> 01:01:24,499
exponent you know what maybe let's think

1187
01:01:23,298 --> 01:01:29,478
about it let's let's do the opposite of

1188
01:01:24,498 --> 01:01:32,838
that so the horizontal one will do the

1189
01:01:29,478 --> 01:01:36,379
whole row and the T y1 will only do part

1190
01:01:32,838 --> 01:01:39,380
of the row right and so to do this what

1191
01:01:36,380 --> 01:01:40,160
we need to do is compute these voxel

1192
01:01:39,380 --> 01:01:41,900
coordinates and I

1193
01:01:40,159 --> 01:01:44,210
think we want to kind of make this a

1194
01:01:41,900 --> 01:01:46,099
little bit more systemic here so what

1195
01:01:44,210 --> 01:01:49,190
I'm guessing we want is sort of a

1196
01:01:46,099 --> 01:01:53,240
function that would work to compute

1197
01:01:49,190 --> 01:01:54,980
these based on the fundamental values so

1198
01:01:53,239 --> 01:02:07,429
we probably want like a voxel look up

1199
01:01:54,980 --> 01:02:09,048
here and you know I don't know so we

1200
01:02:07,429 --> 01:02:12,919
want some way of computing a voxel

1201
01:02:09,048 --> 01:02:19,280
offset from an XYZ so we want like you

1202
01:02:12,920 --> 01:02:22,010
know X Y Z T X T Y like that and then we

1203
01:02:19,280 --> 01:02:25,720
want to compute this value so we want

1204
01:02:22,010 --> 01:02:25,720
this to be something we can just get

1205
01:02:28,059 --> 01:02:36,140
right so we want this to happen we

1206
01:02:32,809 --> 01:02:38,530
probably want this to be wrapped so we

1207
01:02:36,139 --> 01:02:42,288
don't get surprises if people pass in

1208
01:02:38,530 --> 01:02:44,298
expressions for the x y&amp;z that would

1209
01:02:42,289 --> 01:02:46,609
then like disaggregate or something like

1210
01:02:44,298 --> 01:02:49,489
that so maybe something like this and

1211
01:02:46,608 --> 01:02:53,750
that way we can say okay yeah like we're

1212
01:02:49,489 --> 01:03:00,379
gonna fill these things and you know

1213
01:02:53,750 --> 01:03:04,420
what the the we can do this just by

1214
01:03:00,380 --> 01:03:04,420
doing a C and a D here

1215
01:03:09,699 --> 01:03:14,500
and and now we've got both so now we can

1216
01:03:12,550 --> 01:03:16,570
just kind of do these anywhere we want

1217
01:03:14,500 --> 01:03:18,579
and again we'll try to make this a

1218
01:03:16,570 --> 01:03:20,590
little bit more systemic later but for

1219
01:03:18,579 --> 01:03:23,199
now I don't care I just want to test it

1220
01:03:20,590 --> 01:03:24,730
and see if we can get it working so I'm

1221
01:03:23,199 --> 01:03:27,489
going to compile this I'm gonna switch

1222
01:03:24,730 --> 01:03:29,460
to using those macros and make sure that

1223
01:03:27,489 --> 01:03:31,869
they still write out the correct stuff

1224
01:03:29,460 --> 01:03:33,340
with what we have now so I want it to

1225
01:03:31,869 --> 01:03:37,449
look exactly like what I'm seeing on the

1226
01:03:33,340 --> 01:03:55,650
screen here and let's go ahead and and

1227
01:03:37,449 --> 01:03:56,889
put that in there and that should do it

1228
01:03:55,650 --> 01:03:59,769
right

1229
01:03:56,889 --> 01:04:04,679
so now if I recompile assuming it

1230
01:03:59,769 --> 01:04:07,000
actually works I can go ahead and check

1231
01:04:04,679 --> 01:04:10,119
to make sure it's still computing and

1232
01:04:07,000 --> 01:04:14,769
filling right and it does so let's go

1233
01:04:10,119 --> 01:04:17,559
ahead now and go into this part where we

1234
01:04:14,769 --> 01:04:20,949
do our copy and what I need to be able

1235
01:04:17,559 --> 01:04:26,230
to do is copy the voxels edges properly

1236
01:04:20,949 --> 01:04:29,139
and if you look we can use this diagram

1237
01:04:26,230 --> 01:04:33,070
to guide us because we know that we're

1238
01:04:29,139 --> 01:04:35,829
unwrapping stuff in this way and we know

1239
01:04:33,070 --> 01:04:39,910
we need to copy these pieces out so that

1240
01:04:35,829 --> 01:04:44,049
they line up and we can use the like

1241
01:04:39,909 --> 01:04:45,789
sort of the winding of these things to

1242
01:04:44,050 --> 01:04:48,400
make sure that we copy them properly so

1243
01:04:45,789 --> 01:04:53,679
for example we know that this edge right

1244
01:04:48,400 --> 01:04:56,530
here is this right so we know that we

1245
01:04:53,679 --> 01:04:59,679
need to take whatever was like right

1246
01:04:56,530 --> 01:05:01,480
here and put it right there you know

1247
01:04:59,679 --> 01:05:07,569
what I'm saying to you we need to like

1248
01:05:01,480 --> 01:05:10,389
copy those we need to copy from one part

1249
01:05:07,570 --> 01:05:14,710
of the triangle to another part of the

1250
01:05:10,389 --> 01:05:17,289
triangle in order to get the correct

1251
01:05:14,710 --> 01:05:20,170
sort of pixel that we expect to be there

1252
01:05:17,289 --> 01:05:23,619
right and similarly like this corner

1253
01:05:20,170 --> 01:05:26,289
pixel here this one probably wants to

1254
01:05:23,619 --> 01:05:30,009
be that and this corner pixel wants to

1255
01:05:26,289 --> 01:05:34,630
be that you and I'm saying so we just

1256
01:05:30,010 --> 01:05:37,630
have this kind of we got to figure out

1257
01:05:34,630 --> 01:05:40,900
what we're doing right but we we more or

1258
01:05:37,630 --> 01:05:46,960
less have to do a block copy over to to

1259
01:05:40,900 --> 01:05:49,289
make these things line up right classes

1260
01:05:46,960 --> 01:05:49,289
are dirty

1261
01:05:49,440 --> 01:05:59,619
in fact I'm gonna clean them so this is

1262
01:05:54,880 --> 01:06:01,720
going to be hugely annoying and we

1263
01:05:59,619 --> 01:06:05,380
probably will have to do some kind of

1264
01:06:01,719 --> 01:06:07,359
structured art to make sure that we

1265
01:06:05,380 --> 01:06:09,670
actually get the results we think we get

1266
01:06:07,360 --> 01:06:11,349
and to make matters worse we don't know

1267
01:06:09,670 --> 01:06:12,809
if this is upside down or right side up

1268
01:06:11,349 --> 01:06:14,949
so we're gonna have to think about that

1269
01:06:12,809 --> 01:06:19,210
meaning I don't know what they drew here

1270
01:06:14,949 --> 01:06:21,969
right I don't know if they drew X Y

1271
01:06:19,210 --> 01:06:23,949
positive or Y negative yeah I'm saying

1272
01:06:21,969 --> 01:06:25,719
to you hopefully it wouldn't matter

1273
01:06:23,949 --> 01:06:28,899
because we just ended up with the thing

1274
01:06:25,719 --> 01:06:31,000
flipped and since the it you know that

1275
01:06:28,900 --> 01:06:32,889
would still you know be symmetric as

1276
01:06:31,000 --> 01:06:34,389
long as we don't as long as we don't

1277
01:06:32,889 --> 01:06:37,599
flip in one way and not flip in the

1278
01:06:34,389 --> 01:06:42,519
other way we should be okay but who

1279
01:06:37,599 --> 01:06:44,469
knows alright so take a look at this we

1280
01:06:42,519 --> 01:06:46,389
need to do these copies and so for

1281
01:06:44,469 --> 01:06:47,859
example like in each of these cases we

1282
01:06:46,389 --> 01:06:50,289
just need to copy what's on this side

1283
01:06:47,860 --> 01:06:51,880
over to what's on that side and the

1284
01:06:50,289 --> 01:06:53,650
annoying part is this got to be flipped

1285
01:06:51,880 --> 01:06:56,320
right so it's gonna be mirrored in a

1286
01:06:53,650 --> 01:06:58,420
sense so you know if you imagine what we

1287
01:06:56,320 --> 01:07:01,150
would be doing for the indices here

1288
01:06:58,420 --> 01:07:04,119
let's just imagine for the X's right and

1289
01:07:01,150 --> 01:07:09,039
we'll start with the X's let's say that

1290
01:07:04,119 --> 01:07:12,609
we're going to do like copying along the

1291
01:07:09,039 --> 01:07:16,719
bottom edge X's so we're going to have

1292
01:07:12,610 --> 01:07:20,380
the XYZ that were on we're going to use

1293
01:07:16,719 --> 01:07:22,359
a T Y of zero because we're on the

1294
01:07:20,380 --> 01:07:30,070
bottom edge we're gonna assume this is y

1295
01:07:22,360 --> 01:07:32,230
up for now and it would be if this is

1296
01:07:30,070 --> 01:07:34,840
yeah I mean it would be so that whining

1297
01:07:32,230 --> 01:07:37,449
is proper this would be the negative Y

1298
01:07:34,840 --> 01:07:40,798
quadrant so if we were copying

1299
01:07:37,449 --> 01:07:46,629
in the the low Y which would be here if

1300
01:07:40,798 --> 01:07:52,630
we started at this base location here so

1301
01:07:46,630 --> 01:07:54,099
TX of zero I don't know what we're gonna

1302
01:07:52,630 --> 01:07:56,858
call this we're gonna call it X off for

1303
01:07:54,099 --> 01:07:58,900
now if we started at the base location

1304
01:07:56,858 --> 01:08:02,469
here and I wanted to do a fill of the

1305
01:07:58,900 --> 01:08:05,710
light voxel sea side of things if I was

1306
01:08:02,469 --> 01:08:07,989
to take the X off here so I'm going to

1307
01:08:05,710 --> 01:08:12,940
fill in this one

1308
01:08:07,989 --> 01:08:14,679
this pixel here right and in fact if we

1309
01:08:12,940 --> 01:08:16,329
look at it we might almost want to do

1310
01:08:14,679 --> 01:08:17,380
the corner pixels separately because I

1311
01:08:16,329 --> 01:08:19,088
don't really know what they're gonna be

1312
01:08:17,380 --> 01:08:20,770
so maybe I'll loop both of these this

1313
01:08:19,088 --> 01:08:22,479
way and we'll handle the corners in a

1314
01:08:20,770 --> 01:08:27,130
specific way I don't know if I want to

1315
01:08:22,479 --> 01:08:28,778
do that but let's just toy with that so

1316
01:08:27,130 --> 01:08:31,600
if we're just gonna fill in this gutter

1317
01:08:28,779 --> 01:08:33,819
here what I need to do is take the

1318
01:08:31,600 --> 01:08:55,569
opposite of that so I need to basically

1319
01:08:33,819 --> 01:09:01,270
do something like this right and I guess

1320
01:08:55,569 --> 01:09:02,980
we want to do that as well I think so

1321
01:09:01,270 --> 01:09:05,170
let's take a look at what that does if

1322
01:09:02,979 --> 01:09:13,448
we just do that copy what is the

1323
01:09:05,170 --> 01:09:16,239
complaint there we go right so right now

1324
01:09:13,448 --> 01:09:18,278
we're not doing any copying there and

1325
01:09:16,238 --> 01:09:21,009
we're gonna try and do some copying now

1326
01:09:18,279 --> 01:09:25,350
I may turn on our little like thing that

1327
01:09:21,009 --> 01:09:28,359
we can tell what's going on copy wise

1328
01:09:25,350 --> 01:09:30,548
because this doesn't help us super much

1329
01:09:28,359 --> 01:09:32,319
to see what we're copying and what we're

1330
01:09:30,548 --> 01:09:35,278
not because we don't always fill in the

1331
01:09:32,319 --> 01:09:39,460
whole square so what I'd rather do here

1332
01:09:35,279 --> 01:09:46,960
potentially right yeah what I'd rather

1333
01:09:39,460 --> 01:09:49,329
do here potentially is be able to I'd

1334
01:09:46,960 --> 01:09:51,359
like to be able to see the whole thing

1335
01:09:49,329 --> 01:09:53,880
filled so if we go

1336
01:09:51,359 --> 01:09:57,630
back to our test code and just turn on

1337
01:09:53,880 --> 01:09:59,819
the like color quadrant mapping so that

1338
01:09:57,630 --> 01:10:01,618
we know that everything has a value in

1339
01:09:59,819 --> 01:10:04,559
it then we should be able to debug our

1340
01:10:01,618 --> 01:10:07,769
test code a little bit better right so

1341
01:10:04,560 --> 01:10:09,659
we can see here what we've got uh you

1342
01:10:07,770 --> 01:10:11,489
know what else I can do because we we

1343
01:10:09,658 --> 01:10:14,849
spent the time to do all this stuff I

1344
01:10:11,488 --> 01:10:17,759
can also turn on the mag side of things

1345
01:10:14,850 --> 01:10:21,329
so we can zoom in right which I think

1346
01:10:17,760 --> 01:10:24,420
would be nice so if we have our V span

1347
01:10:21,329 --> 01:10:29,179
here and I think we used to set it to

1348
01:10:24,420 --> 01:10:33,569
0.03 to get a lot closer to the action

1349
01:10:29,179 --> 01:10:35,760
right so what we could see here you know

1350
01:10:33,569 --> 01:10:38,729
for lack of a better term is I don't see

1351
01:10:35,760 --> 01:10:40,889
any copying happening at all right now

1352
01:10:38,729 --> 01:10:44,968
that makes sense because now I think

1353
01:10:40,889 --> 01:10:47,579
about it we didn't go up one right so we

1354
01:10:44,969 --> 01:10:50,310
were copying from nothing to nothing so

1355
01:10:47,579 --> 01:10:55,800
actually this X off what I actually want

1356
01:10:50,310 --> 01:11:03,780
is maybe like bottom row and then like

1357
01:10:55,800 --> 01:11:04,350
or or you know row zero Row 1 something

1358
01:11:03,779 --> 01:11:07,050
like that

1359
01:11:04,350 --> 01:11:09,989
so I'd say like all right let's take row

1360
01:11:07,050 --> 01:11:14,039
zero start and then we'll do Row 1 start

1361
01:11:09,988 --> 01:11:18,379
here and that should give me the first

1362
01:11:14,039 --> 01:11:18,380
copy in the set right

1363
01:11:22,039 --> 01:11:32,569
or not oh yeah

1364
01:11:30,500 --> 01:11:34,100
you have to act to actually make those

1365
01:11:32,569 --> 01:11:36,019
be different values but you see I'm

1366
01:11:34,100 --> 01:11:38,240
doing right I gotta get from a row that

1367
01:11:36,020 --> 01:11:40,340
has data in it to a row that doesn't

1368
01:11:38,239 --> 01:11:42,439
right so there you can see the copy

1369
01:11:40,340 --> 01:11:46,730
happening unfortunately this is all

1370
01:11:42,439 --> 01:11:50,149
zeros in here in terms of the X and the

1371
01:11:46,729 --> 01:11:52,219
y and the Z so we don't see any actual

1372
01:11:50,149 --> 01:11:54,649
values in there so it's a little hard to

1373
01:11:52,220 --> 01:11:55,970
know if that's copied properly but

1374
01:11:54,649 --> 01:12:00,019
that's what's actually happening in

1375
01:11:55,970 --> 01:12:02,539
terms of the fill so now I need to do

1376
01:12:00,020 --> 01:12:04,730
the the copy for the top and if that

1377
01:12:02,539 --> 01:12:11,689
happens the same way so this is going to

1378
01:12:04,729 --> 01:12:14,659
be like the row you know n start and row

1379
01:12:11,689 --> 01:12:21,619
and one start so it's like N and n minus

1380
01:12:14,659 --> 01:12:24,019
1 and so that's going to be whatever the

1381
01:12:21,619 --> 01:12:27,140
actual full dimension of the square

1382
01:12:24,020 --> 01:12:28,610
would have been you know I'm saying all

1383
01:12:27,140 --> 01:12:32,539
the way up and then all the way up

1384
01:12:28,609 --> 01:12:34,639
backed down by one and so now we're

1385
01:12:32,539 --> 01:12:41,420
doing both copies for the top and the

1386
01:12:34,640 --> 01:12:43,160
bottom in theory right and again that

1387
01:12:41,420 --> 01:12:45,470
looks like about right unfortunately we

1388
01:12:43,159 --> 01:12:48,590
can't quite tell the reversal because on

1389
01:12:45,470 --> 01:12:49,610
that row everything kind of bows out so

1390
01:12:48,590 --> 01:12:52,090
it's a little bit hard to tell whether

1391
01:12:49,609 --> 01:12:57,019
we actually did our inversion properly

1392
01:12:52,090 --> 01:13:02,840
let's cheat slightly and see if we did

1393
01:12:57,020 --> 01:13:07,220
this don't ask me why I didn't just say

1394
01:13:02,840 --> 01:13:08,659
to there but let's do two and three so

1395
01:13:07,220 --> 01:13:11,270
that we're actually copying this and

1396
01:13:08,659 --> 01:13:13,159
that right because that will show us

1397
01:13:11,270 --> 01:13:15,650
whether we actually flipped it or not

1398
01:13:13,159 --> 01:13:17,510
and so that looks good right we're

1399
01:13:15,649 --> 01:13:21,379
seeing that flip and that's what we

1400
01:13:17,510 --> 01:13:22,970
should happen so I'm going to go ahead

1401
01:13:21,380 --> 01:13:26,029
and assume that's at least somewhat

1402
01:13:22,970 --> 01:13:29,750
correct there and we'll move on now to

1403
01:13:26,029 --> 01:13:34,789
the to the

1404
01:13:29,750 --> 01:13:36,079
mmm-hmm vertical line instead and I

1405
01:13:34,789 --> 01:13:37,640
still don't know what happens with these

1406
01:13:36,079 --> 01:13:39,289
pixels on the outside to be completely

1407
01:13:37,640 --> 01:13:43,010
honest with you I assume you set them to

1408
01:13:39,289 --> 01:13:46,779
the average of all four corners because

1409
01:13:43,010 --> 01:13:46,780
that's what's actually there

1410
01:13:47,198 --> 01:13:52,149
sort of or is it or should it be I guess

1411
01:13:50,000 --> 01:13:55,578
maybe it should be the opposing corner I

1412
01:13:52,149 --> 01:13:58,578
really don't know so anyway this is

1413
01:13:55,578 --> 01:14:01,368
actually more or less the same here this

1414
01:13:58,578 --> 01:14:03,558
equation is going to be mostly same it's

1415
01:14:01,368 --> 01:14:08,029
just it's we got to flip it to operate

1416
01:14:03,559 --> 01:14:11,239
in Y instead right so I'm going to do

1417
01:14:08,029 --> 01:14:13,849
that the cheesy way which is going to be

1418
01:14:11,238 --> 01:14:25,368
slower and but it's I just want to make

1419
01:14:13,849 --> 01:14:33,828
sure I do it correctly but we're gonna

1420
01:14:25,368 --> 01:14:36,288
do it with full offsets so here's the

1421
01:14:33,828 --> 01:14:39,198
full offset version what we want to do

1422
01:14:36,288 --> 01:14:42,198
here is specify these values precisely

1423
01:14:39,198 --> 01:14:45,439
so that they give us what we need so

1424
01:14:42,198 --> 01:14:49,549
we've got our T Y values our TX values

1425
01:14:45,439 --> 01:14:52,519
are going to be fixed in this case so in

1426
01:14:49,550 --> 01:14:54,440
one case it will just be 0 and 1 right

1427
01:14:52,520 --> 01:14:56,960
so we're gonna copy from the slightly

1428
01:14:54,439 --> 01:14:59,719
inside border to the outside border and

1429
01:14:56,960 --> 01:15:01,788
in the other case it will be right the

1430
01:14:59,719 --> 01:15:05,000
it'll be exactly the same as as this

1431
01:15:01,788 --> 01:15:06,109
whole situation right so in this case it

1432
01:15:05,000 --> 01:15:14,479
will be we're gonna copy

1433
01:15:06,109 --> 01:15:19,908
oh that's X that is X we're gonna copy

1434
01:15:14,479 --> 01:15:22,129
from here to here right and since that

1435
01:15:19,908 --> 01:15:24,888
value comes up a lot hmm

1436
01:15:22,130 --> 01:15:28,969
I want to do like light color lookup

1437
01:15:24,889 --> 01:15:31,429
squared M minus 1 and I'm just gonna

1438
01:15:28,969 --> 01:15:35,469
call that n because if we just call that

1439
01:15:31,429 --> 01:15:35,469
n this becomes a lot easier to read

1440
01:15:38,139 --> 01:15:45,170
right so you know I'm trying to there

1441
01:15:42,380 --> 01:15:46,880
and so if we just call that and all of

1442
01:15:45,170 --> 01:15:48,649
this is like oh it's just going you know

1443
01:15:46,880 --> 01:15:51,380
it's it's it's much harder to read it

1444
01:15:48,649 --> 01:15:54,469
when it's all blown out like that but if

1445
01:15:51,380 --> 01:15:56,569
we just call that final row n then you

1446
01:15:54,469 --> 01:15:58,389
can kind of see more directly what I'm

1447
01:15:56,569 --> 01:16:02,170
doing

1448
01:15:58,389 --> 01:16:05,750
hmm excuse me

1449
01:16:02,170 --> 01:16:07,460
all right so here again this is exactly

1450
01:16:05,750 --> 01:16:12,078
the same it's just and it's getting

1451
01:16:07,460 --> 01:16:14,149
copied from n minus one and so there we

1452
01:16:12,078 --> 01:16:18,828
just need to do like what are we doing

1453
01:16:14,149 --> 01:16:20,779
with T why right we know that we know

1454
01:16:18,828 --> 01:16:22,429
that T Y is everywhere in here but the

1455
01:16:20,779 --> 01:16:23,469
question is like okay so what what do we

1456
01:16:22,429 --> 01:16:26,630
actually do with it

1457
01:16:23,469 --> 01:16:28,038
and in this case we know that we're

1458
01:16:26,630 --> 01:16:30,109
probably going to copy we're gonna copy

1459
01:16:28,038 --> 01:16:33,948
from T y2 like going backwards from T Y

1460
01:16:30,109 --> 01:16:36,109
right so in this case it's gonna look

1461
01:16:33,948 --> 01:16:37,549
exactly like the previous one right

1462
01:16:36,109 --> 01:16:41,238
we're gonna discuss invert the T wise

1463
01:16:37,550 --> 01:16:42,769
and then in this one we again can do

1464
01:16:41,238 --> 01:16:44,328
exactly the same thing because this

1465
01:16:42,769 --> 01:16:46,369
equation is handling all of the

1466
01:16:44,328 --> 01:16:48,799
unpacking for us so we should just be

1467
01:16:46,368 --> 01:16:51,229
able to do to flip copies exactly the

1468
01:16:48,800 --> 01:17:00,079
same way and I think that's what we need

1469
01:16:51,229 --> 01:17:01,729
I think so now I think we're good

1470
01:17:00,078 --> 01:17:03,649
with all those extensions the only

1471
01:17:01,729 --> 01:17:11,149
difference is we don't actually have the

1472
01:17:03,649 --> 01:17:12,799
corner it pieces right and I also have

1473
01:17:11,149 --> 01:17:14,448
to go make sure that that we don't pull

1474
01:17:12,800 --> 01:17:16,820
from the opposite side like we might be

1475
01:17:14,448 --> 01:17:17,868
so like it may not be that let me just

1476
01:17:16,819 --> 01:17:22,549
double check because I don't know what

1477
01:17:17,868 --> 01:17:24,529
it is so yeah no it's the same right

1478
01:17:22,550 --> 01:17:26,119
it's like these two were neighbors that

1479
01:17:24,529 --> 01:17:28,000
would have folded in on each other so we

1480
01:17:26,118 --> 01:17:30,469
are copying from here to here right and

1481
01:17:28,000 --> 01:17:32,960
the same is true for here like that

1482
01:17:30,469 --> 01:17:36,500
lined up with that right so we're always

1483
01:17:32,960 --> 01:17:38,569
copying from like the other Avenue so

1484
01:17:36,500 --> 01:17:41,538
these are now the only ones we haven't

1485
01:17:38,569 --> 01:17:47,359
filled in let's go ahead and fill those

1486
01:17:41,538 --> 01:17:51,908
in and in order to do that it's just

1487
01:17:47,359 --> 01:17:51,908
going to be a series of these right

1488
01:17:59,260 --> 01:18:06,170
so we need to write for pixel's

1489
01:18:02,569 --> 01:18:14,210
what are those four pixels well it's

1490
01:18:06,170 --> 01:18:16,250
just the 0 0 and 0 0 n and n n right

1491
01:18:14,210 --> 01:18:18,409
those are the 4 pixels we have not yet

1492
01:18:16,250 --> 01:18:20,060
written and where do we want to get

1493
01:18:18,409 --> 01:18:23,329
those well we just want to get those

1494
01:18:20,060 --> 01:18:26,360
from the correct corresponding side so 0

1495
01:18:23,329 --> 01:18:29,479
0 wants to come from n minus 1 n minus 1

1496
01:18:26,359 --> 01:18:31,279
because that's the far corner right I'm

1497
01:18:29,479 --> 01:18:33,349
assuming this right I don't really know

1498
01:18:31,279 --> 01:18:34,579
what the best value to fill in there is

1499
01:18:33,350 --> 01:18:36,289
but I'm assuming that's the thing you

1500
01:18:34,579 --> 01:18:37,609
can't actually that you won't have

1501
01:18:36,289 --> 01:18:39,859
access to otherwise you're gonna you're

1502
01:18:37,609 --> 01:18:41,539
gonna be blending towards that far face

1503
01:18:39,859 --> 01:18:43,069
if you were going over this that that

1504
01:18:41,539 --> 01:18:47,659
side because that's where you're gonna

1505
01:18:43,069 --> 01:18:50,269
wrap around 2 so n 0 right and just to

1506
01:18:47,659 --> 01:18:52,760
point out where those are so 0 0 is here

1507
01:18:50,270 --> 01:18:59,000
it's going to map to n minus 1 my 1 so

1508
01:18:52,760 --> 01:19:01,190
we want to put that 1 here and 0 is here

1509
01:18:59,000 --> 01:19:06,430
right so we want that one to come from

1510
01:19:01,189 --> 01:19:06,429
over here which is going to be 0 n right

1511
01:19:08,289 --> 01:19:13,640
the same would be true here right so you

1512
01:19:11,899 --> 01:19:15,649
flip the coordinates and then the final

1513
01:19:13,640 --> 01:19:18,860
one which is writing n n is just going

1514
01:19:15,649 --> 01:19:20,179
to be like 1 1 right and again these

1515
01:19:18,859 --> 01:19:21,979
actually shouldn't be 0 right they

1516
01:19:20,180 --> 01:19:30,920
should be 1 because they're in 1 from

1517
01:19:21,979 --> 01:19:34,069
the edge I think that's it so I think

1518
01:19:30,920 --> 01:19:35,840
that copies everybody we may have some

1519
01:19:34,069 --> 01:19:39,019
bugs in there that's that's gonna be my

1520
01:19:35,840 --> 01:19:42,170
first pass at it and there's a fully

1521
01:19:39,020 --> 01:19:47,330
fully filled in map now if I go back and

1522
01:19:42,170 --> 01:19:50,180
stop nerfing so we go to here and we

1523
01:19:47,329 --> 01:19:53,149
actually fill in light values we should

1524
01:19:50,180 --> 01:19:54,920
now have a full map so everywhere this

1525
01:19:53,149 --> 01:20:01,488
yet should extend out right you can see

1526
01:19:54,920 --> 01:20:04,100
it now I don't see any evidence that

1527
01:20:01,488 --> 01:20:06,049
that improved right so that to me now

1528
01:20:04,100 --> 01:20:07,130
you know we could still have a bug

1529
01:20:06,050 --> 01:20:09,470
in the way that we're filling it out

1530
01:20:07,130 --> 01:20:14,510
certainly so you know I don't want to

1531
01:20:09,470 --> 01:20:15,800
assume that it's fine but you know I'm

1532
01:20:14,510 --> 01:20:19,820
just trying to I'm trying to look here

1533
01:20:15,800 --> 01:20:24,560
and see about that I will say that that

1534
01:20:19,819 --> 01:20:26,750
doesn't look reassuring like I will say

1535
01:20:24,560 --> 01:20:29,630
we may have some issues with how we're

1536
01:20:26,750 --> 01:20:31,970
feeling I mean what I wonder if we're

1537
01:20:29,630 --> 01:20:37,220
maybe slightly off like we're 0.5 off

1538
01:20:31,970 --> 01:20:39,470
somewhere so we may have some bugs still

1539
01:20:37,220 --> 01:20:41,210
in that map and I'm not sure how we'd

1540
01:20:39,470 --> 01:20:44,600
debug that we may have to go in and be a

1541
01:20:41,210 --> 01:20:47,060
little bit more careful but I would say

1542
01:20:44,600 --> 01:20:50,180
we've got a problem here that isn't

1543
01:20:47,060 --> 01:20:54,560
that's that's separate right that it

1544
01:20:50,180 --> 01:20:56,780
looks too severe at this point I so I

1545
01:20:54,560 --> 01:21:02,090
don't think it's just a case of of

1546
01:20:56,779 --> 01:21:05,050
having a I don't think it's just a case

1547
01:21:02,090 --> 01:21:08,930
of having a blending issue right so

1548
01:21:05,050 --> 01:21:10,520
let's go back to the shader and look at

1549
01:21:08,930 --> 01:21:12,560
what we were actually doing and see if

1550
01:21:10,520 --> 01:21:14,630
there's any indication of of maybe

1551
01:21:12,560 --> 01:21:18,200
something busted here we can first check

1552
01:21:14,630 --> 01:21:19,760
our octahedral mapping just to make sure

1553
01:21:18,199 --> 01:21:22,429
that there's nothing weird coming out of

1554
01:21:19,760 --> 01:21:25,940
there so first of all we do know that R

1555
01:21:22,430 --> 01:21:28,280
is normalized wien so that's good right

1556
01:21:25,939 --> 01:21:31,460
so that helps us ensure that we're not

1557
01:21:28,279 --> 01:21:33,170
feeding bogus values in here when we

1558
01:21:31,460 --> 01:21:35,420
produce the actual octahedral we take

1559
01:21:33,170 --> 01:21:39,350
one over the number one norm times R

1560
01:21:35,420 --> 01:21:43,369
times XY right and that is what we want

1561
01:21:39,350 --> 01:21:48,310
to reduce this to an octahedron so that

1562
01:21:43,369 --> 01:21:48,309
seems correct to me

1563
01:21:53,789 --> 01:21:58,380
I don't really see anything yeah so once

1564
01:21:57,090 --> 01:22:00,720
you get that octahedral then we're just

1565
01:21:58,380 --> 01:22:02,730
looking to see if Z is less than zero

1566
01:22:00,720 --> 01:22:06,150
and if C is less than zero then you can

1567
01:22:02,729 --> 01:22:09,809
see we do the optics why we multiply by

1568
01:22:06,149 --> 01:22:13,319
the sign of the original which is what

1569
01:22:09,810 --> 01:22:17,990
we want times 1 minus the absolute value

1570
01:22:13,319 --> 01:22:24,659
of the inverted version that also looks

1571
01:22:17,989 --> 01:22:27,869
right that looks proper to me I don't

1572
01:22:24,659 --> 01:22:30,470
see anything weird about that that will

1573
01:22:27,869 --> 01:22:32,880
produce negative 1 to 1

1574
01:22:30,470 --> 01:22:35,610
so we're feeding a negative 1 to 1 value

1575
01:22:32,880 --> 01:22:39,989
into sample lighting as the octahedral

1576
01:22:35,609 --> 01:22:42,389
sample we have our voxel lookup which

1577
01:22:39,989 --> 01:22:46,139
itself could be called into question

1578
01:22:42,390 --> 01:22:48,780
here although I don't actually know that

1579
01:22:46,140 --> 01:22:51,450
that would explain those lines are not

1580
01:22:48,779 --> 01:22:53,550
voxel related there they cut straight

1581
01:22:51,449 --> 01:22:57,630
across voxels so I'm gonna go ahead and

1582
01:22:53,550 --> 01:23:02,310
say our voxel indexing is probably not

1583
01:22:57,630 --> 01:23:04,859
wrong our voxel ar-ar-ar moved from a

1584
01:23:02,310 --> 01:23:08,280
voxel index over to a light atlas might

1585
01:23:04,859 --> 01:23:14,299
be to a specific square that could very

1586
01:23:08,279 --> 01:23:16,679
well be wrong but I don't believe our I

1587
01:23:14,300 --> 01:23:18,600
don't believe our index in particular

1588
01:23:16,680 --> 01:23:20,340
being wrong would cause any particular

1589
01:23:18,600 --> 01:23:22,650
problems of the kind that we're looking

1590
01:23:20,340 --> 01:23:24,960
at and in fact when you look at the

1591
01:23:22,649 --> 01:23:27,629
places where it does work it's crossing

1592
01:23:24,960 --> 01:23:29,970
voxel boundaries without a seam just

1593
01:23:27,630 --> 01:23:32,520
fine right there's a voxel boundary

1594
01:23:29,970 --> 01:23:35,970
there and there's no light seem right

1595
01:23:32,520 --> 01:23:41,420
it only gets a light seam at the XY

1596
01:23:35,970 --> 01:23:41,420
boundary not at any other boundary right

1597
01:23:41,779 --> 01:23:50,729
so yeah so I don't know so looking at

1598
01:23:46,649 --> 01:23:55,559
that the question is what about all this

1599
01:23:50,729 --> 01:23:58,409
garbage so we have a voxel index we pick

1600
01:23:55,560 --> 01:24:01,980
a toc map center UV by taking the voxel

1601
01:23:58,409 --> 01:24:02,869
index multiplying it by the light lookup

1602
01:24:01,979 --> 01:24:05,339
voxel dim

1603
01:24:02,869 --> 01:24:07,019
[Music]

1604
01:24:05,340 --> 01:24:11,100
because we're gonna move that far and

1605
01:24:07,020 --> 01:24:13,050
why and to produce the UV value so

1606
01:24:11,100 --> 01:24:30,510
here's the in fact let's do it this way

1607
01:24:13,050 --> 01:24:32,369
so I can read it easier so yeah let's

1608
01:24:30,510 --> 01:24:42,600
take a look at what's actually happening

1609
01:24:32,369 --> 01:24:45,359
here we'll move this down one and we'll

1610
01:24:42,600 --> 01:24:48,120
just take a look at these two in and of

1611
01:24:45,359 --> 01:24:51,659
themselves so here we're seeing alright

1612
01:24:48,119 --> 01:24:54,449
for the actual Y that we're gonna use

1613
01:24:51,659 --> 01:24:57,059
we're gonna take whichever voxel index

1614
01:24:54,449 --> 01:24:59,819
in Z we were looking at and we're going

1615
01:24:57,060 --> 01:25:03,450
to move by however big the exterior UV

1616
01:24:59,819 --> 01:25:04,739
dim is right in Y that seems fine we've

1617
01:25:03,449 --> 01:25:07,349
gotta go we'll have to go verify that

1618
01:25:04,739 --> 01:25:09,359
that's actually correct this value is

1619
01:25:07,350 --> 01:25:10,920
correct which we'll do separately but

1620
01:25:09,359 --> 01:25:13,500
that seems right and then to move to the

1621
01:25:10,920 --> 01:25:16,409
center of it we're gonna do we're gonna

1622
01:25:13,500 --> 01:25:18,149
move 0.5 of that exterior dim which

1623
01:25:16,409 --> 01:25:22,559
should put us dead dead smack in the

1624
01:25:18,149 --> 01:25:26,699
middle right now for the akhmet Center X

1625
01:25:22,560 --> 01:25:28,289
we're gonna say and do that now we're

1626
01:25:26,699 --> 01:25:30,300
gonna say we've got however many Vox

1627
01:25:28,289 --> 01:25:32,760
they're on a side times the Y plus the X

1628
01:25:30,300 --> 01:25:34,380
that unpacks one sheet and then we're

1629
01:25:32,760 --> 01:25:36,630
gonna multiply by the X and again that

1630
01:25:34,380 --> 01:25:39,329
looks pretty solid and both of those

1631
01:25:36,630 --> 01:25:51,409
again go through this so that part

1632
01:25:39,329 --> 01:25:51,409
should be totally solid we then say wait

1633
01:26:04,248 --> 01:26:10,340
No okay we then say all right we've got

1634
01:26:07,760 --> 01:26:12,829
the total interior dimension of the UV

1635
01:26:10,340 --> 01:26:14,929
dim that's how much we want the octa

1636
01:26:12,828 --> 01:26:16,969
cover right it's going from negative one

1637
01:26:14,929 --> 01:26:21,710
to one we need to change it into going

1638
01:26:16,969 --> 01:26:23,748
however far we go for an atlas lookup we

1639
01:26:21,710 --> 01:26:25,840
know we've got the interior dim here and

1640
01:26:23,748 --> 01:26:28,429
we want to divide that in half because

1641
01:26:25,840 --> 01:26:30,050
the dim is if we were going to 0 to 1

1642
01:26:28,429 --> 01:26:32,748
we're going negative 1 to 1 so we need

1643
01:26:30,050 --> 01:26:34,190
like half of the size of it because

1644
01:26:32,748 --> 01:26:37,189
we're gonna reach half in one direction

1645
01:26:34,189 --> 01:26:38,748
in half in another right we then take

1646
01:26:37,189 --> 01:26:42,129
those and look them up into the sampler

1647
01:26:38,748 --> 01:26:44,658
and off we go so that seems plausible

1648
01:26:42,130 --> 01:26:47,210
that seems plausible that seems like a

1649
01:26:44,658 --> 01:26:50,509
lookup that I wouldn't expect to fail

1650
01:26:47,210 --> 01:26:52,760
too much there and so let's take a look

1651
01:26:50,510 --> 01:26:54,650
at our optics terior UV dim stuff here

1652
01:26:52,760 --> 01:26:58,400
and see how that stuff gets computed

1653
01:26:54,649 --> 01:27:08,719
right I again I'm gonna split this just

1654
01:26:58,399 --> 01:27:12,078
so I can see it easier so what we end up

1655
01:27:08,719 --> 01:27:15,939
with here is we've got the exterior

1656
01:27:12,078 --> 01:27:18,349
dimension is just going to be however

1657
01:27:15,939 --> 01:27:20,149
yeah I mean in X it's just going to be

1658
01:27:18,349 --> 01:27:21,739
we know we have light lookup voxel dim

1659
01:27:20,149 --> 01:27:23,988
times light lookup the fossil dim number

1660
01:27:21,738 --> 01:27:27,799
of these things so to move in UV it

1661
01:27:23,988 --> 01:27:30,728
would just be 1 over that count and the

1662
01:27:27,800 --> 01:27:35,260
same would be true in Y so that seems

1663
01:27:30,729 --> 01:27:35,260
uncontroversial right I would say

1664
01:27:44,139 --> 01:27:49,840
let's take a look at this in a little

1665
01:27:45,488 --> 01:27:52,419
more detail so here we've got the color

1666
01:27:49,840 --> 01:28:01,360
lookup squared dim minus the padding

1667
01:27:52,420 --> 01:28:07,059
over whatever the dimension is of the

1668
01:28:01,359 --> 01:28:10,029
total texture that seems good this is

1669
01:28:07,059 --> 01:28:12,369
the number of texels we want to span

1670
01:28:10,029 --> 01:28:18,569
over the number of texels there our

1671
01:28:12,368 --> 01:28:18,569
total which is what we would want right

1672
01:28:20,609 --> 01:28:30,759
this Y value that is totally wrong all

1673
01:28:28,300 --> 01:28:34,210
right so our Y value is complete garbage

1674
01:28:30,760 --> 01:28:35,980
though right because our Y value is

1675
01:28:34,210 --> 01:28:37,929
exactly the same thing as our x value

1676
01:28:35,979 --> 01:28:44,848
the only difference is that we don't

1677
01:28:37,929 --> 01:28:44,849
have the square right so the Y value oh

1678
01:28:44,939 --> 01:28:55,238
wait that was the D value well alright I

1679
01:28:52,649 --> 01:28:57,250
know it wasn't so it this just looks

1680
01:28:55,238 --> 01:28:58,988
wrong this is just garbage so I think

1681
01:28:57,250 --> 01:29:00,368
that was just a typo there probably

1682
01:28:58,988 --> 01:29:04,348
because we can't read this because it's

1683
01:29:00,368 --> 01:29:07,058
in this like kind of an indented format

1684
01:29:04,349 --> 01:29:09,099
but that looks fine right it's this is

1685
01:29:07,059 --> 01:29:11,020
the dimension and we want to divide by

1686
01:29:09,099 --> 01:29:13,300
the total number of pixels so it should

1687
01:29:11,020 --> 01:29:15,730
be those two things right and if we

1688
01:29:13,300 --> 01:29:17,320
wanted to do the D version of those it

1689
01:29:15,729 --> 01:29:21,368
would be the exact same equation the

1690
01:29:17,319 --> 01:29:25,118
only difference is we would have the

1691
01:29:21,368 --> 01:29:27,689
depth constants instead of the color

1692
01:29:25,118 --> 01:29:27,689
constants

1693
01:29:33,920 --> 01:29:36,920
right

1694
01:29:41,389 --> 01:30:12,199
all right unexpected semicolon what's

1695
01:29:52,130 --> 01:30:13,760
the problem okay so this means yeah all

1696
01:30:12,198 --> 01:30:16,398
right I think I've got that properly

1697
01:30:13,760 --> 01:30:24,649
parenthesize now maybe we'll find out in

1698
01:30:16,399 --> 01:30:27,199
a second all right

1699
01:30:24,649 --> 01:30:29,149
so that was definitely a difference

1700
01:30:27,198 --> 01:30:31,188
we're getting some we're getting a

1701
01:30:29,149 --> 01:30:32,959
different kind of bug now so you can see

1702
01:30:31,189 --> 01:30:36,889
like our lookup was definitely in

1703
01:30:32,958 --> 01:30:41,328
question there and so we should probably

1704
01:30:36,889 --> 01:30:44,418
keep pushing on on this all right

1705
01:30:41,328 --> 01:30:48,049
so if we look at this now I think this

1706
01:30:44,418 --> 01:30:49,698
is correct the interior Dempsey which

1707
01:30:48,050 --> 01:30:51,469
we're using down here right so that's

1708
01:30:49,698 --> 01:30:55,488
for our sample CUV

1709
01:30:51,469 --> 01:30:57,198
and then we've got our sample D UV in

1710
01:30:55,488 --> 01:30:58,759
both cases the Centers that should be in

1711
01:30:57,198 --> 01:31:03,379
the same place and it's only the span

1712
01:30:58,760 --> 01:31:05,090
that that should change so looking at

1713
01:31:03,380 --> 01:31:07,130
this right we've got minus two because

1714
01:31:05,090 --> 01:31:09,260
we're using just the interior dimensions

1715
01:31:07,130 --> 01:31:11,359
of this thing and we want to divide by

1716
01:31:09,260 --> 01:31:13,630
the total number the total size of one

1717
01:31:11,359 --> 01:31:25,038
of these textures which is going to be

1718
01:31:13,630 --> 01:31:28,118
this and I think that's it is there

1719
01:31:25,038 --> 01:31:28,118
another bug in here somewhere

1720
01:31:30,840 --> 01:31:48,119
I don't think so I don't think so but I

1721
01:31:37,949 --> 01:31:50,069
don't know that's yeah no III don't know

1722
01:31:48,119 --> 01:31:51,510
I don't see anything particular there so

1723
01:31:50,069 --> 01:31:55,049
I guess I'm not sure there's anything

1724
01:31:51,510 --> 01:31:56,699
else to be gained there so at that point

1725
01:31:55,050 --> 01:31:59,070
I feel like this should be looking up

1726
01:31:56,699 --> 01:32:01,139
roughly correctly I'm just not sure

1727
01:31:59,069 --> 01:32:04,549
we're still seeing some really bad

1728
01:32:01,140 --> 01:32:07,410
artifacts there and they look very

1729
01:32:04,550 --> 01:32:11,130
pronounced right and they're right in

1730
01:32:07,409 --> 01:32:12,989
the sort of octagonal way so it looks

1731
01:32:11,130 --> 01:32:18,329
like it's either a lookup or a blending

1732
01:32:12,989 --> 01:32:20,189
bug right and it's weird because inside

1733
01:32:18,329 --> 01:32:23,279
a particular region I mean that looks

1734
01:32:20,189 --> 01:32:26,579
like an octagonal region so I want to

1735
01:32:23,279 --> 01:32:29,099
almost say that almost looks like it is

1736
01:32:26,579 --> 01:32:31,800
just a blending error like the sides

1737
01:32:29,100 --> 01:32:37,010
don't line up right or we're unpacking

1738
01:32:31,800 --> 01:32:37,010
wrong or something right it's very close

1739
01:32:38,449 --> 01:32:42,779
so I think I mean I think what we're

1740
01:32:41,010 --> 01:32:51,360
literally seeing there is just the

1741
01:32:42,779 --> 01:32:54,869
octagonal boundaries right so I'm not

1742
01:32:51,359 --> 01:32:58,769
sure what we're doing wrong but we're

1743
01:32:54,869 --> 01:33:01,769
gonna have to sort of figure out where

1744
01:32:58,770 --> 01:33:03,540
our blend is is busted there because it

1745
01:33:01,770 --> 01:33:06,140
looks like we've got everything mostly

1746
01:33:03,539 --> 01:33:07,920
right now I don't know maybe not

1747
01:33:06,140 --> 01:33:14,369
but it looks like we've got everything

1748
01:33:07,920 --> 01:33:16,140
mostly right but we aren't quite somehow

1749
01:33:14,369 --> 01:33:20,189
like the blending is not quite working

1750
01:33:16,140 --> 01:33:23,640
or we're sampling - we're not expanding

1751
01:33:20,189 --> 01:33:25,379
to the right region now I guess what I

1752
01:33:23,640 --> 01:33:34,430
would say is if you think about what's

1753
01:33:25,380 --> 01:33:34,430
happening here the interior it should

1754
01:33:35,189 --> 01:33:40,000
so the problem that we're gonna have is

1755
01:33:37,930 --> 01:33:42,400
half the interior no but that's okay cuz

1756
01:33:40,000 --> 01:33:44,619
we're in the middle we're right in the

1757
01:33:42,399 --> 01:33:46,899
middle in between two pixels at the

1758
01:33:44,619 --> 01:33:48,340
middle and we're going to be going let

1759
01:33:46,899 --> 01:33:51,339
me just make sure that this is the

1760
01:33:48,340 --> 01:33:56,230
correct that everything is correct in

1761
01:33:51,340 --> 01:33:58,930
terms of actual quantities because maybe

1762
01:33:56,229 --> 01:34:00,719
I'm actually off by one and we'll see so

1763
01:33:58,930 --> 01:34:07,329
if you imagine what we're doing here

1764
01:34:00,720 --> 01:34:11,500
we're actually talking about so we've

1765
01:34:07,329 --> 01:34:13,720
got a grid right and we've got on the

1766
01:34:11,500 --> 01:34:15,880
side here like around this grid we've

1767
01:34:13,720 --> 01:34:18,250
got a gutter but this is the main grid

1768
01:34:15,880 --> 01:34:21,819
that we want to look up right and we

1769
01:34:18,250 --> 01:34:24,039
believe at least if we are doing the

1770
01:34:21,819 --> 01:34:27,009
math correctly so far we believe that we

1771
01:34:24,039 --> 01:34:29,439
start here and what we want to do is we

1772
01:34:27,010 --> 01:34:35,190
want to take a value from negative one

1773
01:34:29,439 --> 01:34:37,960
to one on all axes right like this and

1774
01:34:35,189 --> 01:34:40,839
we want to make sure that we end like

1775
01:34:37,960 --> 01:34:49,920
right here so we want like we want to go

1776
01:34:40,840 --> 01:34:49,920
out by exactly 4 right from where we are

1777
01:34:50,159 --> 01:34:54,789
so we want to make sure that we take

1778
01:34:52,479 --> 01:34:56,739
whatever input value is and we multiply

1779
01:34:54,789 --> 01:34:58,989
it by exactly 4 that's what we're going

1780
01:34:56,739 --> 01:35:00,609
to be doing I think right we have the

1781
01:34:58,989 --> 01:35:02,619
light color lookup squared dim which is

1782
01:35:00,609 --> 01:35:04,509
8 we subtract I'm sorry which is 10 we

1783
01:35:02,619 --> 01:35:10,479
subtract you from it which is 8 we

1784
01:35:04,510 --> 01:35:12,520
divide that by 5 which is 4 right so it

1785
01:35:10,479 --> 01:35:14,649
is 4 divided by the total size of the

1786
01:35:12,520 --> 01:35:22,120
pics of the map which should be exactly

1787
01:35:14,649 --> 01:35:23,829
4 texels in UV I think and so the

1788
01:35:22,119 --> 01:35:26,289
question is would then actually is that

1789
01:35:23,829 --> 01:35:28,239
actually true so let's suppose that we

1790
01:35:26,289 --> 01:35:30,159
then said okay so that's like 4 texels

1791
01:35:28,239 --> 01:35:32,949
so let's say we had one texel and the

1792
01:35:30,159 --> 01:35:35,829
map was too wide we would want to be

1793
01:35:32,949 --> 01:35:39,729
going Oh point five is the size of one

1794
01:35:35,829 --> 01:35:43,000
texel and 1/2 is 0.5 so I mean it seems

1795
01:35:39,729 --> 01:35:45,339
like these values are correct right I

1796
01:35:43,000 --> 01:35:48,198
mean it seems like we're getting the

1797
01:35:45,340 --> 01:35:51,498
right values there and so

1798
01:35:48,198 --> 01:35:53,928
unless there's some other weirdness

1799
01:35:51,498 --> 01:35:56,448
there I'm not sure what to make of that

1800
01:35:53,929 --> 01:35:58,899
let's go back to structured art just for

1801
01:35:56,448 --> 01:35:58,899
a second

1802
01:36:07,550 --> 01:36:11,958
and see if maybe we can fill some things

1803
01:36:10,458 --> 01:36:15,229
in here

1804
01:36:11,958 --> 01:36:16,819
in ways that would allow us to know what

1805
01:36:15,229 --> 01:36:18,979
we're actually seeing so I'm just gonna

1806
01:36:16,819 --> 01:36:21,649
try to feed structure to our into our

1807
01:36:18,979 --> 01:36:25,550
system and see if I can't suss out what

1808
01:36:21,649 --> 01:36:26,929
some of these bugs actually are right so

1809
01:36:25,550 --> 01:36:28,820
one of these things about this is I can

1810
01:36:26,929 --> 01:36:32,118
sort of see where we're looking at in

1811
01:36:28,819 --> 01:36:34,759
here by looking at some of the color

1812
01:36:32,118 --> 01:36:37,339
changes that I observe right so in

1813
01:36:34,760 --> 01:36:40,239
sweeping this line across like that

1814
01:36:37,340 --> 01:36:43,369
right and looking at where we get

1815
01:36:40,238 --> 01:36:45,708
individual boundaries you can see that

1816
01:36:43,368 --> 01:36:47,268
the lighting bug boundaries line up

1817
01:36:45,708 --> 01:36:51,939
pretty much exactly with the octagonal

1818
01:36:47,269 --> 01:36:54,739
boundaries so that part does seem pretty

1819
01:36:51,939 --> 01:36:59,629
significant right I mean it's worth

1820
01:36:54,738 --> 01:37:01,399
noting now if we furthermore take a look

1821
01:36:59,630 --> 01:37:03,618
at which boundaries we're looking at

1822
01:37:01,399 --> 01:37:06,439
here we can see some things like we can

1823
01:37:03,618 --> 01:37:08,268
see that like the purple side or the

1824
01:37:06,439 --> 01:37:14,198
mean the grace I don't know how you want

1825
01:37:08,269 --> 01:37:19,039
to call that the the way these line up

1826
01:37:14,198 --> 01:37:22,248
may go like this you can see like we've

1827
01:37:19,038 --> 01:37:24,259
got the green one here and the red one

1828
01:37:22,248 --> 01:37:26,269
here or maybe it's purple I guess I

1829
01:37:24,260 --> 01:37:30,010
should probably take off the modulation

1830
01:37:26,269 --> 01:37:30,010
so hold please

1831
01:37:40,659 --> 01:37:45,319
here you go so when we're doing this

1832
01:37:43,340 --> 01:37:48,140
here what I'm gonna do instead is I'm

1833
01:37:45,319 --> 01:37:50,090
just gonna say like alright forget that

1834
01:37:48,140 --> 01:37:59,800
I ever told you to do that let's just

1835
01:37:50,090 --> 01:38:02,930
make it equal so here's the world

1836
01:37:59,800 --> 01:38:06,860
according to just full-on the light look

1837
01:38:02,930 --> 01:38:08,810
up right so there's there's only only

1838
01:38:06,859 --> 01:38:12,649
the light look up is actually happening

1839
01:38:08,810 --> 01:38:16,240
here and so now we should be able to see

1840
01:38:12,649 --> 01:38:19,729
like which values we're getting back now

1841
01:38:16,239 --> 01:38:21,559
if we look at what's happening here

1842
01:38:19,729 --> 01:38:22,909
you can see that there's you know

1843
01:38:21,560 --> 01:38:23,990
because these things have different

1844
01:38:22,909 --> 01:38:27,529
light vibes

1845
01:38:23,989 --> 01:38:31,550
these ones are always looking towards

1846
01:38:27,529 --> 01:38:34,969
the the part of the Octagon here which

1847
01:38:31,550 --> 01:38:37,159
is the downward facing positive Y

1848
01:38:34,970 --> 01:38:46,010
negative X I'm sorry upward-facing

1849
01:38:37,159 --> 01:38:48,949
positive Y negative x right and that's

1850
01:38:46,010 --> 01:38:50,480
probably right and this one is the one

1851
01:38:48,949 --> 01:38:52,670
that's facing the other direction so

1852
01:38:50,479 --> 01:38:54,169
like you know we're looking down in this

1853
01:38:52,670 --> 01:38:56,149
thing so it's going to bounce when the

1854
01:38:54,170 --> 01:38:58,630
reflection vector bounces up the

1855
01:38:56,149 --> 01:39:01,159
incoming light is gonna be coming from

1856
01:38:58,630 --> 01:39:04,369
here or here depending on whether you

1857
01:39:01,159 --> 01:39:07,510
bounce in either direction right so that

1858
01:39:04,369 --> 01:39:10,849
is correct that is what you would expect

1859
01:39:07,510 --> 01:39:13,579
now that tells me something really

1860
01:39:10,850 --> 01:39:16,100
important right just working through

1861
01:39:13,579 --> 01:39:17,869
that I've learned something already in

1862
01:39:16,100 --> 01:39:20,600
fact I've learned enough that I think I

1863
01:39:17,869 --> 01:39:22,939
can go take a look at something right

1864
01:39:20,600 --> 01:39:26,240
away that might help us figure out where

1865
01:39:22,939 --> 01:39:32,629
our bugs are and that is if we switch

1866
01:39:26,239 --> 01:39:35,179
back to the if we switch back to the

1867
01:39:32,630 --> 01:39:38,000
actual lighting and we look at the

1868
01:39:35,180 --> 01:39:41,360
lighting bug we know that it was between

1869
01:39:38,000 --> 01:39:45,560
here and here is this same well we have

1870
01:39:41,359 --> 01:39:48,619
a lighting seem there right you can see

1871
01:39:45,560 --> 01:39:51,500
the lighting seem there that's not a

1872
01:39:48,619 --> 01:39:53,890
copy point right

1873
01:39:51,500 --> 01:40:00,649
that's not a point where we're copying

1874
01:39:53,890 --> 01:40:02,630
so I don't know right like this bug this

1875
01:40:00,649 --> 01:40:03,699
lighting seam right here that's running

1876
01:40:02,630 --> 01:40:07,069
right down there

1877
01:40:03,699 --> 01:40:12,769
nobody's comping that that's that's just

1878
01:40:07,069 --> 01:40:16,479
these things directly right so how is it

1879
01:40:12,770 --> 01:40:20,320
possible that we're not smoothly

1880
01:40:16,479 --> 01:40:20,319
interpolating between those two

1881
01:40:21,699 --> 01:40:31,250
okay wait is this an owl of shame is

1882
01:40:28,369 --> 01:40:35,090
this analogy mix I think this may be the

1883
01:40:31,250 --> 01:40:38,510
first I'll real like deep deep I love

1884
01:40:35,090 --> 01:40:40,940
shame we've had in a while I mean

1885
01:40:38,510 --> 01:40:43,300
looking at this you should know

1886
01:40:40,939 --> 01:40:46,699
immediately what I'm about to say right

1887
01:40:43,300 --> 01:40:50,110
uh-huh but I think we're gonna have a

1888
01:40:46,699 --> 01:40:51,979
shame owl situation here in a second so

1889
01:40:50,109 --> 01:40:54,349
yeah sorry about that

1890
01:40:51,979 --> 01:40:58,129
oops where's our where's our open jails

1891
01:40:54,350 --> 01:41:00,380
here yeah that's that's not great

1892
01:40:58,130 --> 01:41:03,500
you know why might you have a lighting

1893
01:41:00,380 --> 01:41:05,869
seam anyway anyone want to guess why you

1894
01:41:03,500 --> 01:41:08,359
might have lines well one reason you

1895
01:41:05,869 --> 01:41:13,849
might have it is if you don't actually

1896
01:41:08,359 --> 01:41:27,259
ask the card to ever blend anything that

1897
01:41:13,850 --> 01:41:30,440
would do it right oh so much nicer as it

1898
01:41:27,260 --> 01:41:33,320
turns out so now let's see what we

1899
01:41:30,439 --> 01:41:36,139
actually gets when we turn on the real

1900
01:41:33,319 --> 01:41:38,389
lighting here and you know if we want to

1901
01:41:36,140 --> 01:41:41,300
avoid the owl of shame we really hope

1902
01:41:38,390 --> 01:41:43,430
that there's some other bug there but we

1903
01:41:41,300 --> 01:41:47,020
don't know so we'll see we might get

1904
01:41:43,430 --> 01:41:47,020
shamed in a moment

1905
01:41:55,550 --> 01:42:06,059
Wow that looks like there's a lot less

1906
01:41:59,429 --> 01:42:09,029
seams in it all of a sudden we still

1907
01:42:06,059 --> 01:42:15,510
have some popping I'm not sure it's

1908
01:42:09,029 --> 01:42:25,729
totally right but all the seams I was

1909
01:42:15,510 --> 01:42:30,409
looking at before are now gone right so

1910
01:42:25,729 --> 01:42:30,408
that's an alle shame hold on

1911
01:42:49,659 --> 01:42:56,000
so definitely an alum there we probably

1912
01:42:54,260 --> 01:42:58,789
still have a little bit of bug finding

1913
01:42:56,000 --> 01:43:03,050
to do but that was the majority of it so

1914
01:42:58,789 --> 01:43:06,229
like hardly any seems visible now I mean

1915
01:43:03,050 --> 01:43:13,220
that looks clean pretty much everywhere

1916
01:43:06,229 --> 01:43:16,489
let's try turning the shader back on and

1917
01:43:13,220 --> 01:43:18,619
see what we get if we modulate the color

1918
01:43:16,489 --> 01:43:20,949
but I'm guessing it's probably just fine

1919
01:43:18,619 --> 01:43:20,949
now

1920
01:43:21,430 --> 01:43:31,150
oops yeah that looks a lot like lighting

1921
01:43:28,880 --> 01:43:31,150
now

1922
01:43:36,550 --> 01:43:44,199
yep so I guess what I would say is you

1923
01:43:40,960 --> 01:43:46,659
can kind of see here there's so there's

1924
01:43:44,199 --> 01:43:48,550
a couple aspects of the lighting now one

1925
01:43:46,659 --> 01:43:50,260
thing we want to note here is the

1926
01:43:48,550 --> 01:43:52,060
lighting is now very directionally it

1927
01:43:50,260 --> 01:43:53,680
wasn't before because we weren't really

1928
01:43:52,060 --> 01:43:55,900
taking that into account but now that

1929
01:43:53,680 --> 01:43:58,690
with the light probes it kind of is so

1930
01:43:55,899 --> 01:44:00,519
now you can see it's very it's it's it's

1931
01:43:58,689 --> 01:44:03,849
using this since its using the specular

1932
01:44:00,520 --> 01:44:05,860
lookup right and we may want to keep it

1933
01:44:03,850 --> 01:44:08,140
that way or we may want to use some

1934
01:44:05,859 --> 01:44:10,389
blurring to add a diffuse term in there

1935
01:44:08,140 --> 01:44:11,500
that takes light from all directions in

1936
01:44:10,390 --> 01:44:14,440
you know what I mean

1937
01:44:11,500 --> 01:44:16,060
for so we may want to do that and the

1938
01:44:14,439 --> 01:44:19,359
way we would do that is just by blurring

1939
01:44:16,060 --> 01:44:23,110
our map here by using a lower mid levels

1940
01:44:19,359 --> 01:44:25,000
of this map for example so it's not that

1941
01:44:23,109 --> 01:44:27,009
hard to imagine doing something there

1942
01:44:25,000 --> 01:44:29,470
that that would be not very hard for us

1943
01:44:27,010 --> 01:44:31,750
to accomplish certainly we could also

1944
01:44:29,470 --> 01:44:34,659
just take more samples of the same map

1945
01:44:31,750 --> 01:44:36,689
right is another way of doing that so we

1946
01:44:34,659 --> 01:44:40,809
could take some additional samples there

1947
01:44:36,689 --> 01:44:43,539
but either way like yeah totally working

1948
01:44:40,810 --> 01:44:47,020
so our arterial mapping is is pretty

1949
01:44:43,539 --> 01:44:48,729
solid right now there is something

1950
01:44:47,020 --> 01:44:50,650
that's troubling me looking at this I

1951
01:44:48,729 --> 01:44:52,239
see something that looks kind of a

1952
01:44:50,649 --> 01:44:56,109
little bit like a scene here I'd like to

1953
01:44:52,239 --> 01:45:00,130
investigate a little bit more so I may

1954
01:44:56,109 --> 01:45:04,659
go ahead and keep this out for now and

1955
01:45:00,130 --> 01:45:06,100
just take a look at what we see along

1956
01:45:04,659 --> 01:45:08,500
that line so you can see there's a

1957
01:45:06,100 --> 01:45:11,530
really hard lighting seam coming across

1958
01:45:08,500 --> 01:45:14,229
there and you can you can kind of see it

1959
01:45:11,529 --> 01:45:17,469
coming through there I suspect that is

1960
01:45:14,229 --> 01:45:19,329
now more of a but like maybe our copying

1961
01:45:17,470 --> 01:45:22,090
is not as good as it could be you see

1962
01:45:19,329 --> 01:45:24,189
those lines right so I just want to look

1963
01:45:22,090 --> 01:45:28,630
and see to what extent are those lines

1964
01:45:24,189 --> 01:45:32,859
coming from the from the wrapping border

1965
01:45:28,630 --> 01:45:38,949
right and you can kind of see that they

1966
01:45:32,859 --> 01:45:41,670
are like along a little bit like well

1967
01:45:38,949 --> 01:45:43,899
you know what let me turn off the blend

1968
01:45:41,670 --> 01:45:46,560
at the same time I did well it's it's

1969
01:45:43,899 --> 01:45:46,559
really hard to see

1970
01:45:51,300 --> 01:45:55,119
yeah actually you know what looking at

1971
01:45:53,560 --> 01:45:57,460
that I guess I wouldn't actually even

1972
01:45:55,119 --> 01:46:01,569
say that it's not that's not really a

1973
01:45:57,460 --> 01:46:10,869
seam there it looks like it's straight

1974
01:46:01,569 --> 01:46:14,229
down the middle actually of the pink so

1975
01:46:10,869 --> 01:46:18,369
I guess maybe not that looks like it's

1976
01:46:14,229 --> 01:46:21,489
maybe that lining right in there and I'm

1977
01:46:18,369 --> 01:46:33,269
not sure I don't really know what to

1978
01:46:21,489 --> 01:46:33,269
make of that then so I can create a seam

1979
01:46:33,329 --> 01:46:42,100
sort of here between the white and the

1980
01:46:36,970 --> 01:46:44,380
pink right but that's not a copy that's

1981
01:46:42,100 --> 01:46:46,980
just an actual thing I'm assuming if I

1982
01:46:44,380 --> 01:46:53,800
turn this off I won't see a seam there

1983
01:46:46,979 --> 01:46:56,979
I'm assuming yeah and I don't sew the

1984
01:46:53,800 --> 01:47:02,079
seam is actually running this way right

1985
01:46:56,979 --> 01:47:04,119
and I don't think that is a seam that we

1986
01:47:02,079 --> 01:47:10,720
create I don't think so

1987
01:47:04,119 --> 01:47:13,569
that could be wrong because again here's

1988
01:47:10,720 --> 01:47:15,789
the line between like pink and white you

1989
01:47:13,569 --> 01:47:19,029
can see it kind of creeping up on you

1990
01:47:15,789 --> 01:47:21,909
there and so a line this way would

1991
01:47:19,029 --> 01:47:23,920
really just be that I don't think it's

1992
01:47:21,909 --> 01:47:25,449
there and I don't think it's there I

1993
01:47:23,920 --> 01:47:31,119
mean maybe it is but it doesn't look

1994
01:47:25,449 --> 01:47:33,699
like it so I don't really know why we're

1995
01:47:31,119 --> 01:47:36,970
seeing that seam and that's a little

1996
01:47:33,699 --> 01:47:38,019
troubling like I don't have a theory for

1997
01:47:36,970 --> 01:47:39,760
why that's to me is there now it's

1998
01:47:38,020 --> 01:47:41,800
possible that's actually the lighting

1999
01:47:39,760 --> 01:47:43,060
somehow right I mean it could be that

2000
01:47:41,800 --> 01:47:44,320
that's actually what we've sort of

2001
01:47:43,060 --> 01:47:45,280
defined because our lighting is a weird

2002
01:47:44,319 --> 01:47:47,199
debug light floating about the

2003
01:47:45,279 --> 01:47:49,750
character's head and it's a specular

2004
01:47:47,199 --> 01:47:52,090
light so I mean it's entirely possible

2005
01:47:49,750 --> 01:47:54,340
it's right for the definition of right

2006
01:47:52,090 --> 01:47:58,930
where it's what lighting we said we had

2007
01:47:54,340 --> 01:48:00,670
right so that's certainly possible but

2008
01:47:58,930 --> 01:48:03,640
it's hard I don't

2009
01:48:00,670 --> 01:48:05,560
want to chalk it up to that if I can't

2010
01:48:03,640 --> 01:48:09,910
prove it like I want I would like

2011
01:48:05,560 --> 01:48:11,920
ideally some way of of ensuring that

2012
01:48:09,909 --> 01:48:14,319
that's actually what I'm seeing there

2013
01:48:11,920 --> 01:48:16,329
right and I also see that little pop

2014
01:48:14,319 --> 01:48:19,119
like the lighting gets brighter when the

2015
01:48:16,329 --> 01:48:23,909
character pops up like that I'm not sure

2016
01:48:19,119 --> 01:48:23,909
what that's from either right

2017
01:48:29,279 --> 01:48:38,920
so I feel like there's maybe possibly

2018
01:48:32,979 --> 01:48:40,479
still something going on here that I

2019
01:48:38,920 --> 01:48:42,310
would like more information about

2020
01:48:40,479 --> 01:48:45,609
there's just there's some hard edges

2021
01:48:42,310 --> 01:48:47,230
like I see that and I am concerned so I

2022
01:48:45,609 --> 01:48:52,119
feel like there's still a little bit

2023
01:48:47,229 --> 01:48:55,509
going on there that might be expected so

2024
01:48:52,119 --> 01:48:59,140
it might be fine but I don't really want

2025
01:48:55,510 --> 01:49:03,750
to count on that I would I wish we had a

2026
01:48:59,140 --> 01:49:09,450
way I would like a way of making

2027
01:49:03,750 --> 01:49:21,180
something of investigating that further

2028
01:49:09,449 --> 01:49:24,760
right trying to think of what exactly I

2029
01:49:21,180 --> 01:49:27,850
could do to help us investigate right

2030
01:49:24,760 --> 01:49:31,110
like what could I do to provoke this so

2031
01:49:27,850 --> 01:49:33,430
that I can see a little more clearly

2032
01:49:31,109 --> 01:49:36,699
which part of the equations that's

2033
01:49:33,430 --> 01:49:40,510
coming from you know I'm saying so like

2034
01:49:36,699 --> 01:49:43,449
I'm just wondering you know what what to

2035
01:49:40,510 --> 01:49:46,960
do there what interesting thing here

2036
01:49:43,449 --> 01:49:50,769
would be well what if we said R equals

2037
01:49:46,960 --> 01:49:53,109
Naz world in right so we just sample the

2038
01:49:50,770 --> 01:49:55,360
lighting rather than reflecting we just

2039
01:49:53,109 --> 01:49:58,750
sample the lighting from which direction

2040
01:49:55,359 --> 01:50:05,099
you're pointing right and so now we

2041
01:49:58,750 --> 01:50:05,100
would not have any changes based on

2042
01:50:06,000 --> 01:50:11,949
based on the view direction we just have

2043
01:50:09,489 --> 01:50:14,590
changes based on your normal so the

2044
01:50:11,949 --> 01:50:17,649
normal in question is what

2045
01:50:14,590 --> 01:50:21,569
the lighting and you know do we see any

2046
01:50:17,649 --> 01:50:24,549
seams right so we can sort of see our

2047
01:50:21,569 --> 01:50:27,130
our distance fall-off there is happening

2048
01:50:24,550 --> 01:50:29,739
in sort of a radius right we can see

2049
01:50:27,130 --> 01:50:34,599
we're getting a light hiccup in

2050
01:50:29,738 --> 01:50:37,779
brightness and I'm not sure what that's

2051
01:50:34,599 --> 01:50:39,789
coming from so I don't know if that's

2052
01:50:37,779 --> 01:50:42,130
just because as the light gets higher up

2053
01:50:39,789 --> 01:50:44,260
it actually produces a brighter value or

2054
01:50:42,130 --> 01:50:47,260
if there's a bug in when it crosses over

2055
01:50:44,260 --> 01:50:50,409
a particular boundary you know there's

2056
01:50:47,260 --> 01:50:53,289
so that to me is also an unsolved

2057
01:50:50,408 --> 01:50:55,988
problem but so looking at this that's

2058
01:50:53,289 --> 01:50:57,579
pretty good lighting interpolation right

2059
01:50:55,988 --> 01:51:02,138
I don't have any real complaints about

2060
01:50:57,579 --> 01:51:04,599
that but I don't know and I don't see

2061
01:51:02,139 --> 01:51:07,690
any seams so that suggests to me that

2062
01:51:04,599 --> 01:51:10,029
it's the that the the seams might be

2063
01:51:07,689 --> 01:51:12,250
possibly induced a little bit by however

2064
01:51:10,029 --> 01:51:14,349
we're doing our reflections I'm not sure

2065
01:51:12,250 --> 01:51:16,448
it may just be because reflections

2066
01:51:14,349 --> 01:51:18,130
produce smoothly varying normals and we

2067
01:51:16,448 --> 01:51:21,250
don't have any of that here these are

2068
01:51:18,130 --> 01:51:26,230
all normals that don't smoothly vary so

2069
01:51:21,250 --> 01:51:28,960
it would suggest that the what we're

2070
01:51:26,229 --> 01:51:34,979
seeing is a bug as the normal moves

2071
01:51:28,960 --> 01:51:34,980
through things and I just don't know

2072
01:51:44,590 --> 01:52:10,420
I just don't know so here's one thing I

2073
01:52:04,300 --> 01:52:12,760
will say let's go back to this and think

2074
01:52:10,420 --> 01:52:15,579
for a second about what's happening here

2075
01:52:12,760 --> 01:52:22,960
I wonder to what extent these are

2076
01:52:15,579 --> 01:52:26,859
actually getting placed incorrectly so I

2077
01:52:22,960 --> 01:52:29,829
want to know what the octahedral value

2078
01:52:26,859 --> 01:52:32,859
here would be at the center of the Texel

2079
01:52:29,829 --> 01:52:36,488
but this is not probably going to give

2080
01:52:32,859 --> 01:52:40,658
me that is it because let's suppose that

2081
01:52:36,488 --> 01:52:44,589
I want to know what I'm going to get at

2082
01:52:40,658 --> 01:52:49,388
the halfway point right I mean let's

2083
01:52:44,590 --> 01:52:52,569
think about this for a second so on the

2084
01:52:49,389 --> 01:52:56,349
far edge which direction am I actually

2085
01:52:52,569 --> 01:53:00,399
trying to sample from that Texel right

2086
01:52:56,349 --> 01:53:05,650
it's not actually the farthest over let

2087
01:53:00,399 --> 01:53:09,368
me let me draw this out for you it's

2088
01:53:05,649 --> 01:53:10,359
hard with the owl but hey if you didn't

2089
01:53:09,368 --> 01:53:11,769
want to have to program with an eye on

2090
01:53:10,359 --> 01:53:19,089
your shoulder maybe you shouldn't have

2091
01:53:11,770 --> 01:53:22,840
screwed up so you know riddle me this

2092
01:53:19,090 --> 01:53:25,270
Batman so what we're doing here is we're

2093
01:53:22,840 --> 01:53:27,819
picking out a particular Texel and we're

2094
01:53:25,270 --> 01:53:29,440
producing the Oh ex-wife from it but if

2095
01:53:27,819 --> 01:53:30,819
you look at what we're doing where do we

2096
01:53:29,439 --> 01:53:36,309
actually want a sample well we want a

2097
01:53:30,819 --> 01:53:37,829
sample like here right we don't really

2098
01:53:36,310 --> 01:53:40,810
want a sample here

2099
01:53:37,829 --> 01:53:42,849
that's an in-between value and that's

2100
01:53:40,810 --> 01:53:44,860
going to be by linearly reconstructed so

2101
01:53:42,849 --> 01:53:49,599
we really don't want to put that here we

2102
01:53:44,859 --> 01:53:51,429
want to put that here right so if I want

2103
01:53:49,599 --> 01:53:54,210
a sample at the in-between texels that

2104
01:53:51,429 --> 01:53:56,469
means that we're in the actual

2105
01:53:54,210 --> 01:53:58,210
octahedral sampling space am I going to

2106
01:53:56,469 --> 01:54:01,449
be well if this

2107
01:53:58,210 --> 01:54:03,730
boundary is negative 1 and this is 0

2108
01:54:01,449 --> 01:54:06,609
that means this boundary would be

2109
01:54:03,729 --> 01:54:09,369
negative 0.5 and this boundary would be

2110
01:54:06,609 --> 01:54:12,929
0.5 am i right or am I wrong just go

2111
01:54:09,369 --> 01:54:20,859
ahead and say you're right negative 0.75

2112
01:54:12,930 --> 01:54:23,289
0.25 0.25 0.75 right so my boundaries

2113
01:54:20,859 --> 01:54:26,979
are demarcated at the actual whole

2114
01:54:23,289 --> 01:54:28,600
number values the interior center pixels

2115
01:54:26,979 --> 01:54:31,269
where I actually want it's not negative

2116
01:54:28,600 --> 01:54:34,930
1 so this is not the actual equation

2117
01:54:31,270 --> 01:54:40,860
that I wanted right what I actually want

2118
01:54:34,930 --> 01:54:52,960
to do is push this forward by 0.1 by

2119
01:54:40,859 --> 01:54:55,809
half a pixel so 1/16 right I want that

2120
01:54:52,960 --> 01:54:59,170
nudge you know and I'm saying to you I

2121
01:54:55,810 --> 01:55:01,900
want to go halfway in between although

2122
01:54:59,170 --> 01:55:04,239
it should be one sorry one eighth

2123
01:55:01,899 --> 01:55:06,879
because it's negative one to one so

2124
01:55:04,238 --> 01:55:10,419
that's times two yeah yeah what's that

2125
01:55:06,880 --> 01:55:12,609
right so I actually want to be halfway

2126
01:55:10,420 --> 01:55:15,010
in between if we look at what these

2127
01:55:12,609 --> 01:55:18,159
values are I don't want this this is not

2128
01:55:15,010 --> 01:55:19,840
what I actually wanted right when I

2129
01:55:18,159 --> 01:55:21,309
produce two these values because this

2130
01:55:19,840 --> 01:55:25,110
maps from negative 1 to 1

2131
01:55:21,310 --> 01:55:25,110
what I wanted was actually this

2132
01:55:43,409 --> 01:55:58,420
right I actually wanted to offset by

2133
01:55:47,729 --> 01:56:01,509
exactly by exactly half a pixel as I

2134
01:55:58,420 --> 01:56:03,489
went so that's actually the direction

2135
01:56:01,510 --> 01:56:07,630
I'm trying to sample here if I'm not

2136
01:56:03,489 --> 01:56:09,960
mistaken let me go ahead and run a

2137
01:56:07,630 --> 01:56:09,960
compiled

2138
01:56:29,939 --> 01:56:35,280
and that's what we actually should have

2139
01:56:31,738 --> 01:56:36,899
been sampling I would argue right now

2140
01:56:35,279 --> 01:56:40,828
unfortunately just looking at it I don't

2141
01:56:36,899 --> 01:56:43,379
think that helps us at all it still

2142
01:56:40,828 --> 01:56:46,859
looks like we've got the same error here

2143
01:56:43,380 --> 01:56:48,479
right so changing which direction which

2144
01:56:46,859 --> 01:56:50,788
sample direction we were actually using

2145
01:56:48,479 --> 01:56:54,449
I don't know it doesn't seem to have a

2146
01:56:50,788 --> 01:56:56,899
huge impact there like if I go and take

2147
01:56:54,448 --> 01:56:56,899
that out

2148
01:57:00,590 --> 01:57:06,409
that's the offset right so if I do this

2149
01:57:09,800 --> 01:57:15,239
right now let's go

2150
01:57:12,389 --> 01:57:20,458
and turn it off so this is the old way

2151
01:57:15,238 --> 01:57:24,238
and we'll wait till it till it finishes

2152
01:57:20,458 --> 01:57:28,050
recompile so you can see that it

2153
01:57:24,238 --> 01:57:30,808
definitely it's different right but and

2154
01:57:28,050 --> 01:57:32,489
I think it's more correctly what we want

2155
01:57:30,809 --> 01:57:33,570
not that we care if this routine is

2156
01:57:32,488 --> 01:57:37,468
correct but I think it's more correctly

2157
01:57:33,569 --> 01:57:40,529
what we want the only problem it doesn't

2158
01:57:37,469 --> 01:57:43,969
seem to actually matter right like it

2159
01:57:40,529 --> 01:57:49,498
doesn't seem like it really gives us any

2160
01:57:43,969 --> 01:57:53,149
less for it for the seam right it seems

2161
01:57:49,498 --> 01:57:56,149
like the seam is still totally there

2162
01:57:53,149 --> 01:57:56,149
right

2163
01:58:10,199 --> 01:58:15,069
so I don't know so let's go ahead and go

2164
01:58:13,329 --> 01:58:16,739
to Q&amp;A but I think that's something that

2165
01:58:15,069 --> 01:58:19,299
I'm gonna want to look at next week

2166
01:58:16,739 --> 01:58:21,369
because I don't feel like we've quite

2167
01:58:19,300 --> 01:58:23,110
got all the bugs out yet necessarily and

2168
01:58:21,369 --> 01:58:25,029
even if that doesn't turn out to be a

2169
01:58:23,109 --> 01:58:26,769
bug it's at least something I want to

2170
01:58:25,029 --> 01:58:28,300
understand I don't like looking at

2171
01:58:26,770 --> 01:58:32,590
lighting things like that and seeing an

2172
01:58:28,300 --> 01:58:36,090
issue all right so let's go ahead and go

2173
01:58:32,590 --> 01:58:36,090
to Q&amp;A anyone got Q's

2174
01:59:00,609 --> 01:59:06,789
can you vary the light height to see its

2175
01:59:03,038 --> 01:59:09,608
impact do you mean animate it or do you

2176
01:59:06,788 --> 01:59:12,518
just want me to go change the value just

2177
01:59:09,609 --> 01:59:13,869
to something higher III I'll do either

2178
01:59:12,519 --> 01:59:15,609
I'll do whatever you want I just

2179
01:59:13,868 --> 01:59:17,618
I don sure which which one you're asking

2180
01:59:15,609 --> 01:59:18,849
for but I guess I can go do either of

2181
01:59:17,618 --> 01:59:30,069
those two things something of which one

2182
01:59:18,849 --> 01:59:31,989
you wanted to see either way okay can

2183
01:59:30,069 --> 01:59:35,349
you draw in the light probe positions

2184
01:59:31,988 --> 01:59:38,788
yes we well but we're not using light

2185
01:59:35,349 --> 01:59:41,800
probes so you mean the the light atlas

2186
01:59:38,788 --> 01:59:43,868
locations the probes we have actual

2187
01:59:41,800 --> 01:59:45,038
probed locations and those I guess will

2188
01:59:43,868 --> 01:59:46,898
now go away

2189
01:59:45,038 --> 01:59:49,418
they might not though because they say

2190
01:59:46,899 --> 01:59:53,588
where we're gonna cast from but that's a

2191
01:59:49,418 --> 01:59:58,479
separate issue okay yeah but I can I can

2192
01:59:53,588 --> 02:00:02,229
go fix that drawing light probe

2193
01:59:58,479 --> 02:00:05,449
locations will require us to

2194
02:00:02,229 --> 02:00:05,449
[Music]

2195
02:00:14,430 --> 02:00:20,560
so actually drawing those I guess the

2196
02:00:18,069 --> 02:00:23,529
easiest thing would probably be to use

2197
02:00:20,560 --> 02:00:27,490
this routine here and just draw a debug

2198
02:00:23,529 --> 02:00:30,429
box there so for each one of these when

2199
02:00:27,489 --> 02:00:32,800
we do Vox Center P I think that's

2200
02:00:30,430 --> 02:00:34,570
probably what we would want to do so we

2201
02:00:32,800 --> 02:00:36,550
would draw a debug like I think that's

2202
02:00:34,569 --> 02:00:42,969
probably what we want so we probably

2203
02:00:36,550 --> 02:00:45,250
want to draw a debug box I don't

2204
02:00:42,970 --> 02:00:48,539
remember what that call looks like so

2205
02:00:45,250 --> 02:00:48,539
I'm just going to try and grab it here

2206
02:00:56,828 --> 02:01:05,299
there it is so if I wanted to draw those

2207
02:01:01,488 --> 02:01:09,138
I would just do it here probably so I

2208
02:01:05,300 --> 02:01:11,510
can say all right push debug box we've

2209
02:01:09,139 --> 02:01:14,840
got the lighting solution the box min

2210
02:01:11,510 --> 02:01:17,179
the box Max and the box color so for box

2211
02:01:14,840 --> 02:01:21,880
color what I'll probably do here is just

2212
02:01:17,179 --> 02:01:24,319
pass down the light color I guess right

2213
02:01:21,880 --> 02:01:29,989
seems like the most sensible thing to do

2214
02:01:24,319 --> 02:01:32,658
I don't know maybe it's not then for the

2215
02:01:29,988 --> 02:01:38,029
Box mannan Box max I would just do Vox

2216
02:01:32,658 --> 02:01:40,819
Center P - box our and box Center P plus

2217
02:01:38,029 --> 02:01:54,228
box R and then you know I don't know box

2218
02:01:40,819 --> 02:01:58,448
R is that I'm not sure so this would

2219
02:01:54,229 --> 02:02:01,489
just show us like where these things are

2220
02:01:58,448 --> 02:02:05,928
looks like we've got too many of them

2221
02:02:01,488 --> 02:02:09,189
actually though because there's just too

2222
02:02:05,929 --> 02:02:09,190
many box lines there

2223
02:02:13,720 --> 02:02:18,909
so let's do something where we just do

2224
02:02:16,329 --> 02:02:21,130
when we come through here oh whoops no

2225
02:02:18,909 --> 02:02:26,579
that's just because I do too many of

2226
02:02:21,130 --> 02:02:29,500
these so we'll do it here

2227
02:02:26,579 --> 02:02:33,010
that was one per pixel that's obviously

2228
02:02:29,500 --> 02:02:34,329
way too many but hopefully we can draw

2229
02:02:33,010 --> 02:02:37,239
each of these I don't know maybe we

2230
02:02:34,329 --> 02:02:38,829
can't but we'll see for now actually

2231
02:02:37,239 --> 02:02:40,239
because I won't have I could do an

2232
02:02:38,829 --> 02:02:42,100
aggregate like color but I'm just going

2233
02:02:40,239 --> 02:02:44,920
to do this instead we'll just do pure

2234
02:02:42,100 --> 02:02:47,220
bright at that point and we'll see what

2235
02:02:44,920 --> 02:02:47,220
happens

2236
02:02:59,609 --> 02:03:08,109
so I think that would be it um still too

2237
02:03:05,019 --> 02:03:09,729
many looks like so we could do a

2238
02:03:08,109 --> 02:03:11,558
narrower bound here or we could try to

2239
02:03:09,729 --> 02:03:13,659
increase the number of debug points we

2240
02:03:11,559 --> 02:03:16,929
got I don't know how we want to do that

2241
02:03:13,658 --> 02:03:19,328
exactly but we've already got a lot of

2242
02:03:16,929 --> 02:03:21,069
them is that really the case how many

2243
02:03:19,328 --> 02:03:24,009
how many of these do we have it's gonna

2244
02:03:21,069 --> 02:03:26,259
make a nasty problem for us render wise

2245
02:03:24,010 --> 02:03:29,170
if we have too many of these but blue -

2246
02:03:26,260 --> 02:03:34,800
I'm sorry - times thirty-two times what

2247
02:03:29,170 --> 02:03:39,550
is it so it would be eight twelve Oh God

2248
02:03:34,800 --> 02:03:41,800
so let's try to narrow this then that's

2249
02:03:39,550 --> 02:03:48,849
too many boxes so let's try to narrow

2250
02:03:41,800 --> 02:03:51,340
this and just say look if you know Z is

2251
02:03:48,849 --> 02:03:54,610
greater than or equal to hot game over

2252
02:03:51,340 --> 02:04:01,050
to and Z is less than or equal to hot

2253
02:03:54,609 --> 02:04:01,049
damn / - right oops

2254
02:04:08,988 --> 02:04:25,009
I don't know how to do this we can just

2255
02:04:20,300 --> 02:04:26,480
do a smaller cube but I'm not sure how

2256
02:04:25,010 --> 02:04:31,989
yeah so I mean I guess we could do this

2257
02:04:26,479 --> 02:04:31,988
like how about this

2258
02:04:35,859 --> 02:04:57,759
so or how about this something like this

2259
02:04:57,969 --> 02:05:04,520
we just need to leave this so that we're

2260
02:05:00,590 --> 02:05:06,319
not drawing too many so we'll just say

2261
02:05:04,520 --> 02:05:08,390
look we've got some function here it

2262
02:05:06,319 --> 02:05:10,729
does something or maybe it's a pound of

2263
02:05:08,390 --> 02:05:13,340
time I don't care

2264
02:05:10,729 --> 02:05:15,859
we pass three things down or just one

2265
02:05:13,340 --> 02:05:17,719
thing down rather and we say like

2266
02:05:15,859 --> 02:05:26,119
alright if V is greater than equal to

2267
02:05:17,719 --> 02:05:28,489
hot dim divided by 2 - hot dim divided

2268
02:05:26,119 --> 02:05:30,439
by 4 I don't know actually it's good to

2269
02:05:28,488 --> 02:05:33,919
do it this way if ax greater than equal

2270
02:05:30,439 --> 02:05:36,139
to hot dim divided by 4 and V is less

2271
02:05:33,920 --> 02:05:41,239
than or equal to hot dim divided by 4

2272
02:05:36,140 --> 02:05:44,989
you know from the other direction it's

2273
02:05:41,238 --> 02:05:45,919
just a narrower region alright so maybe

2274
02:05:44,988 --> 02:05:47,659
it'll work

2275
02:05:45,920 --> 02:05:49,789
we just need to narrow that number down

2276
02:05:47,659 --> 02:05:58,670
so we're not drawing so many of those

2277
02:05:49,789 --> 02:06:02,659
cubes and so how many we got now I guess

2278
02:05:58,670 --> 02:06:08,000
we don't know oops so how much would

2279
02:06:02,659 --> 02:06:17,739
that be so that's 32 so it's that would

2280
02:06:08,000 --> 02:06:20,000
be 32 divided by 2 to the third times 12

2281
02:06:17,739 --> 02:06:22,159
so that should have worked although I

2282
02:06:20,000 --> 02:06:24,109
guess with other debug lines it might

2283
02:06:22,159 --> 02:06:27,170
not so I guess we have to go even

2284
02:06:24,109 --> 02:06:28,729
smaller than that so let's do it the

2285
02:06:27,170 --> 02:06:30,789
other way this is a real pain in the

2286
02:06:28,729 --> 02:06:30,789
butt

2287
02:06:55,789 --> 02:07:10,319
all right let me try to make this right

2288
02:07:02,819 --> 02:07:13,039
so that closes that guy again and that

2289
02:07:10,319 --> 02:07:13,039
closes that guy

2290
02:07:22,618 --> 02:07:27,908
all right so in theory we are now

2291
02:07:25,599 --> 02:07:31,659
drawing these in fact there they are

2292
02:07:27,908 --> 02:07:36,788
right and they're in the wrong place as

2293
02:07:31,658 --> 02:07:39,788
far as I can tell which seems bad oh and

2294
02:07:36,788 --> 02:07:44,679
that's totally true like how are we

2295
02:07:39,788 --> 02:07:47,500
getting that as the Vox Center P okay so

2296
02:07:44,679 --> 02:07:54,578
that's totally wrong sorry let's fix

2297
02:07:47,500 --> 02:07:56,229
that yeah this is using the light uvw so

2298
02:07:54,578 --> 02:08:02,639
we need to be able to compute the actual

2299
02:07:56,229 --> 02:08:05,408
light location which we don't have here

2300
02:08:02,639 --> 02:08:08,650
so let me go ahead and actually try to

2301
02:08:05,408 --> 02:08:14,888
compute that so if you look at the Vox

2302
02:08:08,649 --> 02:08:16,089
min corner can actually see here like

2303
02:08:14,889 --> 02:08:20,849
how this is working

2304
02:08:16,090 --> 02:08:24,340
so if we were to take the XY Z here and

2305
02:08:20,849 --> 02:08:33,279
take the it's the hot DIMMs min corner

2306
02:08:24,340 --> 02:08:36,880
so I'm not sure it's this right so if we

2307
02:08:33,279 --> 02:08:40,750
wanted to know where the box was its Vox

2308
02:08:36,880 --> 02:08:44,920
Center P is whatever the minimum corner

2309
02:08:40,750 --> 02:08:48,760
is for this thing and then we're gonna

2310
02:08:44,920 --> 02:08:51,960
have to take this and I guess that can

2311
02:08:48,760 --> 02:08:51,960
kind of come out here right

2312
02:09:02,069 --> 02:09:09,609
and then what we would need to do is say

2313
02:09:04,719 --> 02:09:12,640
take the min corner of this thing of the

2314
02:09:09,609 --> 02:09:15,549
hot corner and add to it whatever our

2315
02:09:12,640 --> 02:09:18,400
actual dimensions of this thing are so

2316
02:09:15,550 --> 02:09:21,219
whatever the Vox Center P is and we

2317
02:09:18,399 --> 02:09:24,429
would also need to move by that the size

2318
02:09:21,219 --> 02:09:30,069
so whatever the Vox dim the actual Vox

2319
02:09:24,430 --> 02:09:35,260
dim size is so like the cell size is

2320
02:09:30,069 --> 02:09:44,859
actually essentially so that would be

2321
02:09:35,260 --> 02:09:47,110
voxel dim and so that should place us in

2322
02:09:44,859 --> 02:09:54,670
the correct like world space location

2323
02:09:47,109 --> 02:10:04,599
for the voxel I think and so those are

2324
02:09:54,670 --> 02:10:06,969
the light probes themselves I'm guessing

2325
02:10:04,600 --> 02:10:11,170
the flash is coming from like the light

2326
02:10:06,969 --> 02:10:16,948
hop going between two voxel cells that's

2327
02:10:11,170 --> 02:10:16,949
not we don't quite have the I don't know

2328
02:10:20,430 --> 02:10:27,280
although you know what it might be it

2329
02:10:25,390 --> 02:10:31,980
might actually come from a discontinuity

2330
02:10:27,279 --> 02:10:34,659
in the actual Z ground interpolation

2331
02:10:31,979 --> 02:10:38,909
that's actually probably what it is I

2332
02:10:34,659 --> 02:10:38,909
doubt this is actually a lighting bug

2333
02:11:04,920 --> 02:11:14,380
so I think that could actually be a Z

2334
02:11:07,359 --> 02:11:17,559
discontinuity to be honest so I think

2335
02:11:14,380 --> 02:11:32,260
what we'd want to do here is be a little

2336
02:11:17,560 --> 02:11:36,789
bit more like careful and see I sorry I

2337
02:11:32,260 --> 02:11:38,739
missed a bunch of these questions should

2338
02:11:36,789 --> 02:11:40,989
you get our copy from the opposite flip

2339
02:11:38,739 --> 02:11:48,250
sides of the octal mapping so the

2340
02:11:40,989 --> 02:11:50,619
bilinear blend will blend correctly not

2341
02:11:48,250 --> 02:11:56,489
sure what that means we tried to do the

2342
02:11:50,619 --> 02:12:02,260
correct copy right so the gutter is

2343
02:11:56,489 --> 02:12:04,899
around this outside right and so if you

2344
02:12:02,260 --> 02:12:11,770
look at where these would match up with

2345
02:12:04,899 --> 02:12:15,819
right where does this go well it goes to

2346
02:12:11,770 --> 02:12:19,780
here right so when we do the copy we

2347
02:12:15,819 --> 02:12:24,449
want to copy here to here and here to

2348
02:12:19,779 --> 02:12:30,449
here which is what we did right this is

2349
02:12:24,449 --> 02:12:30,449
here that is there right

2350
02:12:34,760 --> 02:12:42,110
am I am I wrong so as far as I know we

2351
02:12:39,800 --> 02:12:44,119
copied the gutters in the way that the

2352
02:12:42,109 --> 02:12:48,589
action the way they actually go around

2353
02:12:44,119 --> 02:12:50,829
the octahedron so unless that's not what

2354
02:12:48,590 --> 02:12:50,829
you mean

2355
02:12:51,140 --> 02:12:59,090
as far as the lighting height let's see

2356
02:12:53,779 --> 02:13:07,609
if we can get it to wig out on the on

2357
02:12:59,090 --> 02:13:10,369
the debug light position so if you look

2358
02:13:07,609 --> 02:13:14,509
here we've got this world mode debug

2359
02:13:10,369 --> 02:13:17,479
light PE nonsense and that debug light P

2360
02:13:14,510 --> 02:13:21,970
is something that takes whatever the

2361
02:13:17,479 --> 02:13:21,969
ground P is and just like hovers it

2362
02:13:22,210 --> 02:13:28,939
right so if we were to take that value

2363
02:13:26,060 --> 02:13:33,170
and smoothly vary this thing you know

2364
02:13:28,939 --> 02:13:38,589
somehow we could definitely make

2365
02:13:33,170 --> 02:13:38,590
something that was going to you know

2366
02:13:51,439 --> 02:13:57,448
so here we can just like very this thing

2367
02:13:54,328 --> 02:13:58,738
using DT which we don't really want to

2368
02:13:57,448 --> 02:14:00,538
do for anything real but it's pretty

2369
02:13:58,738 --> 02:14:04,078
easy for us to do it here so we can just

2370
02:14:00,538 --> 02:14:10,859
say like look why don't you add to this

2371
02:14:04,078 --> 02:14:15,799
like the sine of T crappy and we'll make

2372
02:14:10,859 --> 02:14:18,328
it hover by like 0.25 or something right

2373
02:14:15,800 --> 02:14:20,788
and that makes it so that this will go

2374
02:14:18,328 --> 02:14:24,389
up and down separately to see if we can

2375
02:14:20,788 --> 02:14:25,198
find that that error there oops this is

2376
02:14:24,389 --> 02:14:28,050
an f32

2377
02:14:25,198 --> 02:14:30,699
and so we can just make that like thing

2378
02:14:28,050 --> 02:14:33,840
like hover in place and

2379
02:14:30,699 --> 02:14:33,840
[Music]

2380
02:14:40,529 --> 02:14:47,399
so there you can see it hovering up and

2381
02:14:43,050 --> 02:14:50,550
down and I don't see a pop in that right

2382
02:14:47,399 --> 02:14:53,339
and so if I I could make it hover up and

2383
02:14:50,550 --> 02:14:56,719
down quite a bit more so than I think

2384
02:14:53,340 --> 02:14:56,719
the hero does ever

2385
02:15:07,100 --> 02:15:13,370
so there is a pop there right for sure

2386
02:15:13,399 --> 02:15:17,638
you know what I'm thinking actually now

2387
02:15:15,869 --> 02:15:20,250
that I'm seeing what it's doing

2388
02:15:17,639 --> 02:15:24,210
I guess that pop is just actually true

2389
02:15:20,250 --> 02:15:26,340
because it's a point light source we're

2390
02:15:24,210 --> 02:15:29,908
treating it as a point so when that

2391
02:15:26,340 --> 02:15:31,260
point moves below a certain probe that's

2392
02:15:29,908 --> 02:15:33,839
just what's gonna happen it's gonna

2393
02:15:31,260 --> 02:15:37,110
instantaneously go from being visible

2394
02:15:33,840 --> 02:15:39,989
above it to being invisible right so

2395
02:15:37,109 --> 02:15:44,309
unless we add a cosine fall-off there

2396
02:15:39,988 --> 02:15:45,988
and even if we didn't the fact that it's

2397
02:15:44,310 --> 02:15:48,719
moving it could move straight through

2398
02:15:45,988 --> 02:15:51,408
one of these things and in fact it will

2399
02:15:48,719 --> 02:15:54,090
because we're lined up with it exactly

2400
02:15:51,408 --> 02:15:55,500
so I think that may be somewhat

2401
02:15:54,090 --> 02:15:57,619
unavoidable I mean don't quote me on

2402
02:15:55,500 --> 02:15:57,619
that

2403
02:15:59,988 --> 02:16:08,519
but that may be somewhat unavoidable and

2404
02:16:05,840 --> 02:16:10,770
and remember we're not doing an inner

2405
02:16:08,520 --> 02:16:12,840
product for the lighting right now which

2406
02:16:10,770 --> 02:16:14,310
we should be doing and you know what now

2407
02:16:12,840 --> 02:16:16,319
I think about it without that inner

2408
02:16:14,310 --> 02:16:17,639
product that could also explain where

2409
02:16:16,319 --> 02:16:19,460
some of these seams are coming from

2410
02:16:17,639 --> 02:16:22,230
right because that's a hard

2411
02:16:19,460 --> 02:16:25,069
discontinuity let me see what happens if

2412
02:16:22,229 --> 02:16:27,658
I just put that into our Z bias program

2413
02:16:25,069 --> 02:16:30,029
so if I come out here to the Xevious

2414
02:16:27,658 --> 02:16:32,869
program and I just say all right so you

2415
02:16:30,029 --> 02:16:37,978
know we're gonna want to actually do a

2416
02:16:32,870 --> 02:16:41,519
clamp 0 1 cosine fall-off curve here

2417
02:16:37,978 --> 02:16:44,609
right so when we actually do our light

2418
02:16:41,519 --> 02:16:47,280
lookup and we're gonna actually like

2419
02:16:44,610 --> 02:16:52,500
combine these here before I go and

2420
02:16:47,280 --> 02:16:59,880
actually you know include them I want to

2421
02:16:52,500 --> 02:17:01,679
do some kind of a of a clamp and

2422
02:16:59,879 --> 02:17:05,239
fortunately I don't pass the normal do I

2423
02:17:01,679 --> 02:17:07,860
so we kind of need we kind of need this

2424
02:17:05,239 --> 02:17:08,039
to come in there how is that going to

2425
02:17:07,860 --> 02:17:10,579
work

2426
02:17:08,040 --> 02:17:10,580
so the

2427
02:17:12,501 --> 02:17:29,341
so the our value is as that point light

2428
02:17:19,860 --> 02:17:30,810
is moving through we you know I sorry

2429
02:17:29,341 --> 02:17:32,280
I'm not gonna throw that and that's a

2430
02:17:30,809 --> 02:17:35,119
little bit too much to throw in so we'll

2431
02:17:32,280 --> 02:17:35,120
see later but

2432
02:17:57,549 --> 02:18:05,198
all right so I think we're good I'm

2433
02:18:00,760 --> 02:18:08,109
gonna leave this and we can take a look

2434
02:18:05,199 --> 02:18:10,510
at that the popping but I'm assuming

2435
02:18:08,109 --> 02:18:13,899
that that's what that is as it goes from

2436
02:18:10,510 --> 02:18:19,029
one probe to the other you can actually

2437
02:18:13,898 --> 02:18:20,948
see where the probe is so you can

2438
02:18:19,029 --> 02:18:22,960
actually see as it passes through the

2439
02:18:20,949 --> 02:18:26,039
center point that's exactly what's

2440
02:18:22,959 --> 02:18:26,038
happening right

2441
02:18:41,539 --> 02:18:46,949
so that's like what's happening all

2442
02:18:44,968 --> 02:18:48,089
right we can fix all that so I'm not too

2443
02:18:46,949 --> 02:18:50,519
concerned about that at all

2444
02:18:48,090 --> 02:18:52,228
so I'm gonna go ahead and and nerf this

2445
02:18:50,519 --> 02:18:54,539
here I don't really want that in there

2446
02:18:52,228 --> 02:18:57,349
long term that was just to see if I was

2447
02:18:54,539 --> 02:19:00,149
right but it looks like that's the case

2448
02:18:57,349 --> 02:19:02,068
all right so I think we're good with

2449
02:19:00,148 --> 02:19:05,218
that and I'm gonna go ahead and call it

2450
02:19:02,068 --> 02:19:10,609
for today let's make sure that

2451
02:19:05,218 --> 02:19:13,259
recompiles everything's good all right

2452
02:19:10,609 --> 02:19:14,789
boop boop

2453
02:19:13,260 --> 02:19:15,929
thank you everyone for joining me for

2454
02:19:14,789 --> 02:19:17,429
the facade of handmade hero sort of

2455
02:19:15,929 --> 02:19:18,510
pleasure coating with you as always if

2456
02:19:17,429 --> 02:19:21,689
you would like to follow a series at

2457
02:19:18,510 --> 02:19:24,238
home you can always pre-order the game

2458
02:19:21,689 --> 02:19:25,498
on handmade hero arc it comes with a

2459
02:19:24,238 --> 02:19:30,478
source code so you can follow along with

2460
02:19:25,498 --> 02:19:31,498
it from day to day I will I think I

2461
02:19:30,478 --> 02:19:33,448
forgot to upload the video from

2462
02:19:31,498 --> 02:19:37,408
yesterday I will upload the video from

2463
02:19:33,449 --> 02:19:39,209
yesterday to be sure until then everyone

2464
02:19:37,408 --> 02:19:39,689
have fun programming and I'll see you on

2465
02:19:39,209 --> 02:19:42,349
the Internet

2466
02:19:39,689 --> 02:19:42,349
Diggy's everybody

