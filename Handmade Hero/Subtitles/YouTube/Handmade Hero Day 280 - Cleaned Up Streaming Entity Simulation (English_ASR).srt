1
00:00:00,439 --> 00:00:06,778
all righty hello everyone and welcome to

2
00:00:05,009 --> 00:00:08,820
another edition of handmade Hero the

3
00:00:06,778 --> 00:00:11,609
show recode a complete-game live on

4
00:00:08,820 --> 00:00:12,900
stream today is day 280 so if you were

5
00:00:11,609 --> 00:00:14,279
trying to follow along with stream at

6
00:00:12,900 --> 00:00:17,039
home you should start with day two seven

7
00:00:14,279 --> 00:00:19,169
nine source code and you should get

8
00:00:17,039 --> 00:00:22,560
ready for some debugging because what we

9
00:00:19,170 --> 00:00:24,779
are doing today is getting all of our

10
00:00:22,559 --> 00:00:27,059
changes working that we made as far as

11
00:00:24,778 --> 00:00:29,009
the way that entities are stored in our

12
00:00:27,059 --> 00:00:32,129
system because we're starting to make

13
00:00:29,010 --> 00:00:35,039
that be a more realistic part of the of

14
00:00:32,130 --> 00:00:36,239
the game now more a real system that can

15
00:00:35,039 --> 00:00:43,189
actually handle what we need it to

16
00:00:36,238 --> 00:00:47,819
handle for our game and so due to this

17
00:00:43,189 --> 00:00:48,899
we obviously need to to think that stuff

18
00:00:47,820 --> 00:00:50,878
through and make it work a little bit

19
00:00:48,899 --> 00:00:53,370
more reasonably so

20
00:00:50,878 --> 00:00:54,929
what we did at the end of yesterday's

21
00:00:53,369 --> 00:00:56,308
stream is we'd sort of gotten everything

22
00:00:54,929 --> 00:00:58,439
compiling instead of but we haven't

23
00:00:56,308 --> 00:00:59,968
debugged anything I guess I fixed a

24
00:00:58,439 --> 00:01:01,710
little bit of something because just I

25
00:00:59,969 --> 00:01:02,879
like couldn't quite let it go I fixed a

26
00:01:01,710 --> 00:01:04,680
few little things so it would run

27
00:01:02,878 --> 00:01:07,890
properly but we're not actually running

28
00:01:04,680 --> 00:01:09,150
correctly we're just not crashing so we

29
00:01:07,890 --> 00:01:11,728
have a bunch of work to do to go verify

30
00:01:09,150 --> 00:01:12,960
that things are working right and also

31
00:01:11,728 --> 00:01:14,989
somebody already posted on the forums

32
00:01:12,959 --> 00:01:20,039
who I guess is following along every day

33
00:01:14,989 --> 00:01:23,219
said we had a size of problem which

34
00:01:20,040 --> 00:01:26,070
sounded pretty much like exactly what I

35
00:01:23,219 --> 00:01:29,368
would expect for when we were packing

36
00:01:26,069 --> 00:01:33,059
stuff in I believe it would have been

37
00:01:29,368 --> 00:01:34,618
size of source like here so you can like

38
00:01:33,060 --> 00:01:36,478
the the pack size here when I was doing

39
00:01:34,618 --> 00:01:38,578
this I was careless we actually want the

40
00:01:36,478 --> 00:01:41,368
size of the the thing we're packing is

41
00:01:38,578 --> 00:01:45,000
an entity not the pointer so this should

42
00:01:41,368 --> 00:01:46,530
technically be look like this remember

43
00:01:45,000 --> 00:01:48,709
we're not actually doing packing at the

44
00:01:46,530 --> 00:01:53,159
moment all we're doing at the moment is

45
00:01:48,709 --> 00:01:55,078
we are sort of using the we're just sort

46
00:01:53,159 --> 00:01:57,930
of block copying entities into world

47
00:01:55,078 --> 00:01:59,399
chunks when we sort of pack them and the

48
00:01:57,930 --> 00:02:00,530
idea is that we'll just keep doing that

49
00:01:59,399 --> 00:02:03,689
for a little while and then eventually

50
00:02:00,530 --> 00:02:05,968
once we actually care we'll come in here

51
00:02:03,688 --> 00:02:07,618
and do some work to like sort of compact

52
00:02:05,968 --> 00:02:09,090
them down because eventually I think

53
00:02:07,618 --> 00:02:11,489
they'll be too large and you won't want

54
00:02:09,090 --> 00:02:13,878
to do block copies like that so that's

55
00:02:11,489 --> 00:02:13,878
how that works

56
00:02:14,530 --> 00:02:19,750
and so there was definitely a bug in

57
00:02:17,949 --> 00:02:22,329
there and there was another one problem

58
00:02:19,750 --> 00:02:24,610
with stored index stored index though is

59
00:02:22,330 --> 00:02:26,319
kind of janky at the moment and so

60
00:02:24,610 --> 00:02:29,530
stored index really doesn't want to be

61
00:02:26,318 --> 00:02:31,750
called stored index anymore stored index

62
00:02:29,530 --> 00:02:33,549
just wants to be called ID there's no

63
00:02:31,750 --> 00:02:34,598
such thing as like storage indexing or

64
00:02:33,549 --> 00:02:37,480
anything like that what there used to be

65
00:02:34,598 --> 00:02:40,298
so really the name stored index itself

66
00:02:37,479 --> 00:02:42,878
is erroneous and we haven't really fixed

67
00:02:40,299 --> 00:02:44,799
that yet so rather than debug something

68
00:02:42,878 --> 00:02:46,179
that's not quite correct this we might

69
00:02:44,799 --> 00:02:47,349
as well do one more change here since

70
00:02:46,180 --> 00:02:49,810
we're gonna do go through all the

71
00:02:47,348 --> 00:02:51,578
trouble of debugging it all I kind of

72
00:02:49,810 --> 00:02:54,310
want to go through and say well from now

73
00:02:51,579 --> 00:02:56,469
on we'll actually have a notion in here

74
00:02:54,310 --> 00:02:57,939
of the correct thing which is a set of

75
00:02:56,469 --> 00:02:59,739
storage index this is actually the

76
00:02:57,939 --> 00:03:02,289
entity ID which is what we actually want

77
00:02:59,739 --> 00:03:03,700
right so then we'll come through here

78
00:03:02,289 --> 00:03:06,519
and we'll take a look at where all the

79
00:03:03,699 --> 00:03:09,098
stuff is being used right and we'll

80
00:03:06,519 --> 00:03:10,870
change storage index to an ID so in

81
00:03:09,098 --> 00:03:13,929
store entity reference this is what we

82
00:03:10,870 --> 00:03:15,599
want meaning we'll be grabbing out of

83
00:03:13,930 --> 00:03:17,859
the ref what the ID actually is

84
00:03:15,598 --> 00:03:19,959
similarly when we pass these things in

85
00:03:17,859 --> 00:03:23,620
here that makes sense that we would be

86
00:03:19,959 --> 00:03:28,239
taking a look at those storage indexes

87
00:03:23,620 --> 00:03:30,340
like so when we record that for adding

88
00:03:28,239 --> 00:03:33,909
an entity that is also what we will

89
00:03:30,340 --> 00:03:35,079
store there is that ID same here you

90
00:03:33,909 --> 00:03:39,009
know what I should probably be doing

91
00:03:35,079 --> 00:03:41,169
that I should probably be doing that not

92
00:03:39,009 --> 00:03:45,608
in this I should do it in this window so

93
00:03:41,169 --> 00:03:46,930
we don't go behind my head it needs to

94
00:03:45,609 --> 00:03:48,700
be a thing in for coder since we're all

95
00:03:46,930 --> 00:03:49,900
using it to stream that like is it you

96
00:03:48,699 --> 00:03:52,469
can put a little thing that knows that

97
00:03:49,900 --> 00:03:53,769
there's a square down there or something

98
00:03:52,469 --> 00:03:58,780
but anyway

99
00:03:53,769 --> 00:04:01,289
alright so storage index ID do we

100
00:03:58,780 --> 00:04:04,959
actually have any more is that it

101
00:04:01,289 --> 00:04:07,989
let's see so get hash from ID let's

102
00:04:04,959 --> 00:04:13,000
actually change the name of that get

103
00:04:07,989 --> 00:04:16,149
hash from nowhere that actually is there

104
00:04:13,000 --> 00:04:22,610
it is alright

105
00:04:16,149 --> 00:04:29,599
get hash from let's see storage index D

106
00:04:22,610 --> 00:04:33,919
yep yep yep yep yep yeah when we add in

107
00:04:29,600 --> 00:04:36,530
the yeah I guess that's still looking at

108
00:04:33,918 --> 00:04:38,719
it we don't really need to pass that

109
00:04:36,529 --> 00:04:40,159
anymore when we do add entity in fact I

110
00:04:38,720 --> 00:04:41,930
might as well take care of that now so

111
00:04:40,160 --> 00:04:45,259
when we do an identity to the to the

112
00:04:41,930 --> 00:04:48,110
thing really we can just sort of pass in

113
00:04:45,259 --> 00:04:51,680
the lo here because this will be the

114
00:04:48,110 --> 00:04:53,598
unpack operation in the future and in

115
00:04:51,680 --> 00:04:56,689
fact you know we could actually make

116
00:04:53,598 --> 00:04:58,370
this be a thing do we do we get rid of

117
00:04:56,689 --> 00:05:00,500
the non spatial flag I think I said I

118
00:04:58,370 --> 00:05:04,430
wanted to so we could also get rid of

119
00:05:00,500 --> 00:05:06,949
that non spatial flag entirely and and

120
00:05:04,430 --> 00:05:07,939
just say that this isn't going to be a

121
00:05:06,949 --> 00:05:09,860
thing anymore either

122
00:05:07,939 --> 00:05:11,389
so it's always going to do you know

123
00:05:09,860 --> 00:05:13,699
something like this where it checks the

124
00:05:11,389 --> 00:05:18,079
MD overlaps rectangle code and it's

125
00:05:13,699 --> 00:05:20,810
going to do that ad and be something

126
00:05:18,079 --> 00:05:23,629
more like this so this is actually an

127
00:05:20,810 --> 00:05:24,769
unpack operation and so we might want to

128
00:05:23,629 --> 00:05:26,300
start calling that I guess there's

129
00:05:24,769 --> 00:05:29,180
really no no need to do it immediately

130
00:05:26,300 --> 00:05:32,439
but that's where that's gonna happen let

131
00:05:29,180 --> 00:05:35,689
me go ahead and get rid of these as well

132
00:05:32,439 --> 00:05:37,908
do we need to call make end of the

133
00:05:35,689 --> 00:05:40,009
spatial to be ever call make entity

134
00:05:37,908 --> 00:05:42,019
spatial I don't even know if we do if we

135
00:05:40,009 --> 00:05:46,460
don't again a lot of these things are

136
00:05:42,019 --> 00:05:49,969
gonna kind of be changed now so this is

137
00:05:46,459 --> 00:05:51,769
always going to complete like so but

138
00:05:49,970 --> 00:05:53,210
again a lot of this stuff even that is

139
00:05:51,769 --> 00:05:56,389
really not a necessary piece of code

140
00:05:53,209 --> 00:05:57,560
anymore that gets sim space P we can

141
00:05:56,389 --> 00:05:59,418
sort of streamline that because it's

142
00:05:57,560 --> 00:06:00,740
only gonna happen during the unpack so

143
00:05:59,418 --> 00:06:03,468
no one should ever be calling that

144
00:06:00,740 --> 00:06:05,598
function anyway it's gonna be directly

145
00:06:03,468 --> 00:06:07,069
done in the pack unpack phase so a lot

146
00:06:05,598 --> 00:06:09,529
of that stuff is gonna get a lot cleaner

147
00:06:07,069 --> 00:06:12,050
I think all right so let's take a look

148
00:06:09,529 --> 00:06:13,309
at entity here we know that we were

149
00:06:12,050 --> 00:06:15,560
passing sort of redundant information

150
00:06:13,310 --> 00:06:17,060
like the ID and the source but we don't

151
00:06:15,560 --> 00:06:18,589
really need to do that because if we

152
00:06:17,060 --> 00:06:22,519
want the ID we can just get it out of

153
00:06:18,589 --> 00:06:24,918
the source let's take a look at the rest

154
00:06:22,519 --> 00:06:27,769
of these so storage index is going to be

155
00:06:24,918 --> 00:06:29,120
ID now here obviously that's all fine

156
00:06:27,769 --> 00:06:31,250
checking for things like

157
00:06:29,120 --> 00:06:36,379
illusions is fine right these are all

158
00:06:31,250 --> 00:06:40,430
IBA IDs all right

159
00:06:36,379 --> 00:06:42,139
so non-spatial if if non-spatial is not

160
00:06:40,430 --> 00:06:44,360
set property based logic goes here

161
00:06:42,139 --> 00:06:47,389
better hash function so this is saying

162
00:06:44,360 --> 00:06:49,220
if non-spatial is not they neither of

163
00:06:47,389 --> 00:06:51,680
them are set then the result is that

164
00:06:49,220 --> 00:06:53,470
they can collide I guess is what we're

165
00:06:51,680 --> 00:06:55,790
saying

166
00:06:53,470 --> 00:06:59,180
which I guess is always gonna be true

167
00:06:55,790 --> 00:07:00,919
now right and then you know you would

168
00:06:59,180 --> 00:07:02,180
need more logic here but again that this

169
00:07:00,918 --> 00:07:03,589
is all stuff that I think we're probably

170
00:07:02,180 --> 00:07:05,990
going to start to clean up in a

171
00:07:03,589 --> 00:07:07,788
different way anyway so let's take a

172
00:07:05,990 --> 00:07:10,639
look at those rules now I think those

173
00:07:07,788 --> 00:07:12,079
would probably be in the world mode so

174
00:07:10,639 --> 00:07:13,728
where is the pairwise collision rule

175
00:07:12,079 --> 00:07:18,439
there it is so these this is just gonna

176
00:07:13,728 --> 00:07:20,779
be ID a and ID B okay so then we've got

177
00:07:18,439 --> 00:07:22,610
let's see non-spatial we don't have to

178
00:07:20,779 --> 00:07:26,739
care about that that goes away because

179
00:07:22,610 --> 00:07:32,150
it's gone now we don't care about this

180
00:07:26,740 --> 00:07:34,550
at all here and then all of this can get

181
00:07:32,149 --> 00:07:38,779
uninvented because everybody is now a

182
00:07:34,550 --> 00:07:40,939
spatial entity by default yeah and let's

183
00:07:38,779 --> 00:07:45,168
see so we've got storage indexes it's

184
00:07:40,939 --> 00:07:50,418
got ID here and I guess these can all

185
00:07:45,168 --> 00:07:55,990
just be storage index B yes yes yes yes

186
00:07:50,418 --> 00:07:55,990
go there we go

187
00:07:56,199 --> 00:08:06,038
nothing to see here just changing all of

188
00:07:59,418 --> 00:08:08,990
these to the correct word yep yep okay

189
00:08:06,038 --> 00:08:11,750
so when we say make entity non-spatial

190
00:08:08,990 --> 00:08:13,129
this is the sword to the sword I wanted

191
00:08:11,750 --> 00:08:15,740
to get rid of so the sword should not

192
00:08:13,129 --> 00:08:18,829
even be here anymore and in fact in the

193
00:08:15,740 --> 00:08:20,509
entity types I don't really know where

194
00:08:18,829 --> 00:08:22,399
we were specifying that probably instant

195
00:08:20,509 --> 00:08:25,370
Legion skill because again this code is

196
00:08:22,399 --> 00:08:28,279
kind of all old but I don't ever even

197
00:08:25,370 --> 00:08:31,240
want the sword to be there right I don't

198
00:08:28,279 --> 00:08:33,978
want to me that so let's see we want

199
00:08:31,240 --> 00:08:36,440
stops on collision is always going to be

200
00:08:33,979 --> 00:08:37,639
true it would appear because it's true

201
00:08:36,440 --> 00:08:38,930
for everyone but the sword and there's

202
00:08:37,639 --> 00:08:41,750
no such thing as a sword anymore

203
00:08:38,929 --> 00:08:43,008
so we'll get groups so we'll get rid of

204
00:08:41,750 --> 00:08:45,379
that

205
00:08:43,009 --> 00:08:47,329
and we don't care about any of this even

206
00:08:45,379 --> 00:08:49,579
in fact all this stuff is just nonsense

207
00:08:47,328 --> 00:08:50,899
and most of its gonna go away it was

208
00:08:49,578 --> 00:08:52,689
just from when we were sort of playing

209
00:08:50,899 --> 00:08:58,610
around in getting things working

210
00:08:52,690 --> 00:09:06,230
if non-spatial is not set and entity

211
00:08:58,610 --> 00:09:07,639
flag movable so we know non-spatial is

212
00:09:06,230 --> 00:09:11,149
never set so really all we're checking

213
00:09:07,639 --> 00:09:14,419
here is whether it's movable right any

214
00:09:11,149 --> 00:09:17,919
type sword is not a thing and off we go

215
00:09:14,419 --> 00:09:20,628
I want to double check that when I was

216
00:09:17,919 --> 00:09:22,789
in the same region stuff I want to make

217
00:09:20,629 --> 00:09:26,149
sure I didn't mess that up when we did

218
00:09:22,789 --> 00:09:29,360
there result equals true code so if set

219
00:09:26,149 --> 00:09:31,100
collides and collides we assume it's

220
00:09:29,360 --> 00:09:33,079
true then we look up to see whether we

221
00:09:31,100 --> 00:09:34,610
have a rule and then we if we do we put

222
00:09:33,078 --> 00:09:35,419
can collide so yeah I think that's

223
00:09:34,610 --> 00:09:37,399
correct

224
00:09:35,419 --> 00:09:41,149
right it's like you always assume that

225
00:09:37,399 --> 00:09:44,179
the two things can collide if they are

226
00:09:41,149 --> 00:09:46,039
you know if they are set to be

227
00:09:44,179 --> 00:09:49,219
collidable unless you have a rule that

228
00:09:46,039 --> 00:09:52,370
tells you otherwise so that's fine all

229
00:09:49,220 --> 00:09:54,589
right so I think now we're a little bit

230
00:09:52,370 --> 00:09:56,778
closer to where we need to be let's

231
00:09:54,589 --> 00:09:57,769
start running things and probably start

232
00:09:56,778 --> 00:09:59,899
stepping through things as well like

233
00:09:57,769 --> 00:10:01,519
creation and stuff to figure out what's

234
00:09:59,899 --> 00:10:02,899
going on now you can see that we're in

235
00:10:01,519 --> 00:10:05,688
the red screen when that what that means

236
00:10:02,899 --> 00:10:07,789
in general is that we don't actually

237
00:10:05,688 --> 00:10:09,500
have any heroes active because if

238
00:10:07,789 --> 00:10:13,188
there's no heroes active it'll it'll

239
00:10:09,500 --> 00:10:14,809
sort of dump back to the main screen so

240
00:10:13,188 --> 00:10:15,980
we kind of have to make sure that we

241
00:10:14,809 --> 00:10:19,008
have the rest of our stuff working

242
00:10:15,980 --> 00:10:24,430
properly but hold on one second well we

243
00:10:19,009 --> 00:10:26,680
sort of figure that out now let's see

244
00:10:24,429 --> 00:10:31,088
move entity

245
00:10:26,679 --> 00:10:34,659
all of this stuff should be fine and so

246
00:10:31,089 --> 00:10:36,910
I think I just need to go into handmade

247
00:10:34,659 --> 00:10:38,769
world mode and start looking at the code

248
00:10:36,909 --> 00:10:40,059
where we create entities and pack

249
00:10:38,769 --> 00:10:42,039
entities and stuff like that because

250
00:10:40,059 --> 00:10:46,000
that's presumably mostly where we care

251
00:10:42,039 --> 00:10:48,159
about this so yeah and so this code here

252
00:10:46,000 --> 00:10:51,519
begin in beginning to be where I put in

253
00:10:48,159 --> 00:10:53,588
the ID we do a zero struct here so

254
00:10:51,519 --> 00:10:55,539
really this needs to happen immediately

255
00:10:53,589 --> 00:10:57,550
after this and these have to be bound

256
00:10:55,539 --> 00:10:59,019
together because otherwise we would

257
00:10:57,549 --> 00:11:02,349
clear the ID value that we were just

258
00:10:59,019 --> 00:11:06,519
setting so that also has to be set in

259
00:11:02,350 --> 00:11:08,440
order for stuff to work obviously hey

260
00:11:06,519 --> 00:11:10,360
we're getting a little closer we're

261
00:11:08,440 --> 00:11:13,209
still not seeing anything though so now

262
00:11:10,360 --> 00:11:15,550
it least believes that there are heroes

263
00:11:13,208 --> 00:11:17,669
in the game so our stuff is getting

264
00:11:15,549 --> 00:11:21,399
created but we still have this problem

265
00:11:17,669 --> 00:11:22,449
that we are that we're not actually

266
00:11:21,399 --> 00:11:23,950
seeing anything so we got to work on

267
00:11:22,450 --> 00:11:25,778
that this is obviously an assertion

268
00:11:23,950 --> 00:11:27,550
because we haven't talked about how

269
00:11:25,778 --> 00:11:29,470
we're going to delete and entities yet

270
00:11:27,549 --> 00:11:30,549
and so that assertion should stay in

271
00:11:29,470 --> 00:11:31,930
there because we're gonna want to

272
00:11:30,549 --> 00:11:34,059
address that right away

273
00:11:31,929 --> 00:11:35,409
basically like that this assertion is

274
00:11:34,059 --> 00:11:37,750
something we need to as soon as we get

275
00:11:35,409 --> 00:11:39,039
our bugs out that's the first thing we

276
00:11:37,750 --> 00:11:41,950
want to implement because right now we

277
00:11:39,039 --> 00:11:44,169
don't have the notion of deletion and

278
00:11:41,950 --> 00:11:47,830
like I said deletion is now going to

279
00:11:44,169 --> 00:11:49,329
just be in the in the stream out you

280
00:11:47,830 --> 00:11:50,709
just don't stream those enemies out so

281
00:11:49,330 --> 00:11:52,810
if an entity gets like marked well

282
00:11:50,708 --> 00:11:55,208
basically it mark deleted and then when

283
00:11:52,809 --> 00:11:58,179
it gets time to stream it out it won't

284
00:11:55,208 --> 00:12:00,069
get streamed out and so that's what we

285
00:11:58,179 --> 00:12:02,049
want to do sort of immediately after we

286
00:12:00,070 --> 00:12:04,000
fix the bug we currently have which is

287
00:12:02,049 --> 00:12:05,469
that we're not actually working right

288
00:12:04,000 --> 00:12:10,000
that we don't actually see at these

289
00:12:05,470 --> 00:12:12,250
entities so let's let's also just double

290
00:12:10,000 --> 00:12:14,799
check because I don't actually know I

291
00:12:12,250 --> 00:12:17,950
want to look at the the sort of used

292
00:12:14,799 --> 00:12:20,379
debug camera and I want to make sure

293
00:12:17,950 --> 00:12:22,839
that like we don't see anything nearby

294
00:12:20,379 --> 00:12:25,299
like we're not just slightly wrong right

295
00:12:22,839 --> 00:12:27,970
and as far as I can tell we're not

296
00:12:25,299 --> 00:12:29,289
because it looks to me like you know

297
00:12:27,970 --> 00:12:32,129
there's there's nothing in any of here

298
00:12:29,289 --> 00:12:35,319
so we're we're pretty wrong right now

299
00:12:32,129 --> 00:12:37,539
all right so what I'm going to do here

300
00:12:35,320 --> 00:12:39,250
is just go and double check how we're

301
00:12:37,539 --> 00:12:39,889
doing our and the spatial stuff and then

302
00:12:39,250 --> 00:12:41,240
I'm gonna start

303
00:12:39,889 --> 00:12:42,649
through the code to see like what we've

304
00:12:41,240 --> 00:12:44,750
actually created and what happens when

305
00:12:42,649 --> 00:12:47,208
we start a sim so I can kind of get a

306
00:12:44,750 --> 00:12:48,860
feel for it so what you can see here

307
00:12:47,208 --> 00:12:50,539
when I do the begin low entity and the

308
00:12:48,860 --> 00:12:53,120
end of these stuff we take this world

309
00:12:50,539 --> 00:12:54,708
position P and that's where the entity s

310
00:12:53,120 --> 00:12:58,039
sense was going to be and when we do PAC

311
00:12:54,708 --> 00:13:01,250
entity into world we're calling into the

312
00:12:58,039 --> 00:13:02,719
the world code here to do that so when

313
00:13:01,250 --> 00:13:04,578
we call a PAC entity in the world you

314
00:13:02,720 --> 00:13:05,899
can see what's happening there we get a

315
00:13:04,578 --> 00:13:07,909
world chunk out of the world and it's

316
00:13:05,899 --> 00:13:11,649
wherever we were told that this thing

317
00:13:07,909 --> 00:13:14,629
was and then we go to the World Arena

318
00:13:11,649 --> 00:13:16,639
and say if you can't like we pass it in

319
00:13:14,629 --> 00:13:18,860
so if you can't find one that already

320
00:13:16,639 --> 00:13:20,179
exists at this location create the chunk

321
00:13:18,860 --> 00:13:21,919
so that's how we know we'll always get a

322
00:13:20,179 --> 00:13:24,169
chunk back and then when we get the

323
00:13:21,919 --> 00:13:25,939
chunk back we call packed entity into

324
00:13:24,169 --> 00:13:27,828
chunk we could also assert this here

325
00:13:25,940 --> 00:13:29,750
because this has to always come back

326
00:13:27,828 --> 00:13:31,549
valid then when we go into packet into

327
00:13:29,750 --> 00:13:33,980
the chunk we take a look at what the

328
00:13:31,549 --> 00:13:38,328
pack size is we've got it we look to see

329
00:13:33,980 --> 00:13:40,550
if we can fit if it can't fit then we go

330
00:13:38,328 --> 00:13:43,039
ahead and make room for it otherwise we

331
00:13:40,549 --> 00:13:46,490
assume that we can and we go in here and

332
00:13:43,039 --> 00:13:49,730
pack the the entity in at the end of the

333
00:13:46,490 --> 00:13:51,620
information so I guess what I would say

334
00:13:49,730 --> 00:13:53,778
is right off the bat I can see a pretty

335
00:13:51,620 --> 00:13:55,459
obvious problem here which is that we're

336
00:13:53,778 --> 00:13:58,000
not actually storing the entity's

337
00:13:55,458 --> 00:14:00,739
position during this packing process

338
00:13:58,000 --> 00:14:05,500
where you can kind of see that we don't

339
00:14:00,740 --> 00:14:10,789
record that location in any way right so

340
00:14:05,500 --> 00:14:13,129
we need some way of we need somewhere

341
00:14:10,789 --> 00:14:15,679
central that that actually occurs so

342
00:14:13,129 --> 00:14:17,389
when I pass in a world position for pack

343
00:14:15,679 --> 00:14:18,649
entity into world I'm assuming that what

344
00:14:17,389 --> 00:14:21,139
we should probably do is make sure that

345
00:14:18,649 --> 00:14:24,289
at is reflected in the actual entity

346
00:14:21,139 --> 00:14:26,958
information so that's obviously a

347
00:14:24,289 --> 00:14:30,198
problem right so here's sim region and

348
00:14:26,958 --> 00:14:32,899
you can see that we've got our RP here

349
00:14:30,198 --> 00:14:35,359
and we've got our chunk P our chunk

350
00:14:32,899 --> 00:14:37,070
position here so at least for right now

351
00:14:35,360 --> 00:14:38,810
since we haven't really started working

352
00:14:37,070 --> 00:14:40,730
on this part of the code which is how

353
00:14:38,809 --> 00:14:43,219
we're storing the entities in you know

354
00:14:40,730 --> 00:14:44,959
the actual data inside the entities we

355
00:14:43,220 --> 00:14:48,410
should at least say that in here when we

356
00:14:44,958 --> 00:14:50,869
do our PAC entity code we should update

357
00:14:48,409 --> 00:14:52,889
that piece of information so we want to

358
00:14:50,870 --> 00:14:56,818
be able to say like okay the

359
00:14:52,889 --> 00:15:00,048
entity that we're packing its chunk P

360
00:14:56,818 --> 00:15:03,899
should probably be set to to act and

361
00:15:00,048 --> 00:15:07,048
it's a p-value which is its displacement

362
00:15:03,899 --> 00:15:09,448
I guess that does can can just be

363
00:15:07,048 --> 00:15:12,088
ignored because when this is unpacked it

364
00:15:09,448 --> 00:15:15,868
can it's gonna do the mapping to get it

365
00:15:12,089 --> 00:15:17,339
to get it back out right and I assume

366
00:15:15,869 --> 00:15:19,829
that the way that that happens let's

367
00:15:17,339 --> 00:15:22,230
double check that is in sim region it's

368
00:15:19,828 --> 00:15:27,088
going to read that chunk P out again so

369
00:15:22,230 --> 00:15:30,058
when we do the call to identity right

370
00:15:27,089 --> 00:15:32,519
here you can see get some space P and we

371
00:15:30,058 --> 00:15:35,608
pass that low that's what I want to see

372
00:15:32,519 --> 00:15:37,918
so what does get some space P do at the

373
00:15:35,609 --> 00:15:40,709
moment so it yeah it looks into that

374
00:15:37,918 --> 00:15:42,259
chunk P and gets it back out so that

375
00:15:40,708 --> 00:15:46,409
should keep that piece of information

376
00:15:42,259 --> 00:15:47,879
stored properly at this point but but

377
00:15:46,409 --> 00:15:50,249
yeah so again we're still not there yet

378
00:15:47,879 --> 00:15:51,869
not seeing anything so let's go ahead

379
00:15:50,249 --> 00:15:53,909
and start stepping through I want to see

380
00:15:51,869 --> 00:15:56,040
a few pieces of information just to give

381
00:15:53,909 --> 00:15:57,899
me an idea of where the bugs are at this

382
00:15:56,039 --> 00:16:00,448
point which is that when I come into

383
00:15:57,899 --> 00:16:03,480
this code here handmade world mode I

384
00:16:00,448 --> 00:16:06,508
want to see what happens when we do that

385
00:16:03,480 --> 00:16:08,730
first unpack so I want to see I want to

386
00:16:06,509 --> 00:16:11,668
restart before anything else happened I

387
00:16:08,730 --> 00:16:13,678
want to jump in here and see the very

388
00:16:11,668 --> 00:16:15,418
first time we go to begin sim I want to

389
00:16:13,678 --> 00:16:18,028
see if we get any actual entities out

390
00:16:15,418 --> 00:16:20,129
and if we do what they are right so when

391
00:16:18,028 --> 00:16:21,568
we come through here I'm gonna set a

392
00:16:20,129 --> 00:16:23,428
breakpoint here to make sure we don't

393
00:16:21,568 --> 00:16:24,928
fall out of the loop and then I'm I set

394
00:16:23,428 --> 00:16:27,720
a breakpoint here to see if we get any

395
00:16:24,928 --> 00:16:30,928
so you notice we didn't get anything so

396
00:16:27,720 --> 00:16:33,298
what that means is that our initial pack

397
00:16:30,928 --> 00:16:35,399
and where we're looking so are like our

398
00:16:33,298 --> 00:16:37,350
camera for example is not actually

399
00:16:35,399 --> 00:16:40,110
looking at where we put our entities or

400
00:16:37,350 --> 00:16:43,319
something similar right so one problem

401
00:16:40,110 --> 00:16:45,269
with that is well right now it's true

402
00:16:43,318 --> 00:16:47,308
that we wouldn't update the camera if we

403
00:16:45,269 --> 00:16:49,528
didn't call the sim code I want to just

404
00:16:47,308 --> 00:16:51,749
make sure quickly and this should have

405
00:16:49,528 --> 00:16:53,458
been happening before if it was a bug so

406
00:16:51,749 --> 00:16:54,778
presumably it's not but I just want to

407
00:16:53,458 --> 00:16:56,308
double check because since we're coming

408
00:16:54,778 --> 00:16:57,899
back to this code after a long time we

409
00:16:56,308 --> 00:17:00,568
want to make sure I kind of know what's

410
00:16:57,899 --> 00:17:02,610
going on when we create the world which

411
00:17:00,568 --> 00:17:05,778
actually should be appear somewhere

412
00:17:02,610 --> 00:17:05,778
right where is it

413
00:17:06,890 --> 00:17:12,020
there must be a place where we create

414
00:17:09,319 --> 00:17:14,889
the world in order to create the world

415
00:17:12,019 --> 00:17:19,490
you must make an apple pie from scratch

416
00:17:14,890 --> 00:17:21,350
so here you go you can see we do this

417
00:17:19,490 --> 00:17:23,269
rule this world mode counter P equals

418
00:17:21,349 --> 00:17:25,159
new camera P and here's where we set

419
00:17:23,269 --> 00:17:27,109
that up so in theory the camera should

420
00:17:25,160 --> 00:17:30,410
start off looking at those entities in

421
00:17:27,109 --> 00:17:34,519
theory so it we probably should check to

422
00:17:30,410 --> 00:17:39,050
see what we're doing wrong in terms of

423
00:17:34,519 --> 00:17:47,509
why we're not seeing any of that because

424
00:17:39,049 --> 00:17:49,519
I don't know so let's see we have we

425
00:17:47,509 --> 00:17:54,079
have a bunch of stuff here where we do

426
00:17:49,519 --> 00:17:58,940
our sort of add code and we generally

427
00:17:54,079 --> 00:18:01,129
always send the those positions which we

428
00:17:58,940 --> 00:18:06,440
use we use map into chunk space for that

429
00:18:01,130 --> 00:18:09,380
and we use the sort of the very basic

430
00:18:06,440 --> 00:18:10,730
stuff for that when we're doing that it

431
00:18:09,380 --> 00:18:12,890
seems like that should be done correctly

432
00:18:10,730 --> 00:18:14,930
and when we do pack entity into world I

433
00:18:12,890 --> 00:18:17,180
did double-check that that was doing it

434
00:18:14,930 --> 00:18:18,289
so I want to step through to see if

435
00:18:17,180 --> 00:18:20,090
maybe there's something about the

436
00:18:18,289 --> 00:18:23,450
packing that isn't working the way that

437
00:18:20,089 --> 00:18:26,029
I would have thought so when we do pack

438
00:18:23,450 --> 00:18:29,990
into let's see down upon a pack entity

439
00:18:26,029 --> 00:18:31,339
in the world I'm gonna call the game or

440
00:18:29,990 --> 00:18:34,099
just I'm going to restart it and see

441
00:18:31,339 --> 00:18:36,079
what actually happens so let's see first

442
00:18:34,099 --> 00:18:39,009
of all what we are think we're doing

443
00:18:36,079 --> 00:18:41,029
here we're calling add standard room and

444
00:18:39,009 --> 00:18:43,990
so we're kind of going through these

445
00:18:41,029 --> 00:18:46,460
these ABS tile X's and Y's here right

446
00:18:43,990 --> 00:18:48,200
and it looks like those are you know

447
00:18:46,460 --> 00:18:49,819
that those should be relatively close to

448
00:18:48,200 --> 00:18:52,190
the zero because they're they're pretty

449
00:18:49,819 --> 00:18:54,259
they're pretty nearby so when we call an

450
00:18:52,190 --> 00:18:55,820
entity what we're passing for P is zero

451
00:18:54,259 --> 00:18:57,980
zero zero which is a totally reasonable

452
00:18:55,819 --> 00:18:59,629
place to want to put something and

453
00:18:57,980 --> 00:19:01,130
something that should be visible on the

454
00:18:59,630 --> 00:19:02,510
screen so that's actually close that you

455
00:19:01,130 --> 00:19:04,820
know that's close to where the camera is

456
00:19:02,509 --> 00:19:07,039
going to be looking so in theory this

457
00:19:04,819 --> 00:19:09,379
should be okay so when we come in here

458
00:19:07,039 --> 00:19:13,519
and we're asking for the zero zero zero

459
00:19:09,380 --> 00:19:16,610
chunk let's see what we actually get

460
00:19:13,519 --> 00:19:17,750
back looks all reasonable for the most

461
00:19:16,609 --> 00:19:21,849
part

462
00:19:17,750 --> 00:19:23,839
and then we initialize that sort of that

463
00:19:21,849 --> 00:19:26,059
source entity that we're packing we

464
00:19:23,839 --> 00:19:29,509
initialize its position we jump into PAC

465
00:19:26,059 --> 00:19:31,369
entity and chunk and we look through

466
00:19:29,509 --> 00:19:32,660
here we can see that it doesn't have any

467
00:19:31,369 --> 00:19:34,579
room for anything because there isn't

468
00:19:32,660 --> 00:19:35,570
even a block to begin with and so what

469
00:19:34,579 --> 00:19:37,279
I'm going to do here is just step

470
00:19:35,569 --> 00:19:39,589
through here and say okay there are no

471
00:19:37,279 --> 00:19:41,180
free blocks obviously so we create a

472
00:19:39,589 --> 00:19:44,169
fake free block and put it on there so

473
00:19:41,180 --> 00:19:46,850
that we can use it we grab it out and

474
00:19:44,170 --> 00:19:49,509
and then we clear it right so now we've

475
00:19:46,849 --> 00:19:51,829
got a block we can use here it is and

476
00:19:49,509 --> 00:19:52,970
it's got sort of these residuals things

477
00:19:51,829 --> 00:19:54,199
in here that we're gonna get rid of

478
00:19:52,970 --> 00:19:55,850
eventually but then it has entity data

479
00:19:54,200 --> 00:19:57,140
which is what we actually care about so

480
00:19:55,849 --> 00:19:58,129
we make sure that it has room which by

481
00:19:57,140 --> 00:20:00,740
now it should because we've basically

482
00:19:58,130 --> 00:20:02,810
ensured that it does and then we've got

483
00:20:00,740 --> 00:20:04,339
this destination pointer which is just

484
00:20:02,809 --> 00:20:07,759
going to be basically the beginning of

485
00:20:04,339 --> 00:20:09,379
the entity data so we we take we snap

486
00:20:07,759 --> 00:20:12,049
that so we can use it to pack and then

487
00:20:09,380 --> 00:20:13,100
we advance by the amount of pack size so

488
00:20:12,049 --> 00:20:15,049
we're basically like pushing something

489
00:20:13,099 --> 00:20:17,389
on there now as you can see we're going

490
00:20:15,049 --> 00:20:18,950
to set cold set that right there and we

491
00:20:17,390 --> 00:20:21,320
can double check now to make sure that

492
00:20:18,950 --> 00:20:28,460
our desk pointer actually contains a

493
00:20:21,319 --> 00:20:30,319
reasonable entity which is oh it's a u8

494
00:20:28,460 --> 00:20:32,420
by default so I have to actually cast it

495
00:20:30,319 --> 00:20:35,659
to an entity so let's let's go ahead and

496
00:20:32,420 --> 00:20:37,340
do that here is it casted to an enemy so

497
00:20:35,660 --> 00:20:38,750
you can see it's ID is one which is what

498
00:20:37,339 --> 00:20:40,369
we would expect for the first entity we

499
00:20:38,750 --> 00:20:42,500
can see that it's location 0 0 which we

500
00:20:40,369 --> 00:20:45,709
want is a floor element which seems good

501
00:20:42,500 --> 00:20:49,390
so all of this seems fine right that

502
00:20:45,710 --> 00:20:54,829
seems totally fine no no weirdness there

503
00:20:49,390 --> 00:20:56,890
so then we pop out here and this part

504
00:20:54,829 --> 00:21:00,589
yeah is just gonna create more of these

505
00:20:56,890 --> 00:21:02,360
and off we go so as that happens I don't

506
00:21:00,589 --> 00:21:04,750
think anything particularly ODS going on

507
00:21:02,359 --> 00:21:07,759
but let's jump in just to one more here

508
00:21:04,750 --> 00:21:09,559
and see if we can't watch it pack into

509
00:21:07,759 --> 00:21:11,960
something where there was already one

510
00:21:09,559 --> 00:21:14,119
hopefully right so we should be able to

511
00:21:11,960 --> 00:21:17,630
catch one it's getting packed into a

512
00:21:14,119 --> 00:21:19,099
chunk that existed and I don't know you

513
00:21:17,630 --> 00:21:20,930
know how long it'll take us to find that

514
00:21:19,099 --> 00:21:23,329
but I'm just gonna set a breakpoint and

515
00:21:20,930 --> 00:21:24,890
watch so there you go so in this case

516
00:21:23,329 --> 00:21:26,389
we're now packing into one that actually

517
00:21:24,890 --> 00:21:28,160
already existed you can see that it's

518
00:21:26,390 --> 00:21:29,330
had one entity packed into it and now

519
00:21:28,160 --> 00:21:32,000
we're packin another end

520
00:21:29,329 --> 00:21:34,759
into it and so I want to go in and

521
00:21:32,000 --> 00:21:36,319
verify that that actually works it's not

522
00:21:34,759 --> 00:21:37,940
that that probably has all that much to

523
00:21:36,319 --> 00:21:41,389
do with our problem but I just want you

524
00:21:37,940 --> 00:21:42,650
to see so here we are we've got you know

525
00:21:41,390 --> 00:21:46,100
we're gonna go through and we're gonna

526
00:21:42,650 --> 00:21:48,440
take a look at what the block looks like

527
00:21:46,099 --> 00:21:50,449
here we can see that the entity data

528
00:21:48,440 --> 00:21:53,059
still has you know a certain amount of

529
00:21:50,450 --> 00:21:55,009
size considered on it we are going to

530
00:21:53,059 --> 00:21:56,509
grab the desk out but what I'm going to

531
00:21:55,009 --> 00:21:59,299
do first before we do that is I'm going

532
00:21:56,509 --> 00:22:02,329
to past this guy this entity data to an

533
00:21:59,299 --> 00:22:04,609
MD star so I can see what it looks like

534
00:22:02,329 --> 00:22:08,210
and I want to verify that there are

535
00:22:04,609 --> 00:22:10,519
going to be two entities after this is

536
00:22:08,210 --> 00:22:12,470
done so here's the two entities that I

537
00:22:10,519 --> 00:22:14,569
would expect to see one is a valid

538
00:22:12,470 --> 00:22:16,850
entity one is not yet about in me and

539
00:22:14,569 --> 00:22:18,769
now when I do this pack I should see it

540
00:22:16,849 --> 00:22:20,000
write directly into here and not touch

541
00:22:18,769 --> 00:22:22,400
anything in here just make sure the

542
00:22:20,000 --> 00:22:24,559
pointers are set properly and it looks

543
00:22:22,400 --> 00:22:27,500
like that all worked exactly as we would

544
00:22:24,559 --> 00:22:30,619
expect so so far the packing looks

545
00:22:27,500 --> 00:22:33,500
pretty good not a lot of mystery there

546
00:22:30,619 --> 00:22:35,809
so that seems reasonable when we come

547
00:22:33,500 --> 00:22:37,099
through and do the rest of this stuff

548
00:22:35,809 --> 00:22:38,929
we're just going to be creating a lot

549
00:22:37,099 --> 00:22:41,329
more entities in exactly the same way

550
00:22:38,930 --> 00:22:44,600
and so let's take a look now it begins

551
00:22:41,329 --> 00:22:47,000
Sam and CY maybe that's having a problem

552
00:22:44,599 --> 00:22:49,849
now we've watched for example an entity

553
00:22:47,000 --> 00:22:53,150
get packed into cells 0 0 0 or I should

554
00:22:49,849 --> 00:22:55,699
say chunk 0 0 0 so I'd like to see you

555
00:22:53,150 --> 00:22:58,490
know do we ever try to iterate over 0 0

556
00:22:55,700 --> 00:23:01,819
0 and if we do why are we not seeing

557
00:22:58,490 --> 00:23:03,710
anything there right so I'm gonna set a

558
00:23:01,819 --> 00:23:10,179
breakpoint here and you can see our

559
00:23:03,710 --> 00:23:13,309
chunk values so I'm gonna go chunk x y&amp;z

560
00:23:10,180 --> 00:23:15,650
and I'm just gonna let that loop on

561
00:23:13,309 --> 00:23:18,259
through right and in fact I guess I can

562
00:23:15,650 --> 00:23:21,259
I can do it out here I can wait till my

563
00:23:18,259 --> 00:23:24,859
Z value gets to 0 then I can wait till

564
00:23:21,259 --> 00:23:28,819
my Y value gets to 0 and then I can wait

565
00:23:24,859 --> 00:23:31,969
until my x value gets to 0 now I know

566
00:23:28,819 --> 00:23:34,639
that this value I watched it have an

567
00:23:31,970 --> 00:23:36,860
entity packed into it so now I'm gonna

568
00:23:34,640 --> 00:23:40,070
see what happens when I actually step in

569
00:23:36,859 --> 00:23:42,349
does that occur so we call get world

570
00:23:40,069 --> 00:23:46,730
shrunk internal here we go

571
00:23:42,349 --> 00:23:49,158
we do not find anything unusual about it

572
00:23:46,730 --> 00:23:50,569
we did find a chunk it matched the first

573
00:23:49,159 --> 00:23:52,399
time so we didn't have to enter this

574
00:23:50,569 --> 00:23:54,950
loop at all we now have a pointer to the

575
00:23:52,398 --> 00:23:57,168
pointer to the chunk we grab the result

576
00:23:54,950 --> 00:24:04,190
out of that here is that result it does

577
00:23:57,169 --> 00:24:05,690
aha well that makes it easy so yeah I

578
00:24:04,190 --> 00:24:07,788
don't even know if we need this value

579
00:24:05,690 --> 00:24:09,769
but we are using it currently and that's

580
00:24:07,788 --> 00:24:11,480
the problem I don't know if you noticed

581
00:24:09,769 --> 00:24:14,450
that I saw it maybe I saw it a little

582
00:24:11,480 --> 00:24:17,058
bit before you did if you were not eagle

583
00:24:14,450 --> 00:24:19,419
eye or if twitches compression was not

584
00:24:17,058 --> 00:24:22,759
letting you see the screen well enough

585
00:24:19,419 --> 00:24:24,889
but if you notice what happens in here

586
00:24:22,759 --> 00:24:26,569
is in these worlds we still had a

587
00:24:24,888 --> 00:24:28,008
residual value that's how many entities

588
00:24:26,569 --> 00:24:29,658
were in there and we are using it right

589
00:24:28,009 --> 00:24:31,069
now in the future I don't think we will

590
00:24:29,659 --> 00:24:32,750
we'll just probably stream I don't know

591
00:24:31,069 --> 00:24:34,099
maybe we will cuz maybe that'll be the

592
00:24:32,750 --> 00:24:37,638
easier way to tell when the stream is

593
00:24:34,099 --> 00:24:39,048
done I don't know we'll see but at the

594
00:24:37,638 --> 00:24:40,699
moment we are using it which means that

595
00:24:39,048 --> 00:24:44,028
every time we pack an entity we had

596
00:24:40,700 --> 00:24:46,340
better well actually increment the

597
00:24:44,028 --> 00:24:48,769
chunks entity counter because if we

598
00:24:46,339 --> 00:24:49,908
don't then we won't actually know how

599
00:24:48,769 --> 00:24:52,519
many are in there and we'll always think

600
00:24:49,909 --> 00:24:54,259
there are none so that's probably what

601
00:24:52,519 --> 00:24:57,109
was going on

602
00:24:54,259 --> 00:24:59,538
oops and that's the block method chunk

603
00:24:57,109 --> 00:25:02,028
sorry and so that's probably why we

604
00:24:59,538 --> 00:25:04,339
weren't getting any hits in that main

605
00:25:02,028 --> 00:25:05,929
part of the code okay so let's keep

606
00:25:04,339 --> 00:25:07,849
going now and we'll see where we're at

607
00:25:05,929 --> 00:25:10,340
okay so now we're actually back to good

608
00:25:07,849 --> 00:25:13,158
we've actually got all the stuff going

609
00:25:10,339 --> 00:25:14,509
that we were having before although

610
00:25:13,159 --> 00:25:16,820
there are still some weirdnesses like

611
00:25:14,509 --> 00:25:18,500
for example we're not getting correct I

612
00:25:16,819 --> 00:25:20,418
did idea of the head and the body

613
00:25:18,500 --> 00:25:22,579
they're exactly like you can kind of see

614
00:25:20,419 --> 00:25:24,590
the body stop tracking the head for some

615
00:25:22,579 --> 00:25:27,349
reason so we've got a little more work

616
00:25:24,589 --> 00:25:30,168
to do but we're getting closer to having

617
00:25:27,349 --> 00:25:34,189
completed this change in its entirety so

618
00:25:30,169 --> 00:25:38,080
that's always good and yeah

619
00:25:34,190 --> 00:25:41,269
let me go ahead and exit out of this and

620
00:25:38,079 --> 00:25:54,559
what the causes of that would be

621
00:25:41,269 --> 00:25:57,589
specifically uh is kind of odd so I say

622
00:25:54,559 --> 00:25:59,509
so if we go to our sim region the way

623
00:25:57,589 --> 00:26:01,399
that we were doing this and it'll

624
00:25:59,509 --> 00:26:02,779
probably remain somewhat similar to this

625
00:26:01,400 --> 00:26:04,070
throughout the course of development is

626
00:26:02,779 --> 00:26:05,869
we have this notion of an entity

627
00:26:04,069 --> 00:26:08,689
reference here and you can kind of see

628
00:26:05,869 --> 00:26:10,369
what's going on with that right and what

629
00:26:08,690 --> 00:26:12,650
we want to do with the entity reference

630
00:26:10,369 --> 00:26:14,809
is we want to make sure that the entity

631
00:26:12,650 --> 00:26:17,950
reference is not getting cleared in some

632
00:26:14,809 --> 00:26:20,690
kind of unreasonable way and I think

633
00:26:17,950 --> 00:26:22,430
what probably in fact I can almost

634
00:26:20,690 --> 00:26:25,190
guarantee I know what happens here

635
00:26:22,430 --> 00:26:27,620
those entity references are resolved now

636
00:26:25,190 --> 00:26:29,029
at the incorrect time in fact I think I

637
00:26:27,619 --> 00:26:33,439
even mentioned this when we went through

638
00:26:29,029 --> 00:26:35,740
it if you look at get entity by ID you

639
00:26:33,440 --> 00:26:39,380
can see that it does a get hash here

640
00:26:35,740 --> 00:26:42,230
that process of unpacking the entity

641
00:26:39,380 --> 00:26:44,390
needs to wait until the very end it

642
00:26:42,230 --> 00:26:46,220
needs to wait until the sim region is

643
00:26:44,390 --> 00:26:48,350
done unpacking all the entities and have

644
00:26:46,220 --> 00:26:50,240
put all the entities into their hash

645
00:26:48,349 --> 00:26:52,939
buckets otherwise if it just gets

646
00:26:50,240 --> 00:26:54,259
unlucky and the head is before the body

647
00:26:52,940 --> 00:26:56,390
or the bodies before the head one of

648
00:26:54,259 --> 00:26:59,960
them will not be able to identify the

649
00:26:56,390 --> 00:27:01,220
other right and so we need to make sure

650
00:26:59,960 --> 00:27:03,470
that all the entities have gotten

651
00:27:01,220 --> 00:27:05,450
unpacked and their pointers added to the

652
00:27:03,470 --> 00:27:08,240
hash table before we start looking up

653
00:27:05,450 --> 00:27:09,740
anything in them so I'm assuming that

654
00:27:08,240 --> 00:27:12,680
it's an ADD entity that's our problem

655
00:27:09,740 --> 00:27:15,259
here you can see in add entity raw we've

656
00:27:12,680 --> 00:27:17,600
got this code to call load entity

657
00:27:15,259 --> 00:27:19,879
reference and load entity reference is

658
00:27:17,599 --> 00:27:21,619
really probably is is almost certainly

659
00:27:19,880 --> 00:27:23,630
where our problem lies right you can

660
00:27:21,619 --> 00:27:26,389
kind of see what's happening here we

661
00:27:23,630 --> 00:27:27,680
call get hash from ID right there so we

662
00:27:26,390 --> 00:27:29,320
don't want that sort of thing to be

663
00:27:27,680 --> 00:27:31,220
happening at all

664
00:27:29,319 --> 00:27:33,619
furthermore I'd like to take a quick

665
00:27:31,220 --> 00:27:35,990
look at this we've got identity and

666
00:27:33,619 --> 00:27:41,059
identity raw and I think now since we're

667
00:27:35,990 --> 00:27:44,539
focusing on the streaming being really

668
00:27:41,059 --> 00:27:46,009
the only way that you're allowed to put

669
00:27:44,539 --> 00:27:47,990
any these into and out of the sim I

670
00:27:46,009 --> 00:27:50,779
think we can start to collapse the

671
00:27:47,990 --> 00:27:53,299
down a little bit so if we take a look

672
00:27:50,779 --> 00:27:54,529
at a Dundee and a dandy raw the only

673
00:27:53,299 --> 00:27:56,389
difference between them is one of them

674
00:27:54,529 --> 00:28:00,319
you pass the ID and the other one you

675
00:27:56,390 --> 00:28:02,780
pass the actual entity pointer right and

676
00:28:00,319 --> 00:28:04,250
so I think we probably want to clean

677
00:28:02,779 --> 00:28:06,099
this up a little bit and collapse those

678
00:28:04,250 --> 00:28:11,179
down since the cases we were handling

679
00:28:06,099 --> 00:28:13,069
before for this were we're simply not

680
00:28:11,179 --> 00:28:15,320
relevant anymore or are simply not

681
00:28:13,069 --> 00:28:17,299
relevant anymore I should say so if you

682
00:28:15,319 --> 00:28:18,950
look when we're calling identity which

683
00:28:17,299 --> 00:28:22,339
is the only way we ever call it anymore

684
00:28:18,950 --> 00:28:25,519
we do a entity overlaps rectangle of the

685
00:28:22,339 --> 00:28:27,409
total volume sim bounds soul situation

686
00:28:25,519 --> 00:28:28,970
right so I'm gonna take a look here at

687
00:28:27,410 --> 00:28:30,380
atom D and just make sure we know where

688
00:28:28,970 --> 00:28:35,150
we call it so you're gonna see we're

689
00:28:30,380 --> 00:28:38,840
calling identity and I'm just curious it

690
00:28:35,150 --> 00:28:42,470
seems to me that we're basically double

691
00:28:38,839 --> 00:28:43,759
counting oh wait no the updatable flag

692
00:28:42,470 --> 00:28:46,490
is just the thing that tells us whether

693
00:28:43,759 --> 00:28:48,170
it's internal in the inner area so

694
00:28:46,490 --> 00:28:50,960
that's fine so what I'm gonna do here is

695
00:28:48,170 --> 00:28:53,900
I'm just gonna take where we were

696
00:28:50,960 --> 00:28:56,569
calling at NV raw before I'm going to

697
00:28:53,900 --> 00:28:58,160
take and I'm going to grab this function

698
00:28:56,569 --> 00:29:01,339
and I'm going to sort of stick it in

699
00:28:58,160 --> 00:29:03,500
into into this one here so we don't need

700
00:29:01,339 --> 00:29:05,928
to call get hash from ID for this guy

701
00:29:03,500 --> 00:29:07,849
or any of that stuff because that's

702
00:29:05,929 --> 00:29:09,710
already been taken care of right that's

703
00:29:07,849 --> 00:29:12,529
something that we already know where we

704
00:29:09,710 --> 00:29:17,240
already know the entity's dest or

705
00:29:12,529 --> 00:29:18,799
whatever although no I take it back

706
00:29:17,240 --> 00:29:20,240
we still need to we do still need to do

707
00:29:18,799 --> 00:29:22,519
that we always need to actually get that

708
00:29:20,240 --> 00:29:25,009
ID and fill it out I suppose so I'm

709
00:29:22,519 --> 00:29:28,160
gonna put that in here and I'm gonna say

710
00:29:25,009 --> 00:29:30,710
we just do that upfront so here we get

711
00:29:28,160 --> 00:29:33,410
the ID I'm sorry we get the hash from

712
00:29:30,710 --> 00:29:34,519
the ID and we make sure that it's

713
00:29:33,410 --> 00:29:36,440
actually something that we need to fill

714
00:29:34,519 --> 00:29:38,629
out which is entry pointer equals zero

715
00:29:36,440 --> 00:29:40,308
this is really an assertion now because

716
00:29:38,630 --> 00:29:42,170
you can never have to end these with the

717
00:29:40,308 --> 00:29:44,149
same ID come out that would be like a

718
00:29:42,170 --> 00:29:45,800
major major problem if that I ever

719
00:29:44,150 --> 00:29:48,490
actually occurred so that's really an

720
00:29:45,799 --> 00:29:50,960
assertion that it better never happened

721
00:29:48,490 --> 00:29:53,150
we then come through and make sure that

722
00:29:50,960 --> 00:29:54,769
we can actually store this thing by

723
00:29:53,150 --> 00:29:56,870
checking it against the max count we're

724
00:29:54,769 --> 00:29:58,369
allowed to sim and assuming that that

725
00:29:56,869 --> 00:30:00,559
actually works then we can go in here

726
00:29:58,369 --> 00:30:03,649
and start to actually do

727
00:30:00,559 --> 00:30:06,289
other stuff to it you can see in here

728
00:30:03,650 --> 00:30:08,780
if the simpie pointer there is valid

729
00:30:06,289 --> 00:30:11,240
we'll go ahead and and set that location

730
00:30:08,779 --> 00:30:13,490
now the sim it seems to me that that

731
00:30:11,240 --> 00:30:16,670
should always be set so I'm not actually

732
00:30:13,490 --> 00:30:18,170
sure what it should either always we

733
00:30:16,670 --> 00:30:19,550
said are not set in other words like we

734
00:30:18,170 --> 00:30:21,710
only have one place that calls it now

735
00:30:19,549 --> 00:30:24,440
and so I feel like that sim space thing

736
00:30:21,710 --> 00:30:26,240
yeah is has already been called and

737
00:30:24,440 --> 00:30:28,430
we're already getting a pointer to it so

738
00:30:26,240 --> 00:30:30,500
I feel like this is kind of a bit

739
00:30:28,430 --> 00:30:32,060
redundant at this point and we really

740
00:30:30,500 --> 00:30:33,140
don't need to worry about this case

741
00:30:32,059 --> 00:30:37,990
anymore

742
00:30:33,140 --> 00:30:40,490
this should be working oops

743
00:30:37,990 --> 00:30:42,200
this should be working this way all the

744
00:30:40,490 --> 00:30:44,029
time there should never be a case where

745
00:30:42,200 --> 00:30:45,559
it's not going through that path and so

746
00:30:44,029 --> 00:30:49,309
then we can come down here and say this

747
00:30:45,559 --> 00:30:52,730
part where we do you know this simply

748
00:30:49,309 --> 00:30:54,529
that's that's done alright so when we

749
00:30:52,730 --> 00:30:55,880
come up here now we still have a bunch

750
00:30:54,529 --> 00:30:58,970
of work to do obviously I'm just doing

751
00:30:55,880 --> 00:31:03,430
that very simple count there let me see

752
00:30:58,970 --> 00:31:05,630
here Emily this is guest entity I guess

753
00:31:03,430 --> 00:31:10,450
let's go ahead and take a look at where

754
00:31:05,630 --> 00:31:15,380
entity is called so this is desk and the

755
00:31:10,450 --> 00:31:19,519
desk equals source load entity reference

756
00:31:15,380 --> 00:31:23,810
guest head is set enemy flag siming

757
00:31:19,519 --> 00:31:25,670
source add flags to sending so we don't

758
00:31:23,809 --> 00:31:27,559
really want to be doing this to the

759
00:31:25,670 --> 00:31:30,380
source because the source is a fake

760
00:31:27,559 --> 00:31:32,720
thing now and the siming thing is not a

761
00:31:30,380 --> 00:31:34,250
thing anymore that's all just you know

762
00:31:32,720 --> 00:31:35,630
we were using that for protection before

763
00:31:34,250 --> 00:31:37,250
but we're not doing any of that anymore

764
00:31:35,630 --> 00:31:38,960
because you can't if you were going to

765
00:31:37,250 --> 00:31:40,220
lock you lock on the chunk level you

766
00:31:38,960 --> 00:31:43,400
don't have to lock on a per entity level

767
00:31:40,220 --> 00:31:45,100
anymore so that's all gone this is just

768
00:31:43,400 --> 00:31:47,840
setting the desk stuff up correctly

769
00:31:45,099 --> 00:31:51,679
there setting the simpie the ID the

770
00:31:47,839 --> 00:31:53,059
updatable stuff will be set by doing the

771
00:31:51,680 --> 00:31:55,039
check that it was doing before and so

772
00:31:53,059 --> 00:32:00,889
now I think that's all much cleaner and

773
00:31:55,039 --> 00:32:03,049
and doing the correct thing okay and if

774
00:32:00,890 --> 00:32:04,810
we need to return the entity I don't

775
00:32:03,049 --> 00:32:07,399
think we're returning entities anymore

776
00:32:04,809 --> 00:32:08,750
right so we would just have this would

777
00:32:07,400 --> 00:32:11,000
just be a void because we're not

778
00:32:08,750 --> 00:32:12,230
actually doing any that work on them

779
00:32:11,000 --> 00:32:13,809
outside after the after the

780
00:32:12,230 --> 00:32:16,519
decompression step

781
00:32:13,809 --> 00:32:17,629
okay so now we should see exactly the

782
00:32:16,519 --> 00:32:19,339
same thing but we should have the same

783
00:32:17,630 --> 00:32:21,320
bug we have not touched the bug we just

784
00:32:19,339 --> 00:32:23,119
cleaned up that code right so we should

785
00:32:21,319 --> 00:32:26,839
still be able to get the body to detach

786
00:32:23,119 --> 00:32:28,549
like there we go and so now we have to

787
00:32:26,839 --> 00:32:30,169
actually focus on fixing that problem of

788
00:32:28,549 --> 00:32:32,629
making sure that everyone decompresses

789
00:32:30,170 --> 00:32:34,340
first and then we do a separate step so

790
00:32:32,630 --> 00:32:35,840
again it's not the most efficient thing

791
00:32:34,339 --> 00:32:37,789
and maybe we need to think about how we

792
00:32:35,839 --> 00:32:39,230
might solve that but at the moment we'll

793
00:32:37,789 --> 00:32:41,990
just do the simplest possible thing at

794
00:32:39,230 --> 00:32:45,170
first and see to get us sort of to where

795
00:32:41,990 --> 00:32:49,039
we need to go which is we need to have a

796
00:32:45,170 --> 00:32:50,960
like connect entity pointers a phase or

797
00:32:49,039 --> 00:32:53,180
something right and what we would do

798
00:32:50,960 --> 00:32:54,710
there is we pass the sim region and what

799
00:32:53,180 --> 00:32:56,269
it will do is it'll just loop over

800
00:32:54,710 --> 00:32:59,090
because remember we've got the way the

801
00:32:56,269 --> 00:33:02,629
sim region works here is it just has

802
00:32:59,089 --> 00:33:04,519
some number of entities in it right so

803
00:33:02,630 --> 00:33:08,930
all we're going to do is we're gonna say

804
00:33:04,519 --> 00:33:14,480
okay for every entity that was actually

805
00:33:08,930 --> 00:33:25,700
in this sim region we're going to go

806
00:33:14,480 --> 00:33:29,299
through we're gonna grab that NV and we

807
00:33:25,700 --> 00:33:31,220
want to remap the pointers in it now so

808
00:33:29,299 --> 00:33:32,720
it would be after the fact so this thing

809
00:33:31,220 --> 00:33:35,630
right here where we do load entity

810
00:33:32,720 --> 00:33:40,400
reference load entity reference is

811
00:33:35,630 --> 00:33:49,280
actually going to be done external like

812
00:33:40,400 --> 00:33:51,590
this okay and so now when you know if we

813
00:33:49,279 --> 00:33:52,250
just ran it at this point what we would

814
00:33:51,589 --> 00:33:54,500
expect to see

815
00:33:52,250 --> 00:33:58,579
oops missing - plus there what we would

816
00:33:54,500 --> 00:34:00,319
expect to see is well two things first

817
00:33:58,579 --> 00:34:01,879
of all we would expect to not have to I

818
00:34:00,319 --> 00:34:03,349
don't even know that load entity

819
00:34:01,880 --> 00:34:04,510
reference needs to be an actual thing

820
00:34:03,349 --> 00:34:07,309
anymore

821
00:34:04,509 --> 00:34:08,628
but if it does it certainly doesn't need

822
00:34:07,309 --> 00:34:09,980
the world mode for any particular

823
00:34:08,628 --> 00:34:15,139
purpose

824
00:34:09,980 --> 00:34:16,760
so we can fix that we go but what I was

825
00:34:15,139 --> 00:34:19,280
going to say is if we ran it now we

826
00:34:16,760 --> 00:34:21,500
should see your head and the body should

827
00:34:19,280 --> 00:34:23,690
be completely well and of course we

828
00:34:21,500 --> 00:34:25,699
can't even get past that because we just

829
00:34:23,690 --> 00:34:27,710
these things don't even have connections

830
00:34:25,699 --> 00:34:29,029
so the head is is pointing to not

831
00:34:27,710 --> 00:34:32,240
or at least should be pointing to

832
00:34:29,030 --> 00:34:33,649
nothing and any head pointer well that's

833
00:34:32,239 --> 00:34:35,269
actually oh no that's okay

834
00:34:33,648 --> 00:34:37,878
right yeah because it's just it's it's

835
00:34:35,269 --> 00:34:39,230
just invalid it's garbage data because

836
00:34:37,878 --> 00:34:42,409
this function is never getting called

837
00:34:39,230 --> 00:34:45,019
right so what we need to do now is after

838
00:34:42,409 --> 00:34:46,490
all of our stuff has been unpacked and

839
00:34:45,019 --> 00:34:48,440
we can now know that we can remap

840
00:34:46,489 --> 00:34:50,239
everything then we can just call connect

841
00:34:48,440 --> 00:34:52,519
entity pointers and let it run through

842
00:34:50,239 --> 00:34:54,019
that list just one time to connect

843
00:34:52,519 --> 00:34:56,628
anything that needs to get connected via

844
00:34:54,019 --> 00:34:58,969
the hash table so now we should be good

845
00:34:56,628 --> 00:35:01,309
to go and in theory now you would not be

846
00:34:58,969 --> 00:35:04,299
able to disconnect this little fellow

847
00:35:01,309 --> 00:35:04,299
anymore right

848
00:35:11,880 --> 00:35:19,220
all right so that's good so let's

849
00:35:17,400 --> 00:35:21,570
continue on this a little bit further

850
00:35:19,219 --> 00:35:23,129
let's just try to clean up some more of

851
00:35:21,570 --> 00:35:24,360
this and just again we're just trying to

852
00:35:23,130 --> 00:35:26,039
get rid of some of those vestigial

853
00:35:24,360 --> 00:35:27,720
remains that we have before we start

854
00:35:26,039 --> 00:35:29,489
digging into the entity stuff a little

855
00:35:27,719 --> 00:35:31,409
bit more specifically and maybe creating

856
00:35:29,489 --> 00:35:33,959
some more stuff right that we can play

857
00:35:31,409 --> 00:35:37,170
with and and so on and so forth

858
00:35:33,960 --> 00:35:38,730
so at the moment we've got renamed sumit

859
00:35:37,170 --> 00:35:44,400
identity as a to do well that's been

860
00:35:38,730 --> 00:35:46,019
done so that's great and consuming maybe

861
00:35:44,400 --> 00:35:47,099
I'll move this up to the top as well so

862
00:35:46,019 --> 00:35:49,190
people can always talk about it

863
00:35:47,099 --> 00:35:51,719
underneath if they would like to again

864
00:35:49,190 --> 00:35:53,909
so now if we have this entity flag

865
00:35:51,719 --> 00:35:55,859
swimming is no longer a flag so we can

866
00:35:53,909 --> 00:35:58,049
delete it and presumably nobody is

867
00:35:55,860 --> 00:36:01,110
looking for it and we that is actually

868
00:35:58,050 --> 00:36:02,070
true so now we have our entity code this

869
00:36:01,110 --> 00:36:03,780
entity code

870
00:36:02,070 --> 00:36:09,150
I don't really know can we move this

871
00:36:03,780 --> 00:36:11,519
entity code out into into something more

872
00:36:09,150 --> 00:36:13,889
into like the entity file for example as

873
00:36:11,519 --> 00:36:15,059
well so I'm gonna go ahead and do a

874
00:36:13,889 --> 00:36:17,009
little bit of cleanup there just make

875
00:36:15,059 --> 00:36:19,619
that any mode I want to see cuz we have

876
00:36:17,010 --> 00:36:22,170
a hand-made entity H and I'm just

877
00:36:19,619 --> 00:36:24,449
curious to know if it would be possible

878
00:36:22,170 --> 00:36:25,829
for us to move this guy to start moving

879
00:36:24,449 --> 00:36:27,359
some of these things out

880
00:36:25,829 --> 00:36:29,309
because we have all this stuff that's

881
00:36:27,360 --> 00:36:31,230
ostensibly entity related and it's all

882
00:36:29,309 --> 00:36:33,599
in the same thing I just want to know is

883
00:36:31,230 --> 00:36:39,750
that actually necessary so I'm going to

884
00:36:33,599 --> 00:36:43,199
grab this all of this and I'm gonna sort

885
00:36:39,750 --> 00:36:47,190
of grab that out and I'm just going to

886
00:36:43,199 --> 00:36:51,000
put it in NV dot H so there it is

887
00:36:47,190 --> 00:36:56,369
we'll see if that works so let's see

888
00:36:51,000 --> 00:37:01,289
here this is struct entity yeah entity

889
00:36:56,369 --> 00:37:02,940
IDs so it looks like for some reason the

890
00:37:01,289 --> 00:37:04,139
order of these maybe there's a reason

891
00:37:02,940 --> 00:37:07,079
for it but looks like the order of these

892
00:37:04,139 --> 00:37:10,739
is a little bit backwards so hand made

893
00:37:07,079 --> 00:37:11,519
entity it comes after sim region I'm not

894
00:37:10,739 --> 00:37:12,959
sure why that is

895
00:37:11,519 --> 00:37:17,570
yeah that doesn't make any sense all

896
00:37:12,960 --> 00:37:17,570
right so we've got hand made entity now

897
00:37:17,659 --> 00:37:20,699
and that's all set in here and that now

898
00:37:20,159 --> 00:37:23,608
has

899
00:37:20,699 --> 00:37:25,858
all this code that we wanted to be

900
00:37:23,608 --> 00:37:27,358
isolated over in the entity file so it's

901
00:37:25,858 --> 00:37:28,739
a little bit easier for us to keep track

902
00:37:27,358 --> 00:37:30,750
of right

903
00:37:28,739 --> 00:37:32,159
and we've also have our entity that's

904
00:37:30,750 --> 00:37:33,480
EPP which basically doesn't have

905
00:37:32,159 --> 00:37:35,699
anything in it but we'll probably start

906
00:37:33,480 --> 00:37:37,199
to have a lot more stuff in it as we

907
00:37:35,699 --> 00:37:38,429
start to build out the logic for the

908
00:37:37,199 --> 00:37:42,649
game and they'll just be tons of

909
00:37:38,429 --> 00:37:42,649
different entity code stuff that we want

910
00:37:45,380 --> 00:37:53,430
okay so let's go in the sim region here

911
00:37:51,239 --> 00:37:54,989
and take a look at what actually remains

912
00:37:53,429 --> 00:37:56,338
in some region this point we can now

913
00:37:54,989 --> 00:37:59,879
delete this forward declaration I

914
00:37:56,338 --> 00:38:02,190
believe so you can kind of see how this

915
00:37:59,880 --> 00:38:04,440
all plays out nothing particularly

916
00:38:02,190 --> 00:38:06,150
unusual here in the end the sort of code

917
00:38:04,440 --> 00:38:09,960
that we have in here is now more

918
00:38:06,150 --> 00:38:11,550
isolated to the sim which is good but we

919
00:38:09,960 --> 00:38:13,079
still you know if there's a fair bit of

920
00:38:11,550 --> 00:38:15,000
gentleness here but it's it's you know

921
00:38:13,079 --> 00:38:16,530
it's starting to look a little bit more

922
00:38:15,000 --> 00:38:17,909
reasonable we've got you know we've got

923
00:38:16,530 --> 00:38:20,130
the simulation there we've got the world

924
00:38:17,909 --> 00:38:21,719
storage we've got the entities we've

925
00:38:20,130 --> 00:38:23,910
broken it down into some pieces that

926
00:38:21,719 --> 00:38:26,368
seem relatively like their systems that

927
00:38:23,909 --> 00:38:27,779
would work and grow you know sort of

928
00:38:26,369 --> 00:38:30,300
isolated from each other in a certain

929
00:38:27,780 --> 00:38:34,920
sense and so that's feeling relatively

930
00:38:30,300 --> 00:38:37,640
nice now the next thing that I want to

931
00:38:34,920 --> 00:38:40,200
do is I guess I would like to go back to

932
00:38:37,639 --> 00:38:42,629
sort of the physical way that we were

933
00:38:40,199 --> 00:38:45,750
the the way that we were creating things

934
00:38:42,630 --> 00:38:47,519
in terms of their like their location

935
00:38:45,750 --> 00:38:50,219
and they're sort of physicality like

936
00:38:47,519 --> 00:38:52,559
they're the Box NISS of them and their

937
00:38:50,219 --> 00:38:54,259
movement I think that's the next thing

938
00:38:52,559 --> 00:38:57,239
that we kind of need to start looking at

939
00:38:54,260 --> 00:38:59,880
so what I would like to do is I'd like

940
00:38:57,239 --> 00:39:01,889
to go to handmade world mode and just

941
00:38:59,880 --> 00:39:06,108
start looking at exactly how we're

942
00:39:01,889 --> 00:39:09,088
creating these like the worlds and so on

943
00:39:06,108 --> 00:39:11,489
for example I'm going to take out the up

944
00:39:09,088 --> 00:39:13,650
and down the the Z up and down kind of

945
00:39:11,489 --> 00:39:15,358
situation I believe you can do that just

946
00:39:13,650 --> 00:39:18,030
by going like this and then I'm gonna

947
00:39:15,358 --> 00:39:20,219
let us create you know eight screens or

948
00:39:18,030 --> 00:39:22,140
something like that and I want to just

949
00:39:20,219 --> 00:39:25,078
see if I can get us to a point where

950
00:39:22,139 --> 00:39:26,730
we're roughly like being able to explore

951
00:39:25,079 --> 00:39:28,260
like we would in a normal situation

952
00:39:26,730 --> 00:39:29,190
because I believe do you have a bunch of

953
00:39:28,260 --> 00:39:31,680
problems here so you can see what

954
00:39:29,190 --> 00:39:33,690
happened we already have a kind of weird

955
00:39:31,679 --> 00:39:34,618
problem there and I remember we had this

956
00:39:33,690 --> 00:39:36,269
thing - if you

957
00:39:34,619 --> 00:39:37,769
over the edge and stuff we just have

958
00:39:36,268 --> 00:39:39,118
some weird stuff going on so I think the

959
00:39:37,768 --> 00:39:43,348
next thing we have to do is just go fix

960
00:39:39,119 --> 00:39:45,420
the bugs that we have in that oh no you

961
00:39:43,349 --> 00:39:46,559
know what we need to do that can wait

962
00:39:45,420 --> 00:39:48,749
till tomorrow what we need to do is we

963
00:39:46,559 --> 00:39:52,319
have an assertion we can fix this one

964
00:39:48,748 --> 00:39:53,608
right here so how do we delete things so

965
00:39:52,318 --> 00:39:55,139
what I'd like to do for deleting things

966
00:39:53,608 --> 00:39:57,210
again I think we already pretty much

967
00:39:55,139 --> 00:39:59,009
know how that's going to work it's a

968
00:39:57,210 --> 00:40:04,139
very simple problem for us what we can

969
00:39:59,009 --> 00:40:06,929
do is have an entity flag deleted and if

970
00:40:04,139 --> 00:40:13,768
the enemy flag deleted is set then that

971
00:40:06,929 --> 00:40:14,998
just means and see here we go we don't

972
00:40:13,768 --> 00:40:16,768
care by this because all this stuff is

973
00:40:14,998 --> 00:40:19,139
gonna get reworked a little bit anyway

974
00:40:16,768 --> 00:40:20,488
the enemy flag deleted gets set then we

975
00:40:19,139 --> 00:40:22,650
simply just don't we just don't stream

976
00:40:20,489 --> 00:40:25,079
that entity app right so that it just

977
00:40:22,650 --> 00:40:29,400
gets deleted as a consequence of the end

978
00:40:25,079 --> 00:40:31,048
of the the sim right so then it's really

979
00:40:29,400 --> 00:40:32,608
easy to delete things too but let's go

980
00:40:31,048 --> 00:40:35,909
ahead and implement that part first so

981
00:40:32,608 --> 00:40:38,578
when we do our I guess it's the package

982
00:40:35,909 --> 00:40:40,318
world here so when we do this code what

983
00:40:38,579 --> 00:40:44,039
we need to do is say all right as we go

984
00:40:40,318 --> 00:40:45,568
through these entities what we want to

985
00:40:44,039 --> 00:40:49,410
do is say okay before you do anything

986
00:40:45,568 --> 00:40:52,588
else if whatever this entity is if it's

987
00:40:49,409 --> 00:40:57,690
flags have been mentioned that it's

988
00:40:52,588 --> 00:41:00,498
deleted then we we aren't going to pack

989
00:40:57,690 --> 00:41:03,838
it right so basically it can never

990
00:41:00,498 --> 00:41:06,149
cannot have the deleted flag set if it's

991
00:41:03,838 --> 00:41:07,650
got it set we will not pack it and that

992
00:41:06,150 --> 00:41:09,329
way just it just gets cleaned up

993
00:41:07,650 --> 00:41:11,729
automatically at that point in the

994
00:41:09,329 --> 00:41:14,309
process what that means is it's trivial

995
00:41:11,728 --> 00:41:19,858
for us to have a delete entity right

996
00:41:14,309 --> 00:41:22,859
delete entity is literally just a thing

997
00:41:19,858 --> 00:41:25,108
that on the entity and will force you to

998
00:41:22,858 --> 00:41:28,139
pass the sim region just because we want

999
00:41:25,108 --> 00:41:29,489
to make you aware that I mean obviously

1000
00:41:28,139 --> 00:41:30,808
you would have to have a sim region

1001
00:41:29,489 --> 00:41:32,099
because otherwise would be no in and you

1002
00:41:30,809 --> 00:41:35,009
begin with but that's beside the point I

1003
00:41:32,099 --> 00:41:37,410
suppose so what you want to do here is

1004
00:41:35,009 --> 00:41:39,748
just say all right if it's supposed to

1005
00:41:37,409 --> 00:41:42,929
get deleted we just or in at the entity

1006
00:41:39,748 --> 00:41:46,498
flag deleted and it's gone so now we

1007
00:41:42,929 --> 00:41:47,369
should flags up we should be able to

1008
00:41:46,498 --> 00:41:50,429
re-implement

1009
00:41:47,369 --> 00:41:54,299
so that assertion no longer is a problem

1010
00:41:50,429 --> 00:42:00,029
when we do that operation we can say I

1011
00:41:54,300 --> 00:42:01,380
would like to delete this Kennedy and

1012
00:42:00,030 --> 00:42:03,780
I'll pass

1013
00:42:01,380 --> 00:42:05,760
whatever the here is now it's a little

1014
00:42:03,780 --> 00:42:08,040
bit tricky because all we have at this

1015
00:42:05,760 --> 00:42:10,230
point is the entity's ID we don't

1016
00:42:08,039 --> 00:42:13,619
actually have the entity itself and so

1017
00:42:10,230 --> 00:42:15,539
we need to again do that deferral to the

1018
00:42:13,619 --> 00:42:17,789
actual simulation we this is just the

1019
00:42:15,539 --> 00:42:20,550
controller code and so what we want is

1020
00:42:17,789 --> 00:42:23,190
con hero like exited or something right

1021
00:42:20,550 --> 00:42:28,590
we want to set that to true and then

1022
00:42:23,190 --> 00:42:31,530
when we come when we come through to

1023
00:42:28,590 --> 00:42:33,750
actually process that we can do the rest

1024
00:42:31,530 --> 00:42:36,780
of it so in here where we do the the

1025
00:42:33,750 --> 00:42:38,639
hero processing you can kind of see in

1026
00:42:36,780 --> 00:42:39,990
here we have the controller stuff this

1027
00:42:38,639 --> 00:42:43,170
is kind of janky code we could probably

1028
00:42:39,989 --> 00:42:44,969
clean some of this up as well but point

1029
00:42:43,170 --> 00:42:47,309
being whatever we're doing here bla bla

1030
00:42:44,969 --> 00:42:50,819
bla bla bla at the very end we can also

1031
00:42:47,309 --> 00:42:54,840
just say like oh hey by the way once we

1032
00:42:50,820 --> 00:43:02,039
have that entity that we've loaded we

1033
00:42:54,840 --> 00:43:05,360
can delete it if this was the situation

1034
00:43:02,039 --> 00:43:05,360
where the person exited

1035
00:43:11,369 --> 00:43:18,099
okay so all that's required to implement

1036
00:43:14,949 --> 00:43:20,139
that properly is the ability to mark the

1037
00:43:18,099 --> 00:43:23,469
fact that somebody asked for an exit

1038
00:43:20,139 --> 00:43:29,920
again very very simple and that's all we

1039
00:43:23,469 --> 00:43:33,159
should actually have to do so there's us

1040
00:43:29,920 --> 00:43:36,250
exiting the game and here is the sorry

1041
00:43:33,159 --> 00:43:39,609
entering the game exit the game the

1042
00:43:36,250 --> 00:43:41,340
enter the game so now we're back to the

1043
00:43:39,610 --> 00:43:44,530
bug that I was talking about before

1044
00:43:41,340 --> 00:43:54,490
we've got about 10 to 15 minutes left I

1045
00:43:44,530 --> 00:43:56,230
think on the clock so I'm not sure

1046
00:43:54,489 --> 00:43:58,989
exactly what the best thing to work on

1047
00:43:56,230 --> 00:44:02,800
is at the moment ground buffers hey

1048
00:43:58,989 --> 00:44:05,649
guess what they're not there anymore

1049
00:44:02,800 --> 00:44:07,180
but you know what we could do is we

1050
00:44:05,650 --> 00:44:09,000
could just go look for what that bug is

1051
00:44:07,179 --> 00:44:12,759
so that we'd have a head start tomorrow

1052
00:44:09,000 --> 00:44:15,369
on reworking how some of that movement

1053
00:44:12,760 --> 00:44:17,710
and and and world stuff is concerned so

1054
00:44:15,369 --> 00:44:20,529
like why does that do what it just did

1055
00:44:17,710 --> 00:44:22,480
for example is a good thing and I

1056
00:44:20,530 --> 00:44:25,390
believe where I had gotten to before is

1057
00:44:22,480 --> 00:44:29,219
I was like oh right the reason for that

1058
00:44:25,389 --> 00:44:32,199
is in the entity structure if you look

1059
00:44:29,219 --> 00:44:36,069
at the way that I did this we have this

1060
00:44:32,199 --> 00:44:38,159
notion of a bunch of these p-values here

1061
00:44:36,070 --> 00:44:40,570
right so movement from movement to and

1062
00:44:38,159 --> 00:44:42,609
really all of those values are

1063
00:44:40,570 --> 00:44:45,490
essentially erroneous once you've been

1064
00:44:42,610 --> 00:44:47,380
packed so position values have to get

1065
00:44:45,489 --> 00:44:49,659
packed just like everything else they

1066
00:44:47,380 --> 00:44:51,579
have to be made relative to their chunk

1067
00:44:49,659 --> 00:44:53,019
right because when you pack and you

1068
00:44:51,579 --> 00:44:54,639
unpack you're doing this thing you

1069
00:44:53,019 --> 00:44:56,259
repack into a local coordinate system

1070
00:44:54,639 --> 00:44:59,049
and you unpack back to a different local

1071
00:44:56,260 --> 00:45:02,560
coordinate system and so these movement

1072
00:44:59,050 --> 00:45:04,269
values we need to actually process the

1073
00:45:02,559 --> 00:45:10,929
same way that we would process the p

1074
00:45:04,269 --> 00:45:14,440
value right so I guess I can start on

1075
00:45:10,929 --> 00:45:16,269
that right away effectively it the first

1076
00:45:14,440 --> 00:45:18,690
thing that I would like to point out is

1077
00:45:16,269 --> 00:45:21,880
that this world position chunk P

1078
00:45:18,690 --> 00:45:22,849
actually isn't a value that we need

1079
00:45:21,880 --> 00:45:25,940
anymore

1080
00:45:22,849 --> 00:45:31,509
right we we can get rid it in fact this

1081
00:45:25,940 --> 00:45:35,800
this entire concept the the concept here

1082
00:45:31,510 --> 00:45:39,470
of this world position is now no longer

1083
00:45:35,800 --> 00:45:42,080
even necessary at all the only reason

1084
00:45:39,469 --> 00:45:44,629
that we actually need it in any way is

1085
00:45:42,079 --> 00:45:46,940
if we want to use it for enduring the

1086
00:45:44,630 --> 00:45:47,630
construction phase so I'm going to leave

1087
00:45:46,940 --> 00:45:49,849
it for now

1088
00:45:47,630 --> 00:45:53,000
but technically it's not even necessary

1089
00:45:49,849 --> 00:45:54,739
anymore and here's why so if I come in

1090
00:45:53,000 --> 00:45:56,000
here right first of all old chunks

1091
00:45:54,739 --> 00:45:58,159
should be able to go away right because

1092
00:45:56,000 --> 00:46:01,369
we're not using that anymore and if I

1093
00:45:58,159 --> 00:46:05,029
wanted to delete chunk P as well I

1094
00:46:01,369 --> 00:46:06,219
should be able to do that too and here's

1095
00:46:05,030 --> 00:46:09,769
why

1096
00:46:06,219 --> 00:46:11,389
so watch what happens when I compile the

1097
00:46:09,769 --> 00:46:13,190
chunk P you can see that it's getting

1098
00:46:11,389 --> 00:46:14,389
set in here and the reason that it's

1099
00:46:13,190 --> 00:46:16,579
getting set is because we have this

1100
00:46:14,389 --> 00:46:18,980
world position at come through but what

1101
00:46:16,579 --> 00:46:20,389
does world position at eutz that's no

1102
00:46:18,980 --> 00:46:22,869
good

1103
00:46:20,389 --> 00:46:25,519
what does world position at have

1104
00:46:22,869 --> 00:46:26,929
actually in it right well here is the

1105
00:46:25,519 --> 00:46:31,250
real thing it's got a chunk extant like

1106
00:46:26,929 --> 00:46:34,460
MC and an offset so actually the world

1107
00:46:31,250 --> 00:46:37,070
chunk that I'm in already contains the

1108
00:46:34,460 --> 00:46:41,329
chunk X chunk lion chunk Z so the only

1109
00:46:37,070 --> 00:46:44,930
thing I actually need to store right is

1110
00:46:41,329 --> 00:46:47,719
the offset because the other things are

1111
00:46:44,929 --> 00:46:50,059
already in the world chunk that contains

1112
00:46:47,719 --> 00:46:52,789
me so I don't need the entity to

1113
00:46:50,059 --> 00:46:56,059
remember when the entity gets packed it

1114
00:46:52,789 --> 00:46:58,219
never needs to recall where in the world

1115
00:46:56,059 --> 00:47:01,849
it was chunk wise because it's in there

1116
00:46:58,219 --> 00:47:03,889
right and so we can just ignore that

1117
00:47:01,849 --> 00:47:06,019
part entirely now let's see what happens

1118
00:47:03,889 --> 00:47:08,389
when he continued compiling okay so get

1119
00:47:06,019 --> 00:47:10,489
sim space key where is get Sims face

1120
00:47:08,389 --> 00:47:12,349
feed called well if you'll note there's

1121
00:47:10,489 --> 00:47:14,239
only one place it's called now which is

1122
00:47:12,349 --> 00:47:17,839
unpack time which is exactly what we

1123
00:47:14,239 --> 00:47:20,689
want so all we have to do is make sure

1124
00:47:17,840 --> 00:47:24,079
that when we're doing this operation we

1125
00:47:20,690 --> 00:47:27,079
just need to pass in what that basis

1126
00:47:24,079 --> 00:47:28,940
chunk X chunk Y chunk Z is that's all we

1127
00:47:27,079 --> 00:47:32,420
really need and furthermore we don't

1128
00:47:28,940 --> 00:47:35,179
even really need that we just need the

1129
00:47:32,420 --> 00:47:37,068
offset between that chunk and

1130
00:47:35,179 --> 00:47:39,230
shunk that were in the chunk the camera

1131
00:47:37,068 --> 00:47:42,829
is in right we just need to know that

1132
00:47:39,230 --> 00:47:45,949
offset so really get sim space P is just

1133
00:47:42,829 --> 00:47:48,380
an ad it's an ad of an offset so this is

1134
00:47:45,949 --> 00:47:50,480
all garbage it doesn't matter at all and

1135
00:47:48,380 --> 00:47:51,829
we can eliminate it remember when I said

1136
00:47:50,480 --> 00:47:53,000
this was going to get really good well

1137
00:47:51,829 --> 00:47:54,680
this is the kind of stuff I was talking

1138
00:47:53,000 --> 00:47:56,239
about basically all those things that

1139
00:47:54,679 --> 00:47:58,399
seemed like ownerís things that were

1140
00:47:56,239 --> 00:48:00,078
difficult to do keeping the giant world

1141
00:47:58,400 --> 00:48:01,760
having things be offsets having those

1142
00:48:00,079 --> 00:48:03,500
things all of that stuff just falls out

1143
00:48:01,760 --> 00:48:05,420
once the architecture starts to get good

1144
00:48:03,500 --> 00:48:08,269
and that's how you know that you're on

1145
00:48:05,420 --> 00:48:10,220
the right track right so in here we can

1146
00:48:08,269 --> 00:48:12,199
do exactly that right let's take a look

1147
00:48:10,219 --> 00:48:14,209
at what that code was doing we can say

1148
00:48:12,199 --> 00:48:16,368
okay what we need to know is we've got

1149
00:48:14,210 --> 00:48:17,720
the sim region origin and we've got this

1150
00:48:16,369 --> 00:48:19,519
storage trunk P we're trying to get

1151
00:48:17,719 --> 00:48:21,259
difference between those two right well

1152
00:48:19,519 --> 00:48:23,780
what I can do instead is say well I know

1153
00:48:21,260 --> 00:48:25,520
what the world chunk that I've got I

1154
00:48:23,780 --> 00:48:27,710
know what its world position is so I

1155
00:48:25,519 --> 00:48:29,809
could reconstruct that right I could say

1156
00:48:27,710 --> 00:48:31,818
chunk position I know exactly what that

1157
00:48:29,809 --> 00:48:33,230
is right I could reconstruct that I

1158
00:48:31,818 --> 00:48:36,558
could reconstruct that because I know

1159
00:48:33,230 --> 00:48:39,530
it's chunk X chunk by chunk Z okay so

1160
00:48:36,559 --> 00:48:41,569
then I can do this subtraction on the

1161
00:48:39,530 --> 00:48:46,220
chunk itself I can just say well tell me

1162
00:48:41,568 --> 00:48:48,440
how far away the chunk this will be like

1163
00:48:46,219 --> 00:48:51,919
the chunk Delta right tell me how far

1164
00:48:48,440 --> 00:48:55,700
away the chunk was so we can take this

1165
00:48:51,920 --> 00:48:57,858
this origin of the of the camera which

1166
00:48:55,699 --> 00:48:59,779
we know or of the same region we just go

1167
00:48:57,858 --> 00:49:03,798
ahead in here and say well whatever that

1168
00:48:59,780 --> 00:49:05,589
chunk position was do the subtraction on

1169
00:49:03,798 --> 00:49:08,869
that please

1170
00:49:05,588 --> 00:49:10,789
now all of our positions when we unpack

1171
00:49:08,869 --> 00:49:13,039
them do not need to go through anything

1172
00:49:10,789 --> 00:49:15,529
particularly unusual instead all they

1173
00:49:13,039 --> 00:49:18,048
have to do is just add the offset that's

1174
00:49:15,530 --> 00:49:19,910
it right so instead of having to pass a

1175
00:49:18,048 --> 00:49:21,889
sim space P here or any of this nonsense

1176
00:49:19,909 --> 00:49:29,598
what we can do instead is just pack a

1177
00:49:21,889 --> 00:49:32,769
pass a chunk Delta like so right and

1178
00:49:29,599 --> 00:49:32,769
then get rid of this entirely

1179
00:49:33,690 --> 00:49:38,530
although I suppose since we want to be

1180
00:49:36,940 --> 00:49:40,869
able to do the overlap check here

1181
00:49:38,530 --> 00:49:45,400
I should really continue to compute it

1182
00:49:40,869 --> 00:49:51,969
just by doing low P plus shock Delta

1183
00:49:45,400 --> 00:49:54,460
right like so but yeah once I pass the

1184
00:49:51,969 --> 00:49:56,649
chunk Delta here then basically everyone

1185
00:49:54,460 --> 00:49:58,780
inside here can use the chunk Delta to

1186
00:49:56,650 --> 00:50:02,829
take their positions and turn them into

1187
00:49:58,780 --> 00:50:05,590
real positions ok so that means that now

1188
00:50:02,829 --> 00:50:07,769
I can go to to my entity and all of the

1189
00:50:05,590 --> 00:50:10,180
stuff that was in the entity struct that

1190
00:50:07,769 --> 00:50:12,460
needs to get unpacked so all of these

1191
00:50:10,179 --> 00:50:14,559
VIII's right like movement from and

1192
00:50:12,460 --> 00:50:16,360
movement to that we were having problems

1193
00:50:14,559 --> 00:50:18,369
with before which are not relative

1194
00:50:16,360 --> 00:50:20,050
values their absolute values and that

1195
00:50:18,369 --> 00:50:22,690
was the problem

1196
00:50:20,050 --> 00:50:25,000
those can just be adjusted just like

1197
00:50:22,690 --> 00:50:27,579
everything else so in here where we do

1198
00:50:25,000 --> 00:50:32,099
desta simpie or that nonsense right we

1199
00:50:27,579 --> 00:50:41,829
can also just do def movement from right

1200
00:50:32,099 --> 00:50:43,630
trunk Delta Delta Delta so the

1201
00:50:41,829 --> 00:50:45,400
decompression step now becomes very

1202
00:50:43,630 --> 00:50:46,840
simple and again we'll sort of will

1203
00:50:45,400 --> 00:50:49,000
coalesce this into a little bit cleaner

1204
00:50:46,840 --> 00:50:55,180
style of thing in a minute here but you

1205
00:50:49,000 --> 00:51:00,969
get the idea right so if we do that now

1206
00:50:55,179 --> 00:51:02,500
this becomes very straightforward what

1207
00:51:00,969 --> 00:51:07,629
is the problem if that needs to be an

1208
00:51:02,500 --> 00:51:15,480
address there you go and what is this

1209
00:51:07,630 --> 00:51:15,480
from new camera chunk P that

1210
00:51:16,579 --> 00:51:24,349
and here we go all right so now what the

1211
00:51:22,639 --> 00:51:26,960
problem we have is when we do our PAC

1212
00:51:24,349 --> 00:51:29,750
entity in the world that process is

1213
00:51:26,960 --> 00:51:34,670
obviously a problem as well the reason

1214
00:51:29,750 --> 00:51:37,639
that's a problem is because all those

1215
00:51:34,670 --> 00:51:39,440
position values are wrong now write all

1216
00:51:37,639 --> 00:51:41,089
those position values in the entity are

1217
00:51:39,440 --> 00:51:45,230
relative to the sim region they need to

1218
00:51:41,090 --> 00:51:46,730
be relative to the chunk but again not

1219
00:51:45,230 --> 00:51:48,170
particularly difficult because once we

1220
00:51:46,730 --> 00:51:50,300
have the chunk view we can do the

1221
00:51:48,170 --> 00:51:52,400
inverse chunk Delta so what we can do

1222
00:51:50,300 --> 00:51:54,320
here is say like oh okay we know what

1223
00:51:52,400 --> 00:51:56,240
the chunk P is so what we can do is

1224
00:51:54,320 --> 00:51:57,920
issue that subtraction call this is not

1225
00:51:56,239 --> 00:51:59,359
as clean and it's because we do the

1226
00:51:57,920 --> 00:52:01,159
chunk sort of out of order here this I

1227
00:51:59,360 --> 00:52:03,200
think will be I will be able to make

1228
00:52:01,159 --> 00:52:05,989
this much faster much better code not

1229
00:52:03,199 --> 00:52:08,269
kind of going forward but point being if

1230
00:52:05,989 --> 00:52:11,439
we want to here we can actually make

1231
00:52:08,269 --> 00:52:15,019
this code be relatively straightforward

1232
00:52:11,440 --> 00:52:17,210
which is to say that once we have the

1233
00:52:15,019 --> 00:52:18,829
chunk Delta we can just do the inverse

1234
00:52:17,210 --> 00:52:19,820
of the one we were doing I could flip

1235
00:52:18,829 --> 00:52:21,049
this track there but I'm going to keep

1236
00:52:19,820 --> 00:52:23,059
it the same so that's the same in both

1237
00:52:21,050 --> 00:52:25,190
piece of the code and then what we can

1238
00:52:23,059 --> 00:52:26,779
do is when we do all of our pressing

1239
00:52:25,190 --> 00:52:27,679
right we can just go ahead and say oh

1240
00:52:26,780 --> 00:52:29,930
right

1241
00:52:27,679 --> 00:52:35,559
add the chunk Delta again to to

1242
00:52:29,929 --> 00:52:35,559
everybody who who needs to to have it

1243
00:52:38,409 --> 00:52:52,730
right needs to not there there we go

1244
00:52:44,750 --> 00:52:56,829
uh so let's see let's see ooh didn't

1245
00:52:52,730 --> 00:52:59,780
quite get that right yet so all right uh

1246
00:52:56,829 --> 00:53:01,190
where are we at here on time I got five

1247
00:52:59,780 --> 00:53:03,080
bits so I'm gonna go ahead and debug

1248
00:53:01,190 --> 00:53:04,820
this guy because then I think actually

1249
00:53:03,079 --> 00:53:09,079
we might have fixed them most of the

1250
00:53:04,820 --> 00:53:13,160
movement problem anyway so let's take a

1251
00:53:09,079 --> 00:53:14,989
look here we've got our chunk Delta on

1252
00:53:13,159 --> 00:53:17,089
the way in and the way out that we have

1253
00:53:14,989 --> 00:53:19,459
to deal with what is happening with the

1254
00:53:17,090 --> 00:53:22,370
PAC entity into world chunk P this this

1255
00:53:19,460 --> 00:53:25,400
now needs to not do what it was doing

1256
00:53:22,369 --> 00:53:27,739
before like this code needs to not do

1257
00:53:25,400 --> 00:53:31,500
this if that makes sense

1258
00:53:27,739 --> 00:53:34,399
so we got to get rid of that and that is

1259
00:53:31,500 --> 00:53:37,400
something that would probably now be

1260
00:53:34,400 --> 00:53:37,400
done

1261
00:53:37,949 --> 00:53:45,028
where are you world mode that's

1262
00:53:42,778 --> 00:53:51,268
something that wants to be done on end

1263
00:53:45,028 --> 00:54:02,998
entity right to initialize this code so

1264
00:53:51,268 --> 00:54:04,649
there it is kilo equals P offset okay so

1265
00:54:02,998 --> 00:54:06,889
that that needed to be fixed I don't

1266
00:54:04,650 --> 00:54:12,079
know if that's the most of it though oh

1267
00:54:06,889 --> 00:54:12,078
oh dear what did I do

1268
00:54:12,528 --> 00:54:17,880
Peck entity into world why did that

1269
00:54:15,778 --> 00:54:26,548
change that should not have changed

1270
00:54:17,880 --> 00:54:27,749
anything this is what you get when you

1271
00:54:26,548 --> 00:54:30,949
try to make quick change with the end of

1272
00:54:27,748 --> 00:54:38,458
a stream what do you do though

1273
00:54:30,949 --> 00:54:41,009
so entity loan comes in we're calling in

1274
00:54:38,458 --> 00:54:43,498
in the which everyone has to call we

1275
00:54:41,009 --> 00:54:45,568
call pac---- entity into world but first

1276
00:54:43,498 --> 00:54:47,159
we take the end of the lows P and we

1277
00:54:45,568 --> 00:54:50,788
take its the world position that we're

1278
00:54:47,159 --> 00:54:53,038
being passed and we set the offset in

1279
00:54:50,789 --> 00:54:55,819
there which all we were doing before is

1280
00:54:53,039 --> 00:54:55,819
just groups

1281
00:54:59,570 --> 00:55:07,740
here we go all we were doing before was

1282
00:55:03,690 --> 00:55:11,389
just that piece of code as well so why

1283
00:55:07,739 --> 00:55:14,759
would that change have changed anything

1284
00:55:11,389 --> 00:55:19,349
because right that should not that

1285
00:55:14,760 --> 00:55:22,740
should not have done anything oh right

1286
00:55:19,349 --> 00:55:25,619
duh it's because moving it out here

1287
00:55:22,739 --> 00:55:27,329
means that we're not that the sim region

1288
00:55:25,619 --> 00:55:29,819
is not calling back code path anymore

1289
00:55:27,329 --> 00:55:33,539
and so I suppose that could obviously be

1290
00:55:29,820 --> 00:55:37,680
it all right so if we come in here and

1291
00:55:33,539 --> 00:55:44,550
assume if we assume that that's what it

1292
00:55:37,679 --> 00:55:45,899
is let's keep going here fine so if we

1293
00:55:44,550 --> 00:55:47,940
assume that that's what it is

1294
00:55:45,900 --> 00:55:51,420
if I take a look at what's going on here

1295
00:55:47,940 --> 00:55:53,010
we get the chunk P which is that's

1296
00:55:51,420 --> 00:55:54,329
actually the entity's offset so that's

1297
00:55:53,010 --> 00:55:56,700
the problem is I just wasn't paying

1298
00:55:54,329 --> 00:56:00,000
close enough attention here so what we

1299
00:55:56,699 --> 00:56:06,899
actually need to do is is figure out

1300
00:56:00,000 --> 00:56:09,599
which chunk this is in - any of the -

1301
00:56:06,900 --> 00:56:13,380
any of the other values right so we want

1302
00:56:09,599 --> 00:56:15,389
a world position that's you know this is

1303
00:56:13,380 --> 00:56:19,820
actually enemy P and we want chunk be to

1304
00:56:15,389 --> 00:56:19,819
be enemy P with the offset set to zero

1305
00:56:24,079 --> 00:56:28,619
right so that's actually what we want to

1306
00:56:26,519 --> 00:56:30,989
have happen there and when we're we were

1307
00:56:28,619 --> 00:56:35,089
using chunk P before we would use enemy

1308
00:56:30,989 --> 00:56:35,089
P for working with the camera right

1309
00:56:37,880 --> 00:56:42,800
and again we'll do another pass through

1310
00:56:40,619 --> 00:56:46,980
this to clean it up a little bit nicer

1311
00:56:42,800 --> 00:56:48,810
okay so there we go and so now we're a

1312
00:56:46,980 --> 00:56:51,869
little bit better here we can go off the

1313
00:56:48,809 --> 00:56:54,509
screen okay but we're not tracking the

1314
00:56:51,869 --> 00:56:55,829
camera move and I'm not sure exactly why

1315
00:56:54,510 --> 00:56:57,120
so let's double check that one because

1316
00:56:55,829 --> 00:56:59,099
we may be able to again like I said just

1317
00:56:57,119 --> 00:57:03,359
finish that up so when we create the

1318
00:56:59,099 --> 00:57:06,150
entity P here what are we doing we check

1319
00:57:03,360 --> 00:57:08,570
to see this is supposed to be entity P

1320
00:57:06,150 --> 00:57:08,570
that's why

1321
00:57:13,250 --> 00:57:28,829
or maybe not entirely why room aced map

1322
00:57:21,449 --> 00:57:33,210
into chunk space and this is using the

1323
00:57:28,829 --> 00:57:35,990
entity px yeah so so really I guess if

1324
00:57:33,210 --> 00:57:38,159
we want to do this camera coach probably

1325
00:57:35,989 --> 00:57:40,139
rewritten but if it's going to use the

1326
00:57:38,159 --> 00:57:42,868
world P this actually this camera code

1327
00:57:40,139 --> 00:57:45,358
needs to execute before we do any more

1328
00:57:42,869 --> 00:57:49,760
of this right so this stuff actually has

1329
00:57:45,358 --> 00:57:49,759
to happen down here like so

1330
00:57:49,789 --> 00:57:56,519
all right there we go so not quite right

1331
00:57:54,659 --> 00:57:58,199
yet you can see it's a little bit janky

1332
00:57:56,519 --> 00:58:00,570
there so I don't think we're going to

1333
00:57:58,199 --> 00:58:02,399
call that done but at least now we have

1334
00:58:00,570 --> 00:58:04,440
the stable position packing and

1335
00:58:02,400 --> 00:58:06,930
unpacking so we're getting a little bit

1336
00:58:04,440 --> 00:58:09,780
further there which is good but you can

1337
00:58:06,929 --> 00:58:14,629
see it kind of it's kind of a little

1338
00:58:09,780 --> 00:58:14,630
nasty it's it's still not quite right

1339
00:58:23,659 --> 00:58:33,089
alright not sure what exactly that's

1340
00:58:29,159 --> 00:58:38,670
doing I need to slow it down so I can

1341
00:58:33,090 --> 00:58:40,920
watch there's like it's a quick frame of

1342
00:58:38,670 --> 00:58:44,099
it being of the camera not being in the

1343
00:58:40,920 --> 00:58:45,720
right place I'm pretty much at that time

1344
00:58:44,099 --> 00:58:47,009
though so I'll go to the Q&amp;A that's you

1345
00:58:45,719 --> 00:58:48,750
know we're gonna be working on this code

1346
00:58:47,010 --> 00:58:49,890
soon anyway so I'll just I'll just leave

1347
00:58:48,750 --> 00:58:51,420
it there and we'll we'll do some more

1348
00:58:49,889 --> 00:58:56,609
tomorrow I'm gonna go ahead and go to

1349
00:58:51,420 --> 00:58:57,990
the questions and the answers so if you

1350
00:58:56,610 --> 00:59:03,110
have questions about where we're at at

1351
00:58:57,989 --> 00:59:03,109
this point feel free to ask them now

1352
00:59:53,510 --> 00:59:57,140
are there questions

1353
01:00:24,978 --> 01:00:33,568
is there any real difference between F

1354
01:00:27,838 --> 01:00:36,509
and F and if not defined not really not

1355
01:00:33,568 --> 01:00:39,268
defined allows you to use it in more

1356
01:00:36,509 --> 01:00:41,599
complicated expressions but that's about

1357
01:00:39,268 --> 01:00:41,598
it

1358
01:00:54,539 --> 01:00:58,329
do you feel like we take stuff backwards

1359
01:00:56,920 --> 01:00:58,570
when we get into code we haven't been in

1360
01:00:58,329 --> 01:01:00,449
a while

1361
01:00:58,570 --> 01:01:04,090
aka the problems with moving the screen

1362
01:01:00,449 --> 01:01:05,769
not really if anything I feel like we're

1363
01:01:04,090 --> 01:01:07,150
massively further than we were before

1364
01:01:05,769 --> 01:01:09,099
because this code was pretty awful

1365
01:01:07,150 --> 01:01:13,570
before and now it's getting quite nice

1366
01:01:09,099 --> 01:01:14,739
so it's it's usually more like as it has

1367
01:01:13,570 --> 01:01:16,059
a chance to marinate then when you

1368
01:01:14,739 --> 01:01:17,649
couldn't kind of come back to it you're

1369
01:01:16,059 --> 01:01:19,210
like ah this is how it'll all work and

1370
01:01:17,650 --> 01:01:22,930
it's nice and that's pretty much exactly

1371
01:01:19,210 --> 01:01:26,619
what's happening do you use a lot of

1372
01:01:22,929 --> 01:01:28,269
header files well I mean we we just

1373
01:01:26,619 --> 01:01:30,250
break since we compiled everything in

1374
01:01:28,269 --> 01:01:31,509
the same we compile everything is one

1375
01:01:30,250 --> 01:01:32,860
translation unit effectively I mean

1376
01:01:31,510 --> 01:01:38,710
technically - because we have a platform

1377
01:01:32,860 --> 01:01:40,690
one but basically we just choose to

1378
01:01:38,710 --> 01:01:42,610
break things up into files based on what

1379
01:01:40,690 --> 01:01:45,039
we want to see like what we want to keep

1380
01:01:42,610 --> 01:01:55,000
bucketed together for convenience that's

1381
01:01:45,039 --> 01:01:57,759
really it so and actually so one thing

1382
01:01:55,000 --> 01:02:01,719
that is true - regarding those panda

1383
01:01:57,760 --> 01:02:03,700
finds is we don't actually need them so

1384
01:02:01,719 --> 01:02:05,500
we could get rid you know like we could

1385
01:02:03,699 --> 01:02:07,480
just get rid of those they're only

1386
01:02:05,500 --> 01:02:09,730
necessary if you were actually going to

1387
01:02:07,480 --> 01:02:12,760
build out with multiple translation

1388
01:02:09,730 --> 01:02:17,650
units so technically like if we just

1389
01:02:12,760 --> 01:02:19,500
look at all of their RH files we

1390
01:02:17,650 --> 01:02:23,470
wouldn't need oops

1391
01:02:19,500 --> 01:02:29,340
any of that anymore that's just it's not

1392
01:02:23,469 --> 01:02:29,339
necessary it can all go away right and

1393
01:02:30,329 --> 01:02:44,130
yeah it can all go away

1394
01:02:33,579 --> 01:02:44,130
so like handmade H that and

1395
01:02:47,789 --> 01:02:55,289
handmade world that H get rid of that

1396
01:02:56,250 --> 01:03:01,449
right none of those things need to be

1397
01:02:59,050 --> 01:03:06,190
there at all

1398
01:03:01,449 --> 01:03:07,500
when 32 handmade that H does not need to

1399
01:03:06,190 --> 01:03:09,700
be there

1400
01:03:07,500 --> 01:03:11,829
there's some weird thing in for coder

1401
01:03:09,699 --> 01:03:15,189
where for some reason caged up doesn't

1402
01:03:11,829 --> 01:03:17,440
go to the top it stops at the first like

1403
01:03:15,190 --> 01:03:19,000
before the top or something it's weird I

1404
01:03:17,440 --> 01:03:21,760
got to go find out why that is I don't

1405
01:03:19,000 --> 01:03:23,710
really know why there's some reason why

1406
01:03:21,760 --> 01:03:28,770
it does that I should write down it as a

1407
01:03:23,710 --> 01:03:42,730
book but I keep forgetting world mid-age

1408
01:03:28,769 --> 01:03:48,429
test asset builder down age oops H see

1409
01:03:42,730 --> 01:03:50,880
if there's any others Jared that H touch

1410
01:03:48,429 --> 01:03:50,879
shader

1411
01:04:00,030 --> 01:04:05,290
random that H we should do a real random

1412
01:04:03,639 --> 01:04:10,059
number generator sometime soon that's

1413
01:04:05,289 --> 01:04:12,969
probably that would be a good I feel

1414
01:04:10,059 --> 01:04:15,309
like that would be a good thing to do

1415
01:04:12,969 --> 01:04:20,559
one of these streams because we're going

1416
01:04:15,309 --> 01:04:23,199
to need one of those at some point so

1417
01:04:20,559 --> 01:04:28,929
indeed H doesn't have one and that's

1418
01:04:23,199 --> 01:04:32,699
fine same reason that H have one mascot

1419
01:04:28,929 --> 01:04:32,699
H yeah

1420
01:04:33,170 --> 01:04:39,909
what else is there intrinsic study H

1421
01:04:36,909 --> 01:04:39,909
oops

1422
01:04:45,130 --> 01:05:07,420
file formats DWI interface bug that H

1423
01:05:10,150 --> 01:05:13,930
cutscene almost done

1424
01:05:16,239 --> 01:05:30,139
Big O yo and last one yeah so those are

1425
01:05:29,599 --> 01:05:33,230
all

1426
01:05:30,139 --> 01:05:34,788
we're totally superfluous they were just

1427
01:05:33,230 --> 01:05:36,440
from the old Emacs thing that used to

1428
01:05:34,789 --> 01:05:39,369
insert them but they're really not

1429
01:05:36,440 --> 01:05:39,369
necessary so

1430
01:06:02,079 --> 01:06:09,579
let's see what else we got

1431
01:06:06,340 --> 01:06:14,269
why not pragma once because pragma once

1432
01:06:09,579 --> 01:06:17,779
was slower so those pound ifs were

1433
01:06:14,269 --> 01:06:20,989
faster than pragma once the reason for

1434
01:06:17,780 --> 01:06:22,519
that is pragma once actually still for

1435
01:06:20,989 --> 01:06:24,319
whatever reason and do not ask me why

1436
01:06:22,519 --> 01:06:26,329
because it doesn't it shouldn't have

1437
01:06:24,320 --> 01:06:29,059
needed to be well okay we'll say a few

1438
01:06:26,329 --> 01:06:31,759
things first of all Visual Studio is

1439
01:06:29,059 --> 01:06:33,699
like you know it's an amazing how slow

1440
01:06:31,760 --> 01:06:35,420
they managed to make a compiler

1441
01:06:33,699 --> 01:06:36,919
especially because they're older

1442
01:06:35,420 --> 01:06:39,650
compilers used to be faster they get

1443
01:06:36,920 --> 01:06:45,380
slower and slower and slower right and

1444
01:06:39,650 --> 01:06:48,260
so when in in 1999 I profiled build

1445
01:06:45,380 --> 01:06:50,360
times very extensively back then and I

1446
01:06:48,260 --> 01:06:52,520
found that by far the fastest thing to

1447
01:06:50,360 --> 01:06:54,079
do was redundant include guards so the

1448
01:06:52,519 --> 01:06:57,199
reason that I have those in there the

1449
01:06:54,079 --> 01:07:01,009
way that I had them where you do if you

1450
01:06:57,199 --> 01:07:04,099
know not defined who pound to find foo

1451
01:07:01,010 --> 01:07:05,870
and if right and here's the header it's

1452
01:07:04,099 --> 01:07:09,130
because then later in a CPP file what

1453
01:07:05,869 --> 01:07:13,609
you do is you say if not defined foo

1454
01:07:09,130 --> 01:07:15,950
pound include food H and that's what my

1455
01:07:13,610 --> 01:07:17,930
includes used to look like when I didn't

1456
01:07:15,949 --> 01:07:22,759
used to use when I used to use multi

1457
01:07:17,929 --> 01:07:26,629
file builds right and I timed those and

1458
01:07:22,760 --> 01:07:29,530
those were faster than pragma once so

1459
01:07:26,630 --> 01:07:33,650
that's always what I did and hilariously

1460
01:07:29,530 --> 01:07:36,290
after I left rad game tools and I think

1461
01:07:33,650 --> 01:07:38,599
it was Dave Moore who was I took over

1462
01:07:36,289 --> 01:07:39,800
grannie after Tom Forsythe took it over

1463
01:07:38,599 --> 01:07:42,799
for a while and then Dave Moore took it

1464
01:07:39,800 --> 01:07:44,570
over he was like do you still need to

1465
01:07:42,800 --> 01:07:46,100
use the redundant include guards on the

1466
01:07:44,570 --> 01:07:49,100
build can I get rid of those and I was

1467
01:07:46,099 --> 01:07:49,789
like well I don't know you'd have to

1468
01:07:49,099 --> 01:07:52,489
profile it

1469
01:07:49,789 --> 01:07:53,900
he profile it again in like I don't

1470
01:07:52,489 --> 01:07:56,449
remember when it would have been twenty

1471
01:07:53,900 --> 01:08:00,590
two thousand seven eight and pragma once

1472
01:07:56,449 --> 01:08:05,899
was still slower so you know it's just

1473
01:08:00,590 --> 01:08:07,579
like what can I say so yeah the fastest

1474
01:08:05,900 --> 01:08:09,079
thing by far though is the way we build

1475
01:08:07,579 --> 01:08:11,239
on handmade hero now which is unity

1476
01:08:09,079 --> 01:08:13,579
build right it's all one translation

1477
01:08:11,239 --> 01:08:16,039
unit that's way faster

1478
01:08:13,579 --> 01:08:17,809
than all that so we don't have to worry

1479
01:08:16,039 --> 01:08:19,369
about pragma once or pound it or any of

1480
01:08:17,810 --> 01:08:21,289
that stuff anymore but if you are

1481
01:08:19,369 --> 01:08:23,659
worrying about them then the reason not

1482
01:08:21,289 --> 01:08:25,489
to use pragma once is if you haven't

1483
01:08:23,659 --> 01:08:27,889
actually verified that packing watts is

1484
01:08:25,489 --> 01:08:30,019
faster on your compiler then you may

1485
01:08:27,890 --> 01:08:32,720
actually be slower than doing it by hand

1486
01:08:30,020 --> 01:08:35,260
which is hilarious because it probably

1487
01:08:32,720 --> 01:08:35,260
shouldn't be right

1488
01:08:52,609 --> 01:08:58,560
let's see would you see the architecture

1489
01:08:57,298 --> 01:09:00,448
of the NA system is based more on

1490
01:08:58,560 --> 01:09:02,190
experience than an exhalation the

1491
01:09:00,448 --> 01:09:04,829
opposite I've never done an entity

1492
01:09:02,189 --> 01:09:08,099
system similar to this one ever before

1493
01:09:04,829 --> 01:09:09,869
in anyway it's completely different I've

1494
01:09:08,100 --> 01:09:12,210
also never heard of anyone doing an ende

1495
01:09:09,869 --> 01:09:14,159
system this way so it is both new for me

1496
01:09:12,210 --> 01:09:15,448
and new period as far as I know it's a

1497
01:09:14,159 --> 01:09:18,568
completely different one so it's it's

1498
01:09:15,448 --> 01:09:28,919
100% exploration zero experience at the

1499
01:09:18,569 --> 01:09:30,480
moment do you have a plan for the

1500
01:09:28,920 --> 01:09:32,819
components of the entities just use

1501
01:09:30,479 --> 01:09:34,259
flags like you are now like I kind of

1502
01:09:32,819 --> 01:09:36,089
explained before we are not having

1503
01:09:34,259 --> 01:09:38,429
concept of components all entities can

1504
01:09:36,088 --> 01:09:41,420
have all things always that's the goal

1505
01:09:38,429 --> 01:09:41,420
of the system anyways

1506
01:09:46,130 --> 01:09:49,429
as a code base for those new functions

1507
01:09:48,319 --> 01:09:51,529
are created and others are no longer

1508
01:09:49,429 --> 01:09:53,149
called anywhere are there any good ways

1509
01:09:51,529 --> 01:09:56,179
that you recommend for finding out which

1510
01:09:53,149 --> 01:09:58,039
functions of code are never used other

1511
01:09:56,179 --> 01:10:00,319
than just when you spot them not really

1512
01:09:58,039 --> 01:10:06,189
no I mean technically that's probably

1513
01:10:00,319 --> 01:10:12,619
something that would be really easy what

1514
01:10:06,189 --> 01:10:21,678
so you should be able to turn on a

1515
01:10:12,619 --> 01:10:24,380
linker warning of the form like combat

1516
01:10:21,679 --> 01:10:26,449
bla was not called and has been removed

1517
01:10:24,380 --> 01:10:28,159
or something so if you set it to compile

1518
01:10:26,448 --> 01:10:33,049
like individual functions to individual

1519
01:10:28,158 --> 01:10:34,849
combats and like and and ask you to give

1520
01:10:33,050 --> 01:10:38,840
that warning you could probably get

1521
01:10:34,850 --> 01:10:41,090
visual studios linker to tell you what

1522
01:10:38,840 --> 01:10:43,630
but when you turn on full optimizations

1523
01:10:41,090 --> 01:10:46,670
right opt ref and all that stuff you

1524
01:10:43,630 --> 01:10:49,039
could probably get it to tell you here

1525
01:10:46,670 --> 01:10:51,380
are all of the functions I got I threw

1526
01:10:49,039 --> 01:10:53,210
out because nobody called them because

1527
01:10:51,380 --> 01:10:55,369
it will do that it'll do the call graph

1528
01:10:53,210 --> 01:10:58,250
analysis and go I can never get to this

1529
01:10:55,369 --> 01:10:59,869
thing so get rid of it so that that

1530
01:10:58,250 --> 01:11:01,670
might be one way if you're looking for a

1531
01:10:59,869 --> 01:11:04,429
way to do that I don't know why you

1532
01:11:01,670 --> 01:11:06,260
would bother necessarily because if you

1533
01:11:04,429 --> 01:11:07,730
don't know about it and you haven't it's

1534
01:11:06,260 --> 01:11:10,940
not like it's taking any of your time

1535
01:11:07,729 --> 01:11:12,079
right and if you stumble upon something

1536
01:11:10,939 --> 01:11:13,158
you're like hey I wonder if I need to

1537
01:11:12,079 --> 01:11:15,619
keep maintaining this does anyone call

1538
01:11:13,158 --> 01:11:19,658
it just delete it and compile and if it

1539
01:11:15,619 --> 01:11:19,658
compiles then the answer was no right

1540
01:11:29,158 --> 01:11:35,729
du Roi is there a way to run the game

1541
01:11:33,118 --> 01:11:37,609
entirely and find out what parts of your

1542
01:11:35,729 --> 01:11:40,558
code isn't being used to get rid of

1543
01:11:37,609 --> 01:11:42,868
there isn't there isn't obviously you

1544
01:11:40,559 --> 01:11:45,000
can do what's called coverage profiling

1545
01:11:42,868 --> 01:11:46,979
and coverage profiling different

1546
01:11:45,000 --> 01:11:48,750
profilers have it depends on you know

1547
01:11:46,979 --> 01:11:54,089
it's a it's a code profiling operation

1548
01:11:48,750 --> 01:11:55,439
so you need a profiler for it and

1549
01:11:54,090 --> 01:11:56,639
basically what that'll do is it'll tell

1550
01:11:55,439 --> 01:11:59,308
you what code paths have been hit in

1551
01:11:56,639 --> 01:12:01,828
which code pass haven't but the problem

1552
01:11:59,309 --> 01:12:03,779
with that is in a game you don't know if

1553
01:12:01,828 --> 01:12:06,210
that's because the player who did that

1554
01:12:03,779 --> 01:12:07,979
test run just never got to the part of

1555
01:12:06,210 --> 01:12:10,408
the game or did the thing that would

1556
01:12:07,979 --> 01:12:12,448
cause that code to run so while coverage

1557
01:12:10,408 --> 01:12:14,279
testing can be very useful for letting

1558
01:12:12,448 --> 01:12:16,348
you know what parts of your code haven't

1559
01:12:14,279 --> 01:12:18,149
been run what it really just tells you

1560
01:12:16,349 --> 01:12:20,460
is these haven't been run it doesn't

1561
01:12:18,149 --> 01:12:21,868
tell you they could never be run and so

1562
01:12:20,460 --> 01:12:23,550
you kind of need to augment that with

1563
01:12:21,868 --> 01:12:25,649
some thinking of your own and designing

1564
01:12:23,550 --> 01:12:27,480
you know how you're going to play tests

1565
01:12:25,649 --> 01:12:29,519
to make sure you actually find out if

1566
01:12:27,479 --> 01:12:30,868
those things ever get called you can't

1567
01:12:29,520 --> 01:12:32,250
just assume that because they didn't get

1568
01:12:30,868 --> 01:12:33,179
called in a particular run through that

1569
01:12:32,250 --> 01:12:36,078
they're never called because that's

1570
01:12:33,179 --> 01:12:36,078
probably not true

1571
01:13:02,470 --> 01:13:09,190
so let's see someone said the the

1572
01:13:06,420 --> 01:13:10,420
dynamite Jack entity system is similar

1573
01:13:09,189 --> 01:13:11,889
but without the compression well the

1574
01:13:10,420 --> 01:13:17,109
compression is kind of the important

1575
01:13:11,890 --> 01:13:18,730
part it's like the thing that actually

1576
01:13:17,109 --> 01:13:20,979
makes this system what it is right

1577
01:13:18,729 --> 01:13:22,779
obviously there's been plenty of games

1578
01:13:20,979 --> 01:13:25,359
before that just have one entity type

1579
01:13:22,779 --> 01:13:27,639
that's not unusual the unusual part is

1580
01:13:25,359 --> 01:13:29,409
making an entity type that has so much

1581
01:13:27,640 --> 01:13:31,750
stuff in it that you couldn't actually

1582
01:13:29,409 --> 01:13:35,819
store it that way but you compress it

1583
01:13:31,750 --> 01:13:35,819
down dynamically as you go right

1584
01:13:36,510 --> 01:13:43,619
have you checked lock recently yeah we

1585
01:13:40,960 --> 01:13:43,619
did the other day

1586
01:13:48,750 --> 01:13:51,750
15,000

1587
01:14:14,130 --> 01:14:19,529
how is your arm now any chance of a

1588
01:14:16,439 --> 01:14:21,539
stream Athan I'm not super in the mood

1589
01:14:19,529 --> 01:14:23,840
for a stream Mathon but my arm is doing

1590
01:14:21,539 --> 01:14:23,840
okay

1591
01:14:38,399 --> 01:14:43,509
jujin basements see time needs clock

1592
01:14:40,929 --> 01:14:45,248
built in well it can't really do that

1593
01:14:43,510 --> 01:14:49,689
right because it doesn't know what

1594
01:14:45,248 --> 01:14:52,238
you're compiling so at Molly I actually

1595
01:14:49,689 --> 01:14:54,699
am pretty close to having that probably

1596
01:14:52,238 --> 01:14:56,468
the next Rev of our tool train will have

1597
01:14:54,698 --> 01:14:57,609
that because everything will be going

1598
01:14:56,469 --> 01:14:58,868
through the meta programming system

1599
01:14:57,609 --> 01:14:59,889
instead of only some things going

1600
01:14:58,868 --> 01:15:01,658
through them at a program system and

1601
01:14:59,889 --> 01:15:04,779
then it will keep both timings and clock

1602
01:15:01,658 --> 01:15:08,138
because it knows all the code at that

1603
01:15:04,779 --> 01:15:10,300
point but it hasn't gotten there yet so

1604
01:15:08,139 --> 01:15:12,668
eventually we'll have that Molly for

1605
01:15:10,300 --> 01:15:14,800
sure but see time can never really have

1606
01:15:12,668 --> 01:15:17,019
that because it doesn't require you to

1607
01:15:14,800 --> 01:15:19,418
give it that information in any way and

1608
01:15:17,019 --> 01:15:21,189
it would actually be problematic for it

1609
01:15:19,418 --> 01:15:23,109
to gather it because the work it's doing

1610
01:15:21,189 --> 01:15:24,880
to gather it would actually increase

1611
01:15:23,109 --> 01:15:26,408
your build time because it has to read

1612
01:15:24,880 --> 01:15:28,739
it all now probably not very very much

1613
01:15:26,408 --> 01:15:28,738
but

1614
01:15:37,239 --> 01:15:43,189
jiron says recode coverage when far

1615
01:15:40,970 --> 01:15:45,320
brush was trying to cut down science of

1616
01:15:43,189 --> 01:15:47,239
K Krieger they wrote a quick code

1617
01:15:45,319 --> 01:15:48,649
coverage tool called Lecter and because

1618
01:15:47,239 --> 01:15:50,359
someone didn't use a certain key in the

1619
01:15:48,649 --> 01:15:52,609
menu the code to handle it was left out

1620
01:15:50,359 --> 01:15:55,130
of the release version yeah that's well

1621
01:15:52,609 --> 01:15:57,829
that's exactly the problem right and

1622
01:15:55,130 --> 01:16:02,260
it's it's a really difficult problem to

1623
01:15:57,829 --> 01:16:05,359
solve because there's two types of

1624
01:16:02,260 --> 01:16:07,850
unused code there's the kind of code

1625
01:16:05,359 --> 01:16:14,869
that can never be reached and that kind

1626
01:16:07,850 --> 01:16:16,550
of code is relatively easy for the or I

1627
01:16:14,869 --> 01:16:18,529
should say there's the kind of code that

1628
01:16:16,550 --> 01:16:21,829
mechanically could never be reached

1629
01:16:18,529 --> 01:16:23,559
nobody ever takes its address ergo you

1630
01:16:21,829 --> 01:16:25,939
can never get to that piece of code

1631
01:16:23,560 --> 01:16:26,840
barring some kind of a bug or a hack

1632
01:16:25,939 --> 01:16:29,569
right

1633
01:16:26,840 --> 01:16:31,520
and that kind of code is easy to remove

1634
01:16:29,569 --> 01:16:33,079
and the linker can remove it for you the

1635
01:16:31,520 --> 01:16:35,930
other kind of code is code that could

1636
01:16:33,079 --> 01:16:37,760
technically be reached potentially like

1637
01:16:35,930 --> 01:16:39,590
someone does have the address of it and

1638
01:16:37,760 --> 01:16:42,170
it is compiled it would be compiled into

1639
01:16:39,590 --> 01:16:44,810
the program but it turns out that the

1640
01:16:42,170 --> 01:16:50,690
state of the program as it is can never

1641
01:16:44,810 --> 01:16:53,180
really get set in a way that you'll

1642
01:16:50,689 --> 01:16:57,229
reach that code and the problem is

1643
01:16:53,180 --> 01:16:59,090
that's impossible to tell right I would

1644
01:16:57,229 --> 01:17:00,679
imagine that a computer science student

1645
01:16:59,090 --> 01:17:02,659
could probably prove that that's

1646
01:17:00,680 --> 01:17:04,970
analogous to the halting problem like if

1647
01:17:02,659 --> 01:17:07,099
you could write something that would

1648
01:17:04,970 --> 01:17:09,110
tell you whether a particular line of

1649
01:17:07,100 --> 01:17:10,700
code could ever be reached then

1650
01:17:09,109 --> 01:17:13,159
presumably you could solve the halting

1651
01:17:10,699 --> 01:17:15,109
problem because I just asked you hey can

1652
01:17:13,159 --> 01:17:17,869
the final line of this program ever be

1653
01:17:15,109 --> 01:17:19,609
reached and now I can solve the halting

1654
01:17:17,869 --> 01:17:22,569
problem because you will have told me

1655
01:17:19,609 --> 01:17:25,339
whether the thing will ever exit right

1656
01:17:22,569 --> 01:17:27,529
so I believe it is a literally

1657
01:17:25,340 --> 01:17:29,750
unsolvable computer science problem to

1658
01:17:27,529 --> 01:17:32,359
tell you whether a particular piece of

1659
01:17:29,750 --> 01:17:33,949
code can ever be reached and so it's a

1660
01:17:32,359 --> 01:17:36,199
very difficult problem and especially

1661
01:17:33,949 --> 01:17:38,449
like in a situation that like for

1662
01:17:36,199 --> 01:17:40,039
example that Fabrice was in in that case

1663
01:17:38,449 --> 01:17:41,689
it's like especially if you're gonna

1664
01:17:40,039 --> 01:17:42,979
rush like that like they were trying to

1665
01:17:41,689 --> 01:17:44,839
get finished for a comp

1666
01:17:42,979 --> 01:17:46,309
competition River and that's similar in

1667
01:17:44,840 --> 01:17:48,260
games right oftentimes you made have

1668
01:17:46,310 --> 01:17:51,889
some tight deadlines or something try

1669
01:17:48,260 --> 01:17:53,690
to figure out how you can put in some

1670
01:17:51,889 --> 01:17:55,760
kind of instrumentation to tell you all

1671
01:17:53,689 --> 01:17:58,098
of the code that might be hit is really

1672
01:17:55,760 --> 01:17:59,420
pretty difficult because you just don't

1673
01:17:58,099 --> 01:18:01,849
know how to make sure that you're

1674
01:17:59,420 --> 01:18:04,519
testing of that hits all of the right

1675
01:18:01,849 --> 01:18:07,099
things that could happen right you don't

1676
01:18:04,519 --> 01:18:08,300
know what things are sort of unusual now

1677
01:18:07,099 --> 01:18:10,460
one of the things that you can do

1678
01:18:08,300 --> 01:18:13,099
obviously is when you are programming

1679
01:18:10,460 --> 01:18:15,019
the game you can try to avoid the kinds

1680
01:18:13,099 --> 01:18:16,730
of code that happens extraordinarily

1681
01:18:15,019 --> 01:18:18,619
rarely you can try to make sure that

1682
01:18:16,729 --> 01:18:21,198
most things go through the same code

1683
01:18:18,618 --> 01:18:26,238
pass so at least the code path has some

1684
01:18:21,198 --> 01:18:29,779
coverage now that doesn't necessarily

1685
01:18:26,238 --> 01:18:33,078
help have the code the code pass be

1686
01:18:29,779 --> 01:18:34,819
tested within the bounds that you're

1687
01:18:33,078 --> 01:18:36,859
expecting because you know values can be

1688
01:18:34,819 --> 01:18:38,448
drastically bigger or smaller and maybe

1689
01:18:36,859 --> 01:18:40,038
you never hit those cases or something

1690
01:18:38,448 --> 01:18:43,578
that go through so that parts is a

1691
01:18:40,038 --> 01:18:45,349
little bit of an issue for sure but you

1692
01:18:43,578 --> 01:18:49,308
you kind of see what I mean just in

1693
01:18:45,349 --> 01:18:50,960
terms of of it sort of being something

1694
01:18:49,309 --> 01:18:52,579
that you can kind of design for a little

1695
01:18:50,960 --> 01:18:54,529
bit when you're programming but on the

1696
01:18:52,578 --> 01:18:55,969
whole it's it's it's not just a hard

1697
01:18:54,529 --> 01:18:57,889
problem it's like an unsolvable problem

1698
01:18:55,969 --> 01:18:59,630
so you have to you're you're always

1699
01:18:57,889 --> 01:19:01,429
dealing with some kind of approximate

1700
01:18:59,630 --> 01:19:03,050
way that you're planning to attack it

1701
01:19:01,429 --> 01:19:06,500
and you don't there's not some magic

1702
01:19:03,050 --> 01:19:07,880
bullet we can just be like ah I just run

1703
01:19:06,500 --> 01:19:10,399
it through this program it tells me all

1704
01:19:07,880 --> 01:19:11,449
the places all the code that is live and

1705
01:19:10,399 --> 01:19:12,348
all the code that's dead that's not

1706
01:19:11,448 --> 01:19:15,018
possible

1707
01:19:12,349 --> 01:19:19,279
and I think like I said I strongly

1708
01:19:15,019 --> 01:19:21,469
suspect that a computer science persons

1709
01:19:19,279 --> 01:19:23,509
would be able to tell you that that's

1710
01:19:21,469 --> 01:19:24,859
that's kind of a halting problem it's

1711
01:19:23,510 --> 01:19:27,230
analogous to a halting problem and you

1712
01:19:24,859 --> 01:19:30,348
can't actually solve it in the grand

1713
01:19:27,229 --> 01:19:32,899
scheme of things like I said linkers

1714
01:19:30,349 --> 01:19:34,610
will do the basic version of it and

1715
01:19:32,899 --> 01:19:36,408
compilers do dead code elimination all

1716
01:19:34,609 --> 01:19:38,569
the time so anything that's reasonably

1717
01:19:36,408 --> 01:19:42,078
easy to conclude that you can't get to

1718
01:19:38,569 --> 01:19:44,538
that's already being removed for you but

1719
01:19:42,078 --> 01:19:47,000
things that are more subtly not possible

1720
01:19:44,538 --> 01:19:48,920
to get to like can this menu item ever

1721
01:19:47,000 --> 01:19:51,260
be reached like does this menu can you

1722
01:19:48,920 --> 01:19:53,269
even pop up this menu who knows right

1723
01:19:51,260 --> 01:19:54,590
like that's such a complicated thing to

1724
01:19:53,269 --> 01:19:56,449
figure out well I don't know like how

1725
01:19:54,590 --> 01:19:57,920
big was the screen and maybe it's

1726
01:19:56,448 --> 01:19:59,928
something that's so far off the screen

1727
01:19:57,920 --> 01:20:02,239
it's almost never possible to click on

1728
01:19:59,929 --> 01:20:03,980
but if the user has a big enough

1729
01:20:02,238 --> 01:20:05,359
monitor then it turns out you can get to

1730
01:20:03,979 --> 01:20:06,408
this weird button that we forgot about

1731
01:20:05,359 --> 01:20:08,238
and you can't actually get to it right

1732
01:20:06,408 --> 01:20:09,408
all those sorts of things are weird and

1733
01:20:08,238 --> 01:20:10,638
then you also have the question if

1734
01:20:09,408 --> 01:20:12,049
should you have been able to get to it

1735
01:20:10,639 --> 01:20:13,279
was a mistake that was up in there so

1736
01:20:12,050 --> 01:20:14,809
even when you're answering the question

1737
01:20:13,279 --> 01:20:15,679
correctly you could still be wrong in

1738
01:20:14,809 --> 01:20:16,820
that well it should have been removed

1739
01:20:15,679 --> 01:20:21,489
because that's supposed to be there bla

1740
01:20:16,819 --> 01:20:21,488
bla bla bla bla right so

1741
01:20:33,350 --> 01:20:40,110
alright looks like there's really not

1742
01:20:35,399 --> 01:20:48,689
any more cues that need paying so I'm

1743
01:20:40,109 --> 01:20:50,880
going to wrap it up alright thank you

1744
01:20:48,689 --> 01:20:51,989
everyone for joining me for an episode

1745
01:20:50,880 --> 01:20:54,539
of hand made here at some pleasure

1746
01:20:51,989 --> 01:20:55,590
coding with you as always if you would

1747
01:20:54,539 --> 01:20:56,729
like to follow along at home you can

1748
01:20:55,590 --> 01:20:58,760
always pre-order the game on handmade

1749
01:20:56,729 --> 01:21:01,709
hero org it comes with the source code

1750
01:20:58,760 --> 01:21:02,970
so that you can follow along there's

1751
01:21:01,710 --> 01:21:04,470
also a forum site if you want to ask

1752
01:21:02,970 --> 01:21:06,000
questions a patreon page you want to

1753
01:21:04,470 --> 01:21:08,760
support the video series a schedule bot

1754
01:21:06,000 --> 01:21:10,739
that lets you know when the episodes air

1755
01:21:08,760 --> 01:21:12,840
or I should say when the stream is live

1756
01:21:10,739 --> 01:21:15,269
and an episode guide if you want to

1757
01:21:12,840 --> 01:21:16,470
catch up on old streams where if there's

1758
01:21:15,270 --> 01:21:18,720
something that we've already covered

1759
01:21:16,470 --> 01:21:21,480
that you want to go and figure out how

1760
01:21:18,720 --> 01:21:24,810
it how it works you can go watch that as

1761
01:21:21,479 --> 01:21:26,750
well that's about it I will be back here

1762
01:21:24,810 --> 01:21:30,539
tomorrow 5:00 p.m. Pacific Daylight Time

1763
01:21:26,750 --> 01:21:31,710
when we will go over our camera code and

1764
01:21:30,539 --> 01:21:33,109
kind of figure out how we want that to

1765
01:21:31,710 --> 01:21:35,760
work I feel like we're gonna want to do

1766
01:21:33,109 --> 01:21:37,289
interpolating cameras because now that

1767
01:21:35,760 --> 01:21:38,430
I'm doing room locked that we'll

1768
01:21:37,289 --> 01:21:40,949
probably want to do like a thing that

1769
01:21:38,430 --> 01:21:43,020
kind of like slides quickly from room to

1770
01:21:40,949 --> 01:21:46,170
room so we'll probably get that going

1771
01:21:43,020 --> 01:21:49,470
tomorrow that's about it I hope all of

1772
01:21:46,170 --> 01:21:50,670
you have fun programming and I will see

1773
01:21:49,470 --> 01:21:53,090
you on the Internet take it easy

1774
01:21:50,670 --> 01:21:53,090
everyone

