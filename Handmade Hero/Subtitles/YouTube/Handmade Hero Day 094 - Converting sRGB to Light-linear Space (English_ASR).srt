1
00:00:00,060 --> 00:00:04,079
start hello everyone welcome to hand

2
00:00:02,790 --> 00:00:06,778
made here on the show Rico to complete

3
00:00:04,080 --> 00:00:08,820
games live on twitch from scratch no

4
00:00:06,778 --> 00:00:10,919
libraries no engines so that we know

5
00:00:08,820 --> 00:00:13,589
everything that goes on nothing hides

6
00:00:10,919 --> 00:00:15,320
from us we are in there with the with

7
00:00:13,589 --> 00:00:18,149
the flashlight looking under the bed

8
00:00:15,320 --> 00:00:20,550
scaring the monsters away even if

9
00:00:18,149 --> 00:00:23,070
they're particularly scary monsters we

10
00:00:20,550 --> 00:00:25,320
just generally are completely

11
00:00:23,070 --> 00:00:27,268
unpersuaded by that because we're kind

12
00:00:25,320 --> 00:00:33,299
of big and gnarly and have hairy fangs

13
00:00:27,268 --> 00:00:34,769
ourselves anyway if you would like to

14
00:00:33,299 --> 00:00:36,000
follow along with today's episode and

15
00:00:34,770 --> 00:00:37,950
you have pre-ordered the game on

16
00:00:36,000 --> 00:00:39,238
handmade hero org please don't forget to

17
00:00:37,950 --> 00:00:40,739
download the source code from the link

18
00:00:39,238 --> 00:00:44,339
in your email and you will want to

19
00:00:40,738 --> 00:00:46,979
unpack de 94 is source code I believe

20
00:00:44,340 --> 00:00:49,289
that's correct date IV I'm sorry day 93

21
00:00:46,979 --> 00:00:51,659
source code so that you can do de 94

22
00:00:49,289 --> 00:00:53,129
which is what rond today that is all you

23
00:00:51,659 --> 00:00:58,319
should need to do and then you will be

24
00:00:53,128 --> 00:01:01,769
exactly where I am so assuming that that

25
00:00:58,320 --> 00:01:04,530
is all good with you I would like to say

26
00:01:01,770 --> 00:01:07,560
a few words about where we left off just

27
00:01:04,530 --> 00:01:09,750
so everyone it's on the same page so

28
00:01:07,560 --> 00:01:12,659
what we did last week is we basically

29
00:01:09,750 --> 00:01:14,938
started our renderer and we did a bunch

30
00:01:12,659 --> 00:01:17,040
of stuff on it as you can see in the

31
00:01:14,938 --> 00:01:18,658
middle of the screen now kind of

32
00:01:17,040 --> 00:01:20,310
ridiculous we don't really have an

33
00:01:18,659 --> 00:01:22,500
excuse for why a tree would be rotating

34
00:01:20,310 --> 00:01:26,060
in place other than it was our test fit

35
00:01:22,500 --> 00:01:28,799
map and you can kind of see right now

36
00:01:26,060 --> 00:01:31,170
that we've actually implemented texture

37
00:01:28,799 --> 00:01:33,930
mapping so that we can freely rotate and

38
00:01:31,170 --> 00:01:35,609
scale things and we did it with the

39
00:01:33,930 --> 00:01:37,618
bilinear filtering so you actually get

40
00:01:35,609 --> 00:01:40,560
kind of a nice smooth version there as

41
00:01:37,618 --> 00:01:42,688
well now we're gonna talk about

42
00:01:40,560 --> 00:01:44,310
something today that normally I don't

43
00:01:42,688 --> 00:01:47,459
think I would really talk about two

44
00:01:44,310 --> 00:01:49,649
completely honest with you but we're

45
00:01:47,459 --> 00:01:53,548
talking about it have to be test of Wan

46
00:01:49,649 --> 00:01:57,540
Chun who made me promise that I would

47
00:01:53,549 --> 00:02:00,750
talk about it on the stream so here we

48
00:01:57,540 --> 00:02:02,189
go it's it's gamma correction and

49
00:02:00,750 --> 00:02:03,899
somebody actually asked about it in one

50
00:02:02,188 --> 00:02:06,298
of the Q&amp;A s they didn't ask for it by

51
00:02:03,899 --> 00:02:08,068
name but I believe they were asking

52
00:02:06,299 --> 00:02:09,330
about it sort of indirectly and so at

53
00:02:08,068 --> 00:02:10,919
least we know there's one person out

54
00:02:09,330 --> 00:02:12,330
there who wanted to know about it and so

55
00:02:10,919 --> 00:02:13,709
it won't be completely useless let's put

56
00:02:12,330 --> 00:02:14,880
it that way

57
00:02:13,710 --> 00:02:16,379
and it's very near and dear to one's

58
00:02:14,879 --> 00:02:18,530
heart apparently so he really wanted

59
00:02:16,379 --> 00:02:21,299
everyone to know so we're gonna do it

60
00:02:18,530 --> 00:02:22,650
and what the person who asked in the Q&amp;A

61
00:02:21,300 --> 00:02:24,450
they were saying they had seen some

62
00:02:22,650 --> 00:02:27,510
video about how color blending is done

63
00:02:24,449 --> 00:02:28,679
incorrectly on computers and he said

64
00:02:27,509 --> 00:02:30,269
like since you're doing this all from

65
00:02:28,680 --> 00:02:32,370
scratch you have the opportunity to do

66
00:02:30,270 --> 00:02:34,500
it correctly so one thing that I should

67
00:02:32,370 --> 00:02:35,849
point out is when they say that blending

68
00:02:34,500 --> 00:02:37,349
on computers is done incorrectly they're

69
00:02:35,849 --> 00:02:40,259
actually just talking about paint

70
00:02:37,349 --> 00:02:42,509
programs games actually do do blending

71
00:02:40,259 --> 00:02:43,979
correctly games we have been doing

72
00:02:42,509 --> 00:02:45,889
blending correctly for a long time

73
00:02:43,979 --> 00:02:50,099
actually for probably about four years

74
00:02:45,889 --> 00:02:52,319
gamma corrected pipelines have been in

75
00:02:50,099 --> 00:02:55,379
the works you know I probably since

76
00:02:52,319 --> 00:03:00,709
half-life 2 certainly in the last of us

77
00:02:55,379 --> 00:03:04,699
and and what was it called uncharted 2

78
00:03:00,710 --> 00:03:06,990
those were all using gamma corrected

79
00:03:04,699 --> 00:03:09,179
pipelines so that they could

80
00:03:06,990 --> 00:03:11,189
specifically do color blending correctly

81
00:03:09,180 --> 00:03:12,810
always right and so games have actually

82
00:03:11,189 --> 00:03:14,280
been way out ahead on this and yes it's

83
00:03:12,810 --> 00:03:15,360
true that people like Adobe and stuff

84
00:03:14,280 --> 00:03:17,430
may not be doing any of this stuff

85
00:03:15,360 --> 00:03:19,350
correctly and that's I think what the

86
00:03:17,430 --> 00:03:21,090
video that you were referring to is

87
00:03:19,349 --> 00:03:22,530
talking about because they don't do

88
00:03:21,090 --> 00:03:24,240
stuff gamma corrected in a lot of places

89
00:03:22,530 --> 00:03:25,830
and there's plenty of art packages that

90
00:03:24,240 --> 00:03:27,990
don't do gamma correction properly but

91
00:03:25,830 --> 00:03:30,150
games are not really one of them

92
00:03:27,990 --> 00:03:31,790
you know maybe 2d games don't do it as

93
00:03:30,150 --> 00:03:34,620
much because it doesn't really matter

94
00:03:31,789 --> 00:03:36,359
but but certainly 3d games where it's

95
00:03:34,620 --> 00:03:38,610
very important for lighting and for HDR

96
00:03:36,360 --> 00:03:41,610
high dynamic range imaging which games

97
00:03:38,610 --> 00:03:43,920
use nowadays that that stuff is really

98
00:03:41,610 --> 00:03:45,570
where you got to get your dammit correct

99
00:03:43,919 --> 00:03:47,939
so so games actually have been doing

100
00:03:45,569 --> 00:03:49,650
gamma correctly and you know you know

101
00:03:47,939 --> 00:03:52,590
I'm not certainly not a gamma expert but

102
00:03:49,650 --> 00:03:54,270
I'll try to give you what the idea is so

103
00:03:52,590 --> 00:03:55,439
that you know you can be aware of it

104
00:03:54,270 --> 00:03:56,580
maybe do some reading on your own and

105
00:03:55,439 --> 00:03:58,109
then I'll show you how we can sort of

106
00:03:56,580 --> 00:03:59,790
implement it a little bit in our

107
00:03:58,110 --> 00:04:01,680
software rasterizer in our hardware

108
00:03:59,789 --> 00:04:03,810
version will do it 100% correctly it's

109
00:04:01,680 --> 00:04:05,370
actually really easy to do correctly in

110
00:04:03,810 --> 00:04:07,710
there a hundred percents probably a

111
00:04:05,370 --> 00:04:11,250
little wrong term but very close to

112
00:04:07,710 --> 00:04:13,980
hundred-percent so basically here is a

113
00:04:11,250 --> 00:04:16,949
chart I don't know if you guys can see

114
00:04:13,979 --> 00:04:20,009
this in fact maybe I'll I'll go ahead

115
00:04:16,949 --> 00:04:22,409
and just play with this this camera

116
00:04:20,009 --> 00:04:24,659
setting here for a second let's see if I

117
00:04:22,410 --> 00:04:26,070
can do this here so if I if I pick

118
00:04:24,660 --> 00:04:29,490
webcam

119
00:04:26,069 --> 00:04:31,409
right can you guys see this chart you

120
00:04:29,490 --> 00:04:34,590
see that you see what it says there so

121
00:04:31,410 --> 00:04:37,920
at the bottom right on the x-axis

122
00:04:34,589 --> 00:04:40,199
it says gray level right and that is

123
00:04:37,920 --> 00:04:42,990
like the pixel value okay that's like

124
00:04:40,199 --> 00:04:46,800
what we're sending like 0 to 255 okay

125
00:04:42,990 --> 00:04:48,389
and then on the on the y-axis there and

126
00:04:46,800 --> 00:04:49,319
see if I can get a little closer on the

127
00:04:48,389 --> 00:04:52,019
y-axis

128
00:04:49,319 --> 00:04:53,639
it says brightness in candelas per meter

129
00:04:52,019 --> 00:04:56,129
squared right

130
00:04:53,639 --> 00:05:00,990
so that is actually gosh darn it we need

131
00:04:56,129 --> 00:05:03,060
to turn off of our sources hold on

132
00:05:00,990 --> 00:05:04,500
second I need to turn off these

133
00:05:03,060 --> 00:05:08,160
assertions I left them in there so we

134
00:05:04,500 --> 00:05:11,490
would know but okay so candelas per

135
00:05:08,160 --> 00:05:12,810
meter squared is the brightness that the

136
00:05:11,490 --> 00:05:15,870
monitor is actually putting out there

137
00:05:12,810 --> 00:05:20,280
okay and what you can see is this does

138
00:05:15,870 --> 00:05:22,920
not form a line right it forms a curve

139
00:05:20,279 --> 00:05:26,449
it forms a curve not a straight line

140
00:05:22,920 --> 00:05:28,439
which means that as you change the

141
00:05:26,449 --> 00:05:31,170
values that you're sending to the

142
00:05:28,439 --> 00:05:34,079
monitor the pixel values they actually

143
00:05:31,170 --> 00:05:36,150
get a lot less bright for every

144
00:05:34,079 --> 00:05:38,639
increment that you use when you're down

145
00:05:36,149 --> 00:05:42,719
at the low end right so down in here if

146
00:05:38,639 --> 00:05:45,629
you add one you know one or two to your

147
00:05:42,720 --> 00:05:48,960
pixel value it actually doesn't get much

148
00:05:45,629 --> 00:05:51,959
brighter right whereas on the other side

149
00:05:48,959 --> 00:05:53,069
like up here when you add one or two to

150
00:05:51,959 --> 00:05:57,299
the value it actually gets significantly

151
00:05:53,069 --> 00:06:02,009
brighter by comparison right does that

152
00:05:57,300 --> 00:06:05,490
make some sense that's what monitors do

153
00:06:02,009 --> 00:06:06,569
and so basically a oh dear the focus is

154
00:06:05,490 --> 00:06:09,620
all gone crazy

155
00:06:06,569 --> 00:06:11,969
hello focus focus on me there we go

156
00:06:09,620 --> 00:06:17,220
mm-hmm let's go back to the programming

157
00:06:11,970 --> 00:06:20,640
stream there okay so that curve is how

158
00:06:17,220 --> 00:06:23,250
monitors operate we could go into the

159
00:06:20,639 --> 00:06:24,719
history of why they operate that way but

160
00:06:23,250 --> 00:06:28,050
you know honestly I'm probably the wrong

161
00:06:24,720 --> 00:06:29,730
person tell that see here I got to start

162
00:06:28,050 --> 00:06:34,460
a new day so we can do some drawing on

163
00:06:29,730 --> 00:06:35,600
the blackboard so here we are day 94

164
00:06:34,459 --> 00:06:38,069
oops

165
00:06:35,600 --> 00:06:42,120
day 94

166
00:06:38,069 --> 00:06:43,860
gamma and as you can see you know the

167
00:06:42,120 --> 00:06:46,230
curve on that thing

168
00:06:43,860 --> 00:06:47,280
Kuras candelas per meter squared which

169
00:06:46,230 --> 00:06:48,689
is basically like a measure of

170
00:06:47,279 --> 00:06:51,209
brightness just like it's you know

171
00:06:48,689 --> 00:06:53,879
candelas are a measure of brightness per

172
00:06:51,209 --> 00:06:56,310
meter squared means you know normalized

173
00:06:53,879 --> 00:06:58,680
to an area how big of an area that's

174
00:06:56,310 --> 00:07:01,079
coming out of the screen right and here

175
00:06:58,680 --> 00:07:03,030
is the actual pixel value it was down at

176
00:07:01,079 --> 00:07:06,180
the bottom right and you notice that

177
00:07:03,029 --> 00:07:08,099
that that thing went like that right it

178
00:07:06,180 --> 00:07:10,019
kind of like had a lot of resolution

179
00:07:08,100 --> 00:07:12,180
down here so you could change a little

180
00:07:10,019 --> 00:07:13,949
bit and have it not changed very much

181
00:07:12,180 --> 00:07:15,689
we'd have a lot of control down here and

182
00:07:13,949 --> 00:07:17,729
then you had very little control up here

183
00:07:15,689 --> 00:07:21,300
so you have like you know high control

184
00:07:17,730 --> 00:07:26,310
down here and low control down here

185
00:07:21,300 --> 00:07:29,040
right and the reason that they did this

186
00:07:26,310 --> 00:07:30,360
as far as I know is well actually to the

187
00:07:29,040 --> 00:07:31,439
truth I don't really know the reason why

188
00:07:30,360 --> 00:07:34,520
I did it I'm not gonna pretend I know

189
00:07:31,439 --> 00:07:39,839
you should go read about it I believe

190
00:07:34,519 --> 00:07:42,509
that the the reason it stays this way is

191
00:07:39,839 --> 00:07:45,989
because your eye is more sensitive to

192
00:07:42,509 --> 00:07:48,089
contrast in darker areas than it is in

193
00:07:45,990 --> 00:07:51,480
brighter areas I believe this is just an

194
00:07:48,089 --> 00:07:52,889
aspect of the human visual system that

195
00:07:51,480 --> 00:07:55,530
basically says that if you have two

196
00:07:52,889 --> 00:07:57,870
bright colors too bright you know color

197
00:07:55,529 --> 00:08:01,199
we can take out a too bright gray values

198
00:07:57,870 --> 00:08:03,300
next to each other and to dark gray

199
00:08:01,199 --> 00:08:06,389
values next to each other a small

200
00:08:03,300 --> 00:08:08,430
difference in the dark gray values will

201
00:08:06,389 --> 00:08:10,349
be much more evident to your eye than a

202
00:08:08,430 --> 00:08:13,250
small difference in the light values

203
00:08:10,350 --> 00:08:15,990
right so basically you can see

204
00:08:13,250 --> 00:08:21,860
differences here

205
00:08:15,990 --> 00:08:24,389
less then you can see them here right so

206
00:08:21,860 --> 00:08:27,120
they put more control in there so that

207
00:08:24,389 --> 00:08:30,509
you'd have more ability to specify finer

208
00:08:27,120 --> 00:08:32,310
shades of those dark Gray's instead of

209
00:08:30,509 --> 00:08:33,870
putting it linear where you'd have the

210
00:08:32,309 --> 00:08:39,478
same control up here which just wasn't

211
00:08:33,870 --> 00:08:40,830
that useful right so why do we care

212
00:08:39,479 --> 00:08:43,200
about this at all why are we even

213
00:08:40,830 --> 00:08:49,470
bringing this up why does one care about

214
00:08:43,200 --> 00:08:51,030
this right so why does one care and why

215
00:08:49,470 --> 00:08:52,410
does the person who asked the quest

216
00:08:51,029 --> 00:08:55,620
what was the video they're referring to

217
00:08:52,409 --> 00:09:01,169
why did the video care so the answer is

218
00:08:55,620 --> 00:09:03,830
because maths is the answer right if

219
00:09:01,169 --> 00:09:07,649
this is the question mass is the answer

220
00:09:03,830 --> 00:09:09,480
the problem with this curve is that a

221
00:09:07,649 --> 00:09:13,289
lot of the things that we want to

222
00:09:09,480 --> 00:09:16,320
compute are in brightness terms right so

223
00:09:13,289 --> 00:09:18,269
if I for example want to do any

224
00:09:16,320 --> 00:09:21,150
operation that I might want to do in

225
00:09:18,269 --> 00:09:22,919
color space right including all of the

226
00:09:21,149 --> 00:09:26,220
ones that we've currently done for

227
00:09:22,919 --> 00:09:32,699
example just yesterday we did the

228
00:09:26,220 --> 00:09:38,610
bilinear blend right we took four pixel

229
00:09:32,700 --> 00:09:40,620
values right a b c and d and we said

230
00:09:38,610 --> 00:09:43,050
let's make a little imaginary rectangle

231
00:09:40,620 --> 00:09:46,379
well square in this case of out of these

232
00:09:43,049 --> 00:09:48,569
we will blend between a and b linearly

233
00:09:46,379 --> 00:09:49,860
we will blend between C and D linearly

234
00:09:48,570 --> 00:09:51,930
and then we will blend between the

235
00:09:49,860 --> 00:09:55,230
result linearly in order to get what the

236
00:09:51,929 --> 00:09:58,079
color should be here now implicit in all

237
00:09:55,230 --> 00:10:01,740
of this was us saying this word right

238
00:09:58,080 --> 00:10:05,250
here linear we were expecting that as we

239
00:10:01,740 --> 00:10:07,139
blended between a and B that if we were

240
00:10:05,250 --> 00:10:09,659
to for example go halfway in between

241
00:10:07,139 --> 00:10:12,960
them we would have a result that looked

242
00:10:09,659 --> 00:10:15,750
let's say half of a plus half of B

243
00:10:12,960 --> 00:10:18,930
that's what we wanted to look like so if

244
00:10:15,750 --> 00:10:22,409
this was say 25% the brightness that the

245
00:10:18,929 --> 00:10:26,339
monitor could output and this was 75% we

246
00:10:22,409 --> 00:10:29,159
wanted this to be 50% right does that

247
00:10:26,340 --> 00:10:31,170
make some sense another way to say that

248
00:10:29,159 --> 00:10:32,939
might be if this was 0% and this was a

249
00:10:31,169 --> 00:10:35,429
hundred percent we want this to be 50%

250
00:10:32,940 --> 00:10:37,380
as well right any balanced range on

251
00:10:35,429 --> 00:10:40,709
either side we want it to come out in

252
00:10:37,379 --> 00:10:43,110
the middle of those two right but what's

253
00:10:40,710 --> 00:10:45,960
actually going to happen when we do that

254
00:10:43,110 --> 00:10:48,180
blend well here is where we're doing the

255
00:10:45,960 --> 00:10:50,670
blend we're doing the blend in pixel

256
00:10:48,179 --> 00:10:51,959
value space right and so let's take a

257
00:10:50,669 --> 00:10:53,669
look at what happens here and

258
00:10:51,960 --> 00:10:55,350
unfortunately I you know it may not come

259
00:10:53,669 --> 00:10:56,939
out that great because you know I didn't

260
00:10:55,350 --> 00:11:01,110
draw the world's most perfect diagram

261
00:10:56,940 --> 00:11:04,680
right but here are the two endpoints of

262
00:11:01,110 --> 00:11:04,930
the pixel value curve right so if I were

263
00:11:04,679 --> 00:11:06,698
to

264
00:11:04,929 --> 00:11:08,318
do that bilinear blend again in the

265
00:11:06,698 --> 00:11:10,149
space are just a linear blend in the

266
00:11:08,318 --> 00:11:12,399
space we just talked about in pixel

267
00:11:10,149 --> 00:11:15,039
space in the color space I would get

268
00:11:12,399 --> 00:11:18,039
here as my 50% value right this is 0

269
00:11:15,039 --> 00:11:19,778
this is 255 I'm gonna get 128 it's gonna

270
00:11:18,039 --> 00:11:22,088
be right there right in the middle

271
00:11:19,778 --> 00:11:25,539
well what brightness that I did I

272
00:11:22,089 --> 00:11:27,670
blended black with white essentially

273
00:11:25,539 --> 00:11:29,379
right as white as the monitor can do and

274
00:11:27,669 --> 00:11:33,509
as black as the matter could do that's

275
00:11:29,379 --> 00:11:39,490
what I blended and I ended up with that

276
00:11:33,509 --> 00:11:42,068
that is like dark gray right it's

277
00:11:39,490 --> 00:11:45,839
nowhere near half the brightness half

278
00:11:42,068 --> 00:11:49,748
the brightness would be up here right so

279
00:11:45,839 --> 00:11:52,329
the result of not taking gamma into

280
00:11:49,749 --> 00:11:55,808
account is that all of this maths

281
00:11:52,328 --> 00:11:58,448
break they all break because we were

282
00:11:55,808 --> 00:12:01,558
doing them in a space and the math is

283
00:11:58,448 --> 00:12:03,789
certainly correct for that space but our

284
00:12:01,558 --> 00:12:06,149
understanding of what that space meant

285
00:12:03,789 --> 00:12:08,438
is wrong we thought we were getting a

286
00:12:06,149 --> 00:12:09,999
brightness blend we're getting a blend

287
00:12:08,438 --> 00:12:12,188
in some space that has nothing to do

288
00:12:09,999 --> 00:12:13,659
with the brightness right it's a totally

289
00:12:12,188 --> 00:12:15,759
different space and when we map it to

290
00:12:13,659 --> 00:12:18,249
the brightness we get a completely wrong

291
00:12:15,759 --> 00:12:22,449
value does that make sense hopefully

292
00:12:18,249 --> 00:12:24,970
that makes some sense so if we actually

293
00:12:22,448 --> 00:12:28,299
want our math to properly be able to

294
00:12:24,970 --> 00:12:31,959
blend things together what we need to do

295
00:12:28,299 --> 00:12:34,990
is undo the effects of this curve right

296
00:12:31,958 --> 00:12:36,698
and unfortunately when you think about

297
00:12:34,990 --> 00:12:38,740
it you're like well there's no way to

298
00:12:36,698 --> 00:12:41,258
really undo the effects of this curve at

299
00:12:38,740 --> 00:12:44,019
some kind of fundamental level because

300
00:12:41,259 --> 00:12:45,278
the monitor outputs this curve and there

301
00:12:44,019 --> 00:12:46,839
ain't no way you're gonna change the

302
00:12:45,278 --> 00:12:48,249
monitor the user already bought the

303
00:12:46,839 --> 00:12:51,040
monitor and you can't really do anything

304
00:12:48,249 --> 00:12:54,490
about that right so what we need to do

305
00:12:51,039 --> 00:12:57,370
is essentially account for the fact that

306
00:12:54,490 --> 00:12:59,318
the user bought this monitor and take

307
00:12:57,370 --> 00:13:02,068
into account all of the ramifications

308
00:12:59,318 --> 00:13:06,878
that go with it now when I say user

309
00:13:02,068 --> 00:13:10,208
unfortunately I don't just mean the

310
00:13:06,879 --> 00:13:11,619
player okay that is one person but

311
00:13:10,208 --> 00:13:14,678
there's another person that matters here

312
00:13:11,619 --> 00:13:16,928
and that is the artist so both your

313
00:13:14,678 --> 00:13:18,000
artist and your player have monitors and

314
00:13:16,928 --> 00:13:20,909
those monitors

315
00:13:18,000 --> 00:13:23,250
look like this so when the artist makes

316
00:13:20,909 --> 00:13:27,769
an image they are actually making the

317
00:13:23,250 --> 00:13:30,059
image in that gamete space right

318
00:13:27,769 --> 00:13:31,759
assuming they're using Photoshop on this

319
00:13:30,059 --> 00:13:37,739
default settings I believe it is called

320
00:13:31,759 --> 00:13:39,840
srgb is the Adobe standard which is sort

321
00:13:37,740 --> 00:13:42,149
of a modified it's it's basically that

322
00:13:39,840 --> 00:13:44,820
gamma curve it's a little tweaked but

323
00:13:42,149 --> 00:13:46,590
that's basically what it is right and so

324
00:13:44,820 --> 00:13:49,980
the artist actually made an image that

325
00:13:46,590 --> 00:13:51,780
was in that space okay they painted it

326
00:13:49,980 --> 00:13:53,580
looking at the monitor so they've tuned

327
00:13:51,779 --> 00:13:55,949
it to be in this space already

328
00:13:53,580 --> 00:13:59,160
and so when we've lit it to the screen

329
00:13:55,950 --> 00:14:02,700
if we didn't do any math on it it would

330
00:13:59,159 --> 00:14:06,629
be correct right so we sort of had a

331
00:14:02,700 --> 00:14:09,090
case where our input right is in this

332
00:14:06,629 --> 00:14:12,929
space this isn't this is an sRGB space

333
00:14:09,090 --> 00:14:15,389
right and our output also needs to be in

334
00:14:12,929 --> 00:14:17,309
srgb space because the monitor is going

335
00:14:15,389 --> 00:14:21,389
to do it right the monitor needs to see

336
00:14:17,309 --> 00:14:23,219
srgb the artist makes srgb so if there's

337
00:14:21,389 --> 00:14:26,009
nothing in between we don't have to

338
00:14:23,220 --> 00:14:28,560
worry but the instant that we do

339
00:14:26,009 --> 00:14:30,088
anything to color values and expect them

340
00:14:28,559 --> 00:14:31,469
to be linear such as a bilinear blend

341
00:14:30,089 --> 00:14:34,830
which you've already seen we need to do

342
00:14:31,470 --> 00:14:37,529
for texture mapping in here where we are

343
00:14:34,830 --> 00:14:40,320
doing them where the maths happen we

344
00:14:37,529 --> 00:14:41,789
have a problem so what we need to do if

345
00:14:40,320 --> 00:14:45,180
we want to correct this problem is we

346
00:14:41,789 --> 00:14:47,639
must do the maths in a linear space we

347
00:14:45,179 --> 00:14:49,709
want to take them out of srg space

348
00:14:47,639 --> 00:14:50,549
that's RGB space actually should have

349
00:14:49,710 --> 00:14:55,139
drawn that a little bit differently

350
00:14:50,549 --> 00:14:56,789
maths linear we want to take them out of

351
00:14:55,139 --> 00:14:58,980
srgb and put them into a linear space

352
00:14:56,789 --> 00:15:01,110
then we want to take them for the linear

353
00:14:58,980 --> 00:15:06,089
space and put them into the srgb space

354
00:15:01,110 --> 00:15:08,300
again when we are finished right so that

355
00:15:06,089 --> 00:15:11,850
is actually the gamma correct pipeline

356
00:15:08,299 --> 00:15:14,519
and it is what Triple A games do is what

357
00:15:11,850 --> 00:15:16,050
a competent engine does if you went and

358
00:15:14,519 --> 00:15:17,819
use the Unreal 4 engine I'm sure it does

359
00:15:16,049 --> 00:15:19,500
it that way I assume unity does now I

360
00:15:17,820 --> 00:15:21,629
don't think they did originally but I

361
00:15:19,500 --> 00:15:23,490
with their photo realistic shader

362
00:15:21,629 --> 00:15:24,600
updates they did I they would have had

363
00:15:23,490 --> 00:15:27,240
to have done this so I'm assuming they

364
00:15:24,600 --> 00:15:29,940
do it now and really anyone who knows

365
00:15:27,240 --> 00:15:31,860
what they're doing does this it's very

366
00:15:29,940 --> 00:15:33,029
easy to do graphics hardware actually

367
00:15:31,860 --> 00:15:38,159
built-in now you just have to turn it

368
00:15:33,028 --> 00:15:40,860
all right but since we're in a software

369
00:15:38,159 --> 00:15:44,069
rasterizer we have to do it so how do we

370
00:15:40,860 --> 00:15:48,360
do it right what exactly are we going to

371
00:15:44,070 --> 00:15:50,250
do right and so what we have to do is we

372
00:15:48,360 --> 00:15:54,570
have to figure out a way to basically

373
00:15:50,250 --> 00:15:56,490
straighten out this curve on when we are

374
00:15:54,570 --> 00:15:58,170
about to operate on things so we have to

375
00:15:56,490 --> 00:16:01,919
be able to straighten it out and then we

376
00:15:58,169 --> 00:16:03,449
have to flatten it again right so we

377
00:16:01,919 --> 00:16:08,129
have to be able to kind of like do this

378
00:16:03,450 --> 00:16:12,240
curve you know in and out right and so

379
00:16:08,129 --> 00:16:14,820
what we thankfully this srgb right

380
00:16:12,240 --> 00:16:17,789
has an actual definition and you can

381
00:16:14,820 --> 00:16:19,290
look it up right sRGB where they've

382
00:16:17,789 --> 00:16:21,179
actually sort of defined what the curve

383
00:16:19,289 --> 00:16:23,549
is and we're probably not going to be

384
00:16:21,179 --> 00:16:24,929
able to use the curve exactly unless we

385
00:16:23,549 --> 00:16:28,349
choose to use a lookup table it'll

386
00:16:24,929 --> 00:16:30,028
depend but we can certainly look at what

387
00:16:28,350 --> 00:16:32,149
the curve is defined to be and then try

388
00:16:30,028 --> 00:16:34,889
to come up with some approximation

389
00:16:32,149 --> 00:16:36,448
thereof now this is a lot more

390
00:16:34,889 --> 00:16:40,799
information than probably I would have

391
00:16:36,448 --> 00:16:42,359
hoped for yeah yeah so this has got all

392
00:16:40,799 --> 00:16:45,419
of the transforms for how they're

393
00:16:42,360 --> 00:16:48,419
computing it yeah so this is a little

394
00:16:45,419 --> 00:16:52,588
bit so basically if we wanted to do

395
00:16:48,419 --> 00:16:54,059
exactly srgb which you know there's the

396
00:16:52,589 --> 00:16:55,680
it's basically a fairly complicated

397
00:16:54,059 --> 00:16:57,929
color space transform here right they're

398
00:16:55,679 --> 00:17:00,049
transforming the colors slightly into

399
00:16:57,929 --> 00:17:04,198
different space and then they're doing

400
00:17:00,049 --> 00:17:05,759
the the gamma-d code here they've got

401
00:17:04,199 --> 00:17:08,068
the exponents listed blah blah blah like

402
00:17:05,759 --> 00:17:09,689
all this stuff if we actually wanted to

403
00:17:08,068 --> 00:17:11,970
do all of this in a software rasterizer

404
00:17:09,689 --> 00:17:13,579
we'd have to do it with the table right

405
00:17:11,970 --> 00:17:16,919
we'd have to have a lookup table that

406
00:17:13,578 --> 00:17:18,269
translates gamma values and I don't know

407
00:17:16,919 --> 00:17:22,530
whether we want to do a lookup table or

408
00:17:18,269 --> 00:17:24,119
not yeah I don't actually know if we

409
00:17:22,529 --> 00:17:25,740
want to do that or not so let me let me

410
00:17:24,119 --> 00:17:27,688
see if I can find just a standard

411
00:17:25,740 --> 00:17:29,308
monitor gamma thing because you're

412
00:17:27,689 --> 00:17:32,040
usually what you do is you assume that

413
00:17:29,308 --> 00:17:34,200
the gamma is about 2.2 and that's an

414
00:17:32,039 --> 00:17:37,740
easier thing that I could sort of show

415
00:17:34,200 --> 00:17:39,870
you how we could do in software right so

416
00:17:37,740 --> 00:17:41,730
in fact you can see it right here

417
00:17:39,869 --> 00:17:43,829
right

418
00:17:41,730 --> 00:17:46,410
the equation that typically ends up

419
00:17:43,829 --> 00:17:48,029
happening where is it

420
00:17:46,410 --> 00:17:51,360
well they kind of wrote it in a way that

421
00:17:48,029 --> 00:17:53,129
I don't love I'm just gonna write it

422
00:17:51,359 --> 00:17:54,569
myself I kind of wanted Wikipedia I

423
00:17:53,130 --> 00:17:57,630
always go to Wikipedia because I want to

424
00:17:54,569 --> 00:18:01,740
show some math and I feel like it always

425
00:17:57,630 --> 00:18:02,490
lets me down a little bit right like you

426
00:18:01,740 --> 00:18:04,799
know what I can do

427
00:18:02,490 --> 00:18:06,480
here's one thing I could do here's what

428
00:18:04,799 --> 00:18:07,409
I'll point you to so that you can read

429
00:18:06,480 --> 00:18:08,519
about this on your own

430
00:18:07,410 --> 00:18:09,690
that's what I'll do I'll point you to

431
00:18:08,519 --> 00:18:13,109
something that's that's better than this

432
00:18:09,690 --> 00:18:18,029
because I do know a place so let me see

433
00:18:13,109 --> 00:18:26,189
gamma correct rendering naughty naughty

434
00:18:18,029 --> 00:18:29,279
dog 2010 here we go so I believe here

435
00:18:26,190 --> 00:18:31,500
you go so these are the slides from the

436
00:18:29,279 --> 00:18:33,599
Uncharted presentation I think they gave

437
00:18:31,500 --> 00:18:35,519
it GDC at one point where they were

438
00:18:33,599 --> 00:18:37,859
explaining how they were doing

439
00:18:35,519 --> 00:18:40,019
gamma correct rendering right and you

440
00:18:37,859 --> 00:18:42,149
can see they drew in that that gamma

441
00:18:40,019 --> 00:18:45,150
there and all the sorts of stuff and

442
00:18:42,150 --> 00:18:47,850
they kind of show kind of nicely what

443
00:18:45,150 --> 00:18:51,140
the math is here relatively well I think

444
00:18:47,849 --> 00:18:53,819
oh well maybe maybe I'm wrong about that

445
00:18:51,140 --> 00:18:55,950
yeah not going my way today I mean here

446
00:18:53,819 --> 00:18:57,419
is basically the equation which is

447
00:18:55,950 --> 00:18:59,279
saying you know that it's it's whatever

448
00:18:57,420 --> 00:19:01,560
the color value is raised to the 2.2

449
00:18:59,279 --> 00:19:03,119
power but I was kind of hoping they

450
00:19:01,559 --> 00:19:04,649
would just have written it out and they

451
00:19:03,119 --> 00:19:08,489
didn't write out the reverse one you can

452
00:19:04,650 --> 00:19:11,100
see they have it here where where

453
00:19:08,490 --> 00:19:12,930
they've got the translation right so two

454
00:19:11,099 --> 00:19:14,490
point two and point four or five which

455
00:19:12,930 --> 00:19:16,080
are the powers that you would go back

456
00:19:14,490 --> 00:19:19,109
and forth right point four five is one

457
00:19:16,079 --> 00:19:20,939
over two point two all right so I don't

458
00:19:19,109 --> 00:19:22,259
know I'll still leave you with this

459
00:19:20,940 --> 00:19:23,820
recommendation because I think it's

460
00:19:22,259 --> 00:19:27,559
probably a good thing to read I remember

461
00:19:23,819 --> 00:19:30,950
it being a pretty good sort of way of

462
00:19:27,559 --> 00:19:33,809
learning about it a little bit right and

463
00:19:30,950 --> 00:19:35,430
you know hopefully you can snap this if

464
00:19:33,809 --> 00:19:36,990
you can pause the video or something on

465
00:19:35,430 --> 00:19:39,720
the YouTube you can snap this guy and

466
00:19:36,990 --> 00:19:42,509
and take a look at here it's John hables

467
00:19:39,720 --> 00:19:44,730
the guy's name and and really like I

468
00:19:42,509 --> 00:19:46,619
said this is kind of the slide that's

469
00:19:44,730 --> 00:19:50,460
that's pretty good here right which is

470
00:19:46,619 --> 00:19:53,069
kind of saying like okay you know if

471
00:19:50,460 --> 00:19:54,400
you're if you've got trying to think if

472
00:19:53,069 --> 00:19:58,089
I see if they've got a

473
00:19:54,400 --> 00:20:00,940
yeah they still down I feel like the

474
00:19:58,089 --> 00:20:03,459
actual presentation had better slides

475
00:20:00,940 --> 00:20:05,740
than this so maybe actually go try to

476
00:20:03,460 --> 00:20:08,100
download the actual talk which I don't

477
00:20:05,740 --> 00:20:11,740
know it should also also be up here oh

478
00:20:08,099 --> 00:20:13,240
well well anyway I did the best I could

479
00:20:11,740 --> 00:20:16,240
I apologize so we'll just leave it at

480
00:20:13,240 --> 00:20:18,370
that and I'll move on here so basically

481
00:20:16,240 --> 00:20:21,279
what ends up happening is instead of

482
00:20:18,369 --> 00:20:23,859
trying to mimic srgb exactly which would

483
00:20:21,279 --> 00:20:25,960
require a table lookup what we can sort

484
00:20:23,859 --> 00:20:30,399
of do is say well this monitor curve is

485
00:20:25,960 --> 00:20:33,759
generally expected to be an output of

486
00:20:30,400 --> 00:20:35,259
the form pow right and I can don't even

487
00:20:33,759 --> 00:20:38,558
have to I guess right pal but I can just

488
00:20:35,259 --> 00:20:40,359
say it is the color value right whatever

489
00:20:38,558 --> 00:20:43,750
it is like the are the G or the B so you

490
00:20:40,359 --> 00:20:45,579
know like R or whatever to the 2.2 power

491
00:20:43,750 --> 00:20:49,269
right so the thing that you actually

492
00:20:45,579 --> 00:20:52,058
this is actually what's going on when

493
00:20:49,269 --> 00:20:52,779
the monitor is going to to display

494
00:20:52,058 --> 00:20:54,279
things right

495
00:20:52,779 --> 00:20:57,069
you've actually got it raising it to the

496
00:20:54,279 --> 00:21:00,220
2.2 power now the 2.2 power is a little

497
00:20:57,069 --> 00:21:02,500
bit problematic obviously because it's a

498
00:21:00,220 --> 00:21:04,808
pal function it's actually you know

499
00:21:02,500 --> 00:21:06,819
raising raising a color value to an

500
00:21:04,808 --> 00:21:08,619
explicit power is a little bit daunting

501
00:21:06,819 --> 00:21:10,689
but potentially in a software rasterizer

502
00:21:08,619 --> 00:21:12,639
again that would be something we'd kind

503
00:21:10,690 --> 00:21:14,350
of think about table driving but what

504
00:21:12,640 --> 00:21:15,940
the compromise that I reached with wom

505
00:21:14,349 --> 00:21:19,899
when he was demanding that I cover this

506
00:21:15,940 --> 00:21:23,259
on the stream was 2.2 is pretty close to

507
00:21:19,900 --> 00:21:24,700
2 right so a curve in fact we could

508
00:21:23,259 --> 00:21:27,549
probably I don't know if Wolfram Alpha

509
00:21:24,700 --> 00:21:31,600
or I think Google made actually do graph

510
00:21:27,549 --> 00:21:35,349
X to the 2 and X to the 2.2 can it do

511
00:21:31,599 --> 00:21:37,178
that so if you look at these curves you

512
00:21:35,349 --> 00:21:39,039
know they're not bad especially in the

513
00:21:37,179 --> 00:21:42,220
range of 1 to 1 I don't know if they

514
00:21:39,039 --> 00:21:44,889
have a way of me sort of explicitly

515
00:21:42,220 --> 00:21:47,769
saying I want to see just that area but

516
00:21:44,890 --> 00:21:50,350
like let's zoom in here right like so

517
00:21:47,769 --> 00:21:52,990
and you can kind of see like from the

518
00:21:50,349 --> 00:21:54,279
area of that we care about from 0 to 1

519
00:21:52,990 --> 00:21:56,140
which is really the color area there to

520
00:21:54,279 --> 00:21:58,329
care about they're really pretty darn

521
00:21:56,140 --> 00:22:01,000
close in there right you can see there

522
00:21:58,329 --> 00:22:03,639
they're not bad right and so it's

523
00:22:01,000 --> 00:22:05,170
certainly a you know one I was basically

524
00:22:03,640 --> 00:22:06,880
saying well you know I don't know that

525
00:22:05,170 --> 00:22:07,160
I'm going to do POW - - you know maybe

526
00:22:06,880 --> 00:22:08,390
we

527
00:22:07,160 --> 00:22:10,190
table drive it I'd really like to keep

528
00:22:08,390 --> 00:22:11,600
tables out of the software rasterizer is

529
00:22:10,190 --> 00:22:17,990
possible so we're not constantly doing

530
00:22:11,599 --> 00:22:19,909
fetches into them etc etc and so to

531
00:22:17,990 --> 00:22:21,589
point to was kind of settled on as not

532
00:22:19,910 --> 00:22:23,930
being possible or something I didn't

533
00:22:21,589 --> 00:22:25,970
really want to do but but two would be

534
00:22:23,930 --> 00:22:28,190
doable and the reason that two is doable

535
00:22:25,970 --> 00:22:30,650
is because squaring something is easy

536
00:22:28,190 --> 00:22:33,049
right that's just R times R and that's

537
00:22:30,650 --> 00:22:34,850
an easy computation for us to do and the

538
00:22:33,049 --> 00:22:36,500
inverse right because we need both of

539
00:22:34,849 --> 00:22:38,569
these right we need to be able to put it

540
00:22:36,500 --> 00:22:40,490
into the space and out of the space so

541
00:22:38,569 --> 00:22:42,289
we would need to be able to do R times R

542
00:22:40,490 --> 00:22:43,730
which is easy and then we do be able to

543
00:22:42,289 --> 00:22:45,170
do square root of R which used to be

544
00:22:43,730 --> 00:22:46,759
actually pretty tough

545
00:22:45,170 --> 00:22:48,920
but nowadays is a lot easier because

546
00:22:46,759 --> 00:22:51,140
processors actually have accelerated

547
00:22:48,920 --> 00:22:52,460
square root of our pretty well now like

548
00:22:51,140 --> 00:22:54,620
Intel processors actually don't have

549
00:22:52,460 --> 00:22:56,059
that hard of a time computing square

550
00:22:54,619 --> 00:22:58,669
root of R because it gets used a lot in

551
00:22:56,059 --> 00:23:00,289
like normalization right like you've

552
00:22:58,670 --> 00:23:02,870
seen us do it on the stream where we had

553
00:23:00,289 --> 00:23:05,299
to do like ok we have a vector and we

554
00:23:02,869 --> 00:23:06,829
want to know how long it is right it's x

555
00:23:05,299 --> 00:23:08,990
squared plus y squared Square rooted

556
00:23:06,829 --> 00:23:10,309
right so you need that quantity a lot

557
00:23:08,990 --> 00:23:12,440
for normalization or to tell how long

558
00:23:10,309 --> 00:23:13,940
things are and stuff like that so this

559
00:23:12,440 --> 00:23:16,700
ended up getting accelerated quite a bit

560
00:23:13,940 --> 00:23:19,100
so R times R and square root of R things

561
00:23:16,700 --> 00:23:20,299
that we could do pretty quickly and you

562
00:23:19,099 --> 00:23:22,009
know maybe if we're feeling super

563
00:23:20,299 --> 00:23:24,529
motivated to try and get closer to 2.2

564
00:23:22,009 --> 00:23:25,970
we could do some fancy numerical stuff

565
00:23:24,529 --> 00:23:28,549
there and try to do that but at the very

566
00:23:25,970 --> 00:23:30,500
least I said well ok that's not that big

567
00:23:28,549 --> 00:23:31,930
of a deal like we can definitely handle

568
00:23:30,500 --> 00:23:36,890
that

569
00:23:31,930 --> 00:23:40,039
so really all this boils down to is when

570
00:23:36,890 --> 00:23:41,630
the artist has the colors right when

571
00:23:40,039 --> 00:23:43,940
they when they put these colors in there

572
00:23:41,630 --> 00:23:46,250
we need to take them out of this space

573
00:23:43,940 --> 00:23:47,779
by doing the forward operation to put

574
00:23:46,250 --> 00:23:50,359
them into linear space so we need to

575
00:23:47,779 --> 00:23:55,579
basically have right here right

576
00:23:50,359 --> 00:23:57,649
we need srgb to linear right and then

577
00:23:55,579 --> 00:23:59,539
right here after we're done doing all of

578
00:23:57,650 --> 00:24:03,080
our operations we need another thing

579
00:23:59,539 --> 00:24:06,559
which is linear - srgb

580
00:24:03,079 --> 00:24:10,039
right and there's two ways that you

581
00:24:06,559 --> 00:24:12,769
could envision this pipeline and they

582
00:24:10,039 --> 00:24:16,909
make sense in different scenarios right

583
00:24:12,769 --> 00:24:20,539
one way is that the frame buffer itself

584
00:24:16,910 --> 00:24:22,430
is linear okay so meaning remember

585
00:24:20,539 --> 00:24:24,230
what we're doing here is we start with

586
00:24:22,430 --> 00:24:26,720
uh with like a canvas right a blank

587
00:24:24,230 --> 00:24:28,670
screen and we start bleeding stuff on to

588
00:24:26,720 --> 00:24:31,130
it right we've got whatever we got trees

589
00:24:28,670 --> 00:24:32,720
and ground and hero's and whatever we

590
00:24:31,130 --> 00:24:36,820
start bleeding stuff onto it right and

591
00:24:32,720 --> 00:24:40,009
all of these things are in srgb sources

592
00:24:36,819 --> 00:24:42,649
but the question is what is this what is

593
00:24:40,009 --> 00:24:45,019
the frame buffer right because we have

594
00:24:42,650 --> 00:24:48,590
two choices when we pull things from

595
00:24:45,019 --> 00:24:50,420
sRGB to linear we can write that linear

596
00:24:48,589 --> 00:24:52,639
into the frame buffer directly or we can

597
00:24:50,420 --> 00:24:55,640
do the blend on it and then convert it

598
00:24:52,640 --> 00:24:57,770
back to srgb and write the srgb into the

599
00:24:55,640 --> 00:24:59,690
frame buffer so the frame buffer can

600
00:24:57,769 --> 00:25:01,430
either be a linear frame buffer or it

601
00:24:59,690 --> 00:25:04,610
can be an sRGB frame buffer and we have

602
00:25:01,430 --> 00:25:06,259
to decide which we want to use right in

603
00:25:04,609 --> 00:25:09,379
our case because we're a software

604
00:25:06,259 --> 00:25:12,079
renderer and because we're not doing a

605
00:25:09,380 --> 00:25:13,670
lot of 3d constructive stuff we're

606
00:25:12,079 --> 00:25:15,710
taking bitmaps that are mostly finished

607
00:25:13,670 --> 00:25:17,570
art maybe doing a little relighting on

608
00:25:15,710 --> 00:25:20,750
them and then you know bleeding them on

609
00:25:17,569 --> 00:25:22,639
top of each other basically we probably

610
00:25:20,750 --> 00:25:25,099
wouldn't get that much use out of a

611
00:25:22,640 --> 00:25:29,000
linear frame buffer right so we'd only

612
00:25:25,099 --> 00:25:30,919
be talking about the need to sort of if

613
00:25:29,000 --> 00:25:32,089
we were trying to save that conversion

614
00:25:30,920 --> 00:25:34,640
to srgb

615
00:25:32,089 --> 00:25:36,740
right which is to say if we're trying to

616
00:25:34,640 --> 00:25:40,160
save these in and outs so that we only

617
00:25:36,740 --> 00:25:42,799
do the in we only do the srgb to linear

618
00:25:40,160 --> 00:25:44,060
and then we only you know we do all our

619
00:25:42,799 --> 00:25:47,119
blitz on top of each other and then we

620
00:25:44,059 --> 00:25:48,559
only once at the very end take the frame

621
00:25:47,119 --> 00:25:50,809
buffer and when we put it out to the

622
00:25:48,559 --> 00:25:54,079
screen right at the very end we'll

623
00:25:50,809 --> 00:25:56,210
translate it back to srgb right and so

624
00:25:54,079 --> 00:25:57,649
that would save repeated transforms when

625
00:25:56,210 --> 00:25:59,120
things you know overlap each other when

626
00:25:57,650 --> 00:26:01,310
we're drawing on top of each other that

627
00:25:59,119 --> 00:26:02,449
would save a bunch of out transforms

628
00:26:01,309 --> 00:26:06,980
right that would save a bunch of linear

629
00:26:02,450 --> 00:26:09,769
to srgb transfer owns but my assumption

630
00:26:06,980 --> 00:26:11,450
and I could be wrong about this my

631
00:26:09,769 --> 00:26:14,119
assumption is that mostly we're going to

632
00:26:11,450 --> 00:26:15,650
care about bandwidth and in order to

633
00:26:14,119 --> 00:26:18,229
store a linear frame buffer we would

634
00:26:15,650 --> 00:26:20,780
need at least 16 bits per pixel per

635
00:26:18,230 --> 00:26:23,360
channel sorry instead of the 8 bits per

636
00:26:20,779 --> 00:26:25,099
channel that we're using now because 8

637
00:26:23,359 --> 00:26:27,099
bits per channel simply isn't enough to

638
00:26:25,099 --> 00:26:29,750
store linear color without banding and

639
00:26:27,099 --> 00:26:33,079
the reason for that is exactly this up

640
00:26:29,750 --> 00:26:34,250
here right 8 bits are sort of enough to

641
00:26:33,079 --> 00:26:35,839
avoid banding

642
00:26:34,250 --> 00:26:37,220
you are in this curve because it puts

643
00:26:35,839 --> 00:26:39,439
the resolution where the resolution

644
00:26:37,220 --> 00:26:41,509
belongs which is at the bottom end right

645
00:26:39,440 --> 00:26:43,160
but if you were to straighten this out

646
00:26:41,509 --> 00:26:45,170
you would not have enough resolution

647
00:26:43,160 --> 00:26:47,300
down here to prevent banding so you need

648
00:26:45,170 --> 00:26:49,519
to set store more bits of precision in

649
00:26:47,299 --> 00:26:53,389
order to actually prevent the banding

650
00:26:49,519 --> 00:26:54,500
you have to go up to 16 right so I don't

651
00:26:53,390 --> 00:26:57,020
want to do that because that would

652
00:26:54,500 --> 00:26:58,279
double the bandwidth requirements for

653
00:26:57,019 --> 00:27:00,710
our reads and writes to the frame buffer

654
00:26:58,279 --> 00:27:02,029
which I don't want to do right now there

655
00:27:00,710 --> 00:27:02,870
are ways we can get around that there

656
00:27:02,029 --> 00:27:04,279
are lots of other things you could

657
00:27:02,869 --> 00:27:05,659
consider there so if we really thought

658
00:27:04,279 --> 00:27:07,339
for some reason we really needed a

659
00:27:05,660 --> 00:27:08,810
linear frame buffer it's entirely

660
00:27:07,339 --> 00:27:11,359
possible that we could structure our

661
00:27:08,809 --> 00:27:12,740
rasterizer around that but I don't

662
00:27:11,359 --> 00:27:14,929
really think that we need it for

663
00:27:12,740 --> 00:27:18,019
anything so I suspect that what we will

664
00:27:14,930 --> 00:27:20,720
want to do is do the in and out on the

665
00:27:18,019 --> 00:27:22,519
blit because we'll already because we're

666
00:27:20,720 --> 00:27:24,259
soft reservoir try to minimize our

667
00:27:22,519 --> 00:27:26,059
overdraw by doing some intelligent

668
00:27:24,259 --> 00:27:28,069
things probably and so I think that

669
00:27:26,059 --> 00:27:29,839
that's probably just the right way to go

670
00:27:28,069 --> 00:27:31,609
because that'll save on the bandwidth

671
00:27:29,839 --> 00:27:34,129
for us save on the cache solution

672
00:27:31,609 --> 00:27:36,229
there's just less in the mix there and

673
00:27:34,130 --> 00:27:38,870
this should be hopefully relatively

674
00:27:36,230 --> 00:27:42,789
cheap to do that extra half of the in

675
00:27:38,869 --> 00:27:45,589
and out that's the hope anyway right so

676
00:27:42,789 --> 00:27:48,470
yeah so that's basically what we're all

677
00:27:45,589 --> 00:27:52,639
we really have to do you know and like I

678
00:27:48,470 --> 00:27:54,759
said try and maybe if you can take a

679
00:27:52,640 --> 00:27:57,200
look at this this is this is really not

680
00:27:54,759 --> 00:28:01,759
unfortunately this is not kind of what I

681
00:27:57,200 --> 00:28:04,910
had hoped for III I guess I should try

682
00:28:01,759 --> 00:28:07,039
and look for the slides because I don't

683
00:28:04,910 --> 00:28:09,019
know I want to point the slides had more

684
00:28:07,039 --> 00:28:11,089
stuff on them and I was kind of hoping

685
00:28:09,019 --> 00:28:12,410
to point you to that as an extra

686
00:28:11,089 --> 00:28:14,419
resource that I know people usually ask

687
00:28:12,410 --> 00:28:16,400
afterwards if there's a thing they can

688
00:28:14,420 --> 00:28:18,430
read about and there is it's a pretty

689
00:28:16,400 --> 00:28:21,500
good presentation I just don't know

690
00:28:18,430 --> 00:28:24,799
where the actual slides are and I was

691
00:28:21,500 --> 00:28:26,160
kind of hoping that maybe someone would

692
00:28:24,799 --> 00:28:30,548
find them

693
00:28:26,160 --> 00:28:33,429
yeah I don't know so I'll look one more

694
00:28:30,548 --> 00:28:37,269
time is there is there a slides here

695
00:28:33,429 --> 00:28:39,340
they are here here we go let's see here

696
00:28:37,269 --> 00:28:42,099
we go so this is another one maybe snap

697
00:28:39,339 --> 00:28:43,629
this address if you can to take a look

698
00:28:42,099 --> 00:28:45,939
at because yeah see there's a lot more

699
00:28:43,630 --> 00:28:47,830
slides in here - he just had like the

700
00:28:45,940 --> 00:28:49,960
highlights in the other one and he shows

701
00:28:47,829 --> 00:28:52,750
like more examples of things right and

702
00:28:49,960 --> 00:28:55,900
that sort of stuff so I don't know I

703
00:28:52,750 --> 00:28:57,220
just I feel like it's a pretty good way

704
00:28:55,900 --> 00:28:59,019
to kind of get more comfortable with it

705
00:28:57,220 --> 00:29:00,910
to look through this whole thing and he

706
00:28:59,019 --> 00:29:02,769
shows kind of like okay you know how

707
00:29:00,910 --> 00:29:07,480
it's stored and how its output and and

708
00:29:02,769 --> 00:29:12,789
that sort of stuff right so yeah alright

709
00:29:07,480 --> 00:29:16,480
so what we want to do here right is we

710
00:29:12,789 --> 00:29:18,190
essentially want to to mimic and of

711
00:29:16,480 --> 00:29:19,900
course again like I said I'm not a gamma

712
00:29:18,190 --> 00:29:21,070
expert so you always have to take these

713
00:29:19,900 --> 00:29:22,330
with a grain of salt and if I make a

714
00:29:21,069 --> 00:29:25,359
mistake somewhere hopefully someone will

715
00:29:22,329 --> 00:29:26,769
catch me because I I'm not you know the

716
00:29:25,359 --> 00:29:30,428
kind of guy who does a lot of this kind

717
00:29:26,769 --> 00:29:34,089
of graphics programming but what we want

718
00:29:30,429 --> 00:29:36,490
to do is we want to first mimic what the

719
00:29:34,089 --> 00:29:38,859
monitor is doing to make uniform

720
00:29:36,490 --> 00:29:41,589
brightness out of these values right so

721
00:29:38,859 --> 00:29:43,659
if the monitor is doing red to the 2.2

722
00:29:41,589 --> 00:29:45,039
right and we're saying we're gonna do a

723
00:29:43,660 --> 00:29:46,298
simpler version which is red to the -

724
00:29:45,039 --> 00:29:49,480
we're going to pretend that's what it's

725
00:29:46,298 --> 00:29:51,519
doing we want to do red to the 2.2 to

726
00:29:49,480 --> 00:29:53,950
get us out of srgb and put us into

727
00:29:51,519 --> 00:29:55,720
linear space we then do all of our

728
00:29:53,950 --> 00:29:59,950
operations that we need to do with math

729
00:29:55,720 --> 00:30:03,100
there then we do the square root of that

730
00:29:59,950 --> 00:30:04,090
right to get us back to srgb space and

731
00:30:03,099 --> 00:30:07,539
we write that down

732
00:30:04,089 --> 00:30:09,428
okay so it's really really simple for us

733
00:30:07,539 --> 00:30:11,950
to implement this you know sort of not

734
00:30:09,429 --> 00:30:14,470
full srgb but very close kind of

735
00:30:11,950 --> 00:30:16,569
approximation because if we go take our

736
00:30:14,470 --> 00:30:17,798
render group and we look at what we were

737
00:30:16,569 --> 00:30:20,259
already doing with draw rectangles

738
00:30:17,798 --> 00:30:23,048
slowly if we want to come in here and do

739
00:30:20,259 --> 00:30:24,789
that really all we have to do is take

740
00:30:23,048 --> 00:30:28,418
these color values that we were

741
00:30:24,789 --> 00:30:31,539
extracting right ABCD right like that

742
00:30:28,419 --> 00:30:33,400
all we have to do is make a function

743
00:30:31,539 --> 00:30:38,829
that's basically like you know Texel a

744
00:30:33,400 --> 00:30:40,000
equals srgb to linear Texel a right this

745
00:30:38,829 --> 00:30:41,409
is all we really need to do

746
00:30:40,000 --> 00:30:45,190
something that takes them out of here

747
00:30:41,410 --> 00:30:47,500
right kcd so that will turn them into

748
00:30:45,190 --> 00:30:51,880
values that are light linear right so

749
00:30:47,500 --> 00:30:56,410
this is you know go from s srgb to light

750
00:30:51,880 --> 00:30:59,170
linear space or we could call it

751
00:30:56,410 --> 00:31:00,220
brightness linear linear brightness

752
00:30:59,170 --> 00:31:04,269
space I don't know what you want to call

753
00:31:00,220 --> 00:31:05,890
it maybe we should just yeah it's there

754
00:31:04,269 --> 00:31:07,869
are some other little tweaky bits which

755
00:31:05,890 --> 00:31:10,240
is like brightness is kind of a

756
00:31:07,869 --> 00:31:12,459
measurement that combines RG and B and

757
00:31:10,240 --> 00:31:14,470
maybe you could argue this isn't quite

758
00:31:12,460 --> 00:31:16,809
linear brightness but it's at least

759
00:31:14,470 --> 00:31:19,299
gamma corrected right it's so we're not

760
00:31:16,809 --> 00:31:21,279
you know we're not having that gamma

761
00:31:19,299 --> 00:31:24,909
curve in there anymore

762
00:31:21,279 --> 00:31:27,220
so let's call it let's call it linear

763
00:31:24,910 --> 00:31:29,769
brighten his space just to sort of put

764
00:31:27,220 --> 00:31:31,509
some scare quotes around it then we do

765
00:31:29,769 --> 00:31:34,629
all of our math which is assuming that

766
00:31:31,509 --> 00:31:36,819
it's in linear right and then when we

767
00:31:34,630 --> 00:31:38,770
are done with that and we want to write

768
00:31:36,819 --> 00:31:41,519
it out we need to convert them back

769
00:31:38,769 --> 00:31:43,869
right now one thing that's kind of

770
00:31:41,519 --> 00:31:46,980
annoying here is these are not

771
00:31:43,869 --> 00:31:52,839
normalized values these are still 255

772
00:31:46,980 --> 00:31:55,089
you know these are still 255 0 to 255

773
00:31:52,839 --> 00:31:57,639
and presumably if we want to do the

774
00:31:55,089 --> 00:32:00,039
squaring here we would really prefer

775
00:31:57,640 --> 00:32:02,320
them to be in zero to one space so we

776
00:32:00,039 --> 00:32:05,440
probably also want to do the inversion

777
00:32:02,319 --> 00:32:10,269
here so maybe like we want to call this

778
00:32:05,440 --> 00:32:13,529
srgb 255 to linear one right because

779
00:32:10,269 --> 00:32:16,960
we're going from 0 55 to that one right

780
00:32:13,529 --> 00:32:18,789
so we'll do that then what we do is

781
00:32:16,960 --> 00:32:21,160
we'll do our operations in that space

782
00:32:18,789 --> 00:32:23,769
and I believe that if we do it in that

783
00:32:21,160 --> 00:32:26,920
space we can now get rid of some of this

784
00:32:23,769 --> 00:32:30,069
this additional the 255 miss that we

785
00:32:26,920 --> 00:32:32,440
were doing so for example si is actually

786
00:32:30,069 --> 00:32:34,419
just correct now it doesn't need to be

787
00:32:32,440 --> 00:32:38,830
divided by 255 because we're now

788
00:32:34,420 --> 00:32:41,320
actually correcting that our source

789
00:32:38,829 --> 00:32:43,269
pixel when we read that in write R I'm

790
00:32:41,319 --> 00:32:45,789
sorry our desk pixel when we read that

791
00:32:43,269 --> 00:32:47,710
in also has to be corrected if our frame

792
00:32:45,789 --> 00:32:50,649
buffer is in srgb space we need to do

793
00:32:47,710 --> 00:32:52,028
the exact same thing there so if we go

794
00:32:50,650 --> 00:32:55,479
ahead here and do

795
00:32:52,028 --> 00:32:58,598
a desk you know to read that in when we

796
00:32:55,479 --> 00:33:06,929
create that and let's see here that

797
00:32:58,598 --> 00:33:15,778
needs to be rgba see here so we have our

798
00:33:06,929 --> 00:33:27,099
we have G oops G B and a there we go

799
00:33:15,778 --> 00:33:29,648
correct our is 16 so now we need our G B

800
00:33:27,098 --> 00:33:30,329
a there we go sorry got to keep that

801
00:33:29,648 --> 00:33:33,819
correct

802
00:33:30,329 --> 00:33:36,128
RGBA yeah there we go got a Gutterman

803
00:33:33,819 --> 00:33:37,928
love that Intel that sorry not Intel

804
00:33:36,128 --> 00:33:40,058
that window is ordering there all right

805
00:33:37,929 --> 00:33:42,249
so we get that desk fix it pixel in and

806
00:33:40,058 --> 00:33:43,598
now we need to be able to do that as

807
00:33:42,249 --> 00:33:48,848
well so that we put that into linear

808
00:33:43,598 --> 00:33:51,278
space so and then what we want to do is

809
00:33:48,848 --> 00:33:53,439
we want to do all of our other

810
00:33:51,278 --> 00:33:56,169
operations on that now I'm going to go

811
00:33:53,440 --> 00:33:59,048
ahead and actually I'm gonna I'm gonna

812
00:33:56,169 --> 00:34:03,389
actually go ahead and change the SAS RS

813
00:33:59,048 --> 00:34:10,000
GSD stuff here to just be like Texel our

814
00:34:03,388 --> 00:34:14,528
Texel g Texel be and similarly like the

815
00:34:10,000 --> 00:34:21,250
desk here we'll do desk are dest g test

816
00:34:14,528 --> 00:34:23,079
be and so that looks about right now we

817
00:34:21,250 --> 00:34:25,898
actually have to before we write them

818
00:34:23,079 --> 00:34:30,700
out we have to convert them back right

819
00:34:25,898 --> 00:34:33,429
so we have to you know convert this

820
00:34:30,699 --> 00:34:37,689
vector we're going to have to do

821
00:34:33,429 --> 00:34:41,409
something here where we say the the this

822
00:34:37,690 --> 00:34:43,240
like desk 255 or something is linear one

823
00:34:41,409 --> 00:34:46,869
- srgb

824
00:34:43,239 --> 00:34:49,479
255 right and we're gonna have to have

825
00:34:46,869 --> 00:34:52,179
this in some actual space that we can do

826
00:34:49,480 --> 00:34:56,048
here like you know this will actually be

827
00:34:52,179 --> 00:34:58,990
I guess blended maybe this will be

828
00:34:56,048 --> 00:35:01,759
blended 255 these are better names for

829
00:34:58,989 --> 00:35:05,419
these things blended

830
00:35:01,760 --> 00:35:07,190
there we go and so if I go ahead and

831
00:35:05,420 --> 00:35:09,380
make this one now into an aggregate

832
00:35:07,190 --> 00:35:17,889
there's the a so that goes at the end

833
00:35:09,380 --> 00:35:22,519
here's the our G and the B and so that

834
00:35:17,889 --> 00:35:26,599
would give me a more correct pipeline so

835
00:35:22,519 --> 00:35:31,219
this is yeah this is go from s 1 to B 2

836
00:35:26,599 --> 00:35:34,819
linear space this is OK and that is as

837
00:35:31,219 --> 00:35:41,059
well and this is to go from that linear

838
00:35:34,820 --> 00:35:42,289
space back to the srgb space right so

839
00:35:41,059 --> 00:35:44,630
now we actually have to implement those

840
00:35:42,289 --> 00:35:48,230
functions obviously since we don't have

841
00:35:44,630 --> 00:35:53,559
them yet so we got srgb to linear and

842
00:35:48,230 --> 00:35:58,789
oops got a couple bugs here that's an A

843
00:35:53,559 --> 00:36:09,980
and then these guys have to be blended

844
00:35:58,789 --> 00:36:13,460
to 55 a or and B all right so let's go

845
00:36:09,980 --> 00:36:16,460
ahead and actually put these in here so

846
00:36:13,460 --> 00:36:20,590
we've got you know a function that we

847
00:36:16,460 --> 00:36:24,230
want that will turn our our color values

848
00:36:20,590 --> 00:36:29,539
from srgb to d5 to linear and then from

849
00:36:24,230 --> 00:36:32,900
linear to srgb to 55 so in this case

850
00:36:29,539 --> 00:36:36,579
like I said what we want to do is create

851
00:36:32,900 --> 00:36:40,220
a result here that's going to be squared

852
00:36:36,579 --> 00:36:42,170
right just like the monitor would do and

853
00:36:40,219 --> 00:36:44,599
we don't touch the Alpha because the

854
00:36:42,170 --> 00:36:48,710
Alpha is not a brightness value the

855
00:36:44,599 --> 00:36:51,650
Alpha is just you know a very the Alpha

856
00:36:48,710 --> 00:36:53,599
is strictly a value which tells us how

857
00:36:51,650 --> 00:36:55,789
much we want to blend as a percentage

858
00:36:53,599 --> 00:36:57,409
and so we only ever operates in that

859
00:36:55,789 --> 00:36:59,480
linear space anyway so we're just going

860
00:36:57,409 --> 00:37:02,269
to assume at least for the time being

861
00:36:59,480 --> 00:37:05,960
that our inputs are in linearly encoded

862
00:37:02,269 --> 00:37:08,210
alpha although you know who knows really

863
00:37:05,960 --> 00:37:09,800
it's hard to say what alpha is encoded

864
00:37:08,210 --> 00:37:10,298
in depending on what the program it came

865
00:37:09,800 --> 00:37:12,699
out of

866
00:37:10,298 --> 00:37:14,318
you know but it should generally be

867
00:37:12,699 --> 00:37:15,639
considered a linear value like if it's

868
00:37:14,318 --> 00:37:18,579
coverage it would be linear and stuff

869
00:37:15,639 --> 00:37:20,798
like that so our G and D values are

870
00:37:18,579 --> 00:37:24,429
going to be you know just whatever the

871
00:37:20,798 --> 00:37:26,018
input was squared there so trying to

872
00:37:24,429 --> 00:37:28,150
mimic what the monitor is doing with

873
00:37:26,018 --> 00:37:31,629
that curve where it's squaring the curve

874
00:37:28,150 --> 00:37:34,119
right and then when we want to take it

875
00:37:31,630 --> 00:37:38,289
out of that we have to do the inverse of

876
00:37:34,119 --> 00:37:42,219
that right so we have our result our

877
00:37:38,289 --> 00:37:43,569
result R is going to be equal to see

878
00:37:42,219 --> 00:37:49,119
that R Square rooted

879
00:37:43,568 --> 00:37:50,768
all right like so and the a is going to

880
00:37:49,119 --> 00:37:53,709
be a pass through just like it was

881
00:37:50,768 --> 00:37:56,889
before okay and then we return the

882
00:37:53,708 --> 00:38:00,518
result now in this process I said we've

883
00:37:56,889 --> 00:38:02,739
got that 255 in there as well right and

884
00:38:00,518 --> 00:38:04,028
so one thing that we want to do before

885
00:38:02,739 --> 00:38:07,688
we do this and in fact do I have a

886
00:38:04,028 --> 00:38:10,659
squaring function I usually write one I

887
00:38:07,688 --> 00:38:20,639
suspect I did yes we actually should

888
00:38:10,659 --> 00:38:20,639
just write it like this there we go okay

889
00:38:20,880 --> 00:38:31,709
so what we want to do here is we want to

890
00:38:26,528 --> 00:38:34,929
convert this first right to that that

891
00:38:31,708 --> 00:38:38,228
that inverse 255 value right we want to

892
00:38:34,929 --> 00:38:40,059
be able to turn this into a value that's

893
00:38:38,228 --> 00:38:41,558
from zero to one before we square it

894
00:38:40,059 --> 00:38:43,390
right I said that that was going to be

895
00:38:41,559 --> 00:38:46,089
baked into this routine that's why it's

896
00:38:43,389 --> 00:38:48,009
s RGB 255 to linear one right so it does

897
00:38:46,088 --> 00:38:50,739
that and the same is going to be true

898
00:38:48,009 --> 00:38:53,498
here where we want to blow it back out

899
00:38:50,739 --> 00:38:55,358
to that because you know we said that

900
00:38:53,498 --> 00:39:01,928
that was how this is going to work right

901
00:38:55,358 --> 00:39:04,328
and we'll go ahead and do that here

902
00:39:01,929 --> 00:39:07,979
so that way we've got that sort of pre

903
00:39:04,329 --> 00:39:07,979
baked in now I believe

904
00:39:09,539 --> 00:39:13,389
everything should be kosher now but I

905
00:39:12,579 --> 00:39:16,710
kind of made a lot of modifications

906
00:39:13,389 --> 00:39:20,799
there so we may end up with a totally

907
00:39:16,710 --> 00:39:22,929
messed up tree yeah as as as one might

908
00:39:20,800 --> 00:39:26,710
have guessed so let's go ahead and go

909
00:39:22,929 --> 00:39:28,960
through that a little more with a little

910
00:39:26,710 --> 00:39:31,480
bit more of a fine-tooth comb and try to

911
00:39:28,960 --> 00:39:32,980
make sure that everything is kosher and

912
00:39:31,480 --> 00:39:34,869
maybe step through it as well just the

913
00:39:32,980 --> 00:39:37,480
bug all of that so let's make sure that

914
00:39:34,869 --> 00:39:39,279
we've got this stuff working properly so

915
00:39:37,480 --> 00:39:41,740
we want to be able to square our values

916
00:39:39,280 --> 00:39:45,220
that come in our our G's and B's they go

917
00:39:41,739 --> 00:39:46,629
through and we're going to we I said I

918
00:39:45,219 --> 00:39:48,669
wasn't going to spray the Alpha and yet

919
00:39:46,630 --> 00:39:49,840
I did square the Alpha make sure that

920
00:39:48,670 --> 00:39:53,800
doesn't happen okay there we go

921
00:39:49,840 --> 00:39:55,090
so that's fixed so right we don't want

922
00:39:53,800 --> 00:39:56,410
to square the alpha we just want to

923
00:39:55,090 --> 00:39:58,000
square the color values and we want to

924
00:39:56,409 --> 00:40:00,699
square them after they converted didn't

925
00:39:58,000 --> 00:40:01,869
converted to the range 0 to 1 right so

926
00:40:00,699 --> 00:40:04,449
we can do that now we don't necessarily

927
00:40:01,869 --> 00:40:05,799
have that what we could do instead we

928
00:40:04,449 --> 00:40:09,369
could still do everything in two to five

929
00:40:05,800 --> 00:40:10,690
space I suppose it's just I'm guessing

930
00:40:09,369 --> 00:40:11,980
that we since we're gonna have to do

931
00:40:10,690 --> 00:40:13,510
that multiply either way we might as

932
00:40:11,980 --> 00:40:16,329
well do it first what we could do is

933
00:40:13,510 --> 00:40:18,310
square them and then multiply by a by

934
00:40:16,329 --> 00:40:20,319
the inverse of 25 to scale them back

935
00:40:18,309 --> 00:40:23,230
down to 0 to 35 but just seems like you

936
00:40:20,320 --> 00:40:24,820
might as well put them to 255 first that

937
00:40:23,230 --> 00:40:26,619
you can do all your operations in the 0

938
00:40:24,820 --> 00:40:31,930
to 1 range which usually makes it a lot

939
00:40:26,619 --> 00:40:33,639
easier so anyway I also think I can't

940
00:40:31,929 --> 00:40:34,869
remember if there's well no I guess

941
00:40:33,639 --> 00:40:36,159
there might not be any accelerated way

942
00:40:34,869 --> 00:40:37,960
it's a necessity to do that you may just

943
00:40:36,159 --> 00:40:41,799
have to do the same your multiply anyway

944
00:40:37,960 --> 00:40:46,599
so you know off we go that looks okay to

945
00:40:41,800 --> 00:40:48,640
me the result here is doing that sort of

946
00:40:46,599 --> 00:40:51,190
- putting that 255 back in there which

947
00:40:48,639 --> 00:40:52,659
is what we want and it's passing the

948
00:40:51,190 --> 00:40:54,039
Alpha through which is also what we want

949
00:40:52,659 --> 00:40:57,339
because we don't actually want the alpha

950
00:40:54,039 --> 00:41:00,279
to be touched in any way in terms of

951
00:40:57,340 --> 00:41:02,500
modifying there oh that's that's not

952
00:41:00,280 --> 00:41:07,870
right though I still want that in there

953
00:41:02,500 --> 00:41:10,090
oops ok yeah and so let's take a look at

954
00:41:07,869 --> 00:41:13,599
the rest of it here you are rectangles

955
00:41:10,090 --> 00:41:17,250
slowly and we'll go to about 6:15 today

956
00:41:13,599 --> 00:41:17,250
since we started pretty late

957
00:41:18,190 --> 00:41:24,170
where are we alright so we grab our

958
00:41:21,590 --> 00:41:30,350
texels out there is our Texel pointers a

959
00:41:24,170 --> 00:41:31,789
b c and d man we've got to stop I've

960
00:41:30,349 --> 00:41:33,019
gotta stop those assertions they're

961
00:41:31,789 --> 00:41:34,610
killing me so I'm gonna go ahead and

962
00:41:33,019 --> 00:41:36,380
just say that we're not gonna start on

963
00:41:34,610 --> 00:41:39,410
those anymore we proved we didn't fetch

964
00:41:36,380 --> 00:41:41,780
outside the texture so we'll just take

965
00:41:39,409 --> 00:41:44,599
those guys off for now we'll leave on

966
00:41:41,780 --> 00:41:46,990
the asserts for the other stuff all

967
00:41:44,599 --> 00:41:46,989
right there we go

968
00:41:47,619 --> 00:41:56,960
so we read out our Texas textures here

969
00:41:52,909 --> 00:41:59,449
we get our Texel a B C and D exactly we

970
00:41:56,960 --> 00:42:01,760
do before we touch any of that we map if

971
00:41:59,449 --> 00:42:03,500
each of those from the 255 space to the

972
00:42:01,760 --> 00:42:08,420
linear space because they are in the 255

973
00:42:03,500 --> 00:42:11,150
0 to 255 space which which is yes which

974
00:42:08,420 --> 00:42:13,579
needs mapping so we mapped them out we

975
00:42:11,150 --> 00:42:17,119
then do the bilinear blend right between

976
00:42:13,579 --> 00:42:18,440
the texels by by doing just a straight

977
00:42:17,119 --> 00:42:21,799
linear blend we didn't touch any of that

978
00:42:18,440 --> 00:42:23,240
we grabbed the textile ABC out there

979
00:42:21,800 --> 00:42:25,789
although I guess we were saying that

980
00:42:23,239 --> 00:42:28,279
sort of I don't know why we we actually

981
00:42:25,789 --> 00:42:31,670
were doing that let's let's just do plug

982
00:42:28,280 --> 00:42:35,390
this right back in there there we go so

983
00:42:31,670 --> 00:42:38,860
let's see here we grab the texels a

984
00:42:35,389 --> 00:42:41,420
times that color a which is the the

985
00:42:38,860 --> 00:42:42,800
which is that value that we were getting

986
00:42:41,420 --> 00:42:44,960
passed in in case you modulate which

987
00:42:42,800 --> 00:42:46,670
should just be 1.0 at this point

988
00:42:44,960 --> 00:42:49,070
although I guess we don't know what that

989
00:42:46,670 --> 00:42:51,139
color value actually is presumably it's

990
00:42:49,070 --> 00:42:52,760
in its in that space there right color

991
00:42:51,139 --> 00:42:54,799
yeah so those color vials are coming in

992
00:42:52,760 --> 00:42:57,260
in in the 0 to 1 space as well so those

993
00:42:54,800 --> 00:43:00,080
are all fine we grab the desktop by

994
00:42:57,260 --> 00:43:04,160
reading from the pixel into let's see

995
00:43:00,079 --> 00:43:07,400
RGB and a which looks right and then we

996
00:43:04,159 --> 00:43:10,899
need to convert that from srgb to linear

997
00:43:07,400 --> 00:43:15,680
so we do that we then take our

998
00:43:10,900 --> 00:43:18,849
destination alpha which is here and we

999
00:43:15,679 --> 00:43:21,349
compute the inverse of the source alpha

1000
00:43:18,849 --> 00:43:25,159
we multiply the inverse source alpha

1001
00:43:21,349 --> 00:43:27,440
times the dest red we add the Texel red

1002
00:43:25,159 --> 00:43:28,429
that we had sampled same thing with the

1003
00:43:27,440 --> 00:43:31,010
ji

1004
00:43:28,429 --> 00:43:33,139
the B so that's a one that's a inverse

1005
00:43:31,010 --> 00:43:35,390
source alpha one blending mode we then

1006
00:43:33,139 --> 00:43:37,819
compute using RSA and RDA the final

1007
00:43:35,389 --> 00:43:40,609
values so this this is not good though

1008
00:43:37,820 --> 00:43:42,620
this 255 should not be in here right

1009
00:43:40,610 --> 00:43:45,140
that should not be there that was a bad

1010
00:43:42,619 --> 00:43:48,409
that was old get rid of that we then

1011
00:43:45,139 --> 00:43:50,989
convert back to srgb space by taking our

1012
00:43:48,409 --> 00:43:53,599
blended 255 there which should multiply

1013
00:43:50,989 --> 00:43:56,479
by 255 and get our colorist back for us

1014
00:43:53,599 --> 00:44:01,969
and then we go ahead and pack in our a

1015
00:43:56,480 --> 00:44:04,460
and ar-ar-ar-ar-ar G and RB into pixel

1016
00:44:01,969 --> 00:44:07,009
so that seems like it should be

1017
00:44:04,460 --> 00:44:08,840
relatively straightforward I'm assuming

1018
00:44:07,010 --> 00:44:10,940
that we must have some kind of typo

1019
00:44:08,840 --> 00:44:13,519
there so I'm gonna go ahead and just set

1020
00:44:10,940 --> 00:44:16,280
a breakpoint so I can watch and see what

1021
00:44:13,519 --> 00:44:19,909
happens in there and see if I can't spot

1022
00:44:16,280 --> 00:44:23,000
what goes wrong so here we go in the

1023
00:44:19,909 --> 00:44:24,230
routine here and it should be hopefully

1024
00:44:23,000 --> 00:44:26,510
pretty easy to spot what goes wrong

1025
00:44:24,230 --> 00:44:27,920
because I mean it's all black so any

1026
00:44:26,510 --> 00:44:30,530
pixel that's getting computed is

1027
00:44:27,920 --> 00:44:32,990
basically wrong right so let's take a

1028
00:44:30,530 --> 00:44:35,630
look at what our Texel values end up

1029
00:44:32,989 --> 00:44:36,889
actually being right so if we take a

1030
00:44:35,630 --> 00:44:39,980
look at our Texel values they are

1031
00:44:36,889 --> 00:44:42,170
correctly in the range of 0 to 1 so

1032
00:44:39,980 --> 00:44:45,949
that's good and hopefully all of them

1033
00:44:42,170 --> 00:44:50,000
are right that one is as well Texel see

1034
00:44:45,949 --> 00:44:51,980
Texel d right so all of those guys are

1035
00:44:50,000 --> 00:44:53,960
in the range 0 to 1 you can see there so

1036
00:44:51,980 --> 00:44:56,510
so at least we know we're loading them

1037
00:44:53,960 --> 00:45:00,010
in operating on them in in sort of a

1038
00:44:56,510 --> 00:45:04,160
reasonable way for the srgb there is our

1039
00:45:00,010 --> 00:45:06,260
blend our bilinear blend let's take a

1040
00:45:04,159 --> 00:45:09,259
look at what our RSA value is which is

1041
00:45:06,260 --> 00:45:14,060
going to be our our source blend which

1042
00:45:09,260 --> 00:45:18,310
is one so our source is I guess that's

1043
00:45:14,059 --> 00:45:20,750
kind of odd don't you think what why why

1044
00:45:18,309 --> 00:45:22,969
how is that the case hold on a second

1045
00:45:20,750 --> 00:45:25,539
here what is our Texel dot a and our

1046
00:45:22,969 --> 00:45:25,539
Clara dot a

1047
00:45:27,150 --> 00:45:33,280
wait a minute why would our color did we

1048
00:45:31,150 --> 00:45:37,769
really stop on a pixel that has a color

1049
00:45:33,280 --> 00:45:37,769
value of one an alpha value of one

1050
00:45:38,460 --> 00:45:43,090
that's kind of weird don't you think I

1051
00:45:40,980 --> 00:45:45,010
feel like the first pixel that we

1052
00:45:43,090 --> 00:45:46,390
encounter should have an alpha value is

1053
00:45:45,010 --> 00:45:49,300
zero because it's gonna be on an edge

1054
00:45:46,389 --> 00:45:54,519
maybe this isn't the first one let's

1055
00:45:49,300 --> 00:45:56,859
find out why min - Oh 380 oh so this

1056
00:45:54,519 --> 00:45:58,960
isn't let's do let's do it this way I

1057
00:45:56,858 --> 00:46:01,029
want to I want to see somebody who's

1058
00:45:58,960 --> 00:46:04,809
that I want to prove to myself that

1059
00:46:01,030 --> 00:46:08,230
we've got an alpha value of zero at at

1060
00:46:04,809 --> 00:46:10,150
that first pixel that we hit so let's

1061
00:46:08,230 --> 00:46:11,260
take a look here so just to make sure

1062
00:46:10,150 --> 00:46:12,880
although that could have been it just

1063
00:46:11,260 --> 00:46:18,100
the first one that was included I

1064
00:46:12,880 --> 00:46:20,170
suppose all right hey there there we go

1065
00:46:18,099 --> 00:46:21,639
okay so we're all zeros here which is

1066
00:46:20,170 --> 00:46:24,250
good so this should leave the

1067
00:46:21,639 --> 00:46:26,440
destination intact which we know it

1068
00:46:24,250 --> 00:46:29,469
isn't so again we should be able to see

1069
00:46:26,440 --> 00:46:31,990
why it isn't hopefully relatively easily

1070
00:46:29,469 --> 00:46:33,250
our RSA value is zero what is our desk

1071
00:46:31,989 --> 00:46:36,368
look like this is reading out of the

1072
00:46:33,250 --> 00:46:41,469
frame buffer it's that lovely purple

1073
00:46:36,369 --> 00:46:45,490
color I'm not sure why it's how it's at

1074
00:46:41,469 --> 00:46:47,500
that lovely purple color that's a bit

1075
00:46:45,489 --> 00:46:49,599
odd to say the least because it

1076
00:46:47,500 --> 00:46:52,449
shouldn't be that purple color right the

1077
00:46:49,599 --> 00:46:57,039
only time this should be drawing it

1078
00:46:52,449 --> 00:47:00,819
should be drawing on top of valid stuff

1079
00:46:57,039 --> 00:47:02,739
so I guess it's cuz oh the first very

1080
00:47:00,820 --> 00:47:04,000
first frame I guess it wouldn't be

1081
00:47:02,739 --> 00:47:05,889
because we haven't filled our ground

1082
00:47:04,000 --> 00:47:09,099
patches yet so okay I can I can believe

1083
00:47:05,889 --> 00:47:11,769
that for now all right so we do our s

1084
00:47:09,099 --> 00:47:15,219
RGB - linear which again converts those

1085
00:47:11,769 --> 00:47:18,639
to what they should be which is one we

1086
00:47:15,219 --> 00:47:20,769
compute our inverse RSA which is one and

1087
00:47:18,639 --> 00:47:23,139
so that should leave us with basically

1088
00:47:20,769 --> 00:47:25,509
just the dest and nothing getting added

1089
00:47:23,139 --> 00:47:28,210
in right so our blended should basically

1090
00:47:25,510 --> 00:47:29,020
be equal to the destination there so

1091
00:47:28,210 --> 00:47:32,380
there's the desk

1092
00:47:29,019 --> 00:47:35,889
there's the blended and that is exactly

1093
00:47:32,380 --> 00:47:37,358
what they should be looks like and then

1094
00:47:35,889 --> 00:47:40,328
we're going to do our linear

1095
00:47:37,358 --> 00:47:43,328
RGB conversion and so that should give

1096
00:47:40,329 --> 00:47:47,559
us values in the range of 0 to 55 and it

1097
00:47:43,329 --> 00:47:49,869
totally did not so what got messed up

1098
00:47:47,559 --> 00:47:55,089
there what is the problem

1099
00:47:49,869 --> 00:47:57,369
ah well that serves me right for being

1100
00:47:55,088 --> 00:47:58,298
hasty you can see what the problem is

1101
00:47:57,369 --> 00:48:00,970
here

1102
00:47:58,298 --> 00:48:04,028
I wanted to square root them before I

1103
00:48:00,969 --> 00:48:05,949
multiply them by 255 but I actually was

1104
00:48:04,028 --> 00:48:08,318
multiplying by 25 first because I just

1105
00:48:05,949 --> 00:48:10,778
kind of like mindlessly typing that in

1106
00:48:08,318 --> 00:48:14,259
so that's no good definitely not good

1107
00:48:10,778 --> 00:48:17,768
that may be our only book let's find out

1108
00:48:14,259 --> 00:48:22,059
we don't really know they'll find out so

1109
00:48:17,768 --> 00:48:25,088
there is our tree you can now see in all

1110
00:48:22,059 --> 00:48:28,180
its gamma collect corrected glory our

1111
00:48:25,088 --> 00:48:30,038
tree sort of rotating around there of

1112
00:48:28,179 --> 00:48:31,629
course we don't really have any good

1113
00:48:30,039 --> 00:48:34,450
tests at the moment to test whether

1114
00:48:31,630 --> 00:48:35,920
we're gamma correcting properly so I

1115
00:48:34,449 --> 00:48:37,929
guess I don't know for sure that we

1116
00:48:35,920 --> 00:48:40,269
actually are but we are at least going

1117
00:48:37,929 --> 00:48:42,969
through the correct pipeline now we're

1118
00:48:40,268 --> 00:48:45,368
actually doing sort of the math into the

1119
00:48:42,969 --> 00:48:48,998
space and the map out of the space so

1120
00:48:45,369 --> 00:48:51,489
you know at the very least Juan will not

1121
00:48:48,998 --> 00:48:53,078
have to lose any sleep over it but again

1122
00:48:51,489 --> 00:48:54,699
like I said it's not the kind of thing

1123
00:48:53,079 --> 00:48:58,690
that I've ever really seen a difference

1124
00:48:54,699 --> 00:49:00,909
for in 2d sprite composition I've even

1125
00:48:58,690 --> 00:49:02,499
seen demos where people say that it

1126
00:49:00,909 --> 00:49:05,798
makes a difference and I didn't see the

1127
00:49:02,498 --> 00:49:11,558
difference so I'm not anticipating this

1128
00:49:05,798 --> 00:49:14,559
really doing anything for us you know I

1129
00:49:11,559 --> 00:49:17,739
I'm sorry I apologize to people like I

1130
00:49:14,559 --> 00:49:20,650
totally for HDR and 3d rendering stuff

1131
00:49:17,739 --> 00:49:22,630
I'm totally on board with the gamma it

1132
00:49:20,650 --> 00:49:26,380
definitely works and it's definitely

1133
00:49:22,630 --> 00:49:28,720
important but it's for 2d compositing

1134
00:49:26,380 --> 00:49:33,400
stuff I've just never seen the effect

1135
00:49:28,719 --> 00:49:34,838
and so you know I mean the only place

1136
00:49:33,400 --> 00:49:38,259
you're gonna see it is where we're

1137
00:49:34,838 --> 00:49:41,170
actually doing blends between relatively

1138
00:49:38,259 --> 00:49:43,269
disparate colors and you know I don't

1139
00:49:41,170 --> 00:49:44,769
know so again we may not have done it

1140
00:49:43,268 --> 00:49:47,169
quite correctly maybe we've got a bug in

1141
00:49:44,768 --> 00:49:48,399
there but even so it's just like you

1142
00:49:47,170 --> 00:49:49,000
know I don't know that there is that

1143
00:49:48,400 --> 00:49:51,099
much wrong

1144
00:49:49,000 --> 00:49:53,949
the original way to begin with anyway so

1145
00:49:51,099 --> 00:49:55,599
I'm not sure you know but there's really

1146
00:49:53,949 --> 00:49:57,279
all that much to get excited about what

1147
00:49:55,599 --> 00:49:58,809
we could do is we could have a little

1148
00:49:57,280 --> 00:50:02,440
toggle that allows us to switch it on

1149
00:49:58,809 --> 00:50:04,299
and off potentially and maybe see if it

1150
00:50:02,440 --> 00:50:06,730
makes a difference I don't know but

1151
00:50:04,300 --> 00:50:09,430
again not really expecting much out of

1152
00:50:06,730 --> 00:50:11,710
it but anyway that is the Gama and you

1153
00:50:09,429 --> 00:50:13,989
do want to know this it is good I mean

1154
00:50:11,710 --> 00:50:15,429
one is correct I should show it because

1155
00:50:13,989 --> 00:50:18,039
it's something you do need to know when

1156
00:50:15,429 --> 00:50:19,629
you start to do some more fancier

1157
00:50:18,039 --> 00:50:21,190
effects that you know maybe you don't do

1158
00:50:19,630 --> 00:50:23,829
as much in 2d stuff but that you would

1159
00:50:21,190 --> 00:50:24,940
do in 3d it's important and so now we've

1160
00:50:23,829 --> 00:50:27,460
got it out of the way at least we know

1161
00:50:24,940 --> 00:50:28,929
it's in there we can make sure our you

1162
00:50:27,460 --> 00:50:32,230
know our pipeline handles it well enough

1163
00:50:28,929 --> 00:50:33,639
and so so there you go we'll have to

1164
00:50:32,230 --> 00:50:34,900
talk about how we're gonna optimize that

1165
00:50:33,639 --> 00:50:36,009
when we get to the optimization stuff

1166
00:50:34,900 --> 00:50:37,660
because now we've got to deal with a

1167
00:50:36,010 --> 00:50:38,920
square root in there but it's like I

1168
00:50:37,659 --> 00:50:41,348
said it's not that big of a deal to

1169
00:50:38,920 --> 00:50:43,030
handle a square root nowadays it used to

1170
00:50:41,349 --> 00:50:47,740
be a big deal but it's not so much

1171
00:50:43,030 --> 00:50:49,720
anymore so that's really it I guess we

1172
00:50:47,739 --> 00:50:51,819
won't even need the extra time that I

1173
00:50:49,719 --> 00:50:53,949
said that I would take but that's really

1174
00:50:51,820 --> 00:50:55,510
all there is to it that's that's that's

1175
00:50:53,949 --> 00:50:59,949
the majority of it so we pretty much

1176
00:50:55,510 --> 00:51:02,349
just have have to do that slight bit of

1177
00:50:59,949 --> 00:51:03,699
work and then we're good now I wasn't

1178
00:51:02,349 --> 00:51:04,960
what maybe what I'll throw in at the end

1179
00:51:03,699 --> 00:51:07,960
here since we do have about 10 minutes

1180
00:51:04,960 --> 00:51:09,880
before before our hour is up what I

1181
00:51:07,960 --> 00:51:12,130
might do is let's go ahead and take that

1182
00:51:09,880 --> 00:51:16,930
color value that's getting passed in

1183
00:51:12,130 --> 00:51:19,720
here and actually use it so draw would

1184
00:51:16,929 --> 00:51:21,669
call it draw a rectangle slowly what I'd

1185
00:51:19,719 --> 00:51:25,000
like to do is say okay when we pass this

1186
00:51:21,670 --> 00:51:27,369
color value here that's not the color

1187
00:51:25,000 --> 00:51:29,619
value sorry when we passed this color

1188
00:51:27,369 --> 00:51:33,970
value here let's actually start using

1189
00:51:29,619 --> 00:51:36,280
that right so what we can do is we can

1190
00:51:33,969 --> 00:51:38,108
do sort of a modulation of the color

1191
00:51:36,280 --> 00:51:39,310
right we can multiply the color values

1192
00:51:38,108 --> 00:51:41,500
that come in with the color values that

1193
00:51:39,309 --> 00:51:43,719
we're reading to tint whatever it is

1194
00:51:41,500 --> 00:51:45,369
that we want so for example right you

1195
00:51:43,719 --> 00:51:47,889
know if I have something this is pretty

1196
00:51:45,369 --> 00:51:50,740
straightforward right but if I have a

1197
00:51:47,889 --> 00:51:54,940
certain amount you know if I have the r

1198
00:51:50,739 --> 00:51:57,639
g and b of the Texel right that's coming

1199
00:51:54,940 --> 00:52:01,150
in if i want to tint this I can

1200
00:51:57,639 --> 00:52:02,400
introduce coefficients like CR C G and C

1201
00:52:01,150 --> 00:52:04,858
be right that multiply

1202
00:52:02,400 --> 00:52:06,990
these values and if those coefficients

1203
00:52:04,858 --> 00:52:09,750
are 0 to 1 I can control how much blue

1204
00:52:06,989 --> 00:52:11,939
how much green and how much red I read

1205
00:52:09,750 --> 00:52:13,679
out of the texture map right so it's

1206
00:52:11,940 --> 00:52:15,298
pretty free for us to add a thing that

1207
00:52:13,679 --> 00:52:17,068
allows us into our texture maps by just

1208
00:52:15,298 --> 00:52:19,139
allowing this color that we were passing

1209
00:52:17,068 --> 00:52:21,449
in to draw the rectangle with as a solid

1210
00:52:19,139 --> 00:52:22,769
color before we can just use that to

1211
00:52:21,449 --> 00:52:26,730
actually just multiply the colors that

1212
00:52:22,769 --> 00:52:29,068
they come in right it's really really

1213
00:52:26,730 --> 00:52:30,510
straightforward for us to to be able to

1214
00:52:29,068 --> 00:52:32,278
implement something like that all we

1215
00:52:30,510 --> 00:52:35,010
would have to do is introduce here a

1216
00:52:32,278 --> 00:52:37,409
place where we multiply you know the

1217
00:52:35,010 --> 00:52:39,359
color values together right like so

1218
00:52:37,409 --> 00:52:43,528
because we're already multiplying in our

1219
00:52:39,358 --> 00:52:45,598
RSA we are already multiplying oops

1220
00:52:43,528 --> 00:52:48,989
that's the desk sorry we're already

1221
00:52:45,599 --> 00:52:50,880
multiplying by that color alpha value so

1222
00:52:48,989 --> 00:52:52,019
we're already doing something where

1223
00:52:50,880 --> 00:52:53,818
we're taking into account the pre

1224
00:52:52,019 --> 00:52:56,818
multiplication of it so all we really

1225
00:52:53,818 --> 00:52:58,469
have to do here is just multiply the

1226
00:52:56,818 --> 00:53:02,099
color values that we read out of the

1227
00:52:58,469 --> 00:53:04,919
Texel by those colors that are input and

1228
00:53:02,099 --> 00:53:08,940
then we content right or at least we

1229
00:53:04,920 --> 00:53:11,059
should be able to send tint so if you

1230
00:53:08,940 --> 00:53:15,028
take a look at what happens there right

1231
00:53:11,059 --> 00:53:17,250
where we've got our tree get our tree up

1232
00:53:15,028 --> 00:53:23,789
there and then I'm gonna go ahead and

1233
00:53:17,250 --> 00:53:26,219
and allow ourselves to sort of do it the

1234
00:53:23,789 --> 00:53:29,849
live code editing that we that we so

1235
00:53:26,219 --> 00:53:32,338
love here on the show so if I do that

1236
00:53:29,849 --> 00:53:34,289
coordinate system thing here where we're

1237
00:53:32,338 --> 00:53:35,909
passing that color I'm gonna go ahead

1238
00:53:34,289 --> 00:53:37,829
and pull that color out into something

1239
00:53:35,909 --> 00:53:40,379
that we can see a little bit more

1240
00:53:37,829 --> 00:53:43,829
directly so here it is alright there's

1241
00:53:40,380 --> 00:53:46,829
the color there it is so you can see

1242
00:53:43,829 --> 00:53:49,318
we've got some kind of crazy stuff in

1243
00:53:46,829 --> 00:53:51,599
here with still an alpha of one point

1244
00:53:49,318 --> 00:53:53,639
now so if I go ahead and compile that we

1245
00:53:51,599 --> 00:53:56,609
can now play around with this pretty

1246
00:53:53,639 --> 00:53:59,129
easily we could call this color angle

1247
00:53:56,608 --> 00:54:02,880
and we could make sure that it oscillate

1248
00:53:59,130 --> 00:54:07,048
s' a lot more frequently like maybe that

1249
00:54:02,880 --> 00:54:09,329
is you know 5.0 times the angle instead

1250
00:54:07,048 --> 00:54:11,460
of so just you know it cycles much more

1251
00:54:09,329 --> 00:54:14,849
frequently and there you can kind of see

1252
00:54:11,460 --> 00:54:16,170
right a much sort of clearer

1253
00:54:14,849 --> 00:54:18,780
demonstration

1254
00:54:16,170 --> 00:54:20,400
of tinting those textures right like so

1255
00:54:18,780 --> 00:54:22,650
we can just put a modulation in there

1256
00:54:20,400 --> 00:54:24,300
it's pretty much free it allows us to

1257
00:54:22,650 --> 00:54:25,920
kind of play with the RG and B values

1258
00:54:24,300 --> 00:54:28,500
after the fact which will probably be

1259
00:54:25,920 --> 00:54:30,329
something that we'll want to use if not

1260
00:54:28,500 --> 00:54:31,590
for normal stuff although you know a lot

1261
00:54:30,329 --> 00:54:33,269
of times you do use tinting like that

1262
00:54:31,590 --> 00:54:34,500
for normal stuff if not for normal

1263
00:54:33,269 --> 00:54:35,849
circumstances that their very least for

1264
00:54:34,500 --> 00:54:38,190
like special effects that kind of things

1265
00:54:35,849 --> 00:54:40,289
maybe where we have sort of like sprites

1266
00:54:38,190 --> 00:54:42,240
that want to be like you know bullets or

1267
00:54:40,289 --> 00:54:43,860
special effects that want to get tinted

1268
00:54:42,239 --> 00:54:45,509
certain colors to depend on what the

1269
00:54:43,860 --> 00:54:47,789
effect is you know that's a pretty cheap

1270
00:54:45,510 --> 00:54:49,950
way again to get more out of your art

1271
00:54:47,789 --> 00:54:51,480
thereby allowing them to be kind of

1272
00:54:49,949 --> 00:54:53,069
freely tempted and again that's an easy

1273
00:54:51,480 --> 00:54:54,179
thing to do the hardware does that as

1274
00:54:53,070 --> 00:54:55,590
well so you know it would translate

1275
00:54:54,179 --> 00:54:58,859
directly over to OpenGL and all that

1276
00:54:55,590 --> 00:55:00,809
sort of stuff so again that's pretty

1277
00:54:58,860 --> 00:55:02,400
easy thing we can throw in there and

1278
00:55:00,809 --> 00:55:04,079
then wow we've still got five minutes

1279
00:55:02,400 --> 00:55:06,000
left so I don't really know I guess

1280
00:55:04,079 --> 00:55:08,099
we'll just go to the QA because I don't

1281
00:55:06,000 --> 00:55:09,599
have really anything else short that I

1282
00:55:08,099 --> 00:55:12,389
want to start talking about at the

1283
00:55:09,599 --> 00:55:13,980
moment but that's pretty much that's

1284
00:55:12,389 --> 00:55:18,900
pretty much it for the gamma and the

1285
00:55:13,980 --> 00:55:21,119
color stuff I could also I guess very if

1286
00:55:18,900 --> 00:55:23,490
I if I throw in here the Alpha value I

1287
00:55:21,119 --> 00:55:25,710
could I could sort of vary the

1288
00:55:23,489 --> 00:55:29,519
transparency of it and we could see if

1289
00:55:25,710 --> 00:55:37,769
that works at all that that seems to be

1290
00:55:29,519 --> 00:55:39,929
working yeah looks like it now of course

1291
00:55:37,769 --> 00:55:42,059
one thing that I guess we didn't do is

1292
00:55:39,929 --> 00:55:46,049
we're not pre multiplying that alpha

1293
00:55:42,059 --> 00:55:48,150
properly so if we change here's the

1294
00:55:46,050 --> 00:55:49,590
thing I was thinking right we're

1295
00:55:48,150 --> 00:55:51,360
handling the preap we're handling the

1296
00:55:49,590 --> 00:55:55,289
Alpha by multiplying the Alpha by the

1297
00:55:51,360 --> 00:55:58,140
Texel egg so our destination we will use

1298
00:55:55,289 --> 00:56:00,539
less of the destination as this goes to

1299
00:55:58,139 --> 00:56:04,500
zero right so it can it can fade out our

1300
00:56:00,539 --> 00:56:08,550
sprite but really these values don't go

1301
00:56:04,500 --> 00:56:10,619
to zero I'm sorry it uses less of the

1302
00:56:08,550 --> 00:56:12,480
value because it's inverted uses less of

1303
00:56:10,619 --> 00:56:15,179
the value as this goes to 1.0 if the

1304
00:56:12,480 --> 00:56:16,980
Texel was one point out right but these

1305
00:56:15,179 --> 00:56:18,509
colors here are supposed to be pre

1306
00:56:16,980 --> 00:56:20,610
multiplied by alpha because we just add

1307
00:56:18,510 --> 00:56:22,670
them straight in right if you remember

1308
00:56:20,610 --> 00:56:25,260
when we talked about premultiplied alpha

1309
00:56:22,670 --> 00:56:26,070
and maybe I can maybe I'll use the ring

1310
00:56:25,260 --> 00:56:28,110
for a minutes to talk a little more

1311
00:56:26,070 --> 00:56:29,789
about that these really want to be

1312
00:56:28,110 --> 00:56:32,579
multiplied by that color a as

1313
00:56:29,789 --> 00:56:36,059
well right because they have not been

1314
00:56:32,579 --> 00:56:39,420
yet so really this should in fact be in

1315
00:56:36,059 --> 00:56:43,619
here like so in order to get the correct

1316
00:56:39,420 --> 00:56:47,970
equation for the blending so now we're

1317
00:56:43,619 --> 00:56:52,650
good now we're now we're blending

1318
00:56:47,969 --> 00:56:56,909
correctly all right at least I believe

1319
00:56:52,650 --> 00:56:58,950
we are that is a weird that is a really

1320
00:56:56,909 --> 00:57:03,379
weird tree let me go ahead and make that

1321
00:56:58,949 --> 00:57:03,379
oscillate a little bit more quickly

1322
00:57:03,920 --> 00:57:07,159
there we go

1323
00:57:08,639 --> 00:57:12,509
so anyway let me briefly mention what I

1324
00:57:10,858 --> 00:57:14,759
did there just so that people understand

1325
00:57:12,510 --> 00:57:17,280
it so what we were doing is we were

1326
00:57:14,760 --> 00:57:19,530
doing premultiplied alpha and I talked

1327
00:57:17,280 --> 00:57:21,560
about the importance of that which is

1328
00:57:19,530 --> 00:57:24,269
basically because much like the gamma

1329
00:57:21,559 --> 00:57:26,608
premultiplied alpha is the only kind of

1330
00:57:24,269 --> 00:57:28,469
alpha that properly works through linear

1331
00:57:26,608 --> 00:57:30,090
blends right so when you're doing linear

1332
00:57:28,469 --> 00:57:31,529
blends and stuff you need to be

1333
00:57:30,090 --> 00:57:33,329
premultiplied alpha because post

1334
00:57:31,530 --> 00:57:35,220
multiplied alpha or non P multiplied

1335
00:57:33,329 --> 00:57:36,690
alpha it's not pre multiplied I'm not

1336
00:57:35,219 --> 00:57:38,819
post multiply but non people applied

1337
00:57:36,690 --> 00:57:40,740
alpha does not actually work as we

1338
00:57:38,820 --> 00:57:42,480
talked about before so what was

1339
00:57:40,739 --> 00:57:44,939
happening there is we have an equation

1340
00:57:42,480 --> 00:57:48,920
right for like each of our channels

1341
00:57:44,940 --> 00:57:53,420
which was you know one minus the alpha

1342
00:57:48,920 --> 00:57:55,590
times the dest right plus the source

1343
00:57:53,420 --> 00:57:57,630
because we're assuming that the source

1344
00:57:55,590 --> 00:58:02,460
is already multiplied by the Alpha this

1345
00:57:57,630 --> 00:58:06,090
is this equation 1 minus a D plus a s

1346
00:58:02,460 --> 00:58:08,820
right assuming that the a s was already

1347
00:58:06,090 --> 00:58:10,980
collapsed into the S right now so it's

1348
00:58:08,820 --> 00:58:16,019
really s prime right it's like s prime

1349
00:58:10,980 --> 00:58:18,240
equals a s and so when we added another

1350
00:58:16,019 --> 00:58:20,070
color in there if I was to take that

1351
00:58:18,239 --> 00:58:20,368
other color we had we had modulated in

1352
00:58:20,070 --> 00:58:22,980
there

1353
00:58:20,369 --> 00:58:25,710
well we essentially didn't take into

1354
00:58:22,980 --> 00:58:27,960
account the alpha of that color that

1355
00:58:25,710 --> 00:58:29,909
second color that we were doing so we

1356
00:58:27,960 --> 00:58:35,389
had what I had written inadvertently was

1357
00:58:29,909 --> 00:58:38,759
one - a d you know plus si s prime B

1358
00:58:35,389 --> 00:58:41,579
where the the color that came out of the

1359
00:58:38,760 --> 00:58:43,589
texture right this is the Texel that was

1360
00:58:41,579 --> 00:58:46,980
pre multiplied but the color that came

1361
00:58:43,588 --> 00:58:48,329
from the function was not and so when

1362
00:58:46,980 --> 00:58:49,530
you multiply something that's non pre

1363
00:58:48,329 --> 00:58:51,269
multiplied by something that is P

1364
00:58:49,530 --> 00:58:54,599
multiplied you get like a half-and-half

1365
00:58:51,269 --> 00:58:57,599
result right so what I actually wanted

1366
00:58:54,599 --> 00:59:00,720
to do was make this S prime a right I

1367
00:58:57,599 --> 00:59:05,130
wanted to multiply the source color by

1368
00:59:00,719 --> 00:59:06,838
its own alpha first right and so that's

1369
00:59:05,130 --> 00:59:08,608
all I did to make sure that all of the

1370
00:59:06,838 --> 00:59:11,400
alphas were pre multiplied in the

1371
00:59:08,608 --> 00:59:16,759
pipeline alright with that

1372
00:59:11,400 --> 00:59:16,760
I think we can go ahead and go to the QA

1373
00:59:23,028 --> 00:59:26,268
there we go

1374
00:59:36,679 --> 00:59:43,549
what would be the visual artifact of

1375
00:59:38,969 --> 00:59:43,549
using two instead of 2.2 for the gamma

1376
00:59:44,690 --> 00:59:49,230
so the answer is nothing for what we're

1377
00:59:47,670 --> 00:59:49,800
doing because there isn't even a visual

1378
00:59:49,230 --> 00:59:52,139
artifact

1379
00:59:49,800 --> 00:59:53,760
for not doing the game as all at all as

1380
00:59:52,139 --> 00:59:57,139
you saw

1381
00:59:53,760 --> 01:00:01,770
so really the reason it's it's basically

1382
00:59:57,139 --> 01:00:04,679
hmm if you look at this curve right so

1383
01:00:01,769 --> 01:00:08,159
you know here's the actual curve right

1384
01:00:04,679 --> 01:00:13,949
this is the 2.2 curve right and here's

1385
01:00:08,159 --> 01:00:17,129
the 2.0 curve right those are the two

1386
01:00:13,949 --> 01:00:21,659
curves let's say here's one and here's

1387
01:00:17,130 --> 01:00:26,760
zero right and here's you know max

1388
01:00:21,659 --> 01:00:28,859
brightness or something and I guess that

1389
01:00:26,760 --> 01:00:30,900
they both cross at one because of the

1390
01:00:28,860 --> 01:00:33,360
properties of raising things to powers

1391
01:00:30,900 --> 01:00:36,300
so that's not quite accurate there so

1392
01:00:33,360 --> 01:00:43,500
let me go ahead and kind of fix that a

1393
01:00:36,300 --> 01:00:45,450
little bit right so basically the only

1394
01:00:43,500 --> 01:00:47,489
visual artifact is things are a little

1395
01:00:45,449 --> 01:00:50,549
bit darker than they should be if you're

1396
01:00:47,489 --> 01:00:52,500
using the 2.0 instead of the 2.2 right

1397
01:00:50,550 --> 01:00:56,280
because when you bringing those things

1398
01:00:52,500 --> 01:00:59,219
up to linear you're you're not quite

1399
01:00:56,280 --> 01:01:00,840
getting them you're not quite pulling

1400
01:00:59,219 --> 01:01:03,359
them back to exactly linear you're

1401
01:01:00,840 --> 01:01:06,329
pulling them back to almost linear so

1402
01:01:03,360 --> 01:01:11,880
you know I don't even know if you

1403
01:01:06,329 --> 01:01:15,420
could perceive that difference to be

1404
01:01:11,880 --> 01:01:16,980
honest with you I don't know but I I

1405
01:01:15,420 --> 01:01:19,250
would suspect that it would be a very

1406
01:01:16,980 --> 01:01:24,289
small difference in most circumstances

1407
01:01:19,250 --> 01:01:24,289
if there was one so it's not a huge deal

1408
01:01:28,030 --> 01:01:31,910
garlanded loom says also need to do

1409
01:01:30,139 --> 01:01:33,739
additive color tinting for full

1410
01:01:31,909 --> 01:01:41,480
expressiveness

1411
01:01:33,739 --> 01:01:43,519
well garland Oh bloom that is is one of

1412
01:01:41,480 --> 01:01:45,289
well I guess if you want additive like

1413
01:01:43,519 --> 01:01:49,090
so you want to be able to add in red

1414
01:01:45,289 --> 01:01:51,829
where there wasn't red before basically

1415
01:01:49,090 --> 01:01:55,280
so there's a plus there's a there's an

1416
01:01:51,829 --> 01:01:59,719
addition in that I don't know how I feel

1417
01:01:55,280 --> 01:02:01,580
about that I mean how would you well

1418
01:01:59,719 --> 01:02:04,929
alright I mean maybe well think about it

1419
01:02:01,579 --> 01:02:04,929
we'll think about it

1420
01:02:11,159 --> 01:02:15,659
I have a CS background but I'm two

1421
01:02:13,710 --> 01:02:17,579
months behind on coding this it is much

1422
01:02:15,659 --> 01:02:19,769
easier to follow when I'm not trying to

1423
01:02:17,579 --> 01:02:21,509
type myself how detrimental would it be

1424
01:02:19,769 --> 01:02:24,059
to my understanding to watch and just

1425
01:02:21,510 --> 01:02:25,440
stop coding if I get too far behind

1426
01:02:24,059 --> 01:02:27,389
sometimes when you're moving things

1427
01:02:25,440 --> 01:02:31,409
around I have to watch that bit two to

1428
01:02:27,389 --> 01:02:32,460
three times I don't know it's a good

1429
01:02:31,409 --> 01:02:33,809
question

1430
01:02:32,460 --> 01:02:35,730
but I don't know the answer to that

1431
01:02:33,809 --> 01:02:37,440
question I mean one of the problems is

1432
01:02:35,730 --> 01:02:39,929
that if you don't do things you tend to

1433
01:02:37,440 --> 01:02:42,900
not really learn them so I would say

1434
01:02:39,929 --> 01:02:45,899
it's probably not a great idea to not

1435
01:02:42,900 --> 01:02:47,369
try to actually do the code because

1436
01:02:45,900 --> 01:02:49,740
remember there's no such thing as

1437
01:02:47,369 --> 01:02:51,659
keeping up with handmade hero it's a

1438
01:02:49,739 --> 01:02:52,859
video series it's gonna last a fixed

1439
01:02:51,659 --> 01:02:54,960
number of hours I don't know how many

1440
01:02:52,860 --> 01:02:56,970
that's gonna be five six hundred

1441
01:02:54,960 --> 01:03:00,090
something like that and that's gonna be

1442
01:02:56,969 --> 01:03:02,039
over and so you will have your entire

1443
01:03:00,090 --> 01:03:05,130
life to catch up with it if you want to

1444
01:03:02,039 --> 01:03:07,050
you don't have to stay up to date in any

1445
01:03:05,130 --> 01:03:08,670
kind of you know real sense so I would

1446
01:03:07,050 --> 01:03:11,190
say just take it at your own pace and

1447
01:03:08,670 --> 01:03:13,170
don't worry too much about being up to

1448
01:03:11,190 --> 01:03:15,030
date you can always ask questions on the

1449
01:03:13,170 --> 01:03:20,789
forums you don't have to ask questions

1450
01:03:15,030 --> 01:03:22,320
live would it be worth only using gamma

1451
01:03:20,789 --> 01:03:25,199
correction on texels that have an alpha

1452
01:03:22,320 --> 01:03:27,240
not equal to zero or one so technically

1453
01:03:25,199 --> 01:03:29,789
no because we're doing a bilinear blend

1454
01:03:27,239 --> 01:03:31,859
between texels so technically those

1455
01:03:29,789 --> 01:03:34,619
texels want to all be gamma corrected as

1456
01:03:31,860 --> 01:03:37,730
well so that bilinear blend will work so

1457
01:03:34,619 --> 01:03:40,559
you know we're doing this for one and so

1458
01:03:37,730 --> 01:03:42,090
you know maybe we'll just have it so you

1459
01:03:40,559 --> 01:03:44,250
can compile out the gamma correction if

1460
01:03:42,090 --> 01:03:46,430
this if it actually makes a different

1461
01:03:44,250 --> 01:03:51,170
speed wise when we actually profile it

1462
01:03:46,429 --> 01:03:51,169
but you know we put it in there for now

1463
01:03:53,010 --> 01:04:09,160
okay robot chocolate Dino says could we

1464
01:04:00,338 --> 01:04:11,829
do our maths in sRGB space so you you

1465
01:04:09,159 --> 01:04:13,598
the answer is you could but if you were

1466
01:04:11,829 --> 01:04:15,239
going to do the minister jaysis they'd

1467
01:04:13,599 --> 01:04:21,480
look like a bunch of power functions

1468
01:04:15,239 --> 01:04:24,669
right because your linear blend is now

1469
01:04:21,480 --> 01:04:29,320
like the definition of your linear blend

1470
01:04:24,670 --> 01:04:31,809
is actually right because okay so here's

1471
01:04:29,320 --> 01:04:38,099
our current lerp our current lerp for a

1472
01:04:31,809 --> 01:04:42,449
tea B right is 1 minus T a plus T B

1473
01:04:38,099 --> 01:04:44,830
right that's what we're currently doing

1474
01:04:42,449 --> 01:04:48,608
if you wanted to make a linear

1475
01:04:44,829 --> 01:04:49,630
interpolant in srgb space well we know

1476
01:04:48,608 --> 01:04:54,940
what it actually is

1477
01:04:49,630 --> 01:04:57,369
it is this function it is the with our

1478
01:04:54,940 --> 01:05:05,650
approximation it is the square root of 1

1479
01:04:57,369 --> 01:05:14,019
minus T a squared plus M plus T B

1480
01:05:05,650 --> 01:05:15,849
squared right so you know I I mean you

1481
01:05:14,019 --> 01:05:18,849
could write your lips that way always

1482
01:05:15,849 --> 01:05:20,080
where you square a and you square B you

1483
01:05:18,849 --> 01:05:23,080
do the blender than a square root them

1484
01:05:20,079 --> 01:05:25,929
but it just would be way less efficient

1485
01:05:23,079 --> 01:05:28,690
to always do the math this way instead

1486
01:05:25,929 --> 01:05:30,639
of doing it just once at the top to get

1487
01:05:28,690 --> 01:05:32,230
that squaring and then once at the end

1488
01:05:30,639 --> 01:05:36,338
to do the square root you know what I

1489
01:05:32,230 --> 01:05:37,990
mean so it just doesn't seem like you'd

1490
01:05:36,338 --> 01:05:40,269
ever want to do the math and s reduces

1491
01:05:37,989 --> 01:05:42,489
but you could you just have to do that

1492
01:05:40,269 --> 01:05:45,550
translation every time if that makes

1493
01:05:42,489 --> 01:05:51,639
sense what's kind of interesting about

1494
01:05:45,550 --> 01:05:52,990
this is this kind of is like a I've

1495
01:05:51,639 --> 01:05:54,670
never really thought about this before

1496
01:05:52,989 --> 01:05:56,679
because I never really looked at what

1497
01:05:54,670 --> 01:05:58,358
happens if you simplify gamma down to

1498
01:05:56,679 --> 01:06:00,608
square and square root which is what

1499
01:05:58,358 --> 01:06:04,119
we're doing here but this is kind of

1500
01:06:00,608 --> 01:06:07,650
interesting right because it looks like

1501
01:06:04,119 --> 01:06:14,769
a triangle right it looks like this

1502
01:06:07,650 --> 01:06:21,900
where lurk is here and you know this is

1503
01:06:14,769 --> 01:06:25,929
one minus T Square rooted a and this is

1504
01:06:21,900 --> 01:06:32,110
square root of T B which is just kind of

1505
01:06:25,929 --> 01:06:33,940
interesting I don't really know I don't

1506
01:06:32,110 --> 01:06:42,220
really know if that has any

1507
01:06:33,940 --> 01:06:45,190
ramifications but it kind of looks like

1508
01:06:42,219 --> 01:06:49,869
that right I mean so let's say that I

1509
01:06:45,190 --> 01:06:52,059
had this triangle right and I wanted to

1510
01:06:49,869 --> 01:06:53,529
solve for lerp and I know I have a side

1511
01:06:52,059 --> 01:06:56,679
that's this and I have a side of that

1512
01:06:53,530 --> 01:06:58,600
right well I know that I would take you

1513
01:06:56,679 --> 01:07:00,460
know a squared plus B squared square

1514
01:06:58,599 --> 01:07:03,429
root it is the formula right so plugging

1515
01:07:00,460 --> 01:07:08,559
those in I would get you know 1 minus T

1516
01:07:03,429 --> 01:07:15,179
a squared which is just 1 minus T a

1517
01:07:08,559 --> 01:07:20,079
squared and I would have you know root T

1518
01:07:15,179 --> 01:07:21,969
B squared which is just T B squared and

1519
01:07:20,079 --> 01:07:23,679
I would add those together square root

1520
01:07:21,969 --> 01:07:25,419
them that Gurian theorem to get miler

1521
01:07:23,679 --> 01:07:28,239
it's kind of interesting that it looks

1522
01:07:25,420 --> 01:07:35,760
that way not sure that there's really

1523
01:07:28,239 --> 01:07:39,339
anything special about that but it's

1524
01:07:35,760 --> 01:07:40,450
kind of interesting right it's just one

1525
01:07:39,340 --> 01:07:49,720
of those things that catches your eye

1526
01:07:40,449 --> 01:07:55,239
when you see it I wonder I wonder if you

1527
01:07:49,719 --> 01:07:59,109
could translate the lerp so that you

1528
01:07:55,239 --> 01:08:00,729
just did the operation on the T value if

1529
01:07:59,110 --> 01:08:04,150
that makes sense

1530
01:08:00,730 --> 01:08:08,170
and didn't actually have to square the a

1531
01:08:04,150 --> 01:08:10,329
or the B I don't know if that if what

1532
01:08:08,170 --> 01:08:11,889
I'm saying makes any sense but basically

1533
01:08:10,329 --> 01:08:14,949
like I'd be interested to know if you

1534
01:08:11,889 --> 01:08:18,608
could turn this into something where you

1535
01:08:14,949 --> 01:08:20,509
could get the equivalent of this out by

1536
01:08:18,609 --> 01:08:24,159
just manipulating the TV

1537
01:08:20,509 --> 01:08:24,158
I use I don't know if you can or not

1538
01:08:30,338 --> 01:08:34,759
let's let's let's just you know what

1539
01:08:32,689 --> 01:08:37,518
sorry I think maybe this QA just turned

1540
01:08:34,759 --> 01:08:41,088
into an exploration so let's say we've

1541
01:08:37,519 --> 01:08:42,139
got this here so this is our F of T I'm

1542
01:08:41,088 --> 01:08:43,698
just going to shorten it so I can write

1543
01:08:42,139 --> 01:08:45,650
it easier but it's really F of a TB

1544
01:08:43,698 --> 01:08:47,838
equals that

1545
01:08:45,649 --> 01:08:52,629
so let's square both sides we'd get f

1546
01:08:47,838 --> 01:08:58,759
squared T right equals one minus T a

1547
01:08:52,630 --> 01:09:00,019
squared plus T B squared right and I

1548
01:08:58,759 --> 01:09:02,538
feel like the problem is you're gonna

1549
01:09:00,019 --> 01:09:08,469
get this cross term in here but there's

1550
01:09:02,538 --> 01:09:13,038
nothing you can really do with you know

1551
01:09:08,469 --> 01:09:17,989
yeah well let's keep going f of T equals

1552
01:09:13,038 --> 01:09:21,399
a squared minus T a squared plus T B

1553
01:09:17,988 --> 01:09:26,919
squared which is of course the familiar

1554
01:09:21,399 --> 01:09:33,198
hmm excuse me which is the familiar a

1555
01:09:26,920 --> 01:09:42,069
squared minus T or sorry plus T B

1556
01:09:33,198 --> 01:09:44,358
squared minus a squared right so yeah I

1557
01:09:42,069 --> 01:09:51,859
don't think there's much you're really

1558
01:09:44,359 --> 01:09:55,029
going to do with that unfortunately yeah

1559
01:09:51,859 --> 01:09:55,029
and I don't see that

1560
01:09:59,149 --> 01:10:03,729
if you could get it so that the tea

1561
01:10:01,250 --> 01:10:06,679
would move outside but I just don't see

1562
01:10:03,729 --> 01:10:08,149
how that's gonna happen I mean then Yuri

1563
01:10:06,679 --> 01:10:09,289
square root it right I mean I guess I'd

1564
01:10:08,149 --> 01:10:10,279
really didn't need the square root in

1565
01:10:09,289 --> 01:10:11,750
the first I mean the really need to

1566
01:10:10,279 --> 01:10:13,939
square it in the first place because

1567
01:10:11,750 --> 01:10:17,238
it's all under the radical anyway but

1568
01:10:13,939 --> 01:10:18,919
you've got a squared right plus T B

1569
01:10:17,238 --> 01:10:22,069
squared minus a squared and you still

1570
01:10:18,920 --> 01:10:25,460
can't pull that that T out in any useful

1571
01:10:22,069 --> 01:10:29,689
way like you want to move this out here

1572
01:10:25,460 --> 01:10:35,349
if you could yeah I don't know it's kind

1573
01:10:29,689 --> 01:10:35,348
of interesting anyway I'll go back to QA

1574
01:10:38,550 --> 01:10:43,900
mmm-hmm what are you going to start

1575
01:10:42,279 --> 01:10:46,389
implementing OpenGL for the rendering

1576
01:10:43,899 --> 01:10:48,219
well probably not till we're done with a

1577
01:10:46,390 --> 01:10:50,350
software like well we'll do the

1578
01:10:48,220 --> 01:10:52,000
optimized software renderer but OpenGL

1579
01:10:50,350 --> 01:10:54,130
is just kind of there for performance

1580
01:10:52,000 --> 01:10:58,630
but you know we won't learn a whole lot

1581
01:10:54,130 --> 01:11:01,770
by implementing OpenGL so we're not

1582
01:10:58,630 --> 01:11:04,569
really focused on that wouldn't the

1583
01:11:01,770 --> 01:11:08,640
10-10-10 2 format which is available in

1584
01:11:04,569 --> 01:11:08,639
hardware be sufficient to avoid banding

1585
01:11:10,319 --> 01:11:19,630
well yeah so the 10-10-10 2 format

1586
01:11:15,880 --> 01:11:21,819
I mean really it depends on how what we

1587
01:11:19,630 --> 01:11:23,590
end up doing with our frame buffer so if

1588
01:11:21,819 --> 01:11:25,299
we end up using destination in the frame

1589
01:11:23,590 --> 01:11:28,840
but destination alpha in the frame

1590
01:11:25,300 --> 01:11:31,539
buffer for translucency 2 bits for alpha

1591
01:11:28,840 --> 01:11:37,000
I'm gonna cut it so you know we could

1592
01:11:31,539 --> 01:11:39,850
use something like 10 10 10 2 or 11 11

1593
01:11:37,000 --> 01:11:43,180
11 10 for example with no alpha in the

1594
01:11:39,850 --> 01:11:45,280
frame buffer we could decide to try and

1595
01:11:43,180 --> 01:11:48,850
do something like that and that might be

1596
01:11:45,279 --> 01:11:51,849
enough to avoid the banding but we would

1597
01:11:48,850 --> 01:11:54,010
be sort of boxing ourselves in because

1598
01:11:51,850 --> 01:11:57,130
then we wouldn't have any way to do

1599
01:11:54,010 --> 01:11:58,930
destination alpha right and so that's a

1600
01:11:57,130 --> 01:12:00,579
little dicey I don't know that I would

1601
01:11:58,930 --> 01:12:02,789
want to go down that route if we'd have

1602
01:12:00,579 --> 01:12:02,789
to

1603
01:12:05,800 --> 01:12:11,529
what is the point of using 2.2 at all

1604
01:12:08,170 --> 01:12:15,010
why not just use two for gamma because

1605
01:12:11,529 --> 01:12:17,259
it's less accurate I mean the answer is

1606
01:12:15,010 --> 01:12:20,739
you can just use two for gamma if you're

1607
01:12:17,260 --> 01:12:23,619
in a pinch but if you want it to be 100%

1608
01:12:20,738 --> 01:12:26,828
accurate everywhere you want to point to

1609
01:12:23,618 --> 01:12:28,839
and so when you're in a situation where

1610
01:12:26,828 --> 01:12:31,139
like hardware for example uses klutz

1611
01:12:28,840 --> 01:12:34,059
oftentimes they use color look-up tables

1612
01:12:31,139 --> 01:12:36,219
for this I believe they can just do

1613
01:12:34,059 --> 01:12:38,860
exactly the srgb profile so they don't

1614
01:12:36,219 --> 01:12:41,139
have any of that wiggle room but yeah

1615
01:12:38,859 --> 01:12:43,598
the answer is I think two is probably

1616
01:12:41,139 --> 01:12:45,279
okay for a lot of uses and I believe a

1617
01:12:43,599 --> 01:12:47,319
lot of people have used two as an

1618
01:12:45,279 --> 01:12:48,849
optimization before so we're not like

1619
01:12:47,319 --> 01:12:51,189
doing that that's not like some new

1620
01:12:48,849 --> 01:12:52,840
thing we're doing that's like I believe

1621
01:12:51,189 --> 01:12:59,198
that's an accepted optimization of like

1622
01:12:52,840 --> 01:13:01,029
yeah it's close enough right by

1623
01:12:59,198 --> 01:13:02,799
repeatedly converting between linear and

1624
01:13:01,029 --> 01:13:06,179
our approximated gamma space when doing

1625
01:13:02,800 --> 01:13:11,110
each blend are we compounding our errors

1626
01:13:06,179 --> 01:13:14,380
so you know yes and no if we thought

1627
01:13:11,109 --> 01:13:16,328
that if we were accumulating so you have

1628
01:13:14,380 --> 01:13:18,670
to understand what do you mean by errors

1629
01:13:16,328 --> 01:13:20,828
right so if you take a look at what's

1630
01:13:18,670 --> 01:13:23,139
happening on the screen a lot of stuff

1631
01:13:20,828 --> 01:13:25,689
is just the result of the final pixel

1632
01:13:23,139 --> 01:13:27,190
that gets written there and there isn't

1633
01:13:25,689 --> 01:13:29,618
a lot of translucency that's happening

1634
01:13:27,189 --> 01:13:32,439
so the only time that you really end up

1635
01:13:29,618 --> 01:13:34,839
with what's you know seeing the result

1636
01:13:32,439 --> 01:13:37,750
of repetitive blending is that the edges

1637
01:13:34,840 --> 01:13:39,550
of things or when there's a thing that's

1638
01:13:37,750 --> 01:13:40,868
like translucent like a transfer

1639
01:13:39,550 --> 01:13:42,279
semi-transparent I should say not

1640
01:13:40,868 --> 01:13:44,948
translucent translucency is a different

1641
01:13:42,279 --> 01:13:46,960
thing translucency is like a superset of

1642
01:13:44,948 --> 01:13:49,089
transparency so forget I said that

1643
01:13:46,960 --> 01:13:51,368
something that's like semi-transparent

1644
01:13:49,090 --> 01:13:55,119
so you know we really won't have that

1645
01:13:51,368 --> 01:13:57,519
much error to compound but you're right

1646
01:13:55,118 --> 01:13:59,859
for for things where a lot of edges were

1647
01:13:57,520 --> 01:14:01,030
overlapping we would be potentially

1648
01:13:59,859 --> 01:14:02,469
compounding our errors there we'd have

1649
01:14:01,029 --> 01:14:04,630
like one bit of rounding error that

1650
01:14:02,469 --> 01:14:05,920
would happen each time potentially for

1651
01:14:04,630 --> 01:14:07,599
example right

1652
01:14:05,920 --> 01:14:09,368
but at the end of the day I don't know

1653
01:14:07,599 --> 01:14:11,980
that that really is gonna add up to all

1654
01:14:09,368 --> 01:14:14,348
that much but that is one motivation for

1655
01:14:11,979 --> 01:14:15,459
why when you're start to doing thing

1656
01:14:14,349 --> 01:14:16,779
when you're starting to do things like

1657
01:14:15,460 --> 01:14:18,819
trying to do photorealistic rendering

1658
01:14:16,779 --> 01:14:19,689
and stuff like that you will keep all

1659
01:14:18,819 --> 01:14:21,488
your stuff in flow

1660
01:14:19,689 --> 01:14:23,948
point so that you have a lot more bits

1661
01:14:21,488 --> 01:14:25,929
of precision so that you don't fall into

1662
01:14:23,948 --> 01:14:27,069
you know traps like that where you might

1663
01:14:25,930 --> 01:14:28,780
end up with something that looks a

1664
01:14:27,069 --> 01:14:30,609
little wrong gets a little bandit or

1665
01:14:28,779 --> 01:14:32,710
something because of it we just don't

1666
01:14:30,609 --> 01:14:34,269
have that kind of scenario happening so

1667
01:14:32,710 --> 01:14:36,310
we really don't have a situation where

1668
01:14:34,270 --> 01:14:37,810
we're going to need to worry about every

1669
01:14:36,310 --> 01:14:39,130
little last bit of precision because

1670
01:14:37,810 --> 01:14:49,239
we're just not doing stuff of that

1671
01:14:39,130 --> 01:14:52,989
nature at the moment do all monitors use

1672
01:14:49,238 --> 01:14:56,259
the same 2.2 curve no actually they

1673
01:14:52,988 --> 01:14:58,059
don't and in fact that is why you get

1674
01:14:56,260 --> 01:15:02,500
these things which are like color

1675
01:14:58,060 --> 01:15:04,420
calibration curves for your monitor the

1676
01:15:02,500 --> 01:15:06,550
the fact is and and I guess this might

1677
01:15:04,420 --> 01:15:10,180
be another argument for why 2.0 might be

1678
01:15:06,550 --> 01:15:11,800
good enough to point to is not exact to

1679
01:15:10,180 --> 01:15:14,020
point to is an approximation of what

1680
01:15:11,800 --> 01:15:15,909
most monitors are trying to do not all

1681
01:15:14,020 --> 01:15:18,160
monitors are doing that not everyone has

1682
01:15:15,909 --> 01:15:19,719
their monitors set up the same way you

1683
01:15:18,159 --> 01:15:20,920
know the contrast on the monitor may be

1684
01:15:19,719 --> 01:15:22,930
set differently there's all these other

1685
01:15:20,920 --> 01:15:24,520
things and you will often see stuff

1686
01:15:22,930 --> 01:15:25,780
where people will actually try to figure

1687
01:15:24,520 --> 01:15:27,400
out what the gamma curve is for a game

1688
01:15:25,779 --> 01:15:31,319
if you've ever seen something where a

1689
01:15:27,399 --> 01:15:33,129
game comes up and says adjust this knob

1690
01:15:31,319 --> 01:15:35,738
which is like a little thing on the

1691
01:15:33,130 --> 01:15:36,219
screen until these gray colors look the

1692
01:15:35,738 --> 01:15:38,049
same

1693
01:15:36,219 --> 01:15:39,310
if you ever seen that that was them

1694
01:15:38,050 --> 01:15:41,980
trying to figure out what your monitor

1695
01:15:39,310 --> 01:15:44,199
dama was right so yeah there it's

1696
01:15:41,979 --> 01:15:46,479
there's no perfect solution for it it's

1697
01:15:44,198 --> 01:15:48,009
one of those sad facts of life where you

1698
01:15:46,479 --> 01:15:50,709
just don't get the information that you

1699
01:15:48,010 --> 01:15:52,750
need to do the perfect solution so you

1700
01:15:50,710 --> 01:15:54,250
know again that's why using 2.2 is

1701
01:15:52,750 --> 01:15:56,198
probably not that bad of a compromise

1702
01:15:54,250 --> 01:15:58,238
because it's much better than not doing

1703
01:15:56,198 --> 01:16:01,089
gamma at all but it's probably not that

1704
01:15:58,238 --> 01:16:03,849
much more incorrect than doing 2.2 for

1705
01:16:01,090 --> 01:16:06,250
most circumstances I would suspect not a

1706
01:16:03,850 --> 01:16:08,560
game expert I'm not the guy to ask so

1707
01:16:06,250 --> 01:16:10,390
that's just my supposition you would

1708
01:16:08,560 --> 01:16:13,680
have to ask somebody who was a little

1709
01:16:10,390 --> 01:16:13,680
more hardcore about it

1710
01:16:23,050 --> 01:16:28,180
is raising the color value to two

1711
01:16:25,960 --> 01:16:30,340
instead of two point two really going to

1712
01:16:28,180 --> 01:16:33,010
save that much processing power yeah

1713
01:16:30,340 --> 01:16:34,270
actually probably a ton because the

1714
01:16:33,010 --> 01:16:36,579
difference between squaring something

1715
01:16:34,270 --> 01:16:38,950
and raising it to the two point two

1716
01:16:36,579 --> 01:16:41,409
power like squaring something is like

1717
01:16:38,949 --> 01:16:43,929
one extra instruction it's one

1718
01:16:41,409 --> 01:16:46,809
multiplication but getting it to the two

1719
01:16:43,930 --> 01:16:49,570
point two it involves a ton of extra

1720
01:16:46,810 --> 01:16:51,970
like many more instructions right I

1721
01:16:49,569 --> 01:16:55,000
don't know exactly how many we'd have to

1722
01:16:51,970 --> 01:16:56,020
actually go work it out but when you're

1723
01:16:55,000 --> 01:16:58,300
talking about the differing one

1724
01:16:56,020 --> 01:16:59,620
instruction and many instructions like

1725
01:16:58,300 --> 01:17:01,449
even let's say it was only five

1726
01:16:59,619 --> 01:17:03,279
instructions when we're talking about

1727
01:17:01,449 --> 01:17:07,569
something we do for every pixel on the

1728
01:17:03,279 --> 01:17:09,429
screen you cannot afford six times more

1729
01:17:07,569 --> 01:17:11,019
expensive right like that's what that

1730
01:17:09,430 --> 01:17:14,950
would be right

1731
01:17:11,020 --> 01:17:17,590
so six times as expensive I should say

1732
01:17:14,949 --> 01:17:21,909
so yeah two point two is a lot more

1733
01:17:17,590 --> 01:17:25,480
expensive than two as it happens but

1734
01:17:21,909 --> 01:17:27,430
that said that's me saying it as if you

1735
01:17:25,479 --> 01:17:30,639
were going to implement it like pow

1736
01:17:27,430 --> 01:17:33,850
so it may be the case that if you worked

1737
01:17:30,640 --> 01:17:35,920
out a good approximation specifically

1738
01:17:33,850 --> 01:17:39,460
for two point two that you could get it

1739
01:17:35,920 --> 01:17:41,890
down to not very many instructions but I

1740
01:17:39,460 --> 01:17:43,960
doubt it would be as fast as one

1741
01:17:41,890 --> 01:17:46,690
instruction which is probably all I'm

1742
01:17:43,960 --> 01:17:50,079
willing to spare for gamma probably I

1743
01:17:46,689 --> 01:17:52,809
would guess but you know who knows and

1744
01:17:50,079 --> 01:17:54,159
again it's not just that raised to the

1745
01:17:52,810 --> 01:17:57,490
two point two you have to do you have to

1746
01:17:54,159 --> 01:17:59,260
do the two point two route right the the

1747
01:17:57,489 --> 01:18:01,210
raised to the 1 over two point two power

1748
01:17:59,260 --> 01:18:03,579
to map it back so you're paying it on

1749
01:18:01,210 --> 01:18:06,720
both sides and you need a good

1750
01:18:03,579 --> 01:18:06,720
approximation on both sides

1751
01:18:08,550 --> 01:18:14,820
I got stuck implementing a bit shift+

1752
01:18:13,889 --> 01:18:16,859
PRNG

1753
01:18:14,819 --> 01:18:18,539
in our engine thanks for showing a code

1754
01:18:16,859 --> 01:18:19,948
comment about weighing hashing earlier

1755
01:18:18,539 --> 01:18:22,859
which was just what I needed

1756
01:18:19,948 --> 01:18:25,039
well very glad that Wang hashing helped

1757
01:18:22,859 --> 01:18:25,039
you have

1758
01:18:41,979 --> 01:18:49,759
let's see here all right so I think

1759
01:18:48,229 --> 01:18:55,069
we're all good looks like the end of the

1760
01:18:49,760 --> 01:18:57,050
questions so I will wrap it up for today

1761
01:18:55,069 --> 01:18:58,519
right on time in fact I guess we're a

1762
01:18:57,050 --> 01:19:00,470
little bit over but that's that's no

1763
01:18:58,520 --> 01:19:04,220
problem no biggie

1764
01:19:00,470 --> 01:19:07,250
so all right it's closed down let's

1765
01:19:04,220 --> 01:19:09,949
close down that tree is getting

1766
01:19:07,250 --> 01:19:12,949
increasingly trippy it's a very very

1767
01:19:09,949 --> 01:19:14,779
bizarre tree all of a sudden so yeah I

1768
01:19:12,949 --> 01:19:16,970
would recommend doing some are reading

1769
01:19:14,779 --> 01:19:18,769
on gamma because again handmade hero

1770
01:19:16,970 --> 01:19:20,360
won't be the place to really see gamma

1771
01:19:18,770 --> 01:19:21,590
in action because we're just not doing

1772
01:19:20,359 --> 01:19:24,559
anything where gamma is gonna matter I

1773
01:19:21,590 --> 01:19:27,500
don't think but now you know about what

1774
01:19:24,560 --> 01:19:28,789
it is I would definitely say go do some

1775
01:19:27,500 --> 01:19:31,340
light reading on it just so you kind of

1776
01:19:28,789 --> 01:19:32,779
get a feel for it because it's something

1777
01:19:31,340 --> 01:19:34,279
that you want to know for when you're

1778
01:19:32,779 --> 01:19:35,960
working on 3d stuff or when you're

1779
01:19:34,279 --> 01:19:37,759
looking at some things that maybe where

1780
01:19:35,960 --> 01:19:39,020
it's important it's good to know so it's

1781
01:19:37,760 --> 01:19:41,180
in the back of your head you can go oh

1782
01:19:39,020 --> 01:19:43,490
wait what I'm doing right now might be

1783
01:19:41,180 --> 01:19:44,810
affected by gamma let me make sure that

1784
01:19:43,489 --> 01:19:46,399
I'm doing it right that's just a good

1785
01:19:44,810 --> 01:19:48,350
thing to know and every graphics printer

1786
01:19:46,399 --> 01:19:49,549
should know it so thank you everyone for

1787
01:19:48,350 --> 01:19:50,930
joining me for another episode of

1788
01:19:49,550 --> 01:19:53,210
handmade hereit's what a pleasure coding

1789
01:19:50,930 --> 01:19:55,420
with us always we did gamma today thank

1790
01:19:53,210 --> 01:19:57,710
you to Wan Chun for forcing the issue

1791
01:19:55,420 --> 01:19:59,899
because it does need to be talked about

1792
01:19:57,710 --> 01:20:01,939
and people should know what it is and

1793
01:19:59,899 --> 01:20:02,989
honestly I was gonna skip it because it

1794
01:20:01,939 --> 01:20:04,909
just wasn't the sort of thing that's

1795
01:20:02,989 --> 01:20:07,010
gonna make much of an impact on our game

1796
01:20:04,909 --> 01:20:08,329
but you know it's not always about just

1797
01:20:07,010 --> 01:20:10,190
doing what makes impact on the game it's

1798
01:20:08,329 --> 01:20:12,409
about trying to teach people what they

1799
01:20:10,189 --> 01:20:13,819
need to know to make their own games and

1800
01:20:12,409 --> 01:20:15,889
maybe your game isn't exactly like

1801
01:20:13,819 --> 01:20:17,329
handmade hero so at that point it is

1802
01:20:15,890 --> 01:20:18,740
good for you to know these sorts of

1803
01:20:17,329 --> 01:20:21,019
things that they're out there and you

1804
01:20:18,739 --> 01:20:25,639
can go take a closer look at them if you

1805
01:20:21,020 --> 01:20:29,450
need to so if you would like to oh my

1806
01:20:25,640 --> 01:20:31,310
goodness I'm having that's the first

1807
01:20:29,449 --> 01:20:34,760
time I think my phone has ever rang on

1808
01:20:31,310 --> 01:20:37,460
the screen on the stream I forget that

1809
01:20:34,760 --> 01:20:39,140
my phone can be rung on the laptop which

1810
01:20:37,460 --> 01:20:41,420
is very kind of disquieting alright

1811
01:20:39,140 --> 01:20:43,010
sorry if you would like to follow along

1812
01:20:41,420 --> 01:20:46,069
at home you can always pre-order the

1813
01:20:43,010 --> 01:20:48,860
game at handmade hero org and you can

1814
01:20:46,069 --> 01:20:50,509
see there you can get a link in your

1815
01:20:48,859 --> 01:20:51,799
email which will allow you download the

1816
01:20:50,510 --> 01:20:54,590
source code and you can play around with

1817
01:20:51,800 --> 01:20:57,079
and do whatever you want to do while you

1818
01:20:54,590 --> 01:20:58,550
try to learn sort of you know from the

1819
01:20:57,079 --> 01:20:59,630
stuff that we do on the stream sometimes

1820
01:20:58,550 --> 01:21:02,119
it helps to be able to play around the

1821
01:20:59,630 --> 01:21:03,800
code because that's just a good way to

1822
01:21:02,119 --> 01:21:05,510
learn and a good way to sort of practice

1823
01:21:03,800 --> 01:21:08,090
for when you need to write your own

1824
01:21:05,510 --> 01:21:09,920
stuff so you can do that on here made

1825
01:21:08,090 --> 01:21:11,210
here or we also have the patriotic last

1826
01:21:09,920 --> 01:21:12,890
part the video series you can subscribe

1827
01:21:11,210 --> 01:21:14,119
there it's always very appreciated

1828
01:21:12,890 --> 01:21:16,100
there's forums so you can ask questions

1829
01:21:14,119 --> 01:21:17,599
and it also has ports to Mac and Linux

1830
01:21:16,100 --> 01:21:18,350
stuff like that it's a good place to go

1831
01:21:17,600 --> 01:21:20,060
if you're trying to learn from the

1832
01:21:18,350 --> 01:21:21,590
series we have a tweet bot that tweets

1833
01:21:20,060 --> 01:21:23,150
the schedule so if you want to catch

1834
01:21:21,590 --> 01:21:27,739
this series live it's great place to go

1835
01:21:23,149 --> 01:21:28,579
and yeah we will be here at 5 p.m. every

1836
01:21:27,739 --> 01:21:30,439
day this week

1837
01:21:28,579 --> 01:21:32,779
so if you want to come back and see us

1838
01:21:30,439 --> 01:21:35,359
again we'll be here 5 p.m. tomorrow on

1839
01:21:32,779 --> 01:21:38,119
Twitch love to see here when we will

1840
01:21:35,359 --> 01:21:40,519
maybe start talking about how to

1841
01:21:38,119 --> 01:21:42,260
structure this rasterizer for actually

1842
01:21:40,520 --> 01:21:44,450
getting some performance out of it and

1843
01:21:42,260 --> 01:21:47,180
that will probably open up a whole bunch

1844
01:21:44,449 --> 01:21:48,800
of cans of worms including sort of some

1845
01:21:47,180 --> 01:21:50,720
performance analysis stuff that we sort

1846
01:21:48,800 --> 01:21:52,159
of have been talked about for a while so

1847
01:21:50,720 --> 01:21:54,199
I highly recommend checking it out I

1848
01:21:52,159 --> 01:21:55,550
think it's gonna be a fun week and and

1849
01:21:54,199 --> 01:21:58,279
we'll be do some interesting stuff hope

1850
01:21:55,550 --> 01:22:02,560
see you there and have a good Tuesday

1851
01:21:58,279 --> 01:22:02,559
either way thanks for tuning everyone

