1
00:00:01,129 --> 00:00:05,250
hello everyone and welcome to hand made

2
00:00:03,899 --> 00:00:07,169
here the show recode a complete game

3
00:00:05,250 --> 00:00:10,440
live on stream we are doing lighting

4
00:00:07,169 --> 00:00:14,219
optimization right now and we've got

5
00:00:10,439 --> 00:00:17,129
some stuff to do we have you know I'm

6
00:00:14,218 --> 00:00:20,278
mostly working lighting system in terms

7
00:00:17,129 --> 00:00:22,710
of how the architecture should go but we

8
00:00:20,278 --> 00:00:24,359
don't really have a solid idea of how

9
00:00:22,710 --> 00:00:25,969
we're gonna make it run at 60 frames a

10
00:00:24,359 --> 00:00:28,769
second right we're too slow right now

11
00:00:25,969 --> 00:00:30,479
for the size of things that we want to

12
00:00:28,768 --> 00:00:32,539
do and there's a lot of things that we

13
00:00:30,480 --> 00:00:35,369
can consider in terms of speeding it up

14
00:00:32,539 --> 00:00:37,589
but at the very least we should probably

15
00:00:35,369 --> 00:00:40,769
finish our spatial hierarchy stuff that

16
00:00:37,590 --> 00:00:42,920
we started down and that is to say that

17
00:00:40,770 --> 00:00:45,059
we implemented a spatial hierarchy for

18
00:00:42,920 --> 00:00:46,530
accelerating our raycast but we never

19
00:00:45,058 --> 00:00:48,538
really played with it

20
00:00:46,530 --> 00:00:50,308
we haven't even drawn it yet so we don't

21
00:00:48,539 --> 00:00:52,350
even really know how well it's working

22
00:00:50,308 --> 00:00:55,890
we could have like obvious bugs in there

23
00:00:52,350 --> 00:00:57,359
and we'd never know so our job now is to

24
00:00:55,890 --> 00:00:59,759
start taking the lighting system and

25
00:00:57,359 --> 00:01:01,738
actually refining it in terms of

26
00:00:59,759 --> 00:01:05,849
performance and then also we need to

27
00:01:01,738 --> 00:01:09,149
make the front-end to it which currently

28
00:01:05,849 --> 00:01:11,849
just drops down equally spaced points on

29
00:01:09,150 --> 00:01:13,920
our little environment cubes we need to

30
00:01:11,849 --> 00:01:15,959
actually do something more intelligent

31
00:01:13,920 --> 00:01:19,409
there right we need to have the thing

32
00:01:15,959 --> 00:01:20,728
that actually creates the world be smart

33
00:01:19,409 --> 00:01:25,950
about where it's gonna put down lighting

34
00:01:20,728 --> 00:01:27,509
points so that you know you can be be

35
00:01:25,950 --> 00:01:29,159
more reasonably assured that you're

36
00:01:27,509 --> 00:01:31,650
going to get decent quality out of the

37
00:01:29,159 --> 00:01:34,229
lighting based on on what you put into

38
00:01:31,650 --> 00:01:36,960
it so let's go ahead and take a quick

39
00:01:34,228 --> 00:01:38,578
look at what I'm talking about here

40
00:01:36,959 --> 00:01:40,589
and again lighting is one of the hardest

41
00:01:38,578 --> 00:01:41,699
things in graphics it's it's basically

42
00:01:40,590 --> 00:01:44,460
the thing that causes all of the

43
00:01:41,700 --> 00:01:46,200
problems so you know you can expect

44
00:01:44,459 --> 00:01:48,658
always for it to be a little bit of a

45
00:01:46,200 --> 00:01:50,130
struggle and it's just because it's one

46
00:01:48,659 --> 00:01:51,450
of the few things in graphics where

47
00:01:50,129 --> 00:01:54,179
everything affects everything else

48
00:01:51,450 --> 00:01:55,649
obviously when we talk about the cost of

49
00:01:54,180 --> 00:01:58,229
things and how difficult they are to

50
00:01:55,649 --> 00:02:00,659
achieve anything that only involves

51
00:01:58,228 --> 00:02:02,069
working with a single thing is usually

52
00:02:00,659 --> 00:02:04,290
something we can manage these days we

53
00:02:02,069 --> 00:02:06,269
have a lot of horsepower so o n problems

54
00:02:04,290 --> 00:02:08,819
like ones that are proportional to their

55
00:02:06,269 --> 00:02:11,219
input size are not that big of a problem

56
00:02:08,818 --> 00:02:12,869
lighting is not that way lighting is

57
00:02:11,219 --> 00:02:13,530
everything affects everything else

58
00:02:12,870 --> 00:02:15,719
because light down

59
00:02:13,530 --> 00:02:18,030
is off surfaces and hits other services

60
00:02:15,719 --> 00:02:19,770
and keeps bouncing and so on and so it's

61
00:02:18,030 --> 00:02:22,650
just a really nasty problem because it's

62
00:02:19,770 --> 00:02:25,800
an M squared or worse kind of a problem

63
00:02:22,650 --> 00:02:27,150
where you end up with the difficulty of

64
00:02:25,800 --> 00:02:29,150
the problem the amount of work you need

65
00:02:27,150 --> 00:02:31,050
to do to do it correctly scaling

66
00:02:29,150 --> 00:02:33,659
nonlinearly and that's like the worst

67
00:02:31,050 --> 00:02:35,580
case right well now there's super

68
00:02:33,659 --> 00:02:39,509
linearly obviously something early would

69
00:02:35,580 --> 00:02:40,980
be great so anyway if you take a look at

70
00:02:39,509 --> 00:02:43,469
what we've got here now you can kind of

71
00:02:40,979 --> 00:02:45,359
see that our lighting is is working for

72
00:02:43,469 --> 00:02:47,250
the most part meaning that we get

73
00:02:45,360 --> 00:02:49,080
predictable results as we move things

74
00:02:47,250 --> 00:02:51,419
around we get bounce lighting which we

75
00:02:49,080 --> 00:02:53,310
want we keep things relatively smooth

76
00:02:51,419 --> 00:02:54,539
but there's a couple of things like I

77
00:02:53,310 --> 00:02:56,370
said we need to do one is on the front

78
00:02:54,539 --> 00:02:58,709
end like you can see like right now we

79
00:02:56,370 --> 00:03:00,030
don't do lighting translation for our

80
00:02:58,709 --> 00:03:02,099
sprites these sprites are just kind of

81
00:03:00,030 --> 00:03:04,590
stamped down here so only our little

82
00:03:02,099 --> 00:03:06,060
actual geometry cubes are getting lit so

83
00:03:04,590 --> 00:03:07,200
that's something that we need to fix now

84
00:03:06,060 --> 00:03:08,670
the other thing is our frame rates just

85
00:03:07,199 --> 00:03:10,169
not good enough right

86
00:03:08,669 --> 00:03:12,299
and it's especially not good enough when

87
00:03:10,169 --> 00:03:13,589
the entire lighting region gets it you

88
00:03:12,300 --> 00:03:15,870
know increased over it's something like

89
00:03:13,590 --> 00:03:18,450
over here where we've got more things

90
00:03:15,870 --> 00:03:20,219
that are being lit so there's just a

91
00:03:18,449 --> 00:03:24,209
bunch of stuff that needs to get sort of

92
00:03:20,219 --> 00:03:26,459
improved and smoothed out so yeah I

93
00:03:24,209 --> 00:03:28,319
don't know exactly what the best

94
00:03:26,459 --> 00:03:30,360
approach is but we've got a couple

95
00:03:28,319 --> 00:03:32,819
things to do the other thing we need to

96
00:03:30,360 --> 00:03:34,739
do is we changed a little bit how the

97
00:03:32,819 --> 00:03:38,389
renderer was handling submissions of

98
00:03:34,739 --> 00:03:40,739
things and one of the problems that we

99
00:03:38,389 --> 00:03:42,629
hadn't actually looked at there is we

100
00:03:40,739 --> 00:03:44,909
still did one thing wrong you can notice

101
00:03:42,629 --> 00:03:47,729
we're not getting our clear of the back

102
00:03:44,909 --> 00:03:49,469
buffer is not clearing properly because

103
00:03:47,729 --> 00:03:51,238
we're you can see it's black and it's

104
00:03:49,469 --> 00:03:53,819
supposed to be the clear color which is

105
00:03:51,239 --> 00:03:54,959
gray actually so we've got a bunch of

106
00:03:53,819 --> 00:03:56,759
things we can work on the day after

107
00:03:54,959 --> 00:03:59,789
doing the debugging we did on the

108
00:03:56,759 --> 00:04:01,828
lighting last week we've got basically a

109
00:03:59,789 --> 00:04:03,060
number of things we've got to do that

110
00:04:01,829 --> 00:04:04,290
are not necessary debugging but they're

111
00:04:03,060 --> 00:04:05,670
like code improvements code

112
00:04:04,289 --> 00:04:07,828
restructuring opposition that sort of

113
00:04:05,669 --> 00:04:10,559
stuff and so that's what we need to

114
00:04:07,829 --> 00:04:12,359
start working on today so I'm gonna

115
00:04:10,560 --> 00:04:15,329
start by saying let's go ahead and try

116
00:04:12,359 --> 00:04:17,370
to fix that render a problem because I

117
00:04:15,329 --> 00:04:20,608
don't really want to leave that lying

118
00:04:17,370 --> 00:04:22,348
around for too long it's not the end of

119
00:04:20,608 --> 00:04:24,810
the world but it's just I don't want

120
00:04:22,348 --> 00:04:27,000
like bugs lurking in the renderer for

121
00:04:24,810 --> 00:04:29,129
too long we're gonna go through and

122
00:04:27,000 --> 00:04:32,819
once we're totally sure that everything

123
00:04:29,129 --> 00:04:34,439
in it is correct so it's not essential

124
00:04:32,819 --> 00:04:35,779
that it be completely squeaky clean but

125
00:04:34,439 --> 00:04:39,180
it just I don't want it to be too

126
00:04:35,779 --> 00:04:42,629
ridiculous so what you can see here is

127
00:04:39,180 --> 00:04:45,540
we've got the render entry begin peals

128
00:04:42,629 --> 00:04:46,860
section here this is when we come

129
00:04:45,540 --> 00:04:48,450
through and we do our depth peeling

130
00:04:46,860 --> 00:04:53,100
passes we're going to render the same

131
00:04:48,449 --> 00:04:55,529
information multiple times and so one

132
00:04:53,100 --> 00:04:57,860
thing you'll notice is that each time we

133
00:04:55,529 --> 00:05:00,929
go through to clear one of these peels

134
00:04:57,860 --> 00:05:03,389
we end up in a situation where we need

135
00:05:00,930 --> 00:05:06,629
to know what to clear it to and what we

136
00:05:03,389 --> 00:05:09,000
want to do is we want to clear any of

137
00:05:06,629 --> 00:05:12,060
the peels that we hit we want to clear

138
00:05:09,000 --> 00:05:14,579
them to nothing first which is you can

139
00:05:12,060 --> 00:05:16,410
see it's zero zero zero because we want

140
00:05:14,579 --> 00:05:18,629
if there's nothing on that peel we want

141
00:05:16,410 --> 00:05:21,120
it to show through to the peel below it

142
00:05:18,629 --> 00:05:24,959
right that's the whole point of doing

143
00:05:21,120 --> 00:05:26,730
the peeling and so when we finally get

144
00:05:24,959 --> 00:05:28,529
to the bottom most layer what we're

145
00:05:26,730 --> 00:05:31,140
doing is we're clearing that bottom most

146
00:05:28,529 --> 00:05:33,439
layer to the clear color or at least

147
00:05:31,139 --> 00:05:36,360
that's what we're supposed to be doing

148
00:05:33,439 --> 00:05:38,100
and since I don't actually have any

149
00:05:36,360 --> 00:05:40,530
verification that that's actually

150
00:05:38,100 --> 00:05:42,930
happening I don't know if we're doing it

151
00:05:40,529 --> 00:05:44,219
wrong or right or what's happening so

152
00:05:42,930 --> 00:05:46,709
what I want to do is I want to take a

153
00:05:44,220 --> 00:05:49,440
look in here and see what's going on

154
00:05:46,709 --> 00:05:50,699
with our clear do we have something

155
00:05:49,439 --> 00:05:52,800
messed up in there

156
00:05:50,699 --> 00:05:55,860
did we just set the color wrong you know

157
00:05:52,800 --> 00:05:59,220
I don't know so I want more information

158
00:05:55,860 --> 00:06:00,300
about this problem so I can start to

159
00:05:59,220 --> 00:06:02,460
debug it and that's what I'm gonna go

160
00:06:00,300 --> 00:06:03,449
look for now so the first thing I'm

161
00:06:02,459 --> 00:06:05,219
gonna do is I'm just gonna set a

162
00:06:03,449 --> 00:06:06,750
breakpoint here I'm gonna turn off

163
00:06:05,220 --> 00:06:08,040
because we don't care how fast this is

164
00:06:06,750 --> 00:06:09,870
running I'm about to turn off

165
00:06:08,040 --> 00:06:11,729
optimizations so it's easier to step

166
00:06:09,870 --> 00:06:14,490
through the code and we can inspect our

167
00:06:11,728 --> 00:06:17,069
variables better so I'm gonna go ahead

168
00:06:14,490 --> 00:06:18,750
and look in here what you can see is we

169
00:06:17,069 --> 00:06:20,399
made good to begin the peels we can see

170
00:06:18,750 --> 00:06:21,600
what the peel index is it's zero on the

171
00:06:20,399 --> 00:06:23,969
first one through which is what we'd

172
00:06:21,600 --> 00:06:25,590
expect max render target is three which

173
00:06:23,970 --> 00:06:27,990
is also expect as we have for render

174
00:06:25,589 --> 00:06:30,659
targets zero one two and three so the

175
00:06:27,990 --> 00:06:32,550
maximum is three we should clear this to

176
00:06:30,660 --> 00:06:34,560
zero and we do we should clear the next

177
00:06:32,550 --> 00:06:36,090
one to zero and we do we should clear

178
00:06:34,560 --> 00:06:38,759
the next one to zero and we do and now

179
00:06:36,089 --> 00:06:40,709
this final one should be cleared to the

180
00:06:38,759 --> 00:06:43,199
okay well

181
00:06:40,709 --> 00:06:45,629
there's your problem right there here we

182
00:06:43,199 --> 00:06:49,490
go this is our problem we reset the peel

183
00:06:45,629 --> 00:06:49,490
index at the end to zero

184
00:06:49,949 --> 00:06:55,560
so and that's because I guess we don't

185
00:06:52,439 --> 00:06:57,629
want depth peeling on so that's our

186
00:06:55,560 --> 00:07:00,180
problem problem solved

187
00:06:57,629 --> 00:07:01,529
we just need to figure out a way for

188
00:07:00,180 --> 00:07:04,740
these loops to work better with each

189
00:07:01,529 --> 00:07:07,409
other so when we hit this right here

190
00:07:04,740 --> 00:07:09,930
render group entry type render entry end

191
00:07:07,410 --> 00:07:17,189
peels when we get to the maximum render

192
00:07:09,930 --> 00:07:18,569
target index it looks like well actually

193
00:07:17,189 --> 00:07:20,699
I don't know if I agree with that

194
00:07:18,569 --> 00:07:22,500
because this should have incremented the

195
00:07:20,699 --> 00:07:24,629
peel index and we should have come

196
00:07:22,500 --> 00:07:28,230
through here at least one time with the

197
00:07:24,629 --> 00:07:30,990
max render target index right because

198
00:07:28,230 --> 00:07:34,830
this is only once on peel index is equal

199
00:07:30,990 --> 00:07:38,269
to it so I guess I'm not sure why

200
00:07:34,829 --> 00:07:43,649
exactly that happened that looks to me

201
00:07:38,269 --> 00:07:47,339
more reasonable actually so what's going

202
00:07:43,649 --> 00:07:49,560
on there let's let's take that one more

203
00:07:47,339 --> 00:07:50,969
time I'm not so sure I mean I see what

204
00:07:49,560 --> 00:07:57,030
caused the bug we didn't come through

205
00:07:50,970 --> 00:07:59,370
here on the on the final one but but I

206
00:07:57,029 --> 00:08:01,259
don't know why we didn't and that's

207
00:07:59,370 --> 00:08:03,899
that's not great so I'm gonna look at

208
00:08:01,259 --> 00:08:06,539
both sides of the loop now to find out

209
00:08:03,899 --> 00:08:08,699
what's going on so I'm gonna tag in the

210
00:08:06,540 --> 00:08:12,030
watch window on peel index so that I can

211
00:08:08,699 --> 00:08:15,089
see exactly what it is at each step so I

212
00:08:12,029 --> 00:08:19,759
started PL 0 I end peel 0 and I

213
00:08:15,089 --> 00:08:19,759
increment to peel 1 and jump back

214
00:08:23,699 --> 00:08:37,449
so somehow when we jumped back

215
00:08:28,988 --> 00:08:40,718
oh we're not actually entering this so

216
00:08:37,448 --> 00:08:43,299
you see what happened here this peel

217
00:08:40,719 --> 00:08:44,499
header restored that snaps header at so

218
00:08:43,299 --> 00:08:46,149
what we were doing is we wanted to

219
00:08:44,499 --> 00:08:48,519
create a loop through our render

220
00:08:46,149 --> 00:08:50,078
instructions and this is the thing that

221
00:08:48,519 --> 00:08:52,870
restores the pointer that we're reading

222
00:08:50,078 --> 00:08:54,308
from but we saved the pointer at the

223
00:08:52,870 --> 00:08:56,889
wrong time

224
00:08:54,308 --> 00:08:59,528
we saved the pointer and we really want

225
00:08:56,889 --> 00:09:02,860
the pointer to point to the header right

226
00:08:59,528 --> 00:09:04,808
not header at so we really want this we

227
00:09:02,860 --> 00:09:06,639
want the put that header restore to

228
00:09:04,808 --> 00:09:09,249
point to the header we're on so that we

229
00:09:06,639 --> 00:09:11,350
run the begin loop again so does that

230
00:09:09,249 --> 00:09:15,040
mean we were never clearing any of those

231
00:09:11,350 --> 00:09:19,170
somehow no I step through it so how is

232
00:09:15,039 --> 00:09:19,169
that possible that's just very strange

233
00:09:35,798 --> 00:09:45,769
so looking at this here so it's a little

234
00:09:44,178 --> 00:09:47,208
bit wonky so if you take a look at what

235
00:09:45,769 --> 00:09:58,100
happens we're stepping through the

236
00:09:47,208 --> 00:10:01,849
header here by doing an increment of the

237
00:09:58,100 --> 00:10:06,350
of the entry size but that's a little

238
00:10:01,850 --> 00:10:09,709
bit odd and I'm not sure why we're doing

239
00:10:06,350 --> 00:10:16,040
it in that way

240
00:10:09,708 --> 00:10:17,659
I mean basically what this means is if

241
00:10:16,039 --> 00:10:19,338
we wanted to set up the pointer properly

242
00:10:17,659 --> 00:10:23,568
for the end of the loop because this

243
00:10:19,339 --> 00:10:25,699
here happens at sort of an odd time I

244
00:10:23,568 --> 00:10:28,639
would almost say I would like to move

245
00:10:25,698 --> 00:10:33,368
this out so the increment I feel like it

246
00:10:28,639 --> 00:10:33,369
might be nicer if it actually happened

247
00:10:33,818 --> 00:10:39,288
here

248
00:10:35,019 --> 00:10:42,159
right because then the header pointer is

249
00:10:39,288 --> 00:10:46,159
still the right pointer to set this to

250
00:10:42,159 --> 00:10:50,208
and that seems more sane to me let's

251
00:10:46,159 --> 00:10:55,129
find out if I'm right about that so

252
00:10:50,208 --> 00:10:57,858
there's that clear increment here's the

253
00:10:55,129 --> 00:11:00,288
clear again and the increment clear

254
00:10:57,859 --> 00:11:04,749
increment and there's our clear to the

255
00:11:00,288 --> 00:11:04,749
correct color off we go

256
00:11:06,990 --> 00:11:12,278
so now we're getting back we've gotten

257
00:11:10,480 --> 00:11:16,688
back to the correct behavior it looks

258
00:11:12,278 --> 00:11:19,119
like to me so that seems much more sane

259
00:11:16,688 --> 00:11:20,528
let me make sure because I don't

260
00:11:19,119 --> 00:11:24,519
actually know I'm gonna switch to

261
00:11:20,528 --> 00:11:30,278
optimized so we can take a look a little

262
00:11:24,519 --> 00:11:33,839
more cleanly here yeah so that's looking

263
00:11:30,278 --> 00:11:33,838
more like it

264
00:11:39,539 --> 00:11:46,118
still get some artifacting there were

265
00:11:41,860 --> 00:11:53,800
two things overlap exactly for our death

266
00:11:46,119 --> 00:11:54,840
feeling but otherwise we seem okay all

267
00:11:53,799 --> 00:11:56,879
right

268
00:11:54,840 --> 00:11:58,230
so I think that was the only problem

269
00:11:56,879 --> 00:11:59,700
that was the only thing that I was

270
00:11:58,230 --> 00:12:02,159
really wanted to make sure was solved

271
00:11:59,700 --> 00:12:03,509
and it is solved let's double-check also

272
00:12:02,159 --> 00:12:06,629
our profile right now so we know where

273
00:12:03,509 --> 00:12:08,759
we're at you can see here it's exactly

274
00:12:06,629 --> 00:12:10,350
what we would expect our lighting is

275
00:12:08,759 --> 00:12:13,439
taking all of the time so the entire

276
00:12:10,350 --> 00:12:16,259
game is running in very little time but

277
00:12:13,440 --> 00:12:18,180
the lighting is taking forever and so we

278
00:12:16,259 --> 00:12:20,669
essentially know that that's our giant

279
00:12:18,179 --> 00:12:22,528
you know our big target that's that's

280
00:12:20,669 --> 00:12:26,219
what we need to focus on and figure out

281
00:12:22,528 --> 00:12:27,509
how to you know speed up and so that's

282
00:12:26,220 --> 00:12:31,620
what we you know that's we're gonna look

283
00:12:27,509 --> 00:12:34,439
at now all right so I'm fine with that

284
00:12:31,620 --> 00:12:37,589
let's take a look at the current state

285
00:12:34,440 --> 00:12:39,360
of our optimized our attempts to

286
00:12:37,589 --> 00:12:41,820
optimize our lighting so there's a

287
00:12:39,360 --> 00:12:43,050
number of things we want to do here some

288
00:12:41,820 --> 00:12:46,230
will make things better some will make

289
00:12:43,049 --> 00:12:47,699
things worse actually not just in terms

290
00:12:46,230 --> 00:12:50,399
of optimization but just in terms of the

291
00:12:47,700 --> 00:12:52,800
way the algorithm is structured so we

292
00:12:50,399 --> 00:12:56,939
know that basically all of our time is

293
00:12:52,799 --> 00:12:58,740
spent inside the movies app if spent in

294
00:12:56,940 --> 00:13:00,900
time inside the lighting propagation

295
00:12:58,740 --> 00:13:04,289
right so the compute light propagation

296
00:13:00,899 --> 00:13:05,639
function which is this guy right here is

297
00:13:04,289 --> 00:13:06,838
what takes all the time and it's pretty

298
00:13:05,639 --> 00:13:09,870
easy to see why it takes all the time

299
00:13:06,839 --> 00:13:12,630
it's just this giant set of loops right

300
00:13:09,870 --> 00:13:14,580
everything multiplies out so we do a

301
00:13:12,629 --> 00:13:16,169
certain number of iterations over a

302
00:13:14,580 --> 00:13:17,850
certain number of emitters over a

303
00:13:16,169 --> 00:13:22,099
certain number of rays each of which

304
00:13:17,850 --> 00:13:24,360
then has to loop over all of our

305
00:13:22,100 --> 00:13:27,629
collision geometry or started lighting

306
00:13:24,360 --> 00:13:29,310
geometry and that lady's Gemma tree is

307
00:13:27,629 --> 00:13:31,529
broken into spatial hierarchy but that's

308
00:13:29,309 --> 00:13:33,989
still it's still a lot of checking right

309
00:13:31,529 --> 00:13:36,360
and so loop upon loop upon loop upon

310
00:13:33,990 --> 00:13:38,070
loop each loop just multiplies out the

311
00:13:36,360 --> 00:13:40,709
amount of work that has to be done right

312
00:13:38,070 --> 00:13:43,560
and that just creates a really bad

313
00:13:40,708 --> 00:13:45,539
situation so what we're trying to do

314
00:13:43,559 --> 00:13:49,219
here is figure out ways that we can sort

315
00:13:45,539 --> 00:13:52,079
of continue to make this more likely to

316
00:13:49,220 --> 00:13:55,470
you know run in a nice sort of pseudo

317
00:13:52,080 --> 00:13:56,940
fixed amount of time so one thing that

318
00:13:55,470 --> 00:13:59,700
is going to mention is we never really

319
00:13:56,940 --> 00:14:00,959
got our skylight in there and one of the

320
00:13:59,700 --> 00:14:02,310
reasons we don't have a skylight in

321
00:14:00,958 --> 00:14:06,629
there is the way that we're currently

322
00:14:02,309 --> 00:14:08,519
doing our ray casting is we we choose to

323
00:14:06,629 --> 00:14:13,019
shoot rays from our

324
00:14:08,519 --> 00:14:15,299
meters out bird and that makes actually

325
00:14:13,019 --> 00:14:16,860
pretty good sense at first meaning when

326
00:14:15,299 --> 00:14:19,620
you start you probably want to do that

327
00:14:16,860 --> 00:14:22,560
but it definitely makes things harder

328
00:14:19,620 --> 00:14:24,870
for things like skylight where you don't

329
00:14:22,559 --> 00:14:27,569
really have any particular location that

330
00:14:24,870 --> 00:14:28,860
light is coming from skylight is

331
00:14:27,570 --> 00:14:33,090
something that just kind of radiates

332
00:14:28,860 --> 00:14:37,350
inward to everything and you know that's

333
00:14:33,090 --> 00:14:38,790
a pretty important component of lighting

334
00:14:37,350 --> 00:14:41,070
that you know it would be nice if we

335
00:14:38,789 --> 00:14:42,899
captured so we had kind of have some

336
00:14:41,070 --> 00:14:44,700
some issues with that as well where we

337
00:14:42,899 --> 00:14:46,079
don't really know what we are we don't

338
00:14:44,700 --> 00:14:47,879
have a solid plan in here for how we

339
00:14:46,080 --> 00:14:49,470
would do that obviously one thing you

340
00:14:47,879 --> 00:14:52,950
could do was constantly irradiate

341
00:14:49,470 --> 00:14:54,480
everything with skylight but again the

342
00:14:52,950 --> 00:14:56,780
more you do that the more extra rays

343
00:14:54,480 --> 00:14:59,490
you're casting and blah blah blah so

344
00:14:56,779 --> 00:15:01,829
it's hard to say exactly how we want to

345
00:14:59,490 --> 00:15:04,940
do that I'm not sure whether we want to

346
00:15:01,830 --> 00:15:07,139
retain an emission based scheme or not

347
00:15:04,940 --> 00:15:10,710
but my suspicion is what we probably

348
00:15:07,139 --> 00:15:14,850
want to do is do something where we have

349
00:15:10,710 --> 00:15:16,950
emitters we do sort of a shoot out from

350
00:15:14,850 --> 00:15:19,649
emitters to distribute light from the

351
00:15:16,950 --> 00:15:22,950
emission sources but then we probably

352
00:15:19,649 --> 00:15:24,120
also want to do gathers which we played

353
00:15:22,950 --> 00:15:26,250
with a little bit having a mission and

354
00:15:24,120 --> 00:15:28,679
gather we may want to have both

355
00:15:26,250 --> 00:15:30,330
happening you know you know again just

356
00:15:28,679 --> 00:15:33,870
because that's probably something that

357
00:15:30,330 --> 00:15:35,340
makes a little bit more sense alright so

358
00:15:33,870 --> 00:15:36,539
the other thing that I'd like to do is

359
00:15:35,340 --> 00:15:38,100
point out that I think we're getting

360
00:15:36,539 --> 00:15:39,599
pretty low leverage for what we're doing

361
00:15:38,100 --> 00:15:41,580
right now because we recompute the

362
00:15:39,600 --> 00:15:42,840
lighting every frame and then blend it

363
00:15:41,580 --> 00:15:45,450
with the lighting from the previous

364
00:15:42,840 --> 00:15:47,519
frames and the problem with that is I

365
00:15:45,450 --> 00:15:50,580
think we're getting very low leverage

366
00:15:47,519 --> 00:15:52,199
from our computation from that because

367
00:15:50,580 --> 00:15:53,879
once we figure out what the lighting is

368
00:15:52,200 --> 00:15:56,550
on a frame we might as well use that

369
00:15:53,879 --> 00:15:58,710
lighting on the next frame and continue

370
00:15:56,549 --> 00:16:00,449
to propagate it around right I feel like

371
00:15:58,710 --> 00:16:02,639
that's the smarter way to do things

372
00:16:00,450 --> 00:16:04,440
where we can basically say all right

373
00:16:02,639 --> 00:16:06,659
whatever the amount of light we want to

374
00:16:04,440 --> 00:16:09,960
keep from frame to frame is let's just

375
00:16:06,659 --> 00:16:12,019
make that be the starting emission for

376
00:16:09,960 --> 00:16:17,070
those surfaces whatever the reduction is

377
00:16:12,019 --> 00:16:18,449
and we'll go from there right so that

378
00:16:17,070 --> 00:16:20,460
might be the first thing to start with

379
00:16:18,450 --> 00:16:22,528
just so we can get back to something

380
00:16:20,460 --> 00:16:25,560
that's that's properly retaining

381
00:16:22,528 --> 00:16:27,899
actual light and not just blending with

382
00:16:25,559 --> 00:16:29,998
the old results so what I'd like to do

383
00:16:27,899 --> 00:16:33,568
is go ahead and take this routine down

384
00:16:29,999 --> 00:16:36,839
here so this is the routine that

385
00:16:33,568 --> 00:16:39,149
basically goes through and and you know

386
00:16:36,839 --> 00:16:42,600
averages that lighting information what

387
00:16:39,149 --> 00:16:44,970
I'd rather do is have this seed the

388
00:16:42,600 --> 00:16:46,920
initial lighting information so I think

389
00:16:44,970 --> 00:16:49,528
we can start we can do that relatively

390
00:16:46,919 --> 00:16:53,610
straightforward actually by just coming

391
00:16:49,528 --> 00:16:54,899
up here and just doing that right so

392
00:16:53,610 --> 00:16:56,550
right here where I've got this to do

393
00:16:54,899 --> 00:16:58,139
this is reload the previous emission and

394
00:16:56,549 --> 00:17:01,198
direction the starting point that that

395
00:16:58,139 --> 00:17:05,130
whole situation right that's exactly

396
00:17:01,198 --> 00:17:07,318
what I want to do here right that's

397
00:17:05,130 --> 00:17:09,929
exactly what I want to do here and we

398
00:17:07,318 --> 00:17:12,599
can get some nice synergy here because

399
00:17:09,929 --> 00:17:13,890
you can see this box index thing this is

400
00:17:12,599 --> 00:17:16,408
the same loop that we're doing to

401
00:17:13,890 --> 00:17:18,509
generate these points to begin with and

402
00:17:16,409 --> 00:17:20,549
so what I can do here is just say all

403
00:17:18,509 --> 00:17:22,669
right let's go ahead and grab the the

404
00:17:20,548 --> 00:17:25,709
parts of this that are actually relevant

405
00:17:22,669 --> 00:17:29,330
and use those to seed the lighting so

406
00:17:25,709 --> 00:17:32,909
suppose I come in here and say okay

407
00:17:29,329 --> 00:17:34,199
let's take a look at and you know what

408
00:17:32,909 --> 00:17:37,679
else I can do actually let me do this

409
00:17:34,200 --> 00:17:41,038
too as well let me save this down here

410
00:17:37,679 --> 00:17:44,120
and just nerf it so if we want to turn

411
00:17:41,038 --> 00:17:46,769
the blending back on we will be able to

412
00:17:44,119 --> 00:17:49,168
okay that that'll be something we can

413
00:17:46,769 --> 00:17:54,210
keep in there but let's go ahead and

414
00:17:49,169 --> 00:17:56,340
grab inside the boxing next stuff here

415
00:17:54,210 --> 00:17:57,990
I'm gonna go ahead and say we're gonna

416
00:17:56,339 --> 00:17:59,519
load up in that emission and you know

417
00:17:57,990 --> 00:18:01,679
what else - we don't have to care about

418
00:17:59,519 --> 00:18:03,629
this check anymore because the emission

419
00:18:01,679 --> 00:18:06,450
just would be what the emission is right

420
00:18:03,630 --> 00:18:08,190
so if the emission is zero it just won't

421
00:18:06,450 --> 00:18:10,470
add any emission so all we're gonna do

422
00:18:08,190 --> 00:18:12,269
is just add that emission in and so

423
00:18:10,470 --> 00:18:15,538
that's pretty trivial for us to do right

424
00:18:12,269 --> 00:18:17,759
so all we need is this basically we need

425
00:18:15,538 --> 00:18:23,629
to go ahead and here where we set this

426
00:18:17,759 --> 00:18:23,629
emit C zero we need to just add into it

427
00:18:24,680 --> 00:18:30,799
something like this so we need to know

428
00:18:28,069 --> 00:18:33,710
for the given box what the local index

429
00:18:30,799 --> 00:18:35,960
is that we're on right and you can kind

430
00:18:33,710 --> 00:18:41,480
of see how we were doing that already

431
00:18:35,960 --> 00:18:42,559
here we've got this light index here

432
00:18:41,480 --> 00:18:44,150
that's that's coming off the box

433
00:18:42,559 --> 00:18:46,490
lighting next if we wanted to know what

434
00:18:44,150 --> 00:18:48,350
the local index was off of the box it

435
00:18:46,490 --> 00:18:51,319
would just be the light index - this box

436
00:18:48,349 --> 00:18:53,569
index right which is not something that

437
00:18:51,319 --> 00:18:54,649
we currently store but easily could so

438
00:18:53,569 --> 00:18:57,019
if I take a look at where we're using

439
00:18:54,650 --> 00:19:01,490
light index here but you can see that

440
00:18:57,019 --> 00:19:04,519
it's really only used in in these sort

441
00:19:01,490 --> 00:19:06,980
of simplified ways here and what I can

442
00:19:04,519 --> 00:19:08,569
do is I can just change these checks to

443
00:19:06,980 --> 00:19:10,700
be a little bit more well you know what

444
00:19:08,569 --> 00:19:12,200
I could why even bother I'll just do it

445
00:19:10,700 --> 00:19:17,630
this way I'll just reverse computed here

446
00:19:12,200 --> 00:19:19,400
it's fine right so that's the place in

447
00:19:17,630 --> 00:19:21,380
the box where the emission value is

448
00:19:19,400 --> 00:19:23,000
actually being stored so that would seed

449
00:19:21,380 --> 00:19:24,770
the emission for this frame with

450
00:19:23,000 --> 00:19:28,670
whatever it was computed to be on the

451
00:19:24,769 --> 00:19:29,720
previous frame and so that is you know

452
00:19:28,670 --> 00:19:32,269
it's all we want to do there however

453
00:19:29,720 --> 00:19:34,460
remember we don't want to use all of it

454
00:19:32,269 --> 00:19:37,400
so we want a retained emission

455
00:19:34,460 --> 00:19:40,250
coefficient because we don't want we

456
00:19:37,400 --> 00:19:43,280
want the old effects to fade over time

457
00:19:40,250 --> 00:19:45,440
right so we don't know what that

458
00:19:43,279 --> 00:19:47,089
efficient could be it's like what that

459
00:19:45,440 --> 00:19:49,190
coefficient should be because again this

460
00:19:47,089 --> 00:19:50,599
is an ad hoc solution where we're taking

461
00:19:49,190 --> 00:19:53,029
something that we do know how to do

462
00:19:50,599 --> 00:19:54,619
which is slow global illumination and

463
00:19:53,029 --> 00:19:56,720
we're trying to make it fast by making

464
00:19:54,619 --> 00:19:58,579
approximations so this value is

465
00:19:56,720 --> 00:20:02,450
literally just whatever will make it

466
00:19:58,579 --> 00:20:04,429
look the best right and we have no idea

467
00:20:02,450 --> 00:20:07,250
what that is so we'll have to tune it to

468
00:20:04,430 --> 00:20:09,259
whatever looks the best once we run it I

469
00:20:07,250 --> 00:20:12,019
think then we're done I don't know that

470
00:20:09,259 --> 00:20:13,640
we need anything else to happen here I

471
00:20:12,019 --> 00:20:16,400
could be wrong about that but we'll find

472
00:20:13,640 --> 00:20:18,440
out oops that's not index that's light

473
00:20:16,400 --> 00:20:22,700
index and in fact I can here also say

474
00:20:18,440 --> 00:20:28,309
what the local index actually is because

475
00:20:22,700 --> 00:20:30,220
the local index is still a valid name

476
00:20:28,309 --> 00:20:35,599
for that

477
00:20:30,220 --> 00:20:38,899
so let me just pull it out here and

478
00:20:35,599 --> 00:20:41,298
that's I think all we would have to do

479
00:20:38,898 --> 00:20:43,729
to kind of preserve the light so that

480
00:20:41,298 --> 00:20:45,048
the light kind of comes through granted

481
00:20:43,730 --> 00:20:46,929
that is not a particularly flattering

482
00:20:45,048 --> 00:20:50,210
effect for the wow that is pretty

483
00:20:46,929 --> 00:20:55,639
interesting um I'm not sure why it's

484
00:20:50,210 --> 00:20:58,970
quite so flickery I house very odd I

485
00:20:55,638 --> 00:21:01,128
think this is correct and we are

486
00:20:58,970 --> 00:21:09,889
retaining a fair bit of the light there

487
00:21:01,128 --> 00:21:12,168
box storage you know what it's not

488
00:21:09,888 --> 00:21:14,269
getting written back though so the one

489
00:21:12,169 --> 00:21:18,169
thing we do have to do is we do need

490
00:21:14,269 --> 00:21:21,319
this routine to be still enabled and we

491
00:21:18,169 --> 00:21:26,269
just need the box storage omission to be

492
00:21:21,319 --> 00:21:28,069
saved so you can see that happening here

493
00:21:26,269 --> 00:21:30,048
oh and you know what this normalization

494
00:21:28,069 --> 00:21:32,148
also so okay I was a little premature

495
00:21:30,048 --> 00:21:33,528
when I said we could nerf that we can't

496
00:21:32,148 --> 00:21:40,099
actually nerf it the only thing we can

497
00:21:33,528 --> 00:21:42,499
really nerve is this right we still have

498
00:21:40,099 --> 00:21:45,199
to come through here and we still have

499
00:21:42,499 --> 00:21:48,679
to record this information although you

500
00:21:45,200 --> 00:21:49,460
know what actually we don't even really

501
00:21:48,679 --> 00:21:51,288
have to do that

502
00:21:49,460 --> 00:21:53,929
all we have to do is always set valid to

503
00:21:51,288 --> 00:21:56,028
false because as long as valid is always

504
00:21:53,929 --> 00:21:58,399
false then what it will do is it will

505
00:21:56,028 --> 00:22:00,499
always use this branch which all it does

506
00:21:58,398 --> 00:22:02,599
is do direct right backs which is what

507
00:22:00,499 --> 00:22:07,450
we want right narrow blending just right

508
00:22:02,599 --> 00:22:07,449
backs so that should be fine

509
00:22:10,339 --> 00:22:14,298
but yeah we have to do that final loop

510
00:22:12,798 --> 00:22:16,608
because we have to do the normalization

511
00:22:14,298 --> 00:22:20,778
of the direction and we have to store it

512
00:22:16,608 --> 00:22:23,778
so that's all good so this retains I

513
00:22:20,778 --> 00:22:26,388
guess too much light to say the very

514
00:22:23,778 --> 00:22:30,099
least unless I've got a bug there so

515
00:22:26,388 --> 00:22:30,099
let's let's retain less light than that

516
00:22:32,029 --> 00:22:35,660
we're also getting a lot slower I think

517
00:22:33,920 --> 00:22:38,390
because there's a lot more services with

518
00:22:35,660 --> 00:22:41,000
light on them if that makes sense so

519
00:22:38,390 --> 00:22:42,980
it's kind of hard to because so we we

520
00:22:41,000 --> 00:22:45,048
end up doing a lot more propagations in

521
00:22:42,980 --> 00:22:47,120
that initial one but we should also be

522
00:22:45,048 --> 00:22:49,609
able to turn down the lighting quite a

523
00:22:47,119 --> 00:22:52,069
bit from there let me actually see to

524
00:22:49,609 --> 00:22:53,990
what extent I can do that because now we

525
00:22:52,069 --> 00:22:56,329
don't need to do the sort of Jack Trey

526
00:22:53,990 --> 00:23:00,380
count thing you know the rate count gets

527
00:22:56,329 --> 00:23:02,629
gets sort of diminished as we go out

528
00:23:00,380 --> 00:23:05,540
here we don't really have to do that

529
00:23:02,630 --> 00:23:09,290
anymore this can sort of be a flat

530
00:23:05,539 --> 00:23:12,798
number that we can tune because we don't

531
00:23:09,289 --> 00:23:15,798
really have to worry about that initial

532
00:23:12,798 --> 00:23:20,480
lighting part of things right so I don't

533
00:23:15,798 --> 00:23:28,220
know so yeah like still like very

534
00:23:20,480 --> 00:23:29,960
flickery right unfortunately and you

535
00:23:28,220 --> 00:23:31,308
know I'm just trying to think through

536
00:23:29,960 --> 00:23:32,960
exactly how I want to approach this

537
00:23:31,308 --> 00:23:35,119
problem because I would I mean maybe

538
00:23:32,960 --> 00:23:37,940
that's dumb right like maybe you just

539
00:23:35,119 --> 00:23:39,619
don't ever want to remit values in the

540
00:23:37,940 --> 00:23:41,120
previous frame but it seems like you

541
00:23:39,619 --> 00:23:43,308
would want them to be able to propagate

542
00:23:41,119 --> 00:23:48,009
over multiple frames right that just

543
00:23:43,308 --> 00:23:48,009
seems like what you would want to do for

544
00:23:48,130 --> 00:23:54,220
efficacy

545
00:23:49,490 --> 00:23:58,250
efficacy but again I don't really know

546
00:23:54,220 --> 00:24:00,890
these are sort of exercises in in

547
00:23:58,250 --> 00:24:04,369
figuring out what is the you know most

548
00:24:00,890 --> 00:24:09,740
palatable choice so anyway but looking

549
00:24:04,369 --> 00:24:13,548
at this I'm interested to know what

550
00:24:09,740 --> 00:24:16,759
happens if we cast few Ray's but have a

551
00:24:13,548 --> 00:24:19,599
higher retention coefficient just want

552
00:24:16,759 --> 00:24:19,599
to see what happens here

553
00:24:23,950 --> 00:24:28,880
so you can see what happens when the

554
00:24:26,298 --> 00:24:31,099
retention coefficient is high enough you

555
00:24:28,880 --> 00:24:33,860
can see the light kind of spreading it's

556
00:24:31,099 --> 00:24:35,719
interesting actually let me go ahead and

557
00:24:33,859 --> 00:24:42,579
change it on the fly so let's change it

558
00:24:35,720 --> 00:24:42,579
down to 0.5 it's really fascinating

559
00:24:50,250 --> 00:24:57,670
but you can definitely see like so for

560
00:24:52,839 --> 00:24:59,859
example right underneath one of the

561
00:24:57,670 --> 00:25:01,630
problems that you get if I do this right

562
00:24:59,859 --> 00:25:05,619
is that because it's not just blending

563
00:25:01,630 --> 00:25:08,050
results with other results you end up in

564
00:25:05,619 --> 00:25:12,669
a nasty situation where you still get a

565
00:25:08,049 --> 00:25:16,529
lot of flickering because well at this

566
00:25:12,670 --> 00:25:16,529
stochastic part of the process which is

567
00:25:16,859 --> 00:25:21,579
doing that transmission is obviously

568
00:25:19,660 --> 00:25:24,430
going to introduce the noise and you

569
00:25:21,579 --> 00:25:25,960
don't get a lot of reprieve from that so

570
00:25:24,430 --> 00:25:29,830
if we wanted to do something that's

571
00:25:25,960 --> 00:25:31,360
gonna be you know Flickr reducing what

572
00:25:29,829 --> 00:25:34,899
we'd have to do is in you know when

573
00:25:31,359 --> 00:25:36,909
we're actually doing yeah for example

574
00:25:34,900 --> 00:25:41,650
let's suppose we just said you know what

575
00:25:36,910 --> 00:25:43,210
the the light is always going to be you

576
00:25:41,650 --> 00:25:45,730
know we're always gonna propagate the

577
00:25:43,210 --> 00:25:50,620
exact same light and we just want the

578
00:25:45,730 --> 00:25:53,079
light to decay more as it goes right we

579
00:25:50,619 --> 00:25:55,149
could just just take more energy out of

580
00:25:53,079 --> 00:25:58,480
the system as we're doing bounces right

581
00:25:55,150 --> 00:26:00,370
and and not use as much of it let the

582
00:25:58,480 --> 00:26:02,500
light sort of drain out as part of the

583
00:26:00,369 --> 00:26:06,309
bounces and have those bounces effect

584
00:26:02,500 --> 00:26:08,799
surfaces less right and I'm not sure

585
00:26:06,309 --> 00:26:11,109
exactly how we would do that so you know

586
00:26:08,799 --> 00:26:12,879
let's suppose we set this to one so you

587
00:26:11,109 --> 00:26:16,089
just retain all of the light from the

588
00:26:12,880 --> 00:26:18,160
previous frame but when you come in here

589
00:26:16,089 --> 00:26:19,779
and you know you've got this light

590
00:26:18,160 --> 00:26:23,529
retention value instead of this being

591
00:26:19,779 --> 00:26:26,500
power conserving it will just be powered

592
00:26:23,529 --> 00:26:28,599
decaying so for example when you come

593
00:26:26,500 --> 00:26:30,759
through here and we do the retain see

594
00:26:28,599 --> 00:26:32,679
minus equals accumulate sample and you

595
00:26:30,759 --> 00:26:36,190
you know we've got the power value in

596
00:26:32,680 --> 00:26:38,650
here right what we could do is say that

597
00:26:36,190 --> 00:26:42,640
that power value is actually going to be

598
00:26:38,650 --> 00:26:45,250
a lot less than 1.0 right so the total

599
00:26:42,640 --> 00:26:46,930
power that can get distributed out will

600
00:26:45,250 --> 00:26:49,269
be much less than that and they retained

601
00:26:46,930 --> 00:26:58,230
light will be much higher so for example

602
00:26:49,269 --> 00:26:58,230
what we could do is say well you know

603
00:26:58,500 --> 00:27:03,220
we want to do it over ten frames we've

604
00:27:01,269 --> 00:27:06,279
said that say that our power was going

605
00:27:03,220 --> 00:27:09,339
to be a tenth of whatever the amount of

606
00:27:06,279 --> 00:27:12,549
power actually distributed was and so as

607
00:27:09,339 --> 00:27:15,909
we come through here we will retain most

608
00:27:12,549 --> 00:27:18,178
of the light that we had at the start so

609
00:27:15,910 --> 00:27:20,950
we won't change our lighting values much

610
00:27:18,179 --> 00:27:25,330
we will just diminish every time we

611
00:27:20,950 --> 00:27:28,808
actually transport something by by this

612
00:27:25,329 --> 00:27:32,799
blend amount right and I don't know

613
00:27:28,808 --> 00:27:35,230
exactly how we would have to balance

614
00:27:32,799 --> 00:27:39,149
this I'm assuming these or should

615
00:27:35,230 --> 00:27:39,150
basically be equivalent

616
00:27:49,750 --> 00:27:53,930
we're gonna have to work this math out

617
00:27:51,710 --> 00:27:56,140
on the blackboard actually cuz I'm not

618
00:27:53,930 --> 00:27:56,140
sure

619
00:28:01,230 --> 00:28:05,829
but as you can see this is starting to

620
00:28:03,490 --> 00:28:07,720
be more more reasonable so let's go

621
00:28:05,829 --> 00:28:13,869
ahead and say let's let's take a look at

622
00:28:07,720 --> 00:28:16,048
this so let's say we did even less than

623
00:28:13,869 --> 00:28:16,048
this

624
00:28:25,690 --> 00:28:31,159
and you can see that gets us down to a

625
00:28:28,038 --> 00:28:32,980
fairly low amount of flicker right it's

626
00:28:31,159 --> 00:28:37,278
still not quite as much as we would like

627
00:28:32,980 --> 00:28:38,749
but it's getting lower and I'm not sure

628
00:28:37,278 --> 00:28:40,819
how much flicker we would have if we

629
00:28:38,749 --> 00:28:42,288
were to crank our ray count up more I'm

630
00:28:40,819 --> 00:28:45,439
not sure how much thicker we're getting

631
00:28:42,288 --> 00:28:51,739
from the that that could be resolved

632
00:28:45,440 --> 00:28:55,669
with with denser sampling it's like

633
00:28:51,739 --> 00:28:58,940
doesn't help that much it appears to

634
00:28:55,669 --> 00:29:01,778
flicker or less just because the frame

635
00:28:58,940 --> 00:29:05,090
rate gets lower as we crank that value

636
00:29:01,778 --> 00:29:06,919
but it's still quite a bit of flicker so

637
00:29:05,089 --> 00:29:09,558
let's say we set it down even even lower

638
00:29:06,919 --> 00:29:14,239
there I also think maybe we only want to

639
00:29:09,558 --> 00:29:16,460
run one iteration of the lighting now so

640
00:29:14,239 --> 00:29:26,869
what I might say is the iteration count

641
00:29:16,460 --> 00:29:32,960
I may I may actually just nerf this so

642
00:29:26,868 --> 00:29:34,970
we just run one pass for frame right and

643
00:29:32,960 --> 00:29:36,440
you can really see okay so the and this

644
00:29:34,970 --> 00:29:38,899
is running it you know obviously also

645
00:29:36,440 --> 00:29:41,480
have much higher frame rate but you know

646
00:29:38,898 --> 00:29:45,018
you can kind of see how it's like yeah

647
00:29:41,480 --> 00:29:47,899
if we just could get the sampling a

648
00:29:45,019 --> 00:29:51,739
little more stable it starts to be

649
00:29:47,898 --> 00:29:53,748
something fairly usable so I do think

650
00:29:51,739 --> 00:29:58,489
you know I think that's kind of the what

651
00:29:53,749 --> 00:29:59,929
I want to look at I think I want to look

652
00:29:58,489 --> 00:30:02,569
at doing something that just does a

653
00:29:59,929 --> 00:30:04,220
single pass so it doesn't iterate it

654
00:30:02,569 --> 00:30:07,339
does a single pass on the lighting and

655
00:30:04,220 --> 00:30:09,710
then it just refines that one every

656
00:30:07,339 --> 00:30:16,089
frame refract refines the lighting you

657
00:30:09,710 --> 00:30:16,090
know every frame and goes from there so

658
00:30:16,450 --> 00:30:20,690
and the other thing is I don't know

659
00:30:19,009 --> 00:30:24,739
maybe we change it to being pull based

660
00:30:20,690 --> 00:30:27,409
as well too because that's flatter if we

661
00:30:24,739 --> 00:30:28,730
go over everything once and pull from

662
00:30:27,409 --> 00:30:31,249
neighbors

663
00:30:28,730 --> 00:30:33,019
instead of doing push then it doesn't

664
00:30:31,249 --> 00:30:36,679
change based on the lighting environment

665
00:30:33,019 --> 00:30:38,220
the speed of it it's more stable in

666
00:30:36,679 --> 00:30:41,490
terms of frame rate which I think I

667
00:30:38,220 --> 00:30:43,079
so want so let's just try to simplify

668
00:30:41,490 --> 00:30:45,349
this loop down to something that works

669
00:30:43,079 --> 00:30:48,149
like this we're gonna run it one time

670
00:30:45,349 --> 00:30:50,428
we're gonna run over the collection

671
00:30:48,150 --> 00:30:51,840
services they're gonna cast out and see

672
00:30:50,429 --> 00:30:56,340
what they hit and that's all we're gonna

673
00:30:51,839 --> 00:30:59,730
do maybe and you know I I'm a little

674
00:30:56,339 --> 00:31:01,740
nervous about it because I do think

675
00:30:59,730 --> 00:31:04,200
there's a plus two going from the

676
00:31:01,740 --> 00:31:05,970
emitters so we may have to do a

677
00:31:04,200 --> 00:31:08,519
distribution pass where emission

678
00:31:05,970 --> 00:31:12,029
surfaces with high emission will get

679
00:31:08,519 --> 00:31:16,619
some special treatment where they'll get

680
00:31:12,029 --> 00:31:25,889
to shoot rays out as a separate part of

681
00:31:16,619 --> 00:31:27,269
the pass but I don't know it's pretty

682
00:31:25,890 --> 00:31:29,970
hard to say the other thing to remember

683
00:31:27,269 --> 00:31:31,740
is if we again if we add that skylight

684
00:31:29,970 --> 00:31:34,079
in there where we're getting light from

685
00:31:31,740 --> 00:31:35,519
the sky that's gonna even out of the

686
00:31:34,079 --> 00:31:38,908
lighting a little bit by giving some

687
00:31:35,519 --> 00:31:41,460
under you know some ambient to the

688
00:31:38,909 --> 00:31:43,590
lighting that you're getting from from

689
00:31:41,460 --> 00:31:45,150
the outside which will also help but of

690
00:31:43,589 --> 00:31:47,869
course you know for indoor situations

691
00:31:45,150 --> 00:31:51,059
that's not going to be true so you know

692
00:31:47,869 --> 00:31:53,219
your mileage may vary but anyway so

693
00:31:51,058 --> 00:31:55,980
let's let's yeah let's kind of move

694
00:31:53,220 --> 00:32:02,630
towards this a little bit and see what

695
00:31:55,980 --> 00:32:08,690
we can do so let's take and and look at

696
00:32:02,630 --> 00:32:08,690
what maybe this this guy right here and

697
00:32:08,779 --> 00:32:17,819
and sort of transform this loop into

698
00:32:13,859 --> 00:32:26,519
this loop maybe also if we cast from the

699
00:32:17,819 --> 00:32:32,668
light points out that actually might

700
00:32:26,519 --> 00:32:35,579
give us a more useful way to to sample

701
00:32:32,669 --> 00:32:38,210
what lighting we hit I'm not sure about

702
00:32:35,579 --> 00:32:43,889
that but I

703
00:32:38,210 --> 00:32:46,019
there there's right now we're just

704
00:32:43,890 --> 00:32:47,520
whenever we hit a surface we give light

705
00:32:46,019 --> 00:32:50,639
to the surface point that we were

706
00:32:47,519 --> 00:32:51,990
closest to hitting and what we could do

707
00:32:50,640 --> 00:32:54,000
in the future is take

708
00:32:51,990 --> 00:32:56,250
from points that you take lights from

709
00:32:54,000 --> 00:33:00,329
all the points that are nearby much like

710
00:32:56,250 --> 00:33:02,190
we do with our interpolation so I'm not

711
00:33:00,329 --> 00:33:12,779
sure again exactly how we want to treat

712
00:33:02,190 --> 00:33:14,279
that but but I do think that collection

713
00:33:12,779 --> 00:33:17,039
that you know basically doing the

714
00:33:14,279 --> 00:33:19,710
collection basis system would be more

715
00:33:17,039 --> 00:33:21,329
consistent just for Speed purposes

716
00:33:19,710 --> 00:33:23,009
because the speed will remain the same

717
00:33:21,329 --> 00:33:24,750
no matter how much lighting there is

718
00:33:23,009 --> 00:33:26,460
going on in the scene and I'm just

719
00:33:24,750 --> 00:33:27,839
afraid that if we go with an emission

720
00:33:26,460 --> 00:33:30,029
based scheme we're always gonna have

721
00:33:27,839 --> 00:33:31,919
these nasty spikes in the amount of time

722
00:33:30,029 --> 00:33:35,549
that the light takes whereas as you get

723
00:33:31,920 --> 00:33:37,980
more emitters you get slower and I don't

724
00:33:35,549 --> 00:33:41,159
love that so I don't know this may be a

725
00:33:37,980 --> 00:33:43,529
big mistake and I apologize if it is but

726
00:33:41,160 --> 00:33:48,480
I just got to go with with my gut on

727
00:33:43,529 --> 00:33:50,789
this because I don't know ahead of time

728
00:33:48,480 --> 00:33:53,910
exactly what the right solution is going

729
00:33:50,789 --> 00:33:55,170
to be right so let's get rid of these

730
00:33:53,910 --> 00:34:00,179
occlusion counts here

731
00:33:55,170 --> 00:34:03,480
I mean iteration counts and let's

732
00:34:00,179 --> 00:34:07,080
replace it instead with a point

733
00:34:03,480 --> 00:34:08,159
collection style scheme so what we're

734
00:34:07,079 --> 00:34:14,210
going to do is we're gonna go through to

735
00:34:08,159 --> 00:34:17,659
the points here and so for every point

736
00:34:14,210 --> 00:34:20,699
we're gonna do a collection pass and

737
00:34:17,659 --> 00:34:23,929
yeah you know this is exactly what we

738
00:34:20,699 --> 00:34:23,928
would we do right here

739
00:34:29,648 --> 00:34:35,618
so we're going to take a scent this is

740
00:34:32,349 --> 00:34:37,929
sample point index really where we're

741
00:34:35,619 --> 00:34:40,389
going to sample the lighting from so

742
00:34:37,929 --> 00:34:42,940
we'll grab a sample point and in a

743
00:34:40,389 --> 00:34:47,309
sample direction and we'll sample the

744
00:34:42,940 --> 00:34:55,210
hemisphere out from that direction I and

745
00:34:47,309 --> 00:34:58,150
yeah once we do that we're going to want

746
00:34:55,210 --> 00:35:02,858
to throw the Ray out and we're going to

747
00:34:58,150 --> 00:35:03,970
want to see if it hit and then from

748
00:35:02,858 --> 00:35:07,929
there we're gonna have to decide how

749
00:35:03,969 --> 00:35:09,518
we're gonna do our transfer right so I

750
00:35:07,929 --> 00:35:12,399
want to do something like this we go

751
00:35:09,518 --> 00:35:16,808
through everything once one of the nice

752
00:35:12,400 --> 00:35:19,000
things is now emit see one in emit c0r

753
00:35:16,809 --> 00:35:21,369
it's really just a source and a destiny

754
00:35:19,000 --> 00:35:26,739
gets used once so you wouldn't really

755
00:35:21,369 --> 00:35:28,510
have to do the right back here at all we

756
00:35:26,739 --> 00:35:30,129
would not have to clear this to zero now

757
00:35:28,510 --> 00:35:32,619
that doesn't matter that's not taking

758
00:35:30,130 --> 00:35:35,440
much of the time or anything so we can

759
00:35:32,619 --> 00:35:37,000
retain this but then when we go to do

760
00:35:35,440 --> 00:35:42,269
the final cleaned up version of this we

761
00:35:37,000 --> 00:35:42,268
won't have to do that right so this is

762
00:35:49,230 --> 00:35:53,490
so assuming we stick with one-pass we

763
00:35:51,719 --> 00:35:54,989
can eventually get rid of this concept

764
00:35:53,489 --> 00:35:57,389
and we can just have a source and a

765
00:35:54,989 --> 00:35:59,789
destiny so are you the best and we're

766
00:35:57,389 --> 00:36:04,348
done and we don't need to re clear the

767
00:35:59,789 --> 00:36:06,539
desk in any particular way because it's

768
00:36:04,349 --> 00:36:11,519
going to get seeded with the inputs from

769
00:36:06,539 --> 00:36:14,489
from the next time I think again not

770
00:36:11,519 --> 00:36:18,300
100% sure about that but I'm pretty sure

771
00:36:14,489 --> 00:36:19,439
about that yeah because everything has

772
00:36:18,300 --> 00:36:20,609
to come from a lightning box those

773
00:36:19,440 --> 00:36:22,289
lighting boxes are the things that will

774
00:36:20,608 --> 00:36:25,409
be cleared so yeah so this will not

775
00:36:22,289 --> 00:36:27,239
really have to happen anymore because

776
00:36:25,409 --> 00:36:29,039
the sources will just be correct and the

777
00:36:27,239 --> 00:36:32,219
destination will be what we read from at

778
00:36:29,039 --> 00:36:34,108
the end and so everything will be fine

779
00:36:32,219 --> 00:36:36,959
so that's fine I think that's all good

780
00:36:34,108 --> 00:36:38,250
and then what we want to do now is start

781
00:36:36,960 --> 00:36:42,720
to think about how we're actually going

782
00:36:38,250 --> 00:36:46,559
to apply the lighting here so accumulate

783
00:36:42,719 --> 00:36:49,289
sample is still you know the same thing

784
00:36:46,559 --> 00:36:51,779
we want to use we're just going to want

785
00:36:49,289 --> 00:36:56,338
to be passing different information to

786
00:36:51,780 --> 00:36:58,740
it so the sample point that we're going

787
00:36:56,338 --> 00:37:01,380
to be talking about we already know now

788
00:36:58,739 --> 00:37:04,318
so we know it's going to be the sample

789
00:37:01,380 --> 00:37:09,200
point normal here is the normal that

790
00:37:04,318 --> 00:37:12,179
we're gonna get for surface reflection

791
00:37:09,199 --> 00:37:16,129
we also have this decimate c+ closest

792
00:37:12,179 --> 00:37:19,588
point index here I guess that's the

793
00:37:16,130 --> 00:37:22,200
target that we're writing to and so

794
00:37:19,588 --> 00:37:25,230
that's again just going to be the sample

795
00:37:22,199 --> 00:37:28,500
point index right that's that's what

796
00:37:25,230 --> 00:37:30,179
we're writing into the solution average

797
00:37:28,500 --> 00:37:31,980
direction to light plus those pointers

798
00:37:30,179 --> 00:37:33,210
same thing again this is just a sample

799
00:37:31,980 --> 00:37:35,579
point so that's what we're writing out

800
00:37:33,210 --> 00:37:37,949
and then what we need to know is emit

801
00:37:35,579 --> 00:37:40,920
see the power and the the emit direction

802
00:37:37,949 --> 00:37:42,929
so the emit Direction here this actually

803
00:37:40,920 --> 00:37:45,240
isn't going to be negated it is actually

804
00:37:42,929 --> 00:37:47,848
the sample direction because again we're

805
00:37:45,239 --> 00:37:49,919
shooting we're gathering out not you

806
00:37:47,849 --> 00:37:52,019
know talking about an inbound point so I

807
00:37:49,920 --> 00:37:54,780
believe that should be sampled e because

808
00:37:52,019 --> 00:37:56,068
sample D and sample point arrow n are

809
00:37:54,780 --> 00:37:58,260
pointing the same direction which is

810
00:37:56,068 --> 00:38:00,420
what we want for the dot product and so

811
00:37:58,260 --> 00:38:02,190
really it's emit C and power that are

812
00:38:00,420 --> 00:38:02,880
the two things we need to be computing

813
00:38:02,190 --> 00:38:06,570
here

814
00:38:02,880 --> 00:38:08,010
and those need to be computed based on

815
00:38:06,570 --> 00:38:12,570
the box that we hit power

816
00:38:08,010 --> 00:38:14,610
probably not but emit see definitely so

817
00:38:12,570 --> 00:38:17,760
we got the same sorts of problems we

818
00:38:14,610 --> 00:38:20,570
have before where we got to start

819
00:38:17,760 --> 00:38:20,570
thinking about this stuff

820
00:38:31,150 --> 00:38:35,950
that'll look sign to me uh so yeah

821
00:38:34,239 --> 00:38:40,118
taking a look at this we don't care

822
00:38:35,949 --> 00:38:41,439
about we don't care about really how we

823
00:38:40,119 --> 00:38:42,818
were doing this before because we're

824
00:38:41,440 --> 00:38:46,509
gonna have to change the stuff I also

825
00:38:42,818 --> 00:38:55,150
want to grab the sky information stuff

826
00:38:46,509 --> 00:38:57,699
here there we go and what we can do now

827
00:38:55,150 --> 00:39:02,380
is we have a Sun Direction a Sun color

828
00:38:57,699 --> 00:39:06,129
in a sky color I don't know why that's

829
00:39:02,380 --> 00:39:08,858
like that um change the way these work

830
00:39:06,130 --> 00:39:12,490
so once we have a sky color in a Sun

831
00:39:08,858 --> 00:39:18,400
color that means we can also make

832
00:39:12,489 --> 00:39:20,919
whenever we miss so before every time we

833
00:39:18,400 --> 00:39:23,740
missed we did nothing now anytime we

834
00:39:20,920 --> 00:39:26,858
miss we can use this sky color or the

835
00:39:23,739 --> 00:39:29,018
Sun color and we also need us I guess a

836
00:39:26,858 --> 00:39:32,078
ground color which is something for

837
00:39:29,018 --> 00:39:35,318
casting down and don't hit anything so

838
00:39:32,079 --> 00:39:37,720
we kind of just need to know what kind

839
00:39:35,318 --> 00:39:40,900
of it of a situation we're dealing with

840
00:39:37,719 --> 00:39:49,179
I'm gonna set this to something sort of

841
00:39:40,900 --> 00:39:50,139
a dark brownish color I so this stuff

842
00:39:49,179 --> 00:39:54,278
right here will give us the information

843
00:39:50,139 --> 00:39:58,690
we need to fill in our missing emissions

844
00:39:54,278 --> 00:40:00,880
with something related right and so

845
00:39:58,690 --> 00:40:03,159
something that that does like lighting

846
00:40:00,880 --> 00:40:04,690
from the environment so that'll be nice

847
00:40:03,159 --> 00:40:06,879
too because then we can do this sort of

848
00:40:04,690 --> 00:40:12,700
thing we were doing with our with our

849
00:40:06,880 --> 00:40:16,150
son information here and we can yeah we

850
00:40:12,699 --> 00:40:17,139
can we can basically make a more

851
00:40:16,150 --> 00:40:19,568
interesting lighting environment that

852
00:40:17,139 --> 00:40:23,348
way I don't know that we ever have a son

853
00:40:19,568 --> 00:40:24,818
I guess there's a moon in this game but

854
00:40:23,349 --> 00:40:30,759
it doesn't take place in the daytime so

855
00:40:24,818 --> 00:40:32,949
it's gonna be moon color for what's

856
00:40:30,759 --> 00:40:38,489
worth and probably I'm guessing the moon

857
00:40:32,949 --> 00:40:38,489
is you know probably still pretty dark

858
00:40:47,739 --> 00:41:05,299
we're gonna have to set these to

859
00:40:49,670 --> 00:41:06,470
something reasonable I don't really know

860
00:41:05,300 --> 00:41:08,800
if those are even in the ballpark of

861
00:41:06,469 --> 00:41:11,389
correct but we'll mix the colors later

862
00:41:08,800 --> 00:41:14,060
all right so getting back to what we

863
00:41:11,389 --> 00:41:15,379
need to do here so this single pass here

864
00:41:14,059 --> 00:41:16,759
where we're just going to do compute

865
00:41:15,380 --> 00:41:18,829
light propagation we're going to do one

866
00:41:16,760 --> 00:41:21,080
pass over all of the sample points we're

867
00:41:18,829 --> 00:41:23,659
going to compute the ray casts from each

868
00:41:21,079 --> 00:41:28,730
of them and then we're going to write

869
00:41:23,659 --> 00:41:40,449
back and what we need to do here example

870
00:41:28,730 --> 00:41:40,449
D in there uh does recast

871
00:41:42,730 --> 00:41:50,360
so skip index has to be the box that we

872
00:41:47,059 --> 00:41:53,509
were coming from and we don't know the

873
00:41:50,360 --> 00:42:01,519
box that we're coming from which makes

874
00:41:53,510 --> 00:42:03,260
it kind tricky right I think we can

875
00:42:01,519 --> 00:42:04,820
probably just not bother with that

876
00:42:03,260 --> 00:42:06,560
anymore because we know that we're

877
00:42:04,820 --> 00:42:08,840
always sampling from boxes and we're

878
00:42:06,559 --> 00:42:14,440
always we don't check the back faces of

879
00:42:08,840 --> 00:42:14,440
the boxes so I think we're probably fine

880
00:42:15,550 --> 00:42:19,300
at least at the moment

881
00:42:21,289 --> 00:42:28,880
to not do the skip check the problem is

882
00:42:26,659 --> 00:42:36,739
if we want to do something like that in

883
00:42:28,880 --> 00:42:39,550
the future I'm thinking about for bigger

884
00:42:36,739 --> 00:42:39,549
boxes

885
00:42:49,130 --> 00:42:55,280
because if I'm not mistaken didn't we do

886
00:42:51,719 --> 00:42:59,489
something gnarly where we said like okay

887
00:42:55,280 --> 00:43:01,620
when we're splitting the boxes and we

888
00:42:59,489 --> 00:43:03,569
come through here and build them didn't

889
00:43:01,619 --> 00:43:12,299
we do something weird like negate the

890
00:43:03,570 --> 00:43:14,160
radius where did we not do that I guess

891
00:43:12,300 --> 00:43:16,019
we actually checked to see if we're

892
00:43:14,159 --> 00:43:19,230
inside the box so I guess we're okay so

893
00:43:16,019 --> 00:43:29,849
I guess we can if we want to get rid of

894
00:43:19,230 --> 00:43:31,559
this and we'll be okay all right so

895
00:43:29,849 --> 00:43:36,019
anyway in here where we're doing our

896
00:43:31,559 --> 00:43:38,039
sampling we can just get rid of this

897
00:43:36,019 --> 00:43:40,259
sample point next to when we do the

898
00:43:38,039 --> 00:43:55,529
raycast it just doesn't take a skip

899
00:43:40,260 --> 00:43:59,250
index anymore so that's just taken out

900
00:43:55,530 --> 00:44:01,680
of the equation and so yeah I think

901
00:43:59,250 --> 00:44:04,619
we're left with just how exactly we want

902
00:44:01,679 --> 00:44:07,109
to find out what point we're grabbing

903
00:44:04,619 --> 00:44:10,739
from once we get a ray box here if we

904
00:44:07,110 --> 00:44:17,370
don't get a ray box then again the

905
00:44:10,739 --> 00:44:20,159
things we need to set are the emit C and

906
00:44:17,369 --> 00:44:23,690
the power now the power again I think

907
00:44:20,159 --> 00:44:27,149
should be the same it should just be

908
00:44:23,690 --> 00:44:30,720
what what it was going to be tuned to

909
00:44:27,150 --> 00:44:32,369
before or you know since we don't really

910
00:44:30,719 --> 00:44:33,959
know how we want to tune that light

911
00:44:32,369 --> 00:44:35,400
retention we can play with all this

912
00:44:33,960 --> 00:44:37,500
stuff later but it's gonna be exactly

913
00:44:35,400 --> 00:44:40,650
the same it's gonna be set to some fixed

914
00:44:37,500 --> 00:44:43,139
value and we don't really need to worry

915
00:44:40,650 --> 00:44:45,360
ourselves about it other than we need to

916
00:44:43,139 --> 00:44:46,949
tune it later and probably work out some

917
00:44:45,360 --> 00:44:48,960
math on the blackboard to figure out

918
00:44:46,949 --> 00:44:52,019
what a plausible way of doing it would

919
00:44:48,960 --> 00:44:54,119
be thankfully min emission is gone now

920
00:44:52,019 --> 00:44:56,369
so we don't need to tune that so we're

921
00:44:54,119 --> 00:44:58,500
really just looking at at some pretty

922
00:44:56,369 --> 00:44:59,759
basic tuning here which is what we want

923
00:44:58,500 --> 00:45:00,358
we want the least number of tuning

924
00:44:59,760 --> 00:45:03,109
parameters

925
00:45:00,358 --> 00:45:06,119
possible in any in any algorithm right

926
00:45:03,108 --> 00:45:10,259
to keep it simple and more likely to be

927
00:45:06,119 --> 00:45:11,849
correct so when we loop over the rating

928
00:45:10,259 --> 00:45:13,498
to cease here again we need to know what

929
00:45:11,849 --> 00:45:14,940
the omit C is going to be and so in the

930
00:45:13,498 --> 00:45:16,439
case where you don't hit anything for

931
00:45:14,940 --> 00:45:18,838
now we're just gonna say that the omit C

932
00:45:16,440 --> 00:45:23,608
is gonna be the moon color which is this

933
00:45:18,838 --> 00:45:27,719
thing here right and that's all we need

934
00:45:23,608 --> 00:45:28,768
to know the harder case in fact I guess

935
00:45:27,719 --> 00:45:32,518
we don't even have to do that I could

936
00:45:28,768 --> 00:45:33,528
just well yeah we kind of do in fact we

937
00:45:32,518 --> 00:45:36,149
know who said that

938
00:45:33,528 --> 00:45:38,248
so what we need to do here now is set

939
00:45:36,150 --> 00:45:40,200
this emit C to something in the case of

940
00:45:38,248 --> 00:45:42,238
the box and then we've got all the

941
00:45:40,199 --> 00:45:44,699
information that we actually need so all

942
00:45:42,239 --> 00:45:46,920
of this stuff is not necessary anymore

943
00:45:44,699 --> 00:45:48,778
right we don't care about any of this we

944
00:45:46,920 --> 00:45:56,338
do need to put our sample point in here

945
00:45:48,778 --> 00:45:57,748
we need to grab this so we do need to

946
00:45:56,338 --> 00:45:58,920
grab the sample point in X out but we

947
00:45:57,748 --> 00:46:03,538
don't really care about the rest of this

948
00:45:58,920 --> 00:46:06,720
stuff we just need to know how to grab

949
00:46:03,539 --> 00:46:10,160
this thing we'll talk about that in a

950
00:46:06,719 --> 00:46:14,548
second and what that's supposed to show

951
00:46:10,159 --> 00:46:16,259
get rid of all this stuff and then if we

952
00:46:14,548 --> 00:46:23,130
wanted to grab from whatever the closest

953
00:46:16,259 --> 00:46:25,259
point is this would be it and I guess in

954
00:46:23,130 --> 00:46:27,630
here I'm not really sure how you could

955
00:46:25,259 --> 00:46:30,650
end up without a closest point index I'm

956
00:46:27,630 --> 00:46:33,420
not sure why that was being checked

957
00:46:30,650 --> 00:46:35,910
because if the closest point index I

958
00:46:33,420 --> 00:46:37,680
guess the only case would be if there

959
00:46:35,909 --> 00:46:39,598
were no points on the box but if there's

960
00:46:37,679 --> 00:46:41,699
no points on the Box we probably could

961
00:46:39,599 --> 00:46:46,140
just if out on that and not have to do

962
00:46:41,699 --> 00:46:48,618
this whole thing but anyway let's get

963
00:46:46,139 --> 00:46:48,618
rid of all this

964
00:46:51,378 --> 00:47:04,989
so really we're just looking at this

965
00:46:58,248 --> 00:47:04,988
scanning process here and you know I

966
00:47:11,108 --> 00:47:19,788
guess I'm inclined to say mmm so let me

967
00:47:17,838 --> 00:47:23,989
explain on the white bus sorry

968
00:47:19,789 --> 00:47:25,339
blackboard why I think we maybe want to

969
00:47:23,989 --> 00:47:27,608
change the way we're doing that a little

970
00:47:25,338 --> 00:47:27,608
bit

971
00:47:35,639 --> 00:47:47,230
so if we have a surface that we hit and

972
00:47:44,530 --> 00:47:50,590
we know we have some lighting points on

973
00:47:47,230 --> 00:47:54,820
that surface we know we're going to hit

974
00:47:50,590 --> 00:47:57,579
in a particular location and the problem

975
00:47:54,820 --> 00:47:59,350
is we have to decide if we hit in a

976
00:47:57,579 --> 00:48:00,909
particular location so before we

977
00:47:59,349 --> 00:48:02,079
flipping the meaning of this problem

978
00:48:00,909 --> 00:48:03,969
around but the problem remains the same

979
00:48:02,079 --> 00:48:05,949
so you can see what we were doing was we

980
00:48:03,969 --> 00:48:07,509
were saying we have an emitter we're

981
00:48:05,949 --> 00:48:09,669
gonna send a ray out from the emitter

982
00:48:07,510 --> 00:48:11,590
and we're gonna see what it hits and

983
00:48:09,670 --> 00:48:13,809
we're gonna add light to whatever it

984
00:48:11,590 --> 00:48:16,510
hits so this would be the point we're

985
00:48:13,809 --> 00:48:18,579
adding light to and thus we snapped it

986
00:48:16,510 --> 00:48:20,170
to the closest one and added light to

987
00:48:18,579 --> 00:48:21,880
that point that's how we were doing it

988
00:48:20,170 --> 00:48:23,470
we're flipping it around now and saying

989
00:48:21,880 --> 00:48:25,450
okay now instead what we're doing is

990
00:48:23,469 --> 00:48:27,099
we're sampling right we've actually

991
00:48:25,449 --> 00:48:28,949
we're trying to light this surface over

992
00:48:27,099 --> 00:48:31,659
here this is where the light is going

993
00:48:28,949 --> 00:48:34,539
but we're grabbing light from a surface

994
00:48:31,659 --> 00:48:35,920
that we hit we hit here and and if we

995
00:48:34,539 --> 00:48:39,130
want to follow the same procedure we'd

996
00:48:35,920 --> 00:48:40,659
snap to one of the points now why do I

997
00:48:39,130 --> 00:48:42,490
think this is maybe not a good idea for

998
00:48:40,659 --> 00:48:44,199
our final way to do things the reason is

999
00:48:42,489 --> 00:48:45,429
because if you look at the problems

1000
00:48:44,199 --> 00:48:46,509
we're gonna have with lighting and

1001
00:48:45,429 --> 00:48:49,239
they're probably already have its

1002
00:48:46,510 --> 00:48:51,160
lighting its noise right it's the

1003
00:48:49,239 --> 00:48:52,839
flicker we don't want a lot of flicker

1004
00:48:51,159 --> 00:48:54,789
in that solution where does the flicker

1005
00:48:52,840 --> 00:48:58,829
come from well the flare comes from the

1006
00:48:54,789 --> 00:49:01,900
fact that we have insufficient samples

1007
00:48:58,829 --> 00:49:05,920
to capture the full lighting function

1008
00:49:01,900 --> 00:49:08,050
now why why do we have insufficient

1009
00:49:05,920 --> 00:49:09,809
samples well the answer is because the

1010
00:49:08,050 --> 00:49:13,330
lighting that's incoming at a point

1011
00:49:09,809 --> 00:49:16,360
isn't this really ugly discreet problem

1012
00:49:13,329 --> 00:49:18,909
where if you shoot rays out along this

1013
00:49:16,360 --> 00:49:20,890
hemisphere you don't get a nice smooth

1014
00:49:18,909 --> 00:49:23,170
like curve like this of incoming light

1015
00:49:20,889 --> 00:49:24,969
if you did you could just say do a

1016
00:49:23,170 --> 00:49:26,710
couple samples to find the shape of this

1017
00:49:24,969 --> 00:49:29,829
curve and then integrate the curve and

1018
00:49:26,710 --> 00:49:31,780
have the exact answer the real answer is

1019
00:49:29,829 --> 00:49:33,610
because because all of the surfaces are

1020
00:49:31,780 --> 00:49:35,740
hard edged and weird and different

1021
00:49:33,610 --> 00:49:40,180
services reflect differently the actual

1022
00:49:35,739 --> 00:49:44,259
incoming light looks like this right

1023
00:49:40,179 --> 00:49:48,669
it's this horribly ugly super cut

1024
00:49:44,260 --> 00:49:49,390
discrete jumpy discontinuous function so

1025
00:49:48,670 --> 00:49:53,139
we dismissed

1026
00:49:49,389 --> 00:49:55,690
perfectly the discontinuity in the

1027
00:49:53,139 --> 00:49:58,329
incoming light that creates the flicker

1028
00:49:55,690 --> 00:50:00,309
because depending on where we sample we

1029
00:49:58,329 --> 00:50:02,440
will think drastically different things

1030
00:50:00,309 --> 00:50:05,139
about what it looks like if we only

1031
00:50:02,440 --> 00:50:06,940
sample here here and here we would think

1032
00:50:05,139 --> 00:50:09,099
it's this giant incoming bright light

1033
00:50:06,940 --> 00:50:11,019
thing if we only sample here here and

1034
00:50:09,099 --> 00:50:12,549
here we think it's really low if we have

1035
00:50:11,019 --> 00:50:16,150
a mix of the two we get more of an

1036
00:50:12,550 --> 00:50:18,070
average right and so every frame when we

1037
00:50:16,150 --> 00:50:19,900
shoot things out we get drastically

1038
00:50:18,070 --> 00:50:21,490
different results in the only way to

1039
00:50:19,900 --> 00:50:23,860
really solve the problem is to shoot a

1040
00:50:21,489 --> 00:50:26,819
lot more rays which is exactly what

1041
00:50:23,860 --> 00:50:30,130
offline rendering does you know think

1042
00:50:26,820 --> 00:50:31,960
yeah the pipeline for blue sky or Pixar

1043
00:50:30,130 --> 00:50:33,070
where they spend several hours rendering

1044
00:50:31,960 --> 00:50:35,769
a frame potentially or something like

1045
00:50:33,070 --> 00:50:38,500
this they can do enough to make sure

1046
00:50:35,769 --> 00:50:39,699
they get good results but we can't we

1047
00:50:38,500 --> 00:50:40,960
only have a sixtieth of a second and

1048
00:50:39,699 --> 00:50:44,319
we've got a lot of other things to do

1049
00:50:40,960 --> 00:50:49,329
besides rendering as well right so given

1050
00:50:44,320 --> 00:50:50,650
that fact what we need to do is we need

1051
00:50:49,329 --> 00:50:52,269
to figure out how to make our samples go

1052
00:50:50,650 --> 00:50:54,309
as far as possible and so one of the

1053
00:50:52,269 --> 00:50:56,619
things we want to do is not introduce

1054
00:50:54,309 --> 00:50:59,259
any more discontinuities than there

1055
00:50:56,619 --> 00:51:02,769
already might be and that's exactly what

1056
00:50:59,260 --> 00:51:04,510
we would be doing if we snap because

1057
00:51:02,769 --> 00:51:07,000
what a snap does is think about what

1058
00:51:04,510 --> 00:51:09,370
that means that means that as rays hit

1059
00:51:07,000 --> 00:51:12,099
this surface and try to sample the

1060
00:51:09,369 --> 00:51:13,509
lighting from it there's basically

1061
00:51:12,099 --> 00:51:15,849
what's called and that we've never

1062
00:51:13,510 --> 00:51:17,670
covered this so forgive me for using the

1063
00:51:15,849 --> 00:51:20,319
phrase but if you want to look it up

1064
00:51:17,670 --> 00:51:23,110
I'll just mention it we're basically

1065
00:51:20,320 --> 00:51:26,200
creating a Voronoi partition of this

1066
00:51:23,110 --> 00:51:29,230
space and that Voronoi partition you

1067
00:51:26,199 --> 00:51:34,299
could also look at its dual which is a

1068
00:51:29,230 --> 00:51:36,159
Dylan a triangulation these two things

1069
00:51:34,300 --> 00:51:38,410
are the basically the inverse of each

1070
00:51:36,159 --> 00:51:39,639
other well they're tools that's a

1071
00:51:38,409 --> 00:51:41,639
different thing this is way too much

1072
00:51:39,639 --> 00:51:43,569
this is forget I said any of that

1073
00:51:41,639 --> 00:51:45,579
basically what we're talking about is on

1074
00:51:43,570 --> 00:51:47,260
this surface we have a set of points and

1075
00:51:45,579 --> 00:51:49,480
what we're doing is we're snapping to

1076
00:51:47,260 --> 00:51:51,660
the closest one that creates a partition

1077
00:51:49,480 --> 00:51:54,849
of the space which is called a Voronoi

1078
00:51:51,659 --> 00:51:57,879
partition which basically splits it into

1079
00:51:54,849 --> 00:52:00,279
this set of shapes right anyone who

1080
00:51:57,880 --> 00:52:02,039
lands in here will snap to this anyone

1081
00:52:00,280 --> 00:52:05,330
in lands in here will snap to this and

1082
00:52:02,039 --> 00:52:09,300
and that right and thus we have created

1083
00:52:05,329 --> 00:52:11,340
four hard discontinuities along the

1084
00:52:09,300 --> 00:52:14,940
surface that weren't there to begin with

1085
00:52:11,340 --> 00:52:17,130
we've added them so I think what we want

1086
00:52:14,940 --> 00:52:20,010
to do instead is take our points and

1087
00:52:17,130 --> 00:52:23,280
average them together to figure out how

1088
00:52:20,010 --> 00:52:24,390
much light we're gonna grab and we

1089
00:52:23,280 --> 00:52:26,580
should probably blend them together

1090
00:52:24,389 --> 00:52:28,949
based on our distance so if you land

1091
00:52:26,579 --> 00:52:31,259
really close to this one it's this one

1092
00:52:28,949 --> 00:52:32,579
but if you land in between the two it's

1093
00:52:31,260 --> 00:52:35,580
half and a half if you land in the

1094
00:52:32,579 --> 00:52:38,039
middle it's all four right and so I feel

1095
00:52:35,579 --> 00:52:41,400
like that's a better way of approaching

1096
00:52:38,039 --> 00:52:44,279
this problem because now we can say

1097
00:52:41,400 --> 00:52:47,579
definitively that we have not introduced

1098
00:52:44,280 --> 00:52:48,810
a discontinuity we are still left with a

1099
00:52:47,579 --> 00:52:50,759
ton of discontinuities that are there

1100
00:52:48,809 --> 00:52:53,009
because of just the surface geometry and

1101
00:52:50,760 --> 00:52:55,410
how that service geometry affects the

1102
00:52:53,010 --> 00:52:57,330
lighting but we don't we're not

1103
00:52:55,409 --> 00:52:59,279
introducing artificial discontinuities

1104
00:52:57,329 --> 00:53:01,529
that will add yet more flicker to a

1105
00:52:59,280 --> 00:53:02,550
system that already has too much right

1106
00:53:01,530 --> 00:53:04,500
because we're trying to reduce that

1107
00:53:02,550 --> 00:53:06,150
flicker we certainly don't want to do

1108
00:53:04,500 --> 00:53:10,230
anything that's going to exacerbate that

1109
00:53:06,150 --> 00:53:12,210
flicker so I think that's what we want

1110
00:53:10,230 --> 00:53:14,820
to do if we get back a box I think what

1111
00:53:12,210 --> 00:53:20,869
we want to do is loop over the points of

1112
00:53:14,820 --> 00:53:20,870
the box in here

1113
00:53:22,429 --> 00:53:26,639
and then for each one of these surface

1114
00:53:25,260 --> 00:53:28,740
points I think what we want to do is

1115
00:53:26,639 --> 00:53:30,900
rather than just doing a check I think

1116
00:53:28,739 --> 00:53:34,739
what we want to do is use that closest

1117
00:53:30,900 --> 00:53:42,090
distance squared as a blend term so

1118
00:53:34,739 --> 00:53:48,989
basically take our total distance

1119
00:53:42,090 --> 00:53:51,590
squared summit so now when we come

1120
00:53:48,989 --> 00:53:55,819
through here we know exactly how many

1121
00:53:51,590 --> 00:54:02,329
how much total effect we're gonna have

1122
00:53:55,820 --> 00:54:02,330
and then when we sum our omission up

1123
00:54:07,969 --> 00:54:15,119
what we're gonna do is say okay take the

1124
00:54:10,769 --> 00:54:17,039
omit C and add the distance squared we

1125
00:54:15,119 --> 00:54:24,989
probably want to do an inverse of it

1126
00:54:17,039 --> 00:54:28,320
right actually so something that's going

1127
00:54:24,989 --> 00:54:30,689
to decay as you get further away so we

1128
00:54:28,320 --> 00:54:33,809
can do in fact this is exactly what we

1129
00:54:30,690 --> 00:54:37,500
did before we can do like 1.0 f over 1.0

1130
00:54:33,809 --> 00:54:39,659
f + distance squared so basically as you

1131
00:54:37,500 --> 00:54:41,880
get further away you get lower and lower

1132
00:54:39,659 --> 00:54:44,000
and lower and lower so something like

1133
00:54:41,880 --> 00:54:44,000
this

1134
00:54:44,550 --> 00:54:48,690
so we'll sum up those inverse distance

1135
00:54:46,469 --> 00:54:50,789
squared we'll use that as a multiplier

1136
00:54:48,690 --> 00:54:52,500
on the thing that we would have done if

1137
00:54:50,789 --> 00:54:59,029
we were just taking it just from this

1138
00:54:52,500 --> 00:54:59,030
point so the hit points like so

1139
00:55:13,820 --> 00:55:17,400
so you can see what I'm doing here right

1140
00:55:15,840 --> 00:55:20,730
I'm just going through and saying all

1141
00:55:17,400 --> 00:55:22,470
right where is that point that we hit on

1142
00:55:20,730 --> 00:55:24,030
the box and again we haven't actually

1143
00:55:22,469 --> 00:55:26,339
pulled out the box values yet but we

1144
00:55:24,030 --> 00:55:27,930
will in a second take the inverse

1145
00:55:26,340 --> 00:55:29,430
distance so we're gonna get a thing that

1146
00:55:27,929 --> 00:55:30,329
Falls up and if you want to know what

1147
00:55:29,429 --> 00:55:32,609
this looks like

1148
00:55:30,329 --> 00:55:35,009
again you can actually use nowadays you

1149
00:55:32,610 --> 00:55:44,160
can like just ask Google even to graph

1150
00:55:35,010 --> 00:55:46,320
it you can say graph 1 over 1 + X there

1151
00:55:44,159 --> 00:55:47,909
you go

1152
00:55:46,320 --> 00:55:49,890
so if you take a look at what this looks

1153
00:55:47,909 --> 00:55:54,029
like right I don't know if you can zoom

1154
00:55:49,889 --> 00:55:58,469
in here there we go so we know that this

1155
00:55:54,030 --> 00:56:00,870
is always going to be that the distance

1156
00:55:58,469 --> 00:56:02,939
squared is always going to be 0 or

1157
00:56:00,869 --> 00:56:04,769
greater right so we're gonna start right

1158
00:56:02,940 --> 00:56:06,990
here we will never be back there we're

1159
00:56:04,769 --> 00:56:09,389
gonna start right here and just as we go

1160
00:56:06,989 --> 00:56:13,229
we get less and less contribution right

1161
00:56:09,389 --> 00:56:16,019
so as you get out to one unit away

1162
00:56:13,230 --> 00:56:19,409
you're gonna be here this is distance

1163
00:56:16,019 --> 00:56:21,719
squared so 2 is not 2 units away 2 is if

1164
00:56:19,409 --> 00:56:24,779
the square was 2 units away does that

1165
00:56:21,719 --> 00:56:30,599
make sense and off you go I don't know

1166
00:56:24,780 --> 00:56:32,340
if you can do this okay

1167
00:56:30,599 --> 00:56:33,929
so here's what it actually would look

1168
00:56:32,340 --> 00:56:36,240
like this is a better graph because this

1169
00:56:33,929 --> 00:56:38,849
is distance squared so if this now this

1170
00:56:36,239 --> 00:56:40,859
x axis shows actual distance so here is

1171
00:56:38,849 --> 00:56:43,619
1 unit away we're at what I'm sorry 0

1172
00:56:40,860 --> 00:56:45,960
units away we're at 1 right at 1 unit

1173
00:56:43,619 --> 00:56:47,579
away and I can you know what let me zoom

1174
00:56:45,960 --> 00:56:52,260
in to just the positive since that's all

1175
00:56:47,579 --> 00:56:54,650
we care about can you do yes I can no I

1176
00:56:52,260 --> 00:56:54,650
can't

1177
00:56:54,719 --> 00:57:04,289
there we go there we go perfect thank

1178
00:56:59,130 --> 00:57:06,869
you google okay so here we are at one

1179
00:57:04,289 --> 00:57:08,909
you can see us fall off I say here at

1180
00:57:06,869 --> 00:57:11,700
zero we're at one you can see us fall

1181
00:57:08,909 --> 00:57:15,210
off at one unit away we're gonna be at

1182
00:57:11,699 --> 00:57:16,799
like point five right you can kind of

1183
00:57:15,210 --> 00:57:19,590
see it doesn't unfortunately highlight

1184
00:57:16,800 --> 00:57:21,720
where it is on this axis but you can

1185
00:57:19,590 --> 00:57:24,780
read it up here I guess actually so

1186
00:57:21,719 --> 00:57:27,000
there's you can see 0.5 and then when we

1187
00:57:24,780 --> 00:57:29,730
get to two units away we'll be at Point

1188
00:57:27,000 --> 00:57:33,000
2 we get to 3 units away we'll be at

1189
00:57:29,730 --> 00:57:34,349
Point 1 four units away 0.05 so you can

1190
00:57:33,000 --> 00:57:36,300
see it's just a smooth fall-off curve

1191
00:57:34,349 --> 00:57:37,859
the only reason I'm using this right now

1192
00:57:36,300 --> 00:57:38,519
we haven't done any analysis or anything

1193
00:57:37,858 --> 00:57:39,779
on it

1194
00:57:38,519 --> 00:57:42,030
bleh resume using is a convenient

1195
00:57:39,780 --> 00:57:44,430
function to start with for just fall off

1196
00:57:42,030 --> 00:57:47,280
that doesn't need to be checked right

1197
00:57:44,429 --> 00:57:49,710
meaning I don't have to check to see if

1198
00:57:47,280 --> 00:57:51,390
the value is zero first which I would

1199
00:57:49,710 --> 00:57:53,639
have to do if I just did one over the

1200
00:57:51,389 --> 00:57:55,079
actual value so one plus the value here

1201
00:57:53,639 --> 00:57:56,519
is preventing me from ever having to

1202
00:57:55,079 --> 00:57:58,500
check whether it's zero because I know

1203
00:57:56,519 --> 00:58:00,449
it can be zero I could be right on the

1204
00:57:58,500 --> 00:58:02,010
point or at least very close to it and

1205
00:58:00,449 --> 00:58:03,419
then my function would explode and I

1206
00:58:02,010 --> 00:58:04,950
don't want that so I want this this is

1207
00:58:03,420 --> 00:58:09,720
well behaved everywhere we care about

1208
00:58:04,949 --> 00:58:11,519
right so there's a way to get an inverse

1209
00:58:09,719 --> 00:58:13,049
distance on there and then when we do

1210
00:58:11,519 --> 00:58:14,608
the total distance and and you know I'm

1211
00:58:13,050 --> 00:58:16,289
H it change this because it's not really

1212
00:58:14,608 --> 00:58:18,598
told distance squared really what it is

1213
00:58:16,289 --> 00:58:22,619
is total weight if the total amount that

1214
00:58:18,599 --> 00:58:24,570
we've added in right so we're gonna go

1215
00:58:22,619 --> 00:58:27,000
through rent sum up this total weight

1216
00:58:24,570 --> 00:58:29,970
and in addition we're also going to take

1217
00:58:27,000 --> 00:58:33,000
that how to my product like we were

1218
00:58:29,969 --> 00:58:35,069
doing before to produce exactly what we

1219
00:58:33,000 --> 00:58:39,989
think this point should contribute and

1220
00:58:35,070 --> 00:58:43,080
that's going to be our omit C value once

1221
00:58:39,989 --> 00:58:45,959
we have our omit C value at the end now

1222
00:58:43,079 --> 00:58:48,358
we know this was a summation of various

1223
00:58:45,960 --> 00:58:51,449
weight we don't know how much weight in

1224
00:58:48,358 --> 00:58:54,569
toto we summed so what we need to do is

1225
00:58:51,449 --> 00:58:55,949
now normalize both values up so here is

1226
00:58:54,570 --> 00:58:57,269
the one place I will have to check if

1227
00:58:55,949 --> 00:58:58,829
total weight is greater than zero now

1228
00:58:57,269 --> 00:59:01,920
totally it will always be greater than

1229
00:58:58,829 --> 00:59:03,358
zero if we had any points at all but I'm

1230
00:59:01,920 --> 00:59:06,269
just checking to make sure that we do

1231
00:59:03,358 --> 00:59:07,769
have some points right because maybe we

1232
00:59:06,269 --> 00:59:13,199
put in boxes that don't have any pole

1233
00:59:07,769 --> 00:59:15,000
in the future so you know that's all so

1234
00:59:13,199 --> 00:59:17,460
then what we can do is we can produce in

1235
00:59:15,000 --> 00:59:19,409
total weight that's just 1 over the

1236
00:59:17,460 --> 00:59:21,360
total weight and now we can normalize

1237
00:59:19,409 --> 00:59:23,609
everything out so now are we can do a

1238
00:59:21,360 --> 00:59:24,840
Hadamard product or actually going to

1239
00:59:23,610 --> 00:59:26,970
emit see it's not ahead of our

1240
00:59:24,840 --> 00:59:29,970
approaches to regular scalar product we

1241
00:59:26,969 --> 00:59:32,399
can multiply the omit C by it and that

1242
00:59:29,969 --> 00:59:34,619
will tell us exactly what our emission

1243
00:59:32,400 --> 00:59:36,960
color should be averaged based on

1244
00:59:34,619 --> 00:59:41,400
distance from the points that were

1245
00:59:36,960 --> 00:59:47,900
involved now there's one nasty part of

1246
00:59:41,400 --> 00:59:53,690
this and in fact I guess this is yeah I

1247
00:59:47,900 --> 00:59:53,690
would like to do this with only one loop

1248
00:59:54,500 --> 01:00:01,110
but I'm not sure how I could because in

1249
00:59:59,190 --> 01:00:05,280
order to know how much light I'm taking

1250
01:00:01,110 --> 01:00:08,789
away I need to know what the

1251
01:00:05,280 --> 01:00:12,120
distribution of energy that I'm taking

1252
01:00:08,789 --> 01:00:14,219
away from each point is and so in order

1253
01:00:12,119 --> 01:00:15,719
to do that I need two loops one to

1254
01:00:14,219 --> 01:00:18,379
figure out what the total weight is and

1255
01:00:15,719 --> 01:00:21,059
then one to actually apply it and that's

1256
01:00:18,380 --> 01:00:24,079
kind of ugly but I'm not sure any other

1257
01:00:21,059 --> 01:00:24,079
way to do it right

1258
01:00:45,539 --> 01:00:52,579
so I don't really know if there's any

1259
01:00:49,648 --> 01:00:52,578
way around that

1260
01:00:57,369 --> 01:01:03,909
I mean I guess we'll have to find out

1261
01:01:00,730 --> 01:01:04,719
how bad it really is to do the loop

1262
01:01:03,909 --> 01:01:06,849
twice

1263
01:01:04,719 --> 01:01:12,449
it just seems nasty I don't even like

1264
01:01:06,849 --> 01:01:15,130
doing the loop once it's not fantastic

1265
01:01:12,449 --> 01:01:25,989
so doing the loop twice seems like

1266
01:01:15,130 --> 01:01:27,640
really not fantastic but I just don't

1267
01:01:25,989 --> 01:01:41,169
see any other way you could really do it

1268
01:01:27,639 --> 01:01:43,599
you could fake it and say that you just

1269
01:01:41,170 --> 01:01:47,200
take the same amount of light from each

1270
01:01:43,599 --> 01:01:50,409
of them even though you aren't doing

1271
01:01:47,199 --> 01:01:51,579
that so you know you could say this is

1272
01:01:50,409 --> 01:01:54,579
the total amount of light I'm going to

1273
01:01:51,579 --> 01:02:00,219
take I take it evenly distributed across

1274
01:01:54,579 --> 01:02:02,469
all of them you know even though that is

1275
01:02:00,219 --> 01:02:04,119
not how much light I actually gathered

1276
01:02:02,469 --> 01:02:06,099
from each of them so it's an

1277
01:02:04,119 --> 01:02:11,500
approximation that could have

1278
01:02:06,099 --> 01:02:14,079
deleterious consequences it could add or

1279
01:02:11,500 --> 01:02:17,230
remove light from your system in

1280
01:02:14,079 --> 01:02:18,610
potentially a bad way you know and one

1281
01:02:17,230 --> 01:02:20,440
of the problems I guess yeah is that

1282
01:02:18,610 --> 01:02:22,510
it's just really hard to say so

1283
01:02:20,440 --> 01:02:34,840
probably what I should do is do the two

1284
01:02:22,510 --> 01:02:37,650
loops first right and then back off from

1285
01:02:34,840 --> 01:02:41,470
the two loops as much as I can

1286
01:02:37,650 --> 01:02:44,680
in the end I'm not sure really any other

1287
01:02:41,469 --> 01:02:46,629
way I could do it because yeah it's just

1288
01:02:44,679 --> 01:02:49,269
like if you want to do a scattered point

1289
01:02:46,630 --> 01:02:54,240
interpolation like that I don't know

1290
01:02:49,269 --> 01:02:57,750
that there's a lot you can do to prevent

1291
01:02:54,239 --> 01:02:57,750
the double summation

1292
01:03:18,440 --> 01:03:28,650
yeah I mean or at least I'm not able to

1293
01:03:21,989 --> 01:03:38,098
think of what it would be yeah so I

1294
01:03:28,650 --> 01:03:40,079
don't know yeah sorry

1295
01:03:38,099 --> 01:03:42,838
so yeah so this is a this is a tricky

1296
01:03:40,079 --> 01:03:44,039
bit and and I'm not sure how exactly

1297
01:03:42,838 --> 01:03:45,389
we're gonna deal with it man but we'll

1298
01:03:44,039 --> 01:03:48,028
start with this and we'll go from there

1299
01:03:45,389 --> 01:03:49,650
so yeah if we come through here we'd

1300
01:03:48,028 --> 01:03:52,528
have to do this twice and then we would

1301
01:03:49,650 --> 01:03:54,630
have to do something smart about it

1302
01:03:52,528 --> 01:03:57,358
I suppose what that does mean is if we

1303
01:03:54,630 --> 01:03:59,880
were gonna do it twice we could avoid

1304
01:03:57,358 --> 01:04:01,619
having to do this actual extra inversion

1305
01:03:59,880 --> 01:04:04,588
here because we could just pre invert

1306
01:04:01,619 --> 01:04:07,019
the value and multiply it through on the

1307
01:04:04,588 --> 01:04:08,460
second pass through the loop so if we do

1308
01:04:07,018 --> 01:04:09,750
end up having to do two loops I guess we

1309
01:04:08,460 --> 01:04:12,750
can make them slightly more efficient

1310
01:04:09,750 --> 01:04:15,088
and that's slightly good but not that

1311
01:04:12,750 --> 01:04:19,440
good so certainly not as good as not

1312
01:04:15,088 --> 01:04:20,880
doing two loops so okay so let's finish

1313
01:04:19,440 --> 01:04:24,869
off what we're doing here let me go

1314
01:04:20,880 --> 01:04:28,890
ahead and grab the the information we

1315
01:04:24,869 --> 01:04:31,470
actually need from this so inside the

1316
01:04:28,889 --> 01:04:35,009
ray box stuff we want to figure out

1317
01:04:31,469 --> 01:04:42,118
which box we hit in fact I guess we

1318
01:04:35,009 --> 01:04:45,210
could just do this if there is a hitbox

1319
01:04:42,119 --> 01:04:48,329
then we need to grab out the starting

1320
01:04:45,210 --> 01:04:50,309
hit index there and we need to know how

1321
01:04:48,329 --> 01:04:52,019
many points there are these are both

1322
01:04:50,309 --> 01:04:54,089
exactly what we want to do here so

1323
01:04:52,018 --> 01:04:57,058
that's all good but we don't need these

1324
01:04:54,088 --> 01:04:59,969
two but we do need the repas ition so we

1325
01:04:57,059 --> 01:05:03,210
need to compute that by stepping out

1326
01:04:59,969 --> 01:05:05,939
along it after we do that we can do this

1327
01:05:03,210 --> 01:05:07,858
loop properly and that value will be

1328
01:05:05,940 --> 01:05:12,858
correct we can also do it again down

1329
01:05:07,858 --> 01:05:12,858
here in the nicely piggy way

1330
01:05:20,079 --> 01:05:23,559
and then but we you know once we get

1331
01:05:22,329 --> 01:05:28,479
down here the thing that we really need

1332
01:05:23,559 --> 01:05:29,559
to do is take that omission that you

1333
01:05:28,478 --> 01:05:32,379
know you know that new emission that

1334
01:05:29,559 --> 01:05:37,539
we're creating we need to remove some of

1335
01:05:32,380 --> 01:05:39,130
that light from the result and so that's

1336
01:05:37,539 --> 01:05:39,910
the next part that we have to do and so

1337
01:05:39,130 --> 01:05:41,979
we'll figure out how we're gonna do that

1338
01:05:39,909 --> 01:05:44,679
and second once we finish that then we

1339
01:05:41,978 --> 01:05:46,419
really are ready to do the emit C so we

1340
01:05:44,679 --> 01:05:54,298
can finish accumulating the sample and

1341
01:05:46,420 --> 01:05:57,309
everything is happy yeah and off we go

1342
01:05:54,298 --> 01:05:59,858
all right so let's take a look at how

1343
01:05:57,309 --> 01:06:03,309
this is working we start out with our

1344
01:05:59,858 --> 01:06:07,380
compute light propagation you know off

1345
01:06:03,309 --> 01:06:12,509
we go here and we're going to accumulate

1346
01:06:07,380 --> 01:06:15,818
into the desta mission values all of the

1347
01:06:12,509 --> 01:06:17,798
light that we gather and the only thing

1348
01:06:15,818 --> 01:06:20,288
that we haven't done yet is in here we

1349
01:06:17,798 --> 01:06:26,199
need a way to record the fact that some

1350
01:06:20,289 --> 01:06:32,440
of the emission got nerfed right this

1351
01:06:26,199 --> 01:06:34,539
can't happen in line actually so we can

1352
01:06:32,440 --> 01:06:36,940
get rid of that this has to happen at

1353
01:06:34,539 --> 01:06:40,059
the end so when we do our final loop

1354
01:06:36,940 --> 01:06:43,798
over all of the points this is the place

1355
01:06:40,059 --> 01:06:53,709
where we can actually reset the values

1356
01:06:43,798 --> 01:06:55,449
so yeah inside here yeah we can reset

1357
01:06:53,708 --> 01:07:00,690
these now I don't know we may at the

1358
01:06:55,449 --> 01:07:00,690
moment actually want to do these here

1359
01:07:07,420 --> 01:07:13,930
this way we always process every point

1360
01:07:22,719 --> 01:07:29,959
and so this will do that sort of final

1361
01:07:28,039 --> 01:07:32,058
push to get everything out of the

1362
01:07:29,960 --> 01:07:35,088
destination and clear the destination

1363
01:07:32,059 --> 01:07:36,559
and again we can probably clean all of

1364
01:07:35,088 --> 01:07:37,849
this stuff up once we notice that

1365
01:07:36,559 --> 01:07:40,369
everything's working because we can

1366
01:07:37,849 --> 01:07:42,500
structure our buffers properly to not do

1367
01:07:40,369 --> 01:07:45,980
any extra clearing or any extra anything

1368
01:07:42,500 --> 01:07:50,659
that we don't need to do so looking at

1369
01:07:45,980 --> 01:07:52,159
this here when we do this pass through

1370
01:07:50,659 --> 01:07:57,739
what we should be able to do is say well

1371
01:07:52,159 --> 01:08:00,318
however much we wanted to remove from

1372
01:07:57,739 --> 01:08:02,808
any given point what we should be able

1373
01:08:00,318 --> 01:08:06,349
to do is now say well whatever the desta

1374
01:08:02,809 --> 01:08:08,930
mission value for this point was we

1375
01:08:06,349 --> 01:08:11,568
should be able to remove as much of the

1376
01:08:08,929 --> 01:08:15,789
power as we wanted to from there right

1377
01:08:11,568 --> 01:08:15,789
so we're going to do something like this

1378
01:08:17,710 --> 01:08:26,029
we're into the decimate see we record

1379
01:08:20,750 --> 01:08:27,409
the fact that we've taken power out and

1380
01:08:26,029 --> 01:08:30,100
we're make sure we can never take out

1381
01:08:27,409 --> 01:08:32,380
more power than we had to begin with

1382
01:08:30,100 --> 01:08:35,060
just to make sure it never goes negative

1383
01:08:32,380 --> 01:08:40,250
so in here we know which one this is

1384
01:08:35,060 --> 01:08:41,690
this is the hit point index and what we

1385
01:08:40,250 --> 01:08:45,140
want to do is since we know we took

1386
01:08:41,689 --> 01:08:50,419
power out of it here and we know exactly

1387
01:08:45,140 --> 01:08:52,389
how much power we took out yeah we

1388
01:08:50,420 --> 01:08:54,969
should be able to

1389
01:08:52,389 --> 01:08:57,849
do the exact right amount of output

1390
01:08:54,969 --> 01:09:00,239
power so if the amount of power that

1391
01:08:57,849 --> 01:09:02,679
we're taking out is this power value

1392
01:09:00,238 --> 01:09:06,608
then how much we would normally take out

1393
01:09:02,679 --> 01:09:08,618
is just the power times that right like

1394
01:09:06,609 --> 01:09:11,889
this but we know that we're not using

1395
01:09:08,618 --> 01:09:14,738
all the power so what we're actually

1396
01:09:11,889 --> 01:09:19,739
doing is we're taking the inverse total

1397
01:09:14,738 --> 01:09:19,738
weight here and I'm gonna go ahead and

1398
01:09:23,609 --> 01:09:27,819
do it like this we're gonna need the

1399
01:09:25,868 --> 01:09:29,679
inverse total weight to normalize our

1400
01:09:27,819 --> 01:09:31,989
inverse distance squared and that's

1401
01:09:29,679 --> 01:09:39,908
going to give us the modification for

1402
01:09:31,988 --> 01:09:42,129
the power so we'll take the power we

1403
01:09:39,908 --> 01:09:43,388
want to multiply it by our contribution

1404
01:09:42,130 --> 01:09:49,960
which is the inverse distance squared

1405
01:09:43,389 --> 01:09:51,250
and then normalize by the by the inverse

1406
01:09:49,960 --> 01:09:53,349
total weight grant

1407
01:09:51,250 --> 01:09:56,770
so this says however much power we were

1408
01:09:53,349 --> 01:09:59,819
going to use total which is just

1409
01:09:56,770 --> 01:10:03,849
prescribed however much power we want to

1410
01:09:59,819 --> 01:10:06,658
remove on a particular sample we will

1411
01:10:03,849 --> 01:10:09,909
then use our distance squared as the

1412
01:10:06,658 --> 01:10:14,138
weighting value our inverse distance

1413
01:10:09,908 --> 01:10:16,539
squared is the weighting value and then

1414
01:10:14,139 --> 01:10:18,309
we'll divide Li divide that by the total

1415
01:10:16,539 --> 01:10:20,229
weight we know is there so that way we

1416
01:10:18,309 --> 01:10:21,550
take the fractional part of the power

1417
01:10:20,229 --> 01:10:23,709
that's respond that we're responsible

1418
01:10:21,550 --> 01:10:29,199
for and we only remove that much power

1419
01:10:23,710 --> 01:10:31,689
from the destination so I believe that's

1420
01:10:29,198 --> 01:10:34,960
correct we got a couple things we got to

1421
01:10:31,689 --> 01:10:36,879
do here so the Ray point this emit P so

1422
01:10:34,960 --> 01:10:40,109
the Ray is going to be the sample

1423
01:10:36,880 --> 01:10:40,109
direction oops

1424
01:10:40,500 --> 01:10:47,069
sample direction and the sample point P

1425
01:10:49,020 --> 01:10:55,380
the moon color we just want the RGB part

1426
01:10:53,139 --> 01:10:55,380
of that

1427
01:10:58,630 --> 01:11:09,940
retain see this is really not relevant

1428
01:11:02,949 --> 01:11:13,750
I guess although I suppose what was that

1429
01:11:09,939 --> 01:11:16,179
actually doing this was taking that fall

1430
01:11:13,750 --> 01:11:19,350
off into account as well I don't know

1431
01:11:16,180 --> 01:11:19,350
that we really want to do that

1432
01:11:23,880 --> 01:11:30,819
like I'm not sure we really want to do

1433
01:11:26,529 --> 01:11:34,899
this anymore this tells us the total

1434
01:11:30,819 --> 01:11:37,000
amount of light that came back so we

1435
01:11:34,899 --> 01:11:39,729
could if we wanted to do it after the

1436
01:11:37,000 --> 01:11:42,010
fact and actually remove the correct

1437
01:11:39,729 --> 01:11:45,279
amount of power based on how much we

1438
01:11:42,010 --> 01:11:48,789
used but I'm not so sure that that makes

1439
01:11:45,279 --> 01:11:50,829
sense because I don't we I don't know

1440
01:11:48,789 --> 01:11:53,079
that the amount that we actually

1441
01:11:50,829 --> 01:11:55,659
transfer here is related to how much it

1442
01:11:53,079 --> 01:11:59,289
should be giving off because it depends

1443
01:11:55,659 --> 01:12:01,899
on how you look at it the light gets

1444
01:11:59,289 --> 01:12:03,519
emitted one way or the other so yeah but

1445
01:12:01,899 --> 01:12:04,809
you know what since we did it that way

1446
01:12:03,520 --> 01:12:07,600
before I'll keep doing it that way for

1447
01:12:04,810 --> 01:12:10,680
now if we do want to do that all we have

1448
01:12:07,600 --> 01:12:10,680
to do is just this

1449
01:12:30,600 --> 01:12:33,940
so if you take a look at what's going on

1450
01:12:32,439 --> 01:12:37,539
here

1451
01:12:33,939 --> 01:12:41,529
this information right all has to come

1452
01:12:37,539 --> 01:12:42,909
from the hitbox stuff we can actually we

1453
01:12:41,529 --> 01:12:44,769
could actually do this all in line we

1454
01:12:42,909 --> 01:12:46,420
don't even need really need to do much

1455
01:12:44,770 --> 01:12:56,760
in the if statement if we don't want to

1456
01:12:46,420 --> 01:13:04,180
so what we could do is say okay this box

1457
01:12:56,760 --> 01:13:09,070
this whole thing here with the hit index

1458
01:13:04,180 --> 01:13:12,390
and the hit point count I think we

1459
01:13:09,069 --> 01:13:12,389
should be able to do this like this

1460
01:13:17,760 --> 01:13:28,659
right so if we look at what's going on

1461
01:13:23,979 --> 01:13:31,529
here Jimmy we should be able to do a

1462
01:13:28,659 --> 01:13:31,529
thing where we just

1463
01:13:41,800 --> 01:13:50,000
keep most things happening exactly the

1464
01:13:44,989 --> 01:13:51,109
same like so uh yeah like all of this

1465
01:13:50,000 --> 01:14:03,380
stuff can be exactly the same

1466
01:13:51,109 --> 01:14:11,569
effectively and then when we get down

1467
01:14:03,380 --> 01:14:17,000
here hit point count will be zero so we

1468
01:14:11,569 --> 01:14:20,000
will never enter these loops in the case

1469
01:14:17,000 --> 01:14:23,239
where we didn't hit a box but everything

1470
01:14:20,000 --> 01:14:28,569
else will proceed exactly the same so

1471
01:14:23,239 --> 01:14:28,569
then when we figure out how much point

1472
01:14:30,699 --> 01:14:36,979
point light we use there right so we

1473
01:14:35,420 --> 01:14:40,430
accumulate sample we get back our youth

1474
01:14:36,979 --> 01:14:44,059
see now we just know it's actually just

1475
01:14:40,430 --> 01:14:48,170
that amount of the used light would come

1476
01:14:44,060 --> 01:14:53,510
out here right now the reason that I'm

1477
01:14:48,170 --> 01:14:57,590
just not sure about that is because now

1478
01:14:53,510 --> 01:15:00,470
the color yeah see see that's just not

1479
01:14:57,590 --> 01:15:03,680
going to work because the color is gonna

1480
01:15:00,470 --> 01:15:05,480
be wrong it's since the color is a blend

1481
01:15:03,680 --> 01:15:06,470
of the multiple points yeah we can't we

1482
01:15:05,479 --> 01:15:08,839
can't keep doing it that way

1483
01:15:06,470 --> 01:15:10,520
so since we're using a blend we're gonna

1484
01:15:08,840 --> 01:15:13,550
have to we're gonna have to stick with a

1485
01:15:10,520 --> 01:15:16,360
way that doesn't that doesn't require us

1486
01:15:13,550 --> 01:15:16,360
to do that right

1487
01:15:23,010 --> 01:15:26,850
so I think we're gonna have to just nerf

1488
01:15:24,510 --> 01:15:29,670
this concept because once we blend the

1489
01:15:26,850 --> 01:15:31,410
colors together we can't keep them comp

1490
01:15:29,670 --> 01:15:34,079
like we can't keep them conserved

1491
01:15:31,409 --> 01:15:38,789
because we we wouldn't know exactly how

1492
01:15:34,079 --> 01:15:40,289
to reapportioned that information so I

1493
01:15:38,789 --> 01:15:42,390
think we do have to do it exactly this

1494
01:15:40,289 --> 01:15:44,340
way and this information just has to go

1495
01:15:42,390 --> 01:15:46,320
away unfortunately that's just how that

1496
01:15:44,340 --> 01:15:47,880
has to go and that's okay again if this

1497
01:15:46,319 --> 01:15:49,139
is all approximate so I don't think

1498
01:15:47,880 --> 01:15:53,569
there's we don't need to perfectly

1499
01:15:49,140 --> 01:15:53,570
conserve the energy in the system at all

1500
01:15:53,960 --> 01:16:03,380
all right so when we come on the app and

1501
01:16:00,390 --> 01:16:03,380
of this loop

1502
01:16:08,460 --> 01:16:36,449
I guess I'm going to do it let's see

1503
01:16:32,689 --> 01:16:44,089
yeah iteration counts not happening

1504
01:16:36,449 --> 01:16:44,090
anymore and it's not showing up there

1505
01:16:46,279 --> 01:16:50,399
all right so now we just have to debug

1506
01:16:48,869 --> 01:16:55,409
this which is not gonna be fun

1507
01:16:50,399 --> 01:16:57,329
obviously and yeah that's not a great

1508
01:16:55,409 --> 01:16:59,579
start as you'll notice we get no

1509
01:16:57,329 --> 01:17:03,809
lighting at all all right so let's go

1510
01:16:59,579 --> 01:17:06,329
ahead and start stepping through on the

1511
01:17:03,810 --> 01:17:07,560
plus side you will notice really great

1512
01:17:06,329 --> 01:17:10,859
frame right when you don't have any

1513
01:17:07,560 --> 01:17:13,050
lighting as it turns out oh it's not

1514
01:17:10,859 --> 01:17:16,049
it's not no lighting there's a little

1515
01:17:13,050 --> 01:17:18,029
bit of gray in there so I take it back

1516
01:17:16,050 --> 01:17:23,550
it's not quite no lighting it's very

1517
01:17:18,029 --> 01:17:26,029
very little light so let's go ahead and

1518
01:17:23,550 --> 01:17:26,029
step through there

1519
01:17:30,649 --> 01:17:37,219
and I'm gonna just basically walk myself

1520
01:17:33,920 --> 01:17:46,250
through that sort of new structure for

1521
01:17:37,220 --> 01:17:49,280
the routine and see how we go all right

1522
01:17:46,250 --> 01:17:54,949
so here we are we're gonna go over these

1523
01:17:49,279 --> 01:17:56,179
sample points take a look at here so you

1524
01:17:54,949 --> 01:17:57,739
can see there's the location sample

1525
01:17:56,180 --> 01:18:00,530
point there's the color that it's

1526
01:17:57,739 --> 01:18:05,539
reflecting and here's the normal

1527
01:18:00,529 --> 01:18:11,199
I don't think next free is ever used

1528
01:18:05,539 --> 01:18:11,199
anymore is it actually

1529
01:18:24,779 --> 01:18:33,050
yeah I don't think so so let's just get

1530
01:18:29,340 --> 01:18:33,050
rid of it so in we go

1531
01:18:33,210 --> 01:18:42,239
here is our sample point we are going to

1532
01:18:37,020 --> 01:18:43,740
take a random raid erection and that

1533
01:18:42,239 --> 01:18:49,349
should be pointing in the same direction

1534
01:18:43,739 --> 01:18:55,920
as this is which it sort of is it's a

1535
01:18:49,350 --> 01:18:58,350
pretty angled that's a pretty steep

1536
01:18:55,920 --> 01:19:03,899
angle to it but you know certainly still

1537
01:18:58,350 --> 01:19:06,810
correct and then we're gonna go ahead

1538
01:19:03,899 --> 01:19:08,759
and do our array cast here is the Ray

1539
01:19:06,810 --> 01:19:11,490
information we got back there was a box

1540
01:19:08,760 --> 01:19:14,369
that it did hit here's the information

1541
01:19:11,489 --> 01:19:17,670
for that box so when we come in here we

1542
01:19:14,369 --> 01:19:18,750
should enter this loop than we do and so

1543
01:19:17,670 --> 01:19:20,850
now we're going to take a look at what

1544
01:19:18,750 --> 01:19:22,890
our first point index is for this box

1545
01:19:20,850 --> 01:19:25,500
there should be four and there are and

1546
01:19:22,890 --> 01:19:27,930
it starts with that one we're gonna take

1547
01:19:25,500 --> 01:19:30,119
again our sample point and we're gonna

1548
01:19:27,930 --> 01:19:35,100
add however far we went along this ray

1549
01:19:30,119 --> 01:19:36,630
which was 2.7 meters here along that Ray

1550
01:19:35,100 --> 01:19:38,340
and again that sample Direction is

1551
01:19:36,630 --> 01:19:41,430
normalized so that's exactly how far it

1552
01:19:38,340 --> 01:19:44,119
should go we then have a total weight

1553
01:19:41,430 --> 01:19:46,170
value here this I assume it's normalized

1554
01:19:44,119 --> 01:19:48,149
we should we have total weight value

1555
01:19:46,170 --> 01:19:50,609
that we initialize to zero and we're

1556
01:19:48,149 --> 01:19:52,259
gonna sum we loop over the surface

1557
01:19:50,609 --> 01:19:54,059
points and we get the distance squared

1558
01:19:52,260 --> 01:19:55,590
to them that's how far away we are from

1559
01:19:54,060 --> 01:19:59,070
that one so it's inverse distance

1560
01:19:55,590 --> 01:20:01,949
squared is 0.8 there and so we sum up

1561
01:19:59,069 --> 01:20:03,779
the point eight and then we do using

1562
01:20:01,949 --> 01:20:05,970
that as a weighting factor we take the

1563
01:20:03,779 --> 01:20:09,630
reflected value and the source emission

1564
01:20:05,970 --> 01:20:12,230
here which let's find out what that

1565
01:20:09,630 --> 01:20:12,230
actually is

1566
01:20:23,119 --> 01:20:36,949
so this point source it doesn't give off

1567
01:20:26,810 --> 01:20:45,950
any light at all which I suppose will be

1568
01:20:36,949 --> 01:20:47,420
true for most of these so you know what

1569
01:20:45,949 --> 01:20:49,519
we may be seeing here is just the fact

1570
01:20:47,420 --> 01:20:51,170
that we're two under sampled to pick up

1571
01:20:49,520 --> 01:20:54,080
because we're not going from light

1572
01:20:51,170 --> 01:20:56,060
sources as with before again I don't

1573
01:20:54,079 --> 01:20:57,649
know if we need an initial seed pass on

1574
01:20:56,060 --> 01:21:00,890
the light sources to get the lighting

1575
01:20:57,649 --> 01:21:02,000
out into the environment but actually

1576
01:21:00,890 --> 01:21:03,739
that can't be true because we should be

1577
01:21:02,000 --> 01:21:07,640
picking up moonlight so I think we've

1578
01:21:03,738 --> 01:21:10,069
got just a bug in general anyway so if

1579
01:21:07,640 --> 01:21:12,350
we take the total weight that we picked

1580
01:21:10,069 --> 01:21:14,449
up there that's a reasonable value for

1581
01:21:12,350 --> 01:21:23,690
that to be taking the inverse total way

1582
01:21:14,449 --> 01:21:25,729
to strip the opposite of that and biz so

1583
01:21:23,689 --> 01:21:31,000
then we go over the surface points here

1584
01:21:25,729 --> 01:21:31,000
and we just decrease their power right

1585
01:21:32,170 --> 01:21:38,050
power values very very low

1586
01:21:41,869 --> 01:21:44,989
I feel like maybe we just need that

1587
01:21:43,579 --> 01:21:51,439
power value to not be quite so low

1588
01:21:44,989 --> 01:21:56,889
that's kind of way too low yeah let me

1589
01:21:51,439 --> 01:22:01,339
let me go ahead and also the moon color

1590
01:21:56,890 --> 01:22:04,520
is never actually getting multiplied by

1591
01:22:01,340 --> 01:22:07,430
the oh no just get math of the power

1592
01:22:04,520 --> 01:22:11,690
there yeah I think that power value is

1593
01:22:07,430 --> 01:22:13,760
just way too low I know how we would

1594
01:22:11,689 --> 01:22:14,960
ever accumulate Athan with that I guess

1595
01:22:13,760 --> 01:22:18,440
the previous one because it was

1596
01:22:14,960 --> 01:22:24,130
transmission paste it's not quite the

1597
01:22:18,439 --> 01:22:27,469
same but yet so I think here the power

1598
01:22:24,130 --> 01:22:29,449
yeah is just gonna be I don't think

1599
01:22:27,470 --> 01:22:32,199
light retention gets used anywhere else

1600
01:22:29,449 --> 01:22:43,069
so I think all we really want to do is

1601
01:22:32,199 --> 01:22:44,239
just say something like this right and I

1602
01:22:43,069 --> 01:22:48,969
don't know what those values want to be

1603
01:22:44,239 --> 01:22:48,969
tuned to yet but we'll have to see

1604
01:22:54,658 --> 01:23:02,129
so still really problematic in terms of

1605
01:22:57,840 --> 01:23:03,929
the sampling I'm not sure what's going

1606
01:23:02,130 --> 01:23:09,230
on there it almost looks like it doesn't

1607
01:23:03,929 --> 01:23:11,609
retain from frame to frame to me I

1608
01:23:09,229 --> 01:23:22,799
wonder if we just have a bug in how

1609
01:23:11,609 --> 01:23:26,039
we're doing our retention there let me

1610
01:23:22,800 --> 01:23:28,940
just double check something here let's

1611
01:23:26,039 --> 01:23:28,939
make it go really slowly

1612
01:23:31,889 --> 01:23:35,940
Yeah right we got to fix that we got to

1613
01:23:34,380 --> 01:23:38,789
clean up the game code one of these days

1614
01:23:35,939 --> 01:23:42,439
I keep putting enough because well it's

1615
01:23:38,789 --> 01:23:42,439
game code not injured code but

1616
01:23:43,170 --> 01:23:49,590
let me just take it what happens here a

1617
01:23:46,260 --> 01:23:49,590
lot of rays

1618
01:24:00,760 --> 01:24:09,980
yeah so something's kind of weird so I'm

1619
01:24:04,039 --> 01:24:12,800
doing something definitely wrong that's

1620
01:24:09,979 --> 01:24:15,829
not just because of the inbound versus

1621
01:24:12,800 --> 01:24:18,350
outbound lighting so something's up and

1622
01:24:15,829 --> 01:24:31,909
I'm not sure exactly what it is so let's

1623
01:24:18,350 --> 01:24:35,690
double check this again okay oh yeah

1624
01:24:31,909 --> 01:24:38,539
it's quite obvious actually so we are

1625
01:24:35,689 --> 01:24:49,879
never actually summing forward the

1626
01:24:38,539 --> 01:24:53,449
destinations emission so yeah we weren't

1627
01:24:49,880 --> 01:24:57,500
propagating forwards at all in fact so

1628
01:24:53,449 --> 01:24:59,809
in order to start with every point has

1629
01:24:57,500 --> 01:25:02,359
to get its emission from the last frame

1630
01:24:59,810 --> 01:25:05,690
added in to its destination in order for

1631
01:25:02,359 --> 01:25:09,589
it to persist the next round so yeah

1632
01:25:05,689 --> 01:25:13,549
that was just dumb so we were

1633
01:25:09,590 --> 01:25:15,319
effectively getting no no benefit from

1634
01:25:13,550 --> 01:25:17,890
the the actual previous round it was

1635
01:25:15,319 --> 01:25:20,779
just purely the original sampling right

1636
01:25:17,890 --> 01:25:23,150
so now I should be able to set this down

1637
01:25:20,779 --> 01:25:25,219
back to where it was and we should be

1638
01:25:23,149 --> 01:25:28,579
able to see sort of more where we're at

1639
01:25:25,219 --> 01:25:33,350
correctly with the lower sampling right

1640
01:25:28,579 --> 01:25:35,420
here so yeah so you can see first of all

1641
01:25:33,350 --> 01:25:36,620
is we do now that we've got moon light

1642
01:25:35,420 --> 01:25:38,779
in there you can see you get flicker

1643
01:25:36,619 --> 01:25:40,039
from the fact that you know the

1644
01:25:38,779 --> 01:25:44,000
moonlight samples are kind of

1645
01:25:40,039 --> 01:25:45,699
unpredictable and the blend amount also

1646
01:25:44,000 --> 01:25:48,050
is something is set you know pretty

1647
01:25:45,699 --> 01:25:50,329
pretty randomly now too we could we

1648
01:25:48,050 --> 01:25:55,430
could see what happens if we smooth

1649
01:25:50,329 --> 01:25:57,050
quite a bit more and it reduces the

1650
01:25:55,430 --> 01:25:58,610
lighting quite a bit but doesn't really

1651
01:25:57,050 --> 01:26:00,440
reduce the flicker enough so I feel like

1652
01:25:58,609 --> 01:26:03,319
we're still kind of not handling that

1653
01:26:00,439 --> 01:26:05,629
properly right it seems like the flicker

1654
01:26:03,319 --> 01:26:07,549
stays the same regardless of the blend

1655
01:26:05,630 --> 01:26:09,760
amount it's just the the brightness

1656
01:26:07,550 --> 01:26:09,760
right

1657
01:26:13,039 --> 01:26:16,500
that's pretty awesome

1658
01:26:14,789 --> 01:26:19,069
you get enough light in there you never

1659
01:26:16,500 --> 01:26:19,069
get rid of it

1660
01:26:23,840 --> 01:26:28,789
so yeah I am actually relatively

1661
01:26:27,140 --> 01:26:30,289
optimistic about this again we're still

1662
01:26:28,789 --> 01:26:34,329
gonna have to fight this this liquor

1663
01:26:30,289 --> 01:26:34,329
quite a bit but we're getting closer

1664
01:26:52,600 --> 01:26:55,690
all right

1665
01:26:55,738 --> 01:27:05,738
so yeah what we want to do now is start

1666
01:27:03,189 --> 01:27:07,839
to focus on how we can yet keep our

1667
01:27:05,738 --> 01:27:11,829
sampling to something that's going to be

1668
01:27:07,840 --> 01:27:14,770
more consistent obviously one way is to

1669
01:27:11,829 --> 01:27:17,559
require increase our sample camp but it

1670
01:27:14,770 --> 01:27:19,780
seems like maybe we've got other sources

1671
01:27:17,560 --> 01:27:21,070
of flicker I'm not entirely sure because

1672
01:27:19,779 --> 01:27:22,599
it didn't seem like increasing the

1673
01:27:21,069 --> 01:27:26,579
sample count reduce the flicker as much

1674
01:27:22,600 --> 01:27:26,579
as I would have expected it to to do

1675
01:27:28,800 --> 01:27:33,159
four is a very low number and when we

1676
01:27:31,300 --> 01:27:36,070
increased it to 64 I don't remember

1677
01:27:33,158 --> 01:27:43,829
seeing particularly great improvements

1678
01:27:36,069 --> 01:27:43,829
in the flicker right

1679
01:28:08,439 --> 01:28:17,089
so maybe what we want to do here is say

1680
01:28:11,180 --> 01:28:25,400
okay in this case here we're keeping the

1681
01:28:17,090 --> 01:28:27,260
same here's the thing that doesn't make

1682
01:28:25,399 --> 01:28:31,939
less sense to me so we're keeping

1683
01:28:27,260 --> 01:28:34,670
however much of the of what we had last

1684
01:28:31,939 --> 01:28:35,210
frame right so if I set the blend amount

1685
01:28:34,670 --> 01:28:41,090
to zero

1686
01:28:35,210 --> 01:28:42,079
oops it should say the same I guess we

1687
01:28:41,090 --> 01:28:44,300
don't want to do that out right off the

1688
01:28:42,079 --> 01:28:46,159
bat but if I change in the middle of the

1689
01:28:44,300 --> 01:28:48,170
lighting solution right so let's just

1690
01:28:46,159 --> 01:28:49,789
say we get a lighting solution the first

1691
01:28:48,170 --> 01:28:52,250
thing we should verify is that if I

1692
01:28:49,789 --> 01:28:54,800
actually go through here and pick a

1693
01:28:52,250 --> 01:28:56,779
particular spot if I come back and I

1694
01:28:54,800 --> 01:29:01,279
change the blend amount to zero

1695
01:28:56,779 --> 01:29:01,880
I should get a frozen light and I'm and

1696
01:29:01,279 --> 01:29:04,309
I don't

1697
01:29:01,880 --> 01:29:08,480
so something weird is happening here

1698
01:29:04,310 --> 01:29:11,960
right because if I if I literally can't

1699
01:29:08,479 --> 01:29:17,659
transfer any power away something's

1700
01:29:11,960 --> 01:29:19,970
busted I mean this value should always

1701
01:29:17,659 --> 01:29:24,019
be zero so I'm not sure how the

1702
01:29:19,970 --> 01:29:30,020
destination emission can ever get to be

1703
01:29:24,020 --> 01:29:32,750
anything else oh you know what retained

1704
01:29:30,020 --> 01:29:35,660
emission coefficient is exactly what's

1705
01:29:32,750 --> 01:29:39,920
happening there so let's say the

1706
01:29:35,659 --> 01:29:42,430
retained emission coefficient is always

1707
01:29:39,920 --> 01:29:42,430
one

1708
01:29:43,270 --> 01:29:54,210
so we keep everything undecaying in

1709
01:29:47,550 --> 01:29:54,210
theory now right if I come down here

1710
01:29:55,229 --> 01:29:58,739
let's turn it on

1711
01:29:59,130 --> 01:30:06,760
also it doesn't actually need to be

1712
01:30:03,279 --> 01:30:09,819
doing that weird large one right so here

1713
01:30:06,760 --> 01:30:11,829
is a retained power of one so there's no

1714
01:30:09,819 --> 01:30:27,009
decay factor at all and it's kind of

1715
01:30:11,829 --> 01:30:30,180
spreads out ad infinitum which I so I

1716
01:30:27,010 --> 01:30:30,180
guess in

1717
01:30:36,868 --> 01:30:53,460
in terms of decay here we want the decay

1718
01:30:48,270 --> 01:30:57,150
to come from this loop now let me just

1719
01:30:53,460 --> 01:30:59,368
go ahead and really quickly I guess it's

1720
01:30:57,149 --> 01:31:01,618
the skylight to that always because the

1721
01:30:59,368 --> 01:31:04,948
skylight is always adding power to the

1722
01:31:01,618 --> 01:31:08,609
system right I mean I don't know let's

1723
01:31:04,948 --> 01:31:09,529
let's take that out of the equation for

1724
01:31:08,609 --> 01:31:19,219
the time being

1725
01:31:09,529 --> 01:31:19,219
so here's no skylight right

1726
01:31:20,689 --> 01:31:25,339
so now in theory if I go ahead and turn

1727
01:31:23,060 --> 01:31:33,530
off the power transmission I should get

1728
01:31:25,340 --> 01:31:37,250
no change in the lighting it should just

1729
01:31:33,529 --> 01:31:38,750
be the same which looks like it is and

1730
01:31:37,250 --> 01:31:44,750
then when I turn it back on I should get

1731
01:31:38,750 --> 01:31:53,390
transmission there's a lesser

1732
01:31:44,750 --> 01:31:57,260
transmission all right so at least we

1733
01:31:53,390 --> 01:31:59,119
know that's correct there so the thing

1734
01:31:57,260 --> 01:32:01,460
that I'm focused on I think I still have

1735
01:31:59,119 --> 01:32:03,800
kind of a buggy approach to here is that

1736
01:32:01,460 --> 01:32:05,989
I feel like as the blend amount goes

1737
01:32:03,800 --> 01:32:14,810
down the flicker should go down but

1738
01:32:05,989 --> 01:32:17,359
that's not really what's going on I'm

1739
01:32:14,810 --> 01:32:20,570
still seeing a ton of flicker even if

1740
01:32:17,359 --> 01:32:24,880
the blend amount is 1/100 of the total

1741
01:32:20,569 --> 01:32:29,420
light transmission and moonlight is off

1742
01:32:24,880 --> 01:32:31,699
right so something's busted about how

1743
01:32:29,420 --> 01:32:34,760
this is working I'm not thinking about

1744
01:32:31,699 --> 01:32:38,229
the problem correctly because that

1745
01:32:34,760 --> 01:32:38,230
should just not be the case

1746
01:33:36,880 --> 01:33:41,430
so let's take a look at a couple

1747
01:33:38,710 --> 01:33:41,430
different things here

1748
01:33:45,840 --> 01:33:56,020
we know the destination Amit si will

1749
01:33:50,319 --> 01:33:57,189
always be zero zero zero at the start we

1750
01:33:56,020 --> 01:34:00,940
know that we come through the loop we

1751
01:33:57,189 --> 01:34:04,329
will for each sample point we will start

1752
01:34:00,939 --> 01:34:09,639
out by initializing its destination its

1753
01:34:04,329 --> 01:34:13,238
output emission to be whatever its input

1754
01:34:09,640 --> 01:34:14,469
emission was and that seems good and of

1755
01:34:13,238 --> 01:34:16,029
course we won't overwrite any

1756
01:34:14,469 --> 01:34:20,050
transmission that already happened if it

1757
01:34:16,029 --> 01:34:24,009
got transmitted from a point prior that

1758
01:34:20,050 --> 01:34:28,570
happened earlier in the loop as we come

1759
01:34:24,010 --> 01:34:30,760
through here we're going to take a

1760
01:34:28,569 --> 01:34:36,779
weighted average of these points to

1761
01:34:30,760 --> 01:34:36,780
permit to create our emission value

1762
01:34:45,180 --> 01:34:53,110
and the amount that we're going to add

1763
01:34:49,779 --> 01:34:55,420
for light into the system is going to be

1764
01:34:53,109 --> 01:35:01,889
the power right because we're gonna do

1765
01:34:55,420 --> 01:35:01,890
that in inside accumulate sample here I

1766
01:35:06,420 --> 01:35:16,000
don't know why we're using the length of

1767
01:35:09,159 --> 01:35:16,329
the light color oh because we are trunk

1768
01:35:16,000 --> 01:35:17,710
yep

1769
01:35:16,329 --> 01:35:19,029
nevermind that's just trying to figure

1770
01:35:17,710 --> 01:35:22,300
out that for the average direction of

1771
01:35:19,029 --> 01:35:26,729
the light so we're gonna use whatever

1772
01:35:22,300 --> 01:35:26,730
the power was times the light color and

1773
01:35:26,819 --> 01:35:31,659
we're just using the angular fall-off

1774
01:35:29,140 --> 01:35:33,160
factor there so we should be adding less

1775
01:35:31,659 --> 01:35:36,539
light to the system than we're taking

1776
01:35:33,159 --> 01:35:38,829
away because the angular fall-off right

1777
01:35:36,539 --> 01:35:41,470
should be taking light away from the

1778
01:35:38,829 --> 01:35:43,630
system so what I'm seeing happen is the

1779
01:35:41,470 --> 01:35:46,230
exact opposite of what I would expect so

1780
01:35:43,630 --> 01:35:49,300
I know we've got a bug in here somewhere

1781
01:35:46,229 --> 01:35:54,250
because that can't be correct right that

1782
01:35:49,300 --> 01:35:55,840
just can't be the case there shouldn't

1783
01:35:54,250 --> 01:35:57,039
be any way for it to be getting brighter

1784
01:35:55,840 --> 01:36:00,029
over time we should be getting dimmer

1785
01:35:57,039 --> 01:36:00,029
over time

1786
01:36:23,429 --> 01:36:29,369
hmm but again I really don't see it

1787
01:36:37,368 --> 01:36:48,889
I guess let's double check here let me

1788
01:36:40,429 --> 01:36:54,739
make sure that we're summing these

1789
01:36:48,889 --> 01:36:57,529
exactly the same way so in here where we

1790
01:36:54,738 --> 01:37:03,259
do our omit see I'm just gonna take this

1791
01:36:57,529 --> 01:37:07,938
power right if we were just summit

1792
01:37:03,260 --> 01:37:10,479
exactly and we could take if you if we

1793
01:37:07,939 --> 01:37:10,479
look here

1794
01:37:20,829 --> 01:37:24,789
we know that this power is going to

1795
01:37:22,449 --> 01:37:33,550
multiply the emit see here we can just

1796
01:37:24,789 --> 01:37:36,220
say all right the emit see here's our

1797
01:37:33,550 --> 01:37:37,779
weight it's going to be the inverse

1798
01:37:36,220 --> 01:37:42,340
distance squared times the inverse

1799
01:37:37,779 --> 01:37:47,649
totally we can even assert if the weight

1800
01:37:42,340 --> 01:37:50,039
is less than one and I mean we may have

1801
01:37:47,649 --> 01:37:52,509
to put an epsilon in there but we'll see

1802
01:37:50,039 --> 01:37:54,579
and then what we can do is say alright

1803
01:37:52,510 --> 01:37:55,989
we're going to reduce it by the power

1804
01:37:54,579 --> 01:38:00,130
times the weight and we're going to

1805
01:37:55,989 --> 01:38:04,050
increase the emit C by the weight we

1806
01:38:00,130 --> 01:38:09,520
even know that the contribs

1807
01:38:04,050 --> 01:38:13,989
is the same in both cases it's this so

1808
01:38:09,520 --> 01:38:17,410
that's how much we're contributing we're

1809
01:38:13,989 --> 01:38:19,679
going to remove that amount of light

1810
01:38:17,409 --> 01:38:26,289
from the surface we took it from and

1811
01:38:19,680 --> 01:38:27,880
we're going to put that into the amount

1812
01:38:26,289 --> 01:38:28,960
that we're about to distribute we don't

1813
01:38:27,880 --> 01:38:30,880
love to fly it by the power because

1814
01:38:28,960 --> 01:38:38,350
gonna get multiplied by the power down

1815
01:38:30,880 --> 01:38:41,859
here I don't expect that to do anything

1816
01:38:38,350 --> 01:38:43,390
different but I just wanted to sum them

1817
01:38:41,859 --> 01:38:44,829
in the same place using the same values

1818
01:38:43,390 --> 01:38:46,300
just to keep things a little clearer and

1819
01:38:44,829 --> 01:38:52,019
it's really not right it's that's

1820
01:38:46,300 --> 01:38:52,020
exactly what it was doing before right

1821
01:38:54,618 --> 01:38:59,658
so we have to figure out why this is

1822
01:38:56,689 --> 01:39:01,488
producing such a drastic difference and

1823
01:38:59,658 --> 01:39:09,829
so I'm going to do here is I'm going to

1824
01:39:01,488 --> 01:39:10,908
take a look at a couple things first

1825
01:39:09,829 --> 01:39:12,590
thing I'm going to do is I just want to

1826
01:39:10,908 --> 01:39:15,500
step through this and see what this

1827
01:39:12,590 --> 01:39:18,889
comes out to be so the weight values are

1828
01:39:15,500 --> 01:39:20,300
all this assertion is not firing so we

1829
01:39:18,889 --> 01:39:27,770
know the weight values are all exactly

1830
01:39:20,300 --> 01:39:29,000
as we would expect you know and the want

1831
01:39:27,770 --> 01:39:32,540
to make sure I present to you bug mode

1832
01:39:29,000 --> 01:39:36,050
there so I can look at everything and so

1833
01:39:32,539 --> 01:39:38,889
if I take a look at what's actually

1834
01:39:36,050 --> 01:39:38,889
happening here

1835
01:39:40,890 --> 01:39:51,420
it all looks exactly right to me I don't

1836
01:39:49,500 --> 01:39:53,310
know why I can't step in to accumulate

1837
01:39:51,420 --> 01:39:57,029
sample did this not come pre-compile or

1838
01:39:53,310 --> 01:40:10,010
something I was moving why is it moving

1839
01:39:57,029 --> 01:40:12,179
that down there there we go all right so

1840
01:40:10,010 --> 01:40:18,300
if I take a look at what's happening

1841
01:40:12,180 --> 01:40:23,250
with the yeah with the Destin bitsy

1842
01:40:18,300 --> 01:40:33,810
additions here I mean they're just that

1843
01:40:23,250 --> 01:40:36,560
power value is so tiny right basically

1844
01:40:33,810 --> 01:40:36,560
something's up

1845
01:40:40,380 --> 01:40:52,920
I kind of want to measure I kind of want

1846
01:40:51,090 --> 01:40:57,869
to measure the total light removed and

1847
01:40:52,920 --> 01:41:10,319
the total light distributed right so if

1848
01:40:57,869 --> 01:41:11,819
I was to to take you know these two and

1849
01:41:10,319 --> 01:41:26,309
I guess I can just reinstate this

1850
01:41:11,819 --> 01:41:30,389
temporarily or I should say total added

1851
01:41:26,310 --> 01:41:32,970
total removed so if I just measure these

1852
01:41:30,390 --> 01:41:35,640
two together right the total amount of

1853
01:41:32,970 --> 01:41:44,550
light that we add to the system at any

1854
01:41:35,640 --> 01:41:48,590
given time is going to be this and the

1855
01:41:44,550 --> 01:41:48,590
total amount removed is going to be this

1856
01:42:00,539 --> 01:42:07,510
so yeah you start with the same light

1857
01:42:03,819 --> 01:42:09,219
use that you assume you end with the

1858
01:42:07,510 --> 01:42:10,960
same light you started with and then

1859
01:42:09,220 --> 01:42:13,449
this is the thing that determines the

1860
01:42:10,960 --> 01:42:15,850
balance right so whatever you did in

1861
01:42:13,449 --> 01:42:17,619
here and whatever you did in here those

1862
01:42:15,850 --> 01:42:20,710
two things there

1863
01:42:17,619 --> 01:42:22,329
if total removed is more than total

1864
01:42:20,710 --> 01:42:24,670
added you should get dimmer if the

1865
01:42:22,329 --> 01:42:27,069
opposite is true you'll get brighter so

1866
01:42:24,670 --> 01:42:39,760
I'm just curious I want to see now what

1867
01:42:27,069 --> 01:42:42,340
those values look like over time and so

1868
01:42:39,760 --> 01:42:44,470
those values look exactly like what I

1869
01:42:42,340 --> 01:42:46,300
would expect them to look like the total

1870
01:42:44,470 --> 01:42:47,740
amount of light removed is always

1871
01:42:46,300 --> 01:42:51,520
greater than the total amount of light

1872
01:42:47,739 --> 01:42:53,469
added and so I would have thought that

1873
01:42:51,520 --> 01:42:56,170
we would get the opposite result from

1874
01:42:53,470 --> 01:42:58,840
what we were seeing right because of the

1875
01:42:56,170 --> 01:43:00,909
angular fall-off involved I would have

1876
01:42:58,840 --> 01:43:04,029
expected

1877
01:43:00,909 --> 01:43:04,028
[Music]

1878
01:43:06,340 --> 01:43:12,550
I don't understand how it's getting

1879
01:43:09,550 --> 01:43:14,289
brighter and now we have like numerical

1880
01:43:12,550 --> 01:43:16,389
proof that the thing that I'm assuming

1881
01:43:14,289 --> 01:43:18,760
should be happening is what it thinks is

1882
01:43:16,389 --> 01:43:24,639
happening as well so there is some bug

1883
01:43:18,760 --> 01:43:28,539
in how we're doing this computation and

1884
01:43:24,639 --> 01:43:30,520
I just don't know where it is but that's

1885
01:43:28,539 --> 01:43:33,310
our job we got to find that because you

1886
01:43:30,520 --> 01:43:36,750
can see this is not getting dimmer over

1887
01:43:33,310 --> 01:43:36,750
time it's getting brighter over time

1888
01:43:37,229 --> 01:43:46,539
like you can see that happening very

1889
01:43:39,670 --> 01:43:52,210
clearly right and yet the opposite

1890
01:43:46,539 --> 01:43:54,448
should be true now I guess technically

1891
01:43:52,210 --> 01:43:56,710
maybe I'm looking this the wrong way

1892
01:43:54,448 --> 01:43:58,868
technically we do add light to the

1893
01:43:56,710 --> 01:44:07,779
system though because we do add the

1894
01:43:58,868 --> 01:44:09,819
actual lights themselves so I guess what

1895
01:44:07,779 --> 01:44:11,500
we could say is that because we're

1896
01:44:09,819 --> 01:44:14,049
adding those lights themselves maybe

1897
01:44:11,500 --> 01:44:19,889
that's enough to tilt the balance in

1898
01:44:14,050 --> 01:44:19,889
favor of light always I mean

1899
01:44:23,908 --> 01:44:40,719
that certainly seems possible and you

1900
01:44:38,828 --> 01:44:51,670
know if you just don't have quite the

1901
01:44:40,719 --> 01:44:54,880
amount of sink but I mean it still seems

1902
01:44:51,670 --> 01:44:57,940
like an awfully fast spread rate for

1903
01:44:54,880 --> 01:45:01,469
such a small blend amount look what

1904
01:44:57,939 --> 01:45:01,469
happens if it's just ridiculously low

1905
01:45:14,640 --> 01:45:20,920
and so you can see that even when the

1906
01:45:18,220 --> 01:45:28,990
blending is incredibly slow you still

1907
01:45:20,920 --> 01:45:39,190
get a very high flicker rate right which

1908
01:45:28,989 --> 01:45:41,769
is totally wrong because if the only way

1909
01:45:39,189 --> 01:45:44,289
that something can change is by getting

1910
01:45:41,770 --> 01:45:47,110
samples from this small of a coefficient

1911
01:45:44,289 --> 01:45:49,390
how is it possibly flickering it should

1912
01:45:47,109 --> 01:45:53,559
not be able to change how much light it

1913
01:45:49,390 --> 01:45:55,289
has by very much at all on any given

1914
01:45:53,560 --> 01:45:59,200
frame it should be almost impossible

1915
01:45:55,289 --> 01:46:00,460
right to have to affect any change so

1916
01:45:59,199 --> 01:46:02,859
the fact that we're getting such an

1917
01:46:00,460 --> 01:46:03,720
obvious flicker even it's such a small

1918
01:46:02,859 --> 01:46:06,479
framerate

1919
01:46:03,720 --> 01:46:09,070
suggests to me that something pretty

1920
01:46:06,479 --> 01:46:10,750
majorly wrong is happening with how I'm

1921
01:46:09,069 --> 01:46:12,779
doing this and I just don't know what it

1922
01:46:10,750 --> 01:46:12,779
is

1923
01:46:28,220 --> 01:46:33,800
but I'm going to have to figure out a

1924
01:46:30,210 --> 01:46:33,800
creative way to look at it

1925
01:46:48,659 --> 01:46:54,420
and again I thought and I mean will

1926
01:46:51,869 --> 01:46:57,420
Rivera fie it but I also thought that we

1927
01:46:54,420 --> 01:47:02,010
have no flicker nothing changes if I

1928
01:46:57,420 --> 01:47:03,420
just take a particular state of the

1929
01:47:02,010 --> 01:47:06,900
lighting system and turn the blend

1930
01:47:03,420 --> 01:47:14,960
equation to zero and I guess you know

1931
01:47:06,899 --> 01:47:14,960
what I can go back to real time now

1932
01:47:25,109 --> 01:47:30,969
right so you know flickering like crazy

1933
01:47:28,378 --> 01:47:32,588
right just absolutely nuts how much

1934
01:47:30,969 --> 01:47:34,298
flickering despite the fact that it's

1935
01:47:32,588 --> 01:47:37,029
supposed to not be able to change hardly

1936
01:47:34,298 --> 01:47:43,628
at all if I go ahead and change the

1937
01:47:37,029 --> 01:47:45,429
blend amount to zero and I mean that the

1938
01:47:43,628 --> 01:47:47,679
nuts thing about that is look at what

1939
01:47:45,429 --> 01:47:54,248
happened instantaneously these went from

1940
01:47:47,679 --> 01:47:57,668
red to black even weirder so I think

1941
01:47:54,248 --> 01:48:05,260
this flicker is coming from a bug in

1942
01:47:57,668 --> 01:48:09,818
terms of how we're treating the the

1943
01:48:05,260 --> 01:48:16,030
lights on output and not from anything

1944
01:48:09,819 --> 01:48:18,429
else because when you can only change

1945
01:48:16,029 --> 01:48:22,418
the lighting by that much every frame

1946
01:48:18,429 --> 01:48:25,328
per ray and you're only casting for rays

1947
01:48:22,418 --> 01:48:27,010
I mean it should be impossible to get

1948
01:48:25,328 --> 01:48:28,238
flicker it should be almost impossible

1949
01:48:27,010 --> 01:48:30,899
to get flicker

1950
01:48:28,238 --> 01:48:34,478
even if lights were a thousand bright

1951
01:48:30,899 --> 01:48:38,469
they could only affect the RGB color by

1952
01:48:34,479 --> 01:48:44,499
one like frak by one 100th of its

1953
01:48:38,469 --> 01:48:46,899
brightness in a perfect scenario if all

1954
01:48:44,498 --> 01:48:52,448
four rays hit a thousand bright light

1955
01:48:46,899 --> 01:48:57,128
and that's just not common that's just

1956
01:48:52,448 --> 01:48:58,688
not the common case so let's double

1957
01:48:57,128 --> 01:49:04,748
check our assumptions maybe something

1958
01:48:58,689 --> 01:49:06,819
outside the loop is screwing a set so

1959
01:49:04,748 --> 01:49:08,858
let's take a look here when we're coming

1960
01:49:06,819 --> 01:49:14,559
through for outputting

1961
01:49:08,859 --> 01:49:17,260
the results of the lighting here you can

1962
01:49:14,559 --> 01:49:18,760
see me going through and we're never

1963
01:49:17,260 --> 01:49:20,229
going to hit this case anymore because

1964
01:49:18,760 --> 01:49:22,168
valid is always equal to false we're

1965
01:49:20,229 --> 01:49:25,239
always going to come through here and

1966
01:49:22,168 --> 01:49:29,858
for each point we're gonna copy back the

1967
01:49:25,238 --> 01:49:33,058
emit c0 into the permanent storage and

1968
01:49:29,859 --> 01:49:36,719
we're going to take the direction and

1969
01:49:33,059 --> 01:49:36,719
we're going to normalize it

1970
01:49:37,470 --> 01:49:48,789
which makes sense right that's what we

1971
01:49:40,119 --> 01:50:00,119
want to do it could be that that average

1972
01:49:48,789 --> 01:50:00,119
direction to light is what's flickering

1973
01:50:02,489 --> 01:50:14,769
you know what maybe that's what's

1974
01:50:05,739 --> 01:50:16,630
happening maybe because we don't know

1975
01:50:14,770 --> 01:50:20,230
what the average direction to the light

1976
01:50:16,630 --> 01:50:23,859
is yeah yeah yeah

1977
01:50:20,229 --> 01:50:25,809
that's what's happening because we don't

1978
01:50:23,859 --> 01:50:28,500
know what the average directional light

1979
01:50:25,810 --> 01:50:31,750
is if it's zero we will get no lighting

1980
01:50:28,500 --> 01:50:34,090
so that's the flicker it's coming from

1981
01:50:31,750 --> 01:50:37,630
the average direction to light not being

1982
01:50:34,090 --> 01:50:39,760
set so if instead when we seed our

1983
01:50:37,630 --> 01:50:42,279
lighting we also seated our average

1984
01:50:39,760 --> 01:50:47,829
direction to light here I bet our

1985
01:50:42,279 --> 01:50:52,989
problem goes away right so here where we

1986
01:50:47,829 --> 01:50:55,420
take our light in like so I'm going to

1987
01:50:52,989 --> 01:50:58,960
go ahead and also take the average

1988
01:50:55,420 --> 01:51:01,659
direction to light in as well so we'll

1989
01:50:58,960 --> 01:51:06,480
seed with that initial value and let's

1990
01:51:01,659 --> 01:51:06,479
see what that does to the situation

1991
01:51:18,578 --> 01:51:21,988
so now I'm still getting a ton of

1992
01:51:20,139 --> 01:51:24,340
flicker there did I do that right

1993
01:51:21,988 --> 01:51:35,439
average direction delight lady indexical

1994
01:51:24,340 --> 01:51:39,940
smack storage local index direction what

1995
01:51:35,439 --> 01:51:44,259
do we do with that we clear it that's no

1996
01:51:39,939 --> 01:51:52,138
good so I did absolutely nothing with

1997
01:51:44,260 --> 01:51:52,139
that try that one more time there we go

1998
01:51:53,729 --> 01:52:00,689
now that's what I was expecting okay

1999
01:52:01,229 --> 01:52:09,328
finally got to the bottom of it now

2000
01:52:04,439 --> 01:52:09,328
let's try a more reasonable blend amount

2001
01:52:18,359 --> 01:52:24,449
much better and finally now we need to

2002
01:52:22,079 --> 01:52:31,470
work on our transmission amount this is

2003
01:52:24,449 --> 01:52:37,649
the light retention factor here so what

2004
01:52:31,470 --> 01:52:39,570
I think we want to do is again you know

2005
01:52:37,649 --> 01:52:47,429
I don't know how much light we want to

2006
01:52:39,569 --> 01:52:49,199
remove per frame I'm not sure exactly

2007
01:52:47,430 --> 01:52:50,610
how we want to do this we got to work on

2008
01:52:49,199 --> 01:52:52,079
how we want to do this this may require

2009
01:52:50,609 --> 01:52:53,369
the blackboard this might be tomorrow's

2010
01:52:52,079 --> 01:52:55,500
job because you can see we get a lot of

2011
01:52:53,369 --> 01:52:58,250
flicker if we have something in that

2012
01:52:55,500 --> 01:52:58,250
actually decays

2013
01:53:15,689 --> 01:53:19,269
so I'm gonna go ahead and say let's get

2014
01:53:17,949 --> 01:53:28,029
rid of the retained emission coefficient

2015
01:53:19,270 --> 01:53:35,410
there copy those two pieces of

2016
01:53:28,029 --> 01:53:37,119
information out okay and furthermore one

2017
01:53:35,409 --> 01:53:38,859
of the nasty problems about this is we

2018
01:53:37,119 --> 01:53:40,630
also need to know how much we want to

2019
01:53:38,859 --> 01:53:45,849
weight this average direction to light

2020
01:53:40,630 --> 01:53:48,100
here so that's a little bit hard to say

2021
01:53:45,850 --> 01:53:50,079
as well but hopefully that that will not

2022
01:53:48,100 --> 01:53:51,430
be too much a big deal we also don't

2023
01:53:50,079 --> 01:53:52,750
know that we ever really want to use the

2024
01:53:51,430 --> 01:53:53,950
other direction light we may just decide

2025
01:53:52,750 --> 01:53:57,819
that that's a dumb thing and we can

2026
01:53:53,949 --> 01:53:59,199
should get rid of it but so you can see

2027
01:53:57,819 --> 01:54:01,599
that we're getting a little bit too much

2028
01:53:59,199 --> 01:54:04,389
instant popping of light that as it

2029
01:54:01,600 --> 01:54:06,430
comes in there so there's something

2030
01:54:04,390 --> 01:54:11,110
still a little busted with how we're

2031
01:54:06,430 --> 01:54:15,400
doing our transmission here that power

2032
01:54:11,109 --> 01:54:21,869
the blend amount power it's seems to be

2033
01:54:15,399 --> 01:54:21,869
much too powerful and I'm not sure why

2034
01:54:23,850 --> 01:54:29,980
so our omit C is somehow much too large

2035
01:54:28,119 --> 01:54:35,199
even though it should be quite a bit

2036
01:54:29,979 --> 01:54:37,529
lower and I don't know why that is now

2037
01:54:35,199 --> 01:54:40,479
that could be because the max light

2038
01:54:37,529 --> 01:54:44,559
value is too high and so we're just

2039
01:54:40,479 --> 01:54:46,979
transmitting way too much light it's

2040
01:54:44,560 --> 01:54:46,980
hard to say

2041
01:54:55,029 --> 01:54:58,130
yeah I feel like we're gonna have to do

2042
01:54:56,899 --> 01:55:00,289
some black boarding on this because I'm

2043
01:54:58,130 --> 01:55:02,869
I'm kind of now just tweaking a value

2044
01:55:00,289 --> 01:55:04,039
for no apparent reason and we kind of

2045
01:55:02,869 --> 01:55:06,319
want to make sure we know what's going

2046
01:55:04,039 --> 01:55:13,100
on with that right so there's clearly a

2047
01:55:06,319 --> 01:55:15,199
balance here and it seems like light is

2048
01:55:13,100 --> 01:55:16,760
never getting removed the systems in a

2049
01:55:15,199 --> 01:55:20,359
sufficient amount compared to how much

2050
01:55:16,760 --> 01:55:32,630
is getting put in which is kind of odd

2051
01:55:20,359 --> 01:55:37,279
as well so so if you take a look at max

2052
01:55:32,630 --> 01:55:38,840
light emission here for example you know

2053
01:55:37,279 --> 01:55:42,219
I wonder if this is really the thing

2054
01:55:38,840 --> 01:55:42,220
that wants to be coefficient

2055
01:55:51,729 --> 01:56:00,699
like how much light you put in the

2056
01:55:53,899 --> 01:56:00,699
system is a little bit more conserved

2057
01:56:03,750 --> 01:56:09,359
so the amount you preserve is the part

2058
01:56:06,600 --> 01:56:15,810
that's kept up and the part that you put

2059
01:56:09,359 --> 01:56:17,189
in is much less it still looks like

2060
01:56:15,810 --> 01:56:18,630
that's always gonna add light though you

2061
01:56:17,189 --> 01:56:20,129
can see it's always adding light to the

2062
01:56:18,630 --> 01:56:24,600
system no matter how low we make that

2063
01:56:20,130 --> 01:56:29,640
value so yeah we're getting closer

2064
01:56:24,600 --> 01:56:30,960
though what time is it I got four

2065
01:56:29,640 --> 01:56:32,100
minutes left all right I'm gonna call it

2066
01:56:30,960 --> 01:56:33,869
there because we got rid of one of our

2067
01:56:32,100 --> 01:56:36,390
major bugs and we rewrote this routine

2068
01:56:33,869 --> 01:56:38,489
to work more properly so what I'm gonna

2069
01:56:36,390 --> 01:56:40,500
say is we just now need to work on our

2070
01:56:38,489 --> 01:56:42,719
light power distribution how we're gonna

2071
01:56:40,500 --> 01:56:44,609
decay and how we're gonna make sure it

2072
01:56:42,720 --> 01:56:52,560
propagates fast enough I think we're

2073
01:56:44,609 --> 01:56:54,979
getting close though I think we're

2074
01:56:52,560 --> 01:56:54,980
getting close

2075
01:56:57,550 --> 01:57:01,820
what I might say is like let's say you

2076
01:56:59,930 --> 01:57:05,420
know as just an example test here

2077
01:57:01,819 --> 01:57:07,429
suppose we did emit see this this part

2078
01:57:05,420 --> 01:57:15,859
here we do a remove see suppose we

2079
01:57:07,430 --> 01:57:17,150
always remove you know removal ratio or

2080
01:57:15,859 --> 01:57:18,589
something like this suppose we had a

2081
01:57:17,149 --> 01:57:22,939
thing here where we could remove a

2082
01:57:18,590 --> 01:57:26,869
certain amount of power on bounces and

2083
01:57:22,939 --> 01:57:31,519
so our removal ratio you know what's

2084
01:57:26,869 --> 01:57:40,279
going to be higher like for example we

2085
01:57:31,520 --> 01:57:44,200
don't really want this to go negative so

2086
01:57:40,279 --> 01:57:44,199
we would probably have to threshold it

2087
01:57:49,640 --> 01:58:02,890
but basically this part right here will

2088
01:57:58,159 --> 01:58:02,889
just clamp so at the end here we'll say

2089
01:58:05,859 --> 01:58:10,359
can we do a whole vector clamp here I

2090
01:58:11,560 --> 01:58:19,930
just want to check that's greater than

2091
01:58:15,949 --> 01:58:19,929
zero so

2092
01:58:35,250 --> 01:58:56,409
let's do it this way so something like

2093
01:58:44,199 --> 01:59:03,369
this so that way I can make the removal

2094
01:58:56,409 --> 01:59:05,289
ratio be something higher so we can

2095
01:59:03,369 --> 01:59:10,300
remove twice as much light as we tried

2096
01:59:05,289 --> 01:59:14,409
to add even on top of the previous part

2097
01:59:10,300 --> 01:59:15,670
right it's so weird that that still

2098
01:59:14,409 --> 01:59:19,139
doesn't seem to be enough I feel like

2099
01:59:15,670 --> 01:59:19,140
there's maybe one more bug in here

2100
01:59:27,539 --> 01:59:32,019
okay it it's got to be the case that

2101
01:59:30,729 --> 01:59:34,679
we've got a bug where we're just not

2102
01:59:32,020 --> 01:59:34,680
removing white

2103
01:59:46,560 --> 01:59:51,690
like it just looks like the light never

2104
01:59:48,939 --> 01:59:51,689
really gets removed

2105
02:00:19,170 --> 02:00:30,100
I'm just going nuts with this value now

2106
02:00:21,488 --> 02:00:32,829
just to see so I can crank it high

2107
02:00:30,100 --> 02:00:37,440
enough to make it so that it kills any

2108
02:00:32,829 --> 02:00:37,439
transmission all right

2109
02:00:56,099 --> 02:01:05,110
super-weird alright so basically we've

2110
02:01:03,038 --> 02:01:06,550
got some weird stuff going on here and

2111
02:01:05,109 --> 02:01:08,018
we're gonna have to debug this tomorrow

2112
02:01:06,550 --> 02:01:10,239
so that'll be our job tomorrow is to

2113
02:01:08,019 --> 02:01:14,079
figure out how to get the light balance

2114
02:01:10,238 --> 02:01:16,678
to be correct because it's not correct

2115
02:01:14,078 --> 02:01:16,679
at the moment

2116
02:01:25,810 --> 02:01:35,140
something something definitely is odd

2117
02:01:29,210 --> 02:01:35,140
there let's go ahead and go to the Q&amp;A

2118
02:02:13,390 --> 02:02:16,630
I'll be finishing to see exactly what's

2119
02:02:15,579 --> 02:02:22,359
going on with that light it's

2120
02:02:16,630 --> 02:02:34,029
interesting it always seems to retain a

2121
02:02:22,359 --> 02:02:35,319
fair bit of it there's something still

2122
02:02:34,029 --> 02:02:38,469
one more thing in there that I just

2123
02:02:35,319 --> 02:02:41,979
don't get it's kind of cool

2124
02:02:38,470 --> 02:02:46,560
what's happening right now but totally

2125
02:02:41,979 --> 02:02:46,559
not it's totally a bug

2126
02:03:00,099 --> 02:03:06,489
mmm-hmm and go I don't think you're

2127
02:03:04,359 --> 02:03:08,618
laying prone kind of like photon mapping

2128
02:03:06,488 --> 02:03:11,379
but weird will work I think it's worth

2129
02:03:08,618 --> 02:03:18,069
rethinking well we've rethought it a

2130
02:03:11,380 --> 02:03:23,050
couple times so I'm totally not adverse

2131
02:03:18,069 --> 02:03:29,139
to it however I'm not sure I'm ready to

2132
02:03:23,050 --> 02:03:30,849
say that it won't work yet it would help

2133
02:03:29,139 --> 02:03:33,118
if you said why you don't think it will

2134
02:03:30,849 --> 02:03:35,920
work also so we could discuss that

2135
02:03:33,118 --> 02:03:37,479
doesn't service need to need a hit to

2136
02:03:35,920 --> 02:03:38,590
have its light reduced if nothing it's

2137
02:03:37,479 --> 02:03:40,059
the surface the light will remain

2138
02:03:38,590 --> 02:03:44,159
constant yes

2139
02:03:40,060 --> 02:03:44,159
which i think is okay

2140
02:03:57,390 --> 02:04:01,350
actually so you know what's interesting

2141
02:04:01,560 --> 02:04:08,500
is actually this should be

2142
02:04:03,819 --> 02:04:13,689
bi-directional too shouldn't it like

2143
02:04:08,500 --> 02:04:17,529
when you have a Ray between two of them

2144
02:04:13,689 --> 02:04:18,729
they should they should transfer light

2145
02:04:17,529 --> 02:04:23,439
between each other

2146
02:04:18,729 --> 02:04:25,750
technically this is running on only one

2147
02:04:23,439 --> 02:04:28,029
core of the GPU by the way so when we

2148
02:04:25,750 --> 02:04:32,500
actually see if we multi-threaded it on

2149
02:04:28,029 --> 02:04:35,170
the CPU side or move it to GPU it would

2150
02:04:32,500 --> 02:04:37,560
run very very fast compared to what's

2151
02:04:35,170 --> 02:04:37,560
running now

2152
02:04:47,380 --> 02:05:04,328
and you know and have wait emit see plus

2153
02:04:50,859 --> 02:05:05,710
equals wait times contribs see no I I

2154
02:05:04,328 --> 02:05:08,670
think that's correct that's what I

2155
02:05:05,710 --> 02:05:08,670
intended anyway

2156
02:05:22,579 --> 02:05:34,819
whatever using for coder is the rpi

2157
02:05:29,970 --> 02:05:34,820
still a thing what is the RPI

2158
02:05:40,609 --> 02:05:43,789
it's interesting yeah I was just

2159
02:05:42,260 --> 02:05:46,010
thinking about the bi-directional nature

2160
02:05:43,788 --> 02:05:48,198
of this so when you hit something you

2161
02:05:46,010 --> 02:05:51,309
should transfer light between the two of

2162
02:05:48,198 --> 02:05:51,308
you technically

2163
02:06:00,889 --> 02:06:04,788
you know what and also there's another

2164
02:06:03,019 --> 02:06:08,090
aspect of it is when you're transferring

2165
02:06:04,788 --> 02:06:14,050
light because you're using the previous

2166
02:06:08,090 --> 02:06:17,659
lighting to do the transfer you also

2167
02:06:14,050 --> 02:06:22,489
it's unclear whether it's correct to not

2168
02:06:17,658 --> 02:06:33,589
use the same array because sampling from

2169
02:06:22,488 --> 02:06:36,168
the previous light solution is going to

2170
02:06:33,590 --> 02:06:43,639
allow you to multiple use the amount of

2171
02:06:36,168 --> 02:06:49,099
light coming from any given source right

2172
02:06:43,639 --> 02:06:52,219
so if you take a look at this it's

2173
02:06:49,099 --> 02:06:54,800
really not correct to have to to do a

2174
02:06:52,219 --> 02:06:57,050
previous in the next you pretty much

2175
02:06:54,800 --> 02:06:59,899
need to make it so that as you do hits

2176
02:06:57,050 --> 02:07:05,019
you are moving the light around that you

2177
02:06:59,899 --> 02:07:05,019
have but yeah

2178
02:07:14,449 --> 02:07:22,109
but hango this is radiosity that's what

2179
02:07:17,520 --> 02:07:23,850
we're doing the previous loop was more

2180
02:07:22,109 --> 02:07:26,329
like radiosity because it goes from

2181
02:07:23,850 --> 02:07:29,100
emitters out which is the traditional

2182
02:07:26,329 --> 02:07:32,880
well there's both kinds of radiosity

2183
02:07:29,100 --> 02:07:34,050
right but this is literally radiosity so

2184
02:07:32,880 --> 02:07:39,750
the thing you just told me to Google is

2185
02:07:34,050 --> 02:07:41,279
what we've been doing so yeah it's not

2186
02:07:39,750 --> 02:07:45,199
over the top for a live game

2187
02:07:41,279 --> 02:07:48,149
it's what live games do granted they're

2188
02:07:45,199 --> 02:07:50,720
not 2d games they're usually full 3d

2189
02:07:48,149 --> 02:07:50,719
games but

2190
02:08:19,399 --> 02:08:26,019
does anyone know what the rpi thing was

2191
02:08:23,029 --> 02:08:26,019
there we still

2192
02:08:30,909 --> 02:08:36,789
I just need to know what acronym RPI is

2193
02:08:34,510 --> 02:08:37,930
referring to here cuz I'm not sure what

2194
02:08:36,789 --> 02:08:50,019
the question was

2195
02:08:37,930 --> 02:08:53,140
Oh Raspberry Pi yeah I mean that

2196
02:08:50,020 --> 02:08:55,360
definitely at some point when we're done

2197
02:08:53,140 --> 02:09:00,039
will port to Raspberry Pi whichever

2198
02:08:55,359 --> 02:09:02,199
incarnation is popular at that time we

2199
02:09:00,039 --> 02:09:04,810
will have to turn off a bunch of

2200
02:09:02,199 --> 02:09:08,979
graphics features for that because the

2201
02:09:04,810 --> 02:09:13,360
Raspberry Pi just doesn't have much in

2202
02:09:08,979 --> 02:09:15,729
the way of graphics horsepower so like

2203
02:09:13,359 --> 02:09:18,609
we won't be able to use full lighting or

2204
02:09:15,729 --> 02:09:20,649
any of that stuff on a Raspberry Pi but

2205
02:09:18,609 --> 02:09:22,299
we will be able to run the game part of

2206
02:09:20,649 --> 02:09:25,559
the game just fine and we'll have a

2207
02:09:22,300 --> 02:09:29,710
reduced you know unlit version let's say

2208
02:09:25,560 --> 02:09:32,770
at prop at not you know not 1080p and

2209
02:09:29,710 --> 02:09:35,489
not lit but you know the rest of the

2210
02:09:32,770 --> 02:09:35,490
game will be fine

2211
02:09:59,378 --> 02:10:03,108
all right so in bits end of queue so

2212
02:10:01,668 --> 02:10:07,898
tomorrow I'm gonna try making this

2213
02:10:03,109 --> 02:10:10,369
bi-directional and I'm using one array I

2214
02:10:07,899 --> 02:10:17,239
think that's what I'd like to try and

2215
02:10:10,368 --> 02:10:18,498
we'll see how that goes again just in

2216
02:10:17,238 --> 02:10:20,358
case since there were some fusion this

2217
02:10:18,498 --> 02:10:24,559
is absolutely how radiosity works this

2218
02:10:20,359 --> 02:10:26,929
is exactly how radiosity works you can

2219
02:10:24,559 --> 02:10:31,070
even literally look at the previous loop

2220
02:10:26,929 --> 02:10:39,679
was like straight out of radiosity I'll

2221
02:10:31,069 --> 02:10:46,478
show you what I mean see where we get

2222
02:10:39,679 --> 02:10:46,479
sampling approaches right so here you go

2223
02:10:47,189 --> 02:10:51,768
[Music]

2224
02:10:48,760 --> 02:10:54,079
so this is what we're talking about

2225
02:10:51,769 --> 02:10:55,248
right here a sampling method for you

2226
02:10:54,078 --> 02:10:57,588
know without having to update everything

2227
02:10:55,248 --> 02:10:59,538
at once and they're the predominantly

2228
02:10:57,588 --> 02:11:02,958
ones that are probably used for obvious

2229
02:10:59,538 --> 02:11:06,078
reasons and what you can sort of see is

2230
02:11:02,958 --> 02:11:08,510
this is exactly what we're doing right

2231
02:11:06,078 --> 02:11:10,219
we have a path tracing program that uses

2232
02:11:08,510 --> 02:11:12,489
the past that it ends up with to

2233
02:11:10,219 --> 02:11:16,338
transfer light between two surfaces and

2234
02:11:12,488 --> 02:11:18,018
there's a shooting based schemes is more

2235
02:11:16,338 --> 02:11:22,309
specifically what we're talking about

2236
02:11:18,019 --> 02:11:24,378
right in the previous loop and a gather

2237
02:11:22,309 --> 02:11:26,389
based scheme is what we have now so like

2238
02:11:24,378 --> 02:11:27,588
a shooting based scheme which that this

2239
02:11:26,389 --> 02:11:30,550
page is not very good because it's

2240
02:11:27,588 --> 02:11:35,260
asking you to look at something else

2241
02:11:30,550 --> 02:11:35,260
there's probably a better page

2242
02:11:36,310 --> 02:11:41,980
if you could look for if you wanted to

2243
02:11:40,399 --> 02:11:45,649
no I don't know if this is good or not

2244
02:11:41,979 --> 02:11:47,750
but like the previous one was a shooting

2245
02:11:45,649 --> 02:11:51,069
based scheme because it basically starts

2246
02:11:47,750 --> 02:11:54,770
at the emitters and looks outward right

2247
02:11:51,069 --> 02:11:56,179
and the new one is more of a gather

2248
02:11:54,770 --> 02:11:58,850
based scheme because it starts at the

2249
02:11:56,180 --> 02:12:00,110
receiver and works outwards but what I

2250
02:11:58,850 --> 02:12:01,550
just realizing is we might as well just

2251
02:12:00,109 --> 02:12:03,889
do it by directional because every one

2252
02:12:01,550 --> 02:12:05,750
in this case is both an emitter and a

2253
02:12:03,890 --> 02:12:12,670
receiver so there's really no reason to

2254
02:12:05,750 --> 02:12:12,670
do them separately like that um so yeah

2255
02:12:15,069 --> 02:12:19,579
so yeah just just to be clear again

2256
02:12:18,350 --> 02:12:21,829
since there was some confusion there

2257
02:12:19,579 --> 02:12:23,149
this is absolutely radiosity there's no

2258
02:12:21,829 --> 02:12:26,859
other description for it you ain't

2259
02:12:23,149 --> 02:12:28,849
photon mapping because photon mapping is

2260
02:12:26,859 --> 02:12:31,819
although they're similar because they're

2261
02:12:28,850 --> 02:12:34,039
both path tracing based right photon

2262
02:12:31,819 --> 02:12:36,079
mapping just basically says I'm gonna

2263
02:12:34,039 --> 02:12:39,050
start at the emitter I'm gonna shoot

2264
02:12:36,079 --> 02:12:40,970
photons from the emitter as particles

2265
02:12:39,050 --> 02:12:42,710
every time they hit a surface I'm gonna

2266
02:12:40,970 --> 02:12:45,230
either decide to keep the particle on

2267
02:12:42,710 --> 02:12:46,550
the surface or resend it and then at the

2268
02:12:45,229 --> 02:12:47,929
end I just take the total number of

2269
02:12:46,550 --> 02:12:50,900
particles on every surface and that's my

2270
02:12:47,930 --> 02:12:53,270
brightness right and that's not what

2271
02:12:50,899 --> 02:12:54,589
we're doing here again the difference

2272
02:12:53,270 --> 02:13:00,040
being radiating photon tracing is

2273
02:12:54,590 --> 02:13:02,810
actually very small but keeping the

2274
02:13:00,039 --> 02:13:04,880
transfer between surfaces and the total

2275
02:13:02,810 --> 02:13:06,590
number of light on the surfaces as

2276
02:13:04,880 --> 02:13:09,050
actual values is what makes something

2277
02:13:06,590 --> 02:13:11,659
more like radiosity whereas just

2278
02:13:09,050 --> 02:13:15,920
treating it as a single set of particle

2279
02:13:11,659 --> 02:13:17,300
shots is what makes it more like photon

2280
02:13:15,920 --> 02:13:18,409
tracing but thinking of them as two

2281
02:13:17,300 --> 02:13:22,119
different techniques is really not

2282
02:13:18,409 --> 02:13:22,119
correct they're very similar

2283
02:13:24,618 --> 02:13:30,109
mm-hmm I thought radiosity approximates

2284
02:13:28,340 --> 02:13:33,439
the light for one area and not tracing

2285
02:13:30,109 --> 02:13:35,569
glorious areas no so radiosity can be

2286
02:13:33,439 --> 02:13:37,999
implemented in multiple ways so there

2287
02:13:35,569 --> 02:13:40,368
are radiosity techniques that just do an

2288
02:13:37,998 --> 02:13:44,748
N squared pass over all the surfaces and

2289
02:13:40,368 --> 02:13:47,448
try to solve in a giant in one giant

2290
02:13:44,748 --> 02:13:50,599
solve try to figure out how the light

2291
02:13:47,448 --> 02:13:52,719
will normalize that is not the common

2292
02:13:50,599 --> 02:13:55,369
way to do it anymore because it's

2293
02:13:52,719 --> 02:13:56,748
intractable in a lot of cases so the

2294
02:13:55,368 --> 02:13:59,598
common way to do it now is iterative

2295
02:13:56,748 --> 02:14:02,148
with sampling based approaches so you

2296
02:13:59,599 --> 02:14:06,409
basically just count that you try to

2297
02:14:02,149 --> 02:14:08,449
structure your solver so that as you

2298
02:14:06,408 --> 02:14:12,948
sample you converge on a valid result

2299
02:14:08,448 --> 02:14:16,128
right in game development it becomes you

2300
02:14:12,948 --> 02:14:18,498
know difficult because you don't have a

2301
02:14:16,128 --> 02:14:20,599
lot of time so you tend to spread it out

2302
02:14:18,498 --> 02:14:30,260
over multiple frames but it's the same

2303
02:14:20,599 --> 02:14:32,899
basic idea Kurush crust says McGuire's

2304
02:14:30,260 --> 02:14:34,248
2016 paper deep g buffer for stable

2305
02:14:32,899 --> 02:14:35,570
global elimination has a very good

2306
02:14:34,248 --> 02:14:37,668
implementation of radiosity and his

2307
02:14:35,569 --> 02:14:39,018
implementation of a deep G buffer is not

2308
02:14:37,668 --> 02:14:40,398
just the def peeling you are using and

2309
02:14:39,019 --> 02:14:45,168
handmade hero oh that sounds pretty good

2310
02:14:40,399 --> 02:14:47,679
I have not seen this paper maybe we

2311
02:14:45,168 --> 02:14:47,679
should look at it

2312
02:15:50,238 --> 02:15:55,569
so it looks like they do that's

2313
02:15:53,060 --> 02:15:55,570
interesting

2314
02:16:04,699 --> 02:16:06,760
you

2315
02:16:07,179 --> 02:16:11,590
I'm not sure we really want to go this

2316
02:16:09,819 --> 02:16:15,058
route because this is entirely screen

2317
02:16:11,590 --> 02:16:15,059
space even though it's depth field

2318
02:16:23,010 --> 02:16:30,420
that might be fine for us though I mean

2319
02:16:25,500 --> 02:16:36,808
it's hard to say I'll have to read it in

2320
02:16:30,420 --> 02:16:39,859
more detail and they do keep it from

2321
02:16:36,808 --> 02:16:39,858
frame to frame just like we are

2322
02:16:51,239 --> 02:16:56,340
are we implementing transparency yes we

2323
02:16:54,209 --> 02:16:59,099
do do transparency to a limited extent

2324
02:16:56,340 --> 02:17:00,479
like you can't stack up an infinite

2325
02:16:59,100 --> 02:17:10,229
number of things you can stack up like

2326
02:17:00,479 --> 02:17:14,069
one or two things right that's already

2327
02:17:10,229 --> 02:17:18,899
happening in fact do we did we turn off

2328
02:17:14,069 --> 02:17:21,440
the particles let me turn back on the

2329
02:17:18,899 --> 02:17:21,440
particles

2330
02:17:41,468 --> 02:17:46,039
so you can see the although these guys

2331
02:17:44,420 --> 02:17:47,988
fall through the floor since they don't

2332
02:17:46,040 --> 02:17:51,069
bounce at the moment but you can see

2333
02:17:47,988 --> 02:17:57,558
that these guys are actually transparent

2334
02:17:51,068 --> 02:17:58,968
right and they fade out I think that's

2335
02:17:57,558 --> 02:18:00,909
the only objects in the world that we

2336
02:17:58,968 --> 02:18:03,348
have that are transparent at the moment

2337
02:18:00,909 --> 02:18:04,579
that's transparent right there obviously

2338
02:18:03,349 --> 02:18:05,988
it gets transparent it's gets close to

2339
02:18:04,579 --> 02:18:07,488
the camera so there's a transparent

2340
02:18:05,988 --> 02:18:19,159
surface as well the depth feeling just

2341
02:18:07,488 --> 02:18:20,929
handles that and you know and if when

2342
02:18:19,159 --> 02:18:23,689
you remove the light of the current

2343
02:18:20,929 --> 02:18:26,148
frame remove see after say five frames

2344
02:18:23,689 --> 02:18:29,359
you have to in some way clear Desa see

2345
02:18:26,148 --> 02:18:30,829
and add only source see and restoreth

2346
02:18:29,359 --> 02:18:32,479
the blend otherwise it will add forever

2347
02:18:30,829 --> 02:18:34,299
very small portions will get added

2348
02:18:32,478 --> 02:18:44,388
constantly did I misunderstand something

2349
02:18:34,299 --> 02:18:45,648
um so in theory anyway the I guess why I

2350
02:18:44,388 --> 02:18:48,500
say is I don't know there may be a bug

2351
02:18:45,648 --> 02:18:49,250
in it so we'll start with that but in

2352
02:18:48,500 --> 02:18:51,590
theory anyway

2353
02:18:49,250 --> 02:18:53,349
the we're adding light to the scene

2354
02:18:51,590 --> 02:18:58,909
every frame because the lights

2355
02:18:53,349 --> 02:19:02,120
themselves are getting added in so it is

2356
02:18:58,909 --> 02:19:04,519
true that we add light and that is

2357
02:19:02,120 --> 02:19:08,059
something we have to account for but we

2358
02:19:04,519 --> 02:19:09,648
also remove light every frame by the

2359
02:19:08,058 --> 02:19:12,199
fact that angular fall-off is not

2360
02:19:09,648 --> 02:19:15,459
accounted for so we are removing about

2361
02:19:12,200 --> 02:19:20,329
twice as much light per frame as we

2362
02:19:15,459 --> 02:19:22,638
we're removing the amount of light

2363
02:19:20,329 --> 02:19:26,679
that's transported per frame is about

2364
02:19:22,638 --> 02:19:29,119
half as much as the amount we take out

2365
02:19:26,679 --> 02:19:30,200
yet that's still not enough to balance

2366
02:19:29,120 --> 02:19:32,029
out the fact that we're adding light

2367
02:19:30,200 --> 02:19:34,219
every frame apparently although we could

2368
02:19:32,029 --> 02:19:37,219
also just have a bug so I really want to

2369
02:19:34,218 --> 02:19:41,089
make sure that we don't have a bug first

2370
02:19:37,218 --> 02:19:44,869
if that makes sense but yeah and the

2371
02:19:41,090 --> 02:19:46,909
other thing I'd like to do is click

2372
02:19:44,870 --> 02:19:48,439
switch to using just one array because I

2373
02:19:46,909 --> 02:19:48,950
feel like that's another source of

2374
02:19:48,439 --> 02:19:51,860
problem

2375
02:19:48,950 --> 02:19:57,130
because basically when we create the new

2376
02:19:51,860 --> 02:19:57,130
array we have sampled from the old array

2377
02:20:00,728 --> 02:20:08,959
so here's this do you want to hear a

2378
02:20:03,409 --> 02:20:10,728
really dumb idea I have a dumb idea just

2379
02:20:08,959 --> 02:20:11,989
just just bear with me for one second I

2380
02:20:10,728 --> 02:20:15,319
was just thinking of a really stupid

2381
02:20:11,989 --> 02:20:17,449
idea that I want to try so one thing we

2382
02:20:15,319 --> 02:20:21,939
could say is what if we just said the

2383
02:20:17,450 --> 02:20:21,939
total amount of light has to be constant

2384
02:20:22,270 --> 02:20:34,579
right what if we just said that so so

2385
02:20:30,290 --> 02:20:37,570
what if we just said okay when we start

2386
02:20:34,579 --> 02:20:42,049
we're just going to assume that we have

2387
02:20:37,569 --> 02:20:43,430
a total light value and every time we

2388
02:20:42,049 --> 02:20:46,759
come through here we're gonna say that

2389
02:20:43,430 --> 02:20:53,120
the total light is gonna be you know

2390
02:20:46,760 --> 02:20:54,889
whatever it's gonna be added right I so

2391
02:20:53,120 --> 02:20:56,240
we just say and in fact you know what

2392
02:20:54,889 --> 02:20:58,939
we'll just do it I don't even do it

2393
02:20:56,239 --> 02:21:01,159
there I'll do it over here do it at the

2394
02:20:58,939 --> 02:21:04,220
end so we're gonna come through here

2395
02:21:01,159 --> 02:21:13,850
we're gonna do our our point index some

2396
02:21:04,219 --> 02:21:19,039
twice total source light total deaths

2397
02:21:13,850 --> 02:21:24,559
light like I just go okay

2398
02:21:19,040 --> 02:21:27,500
i sum up the total source light and the

2399
02:21:24,559 --> 02:21:33,649
total test light and I see how much

2400
02:21:27,500 --> 02:21:38,540
light we have and I just make them they

2401
02:21:33,649 --> 02:21:42,949
have to be the same just throwing it out

2402
02:21:38,540 --> 02:21:46,450
there as a really dumb idea so I say

2403
02:21:42,950 --> 02:21:46,450
okay my source emits E

2404
02:21:48,620 --> 02:22:22,470
and my destiny at sea I've got so uh see

2405
02:22:15,090 --> 02:22:24,600
I'm going with this so I then know the

2406
02:22:22,469 --> 02:22:27,719
ratio of these two things so assuming

2407
02:22:24,600 --> 02:22:29,399
that my source sum is greater than zero

2408
02:22:27,719 --> 02:22:36,929
which it always should be if there's any

2409
02:22:29,398 --> 02:22:39,239
light in the scene at all right the

2410
02:22:36,930 --> 02:22:43,409
other thing too is the moon here is is

2411
02:22:39,239 --> 02:22:45,898
not really getting totally accounted for

2412
02:22:43,409 --> 02:22:51,030
so I mean maybe I say this starts with

2413
02:22:45,898 --> 02:22:53,909
moon color I don't know right

2414
02:22:51,030 --> 02:22:55,050
so you know let's some power times the

2415
02:22:53,909 --> 02:22:58,129
moon color there I don't know this is

2416
02:22:55,049 --> 02:23:00,148
again very very stupid as I said before

2417
02:22:58,129 --> 02:23:03,989
so then when we come through here we

2418
02:23:00,148 --> 02:23:05,639
just say all right look the we're just

2419
02:23:03,989 --> 02:23:10,170
going to go ahead and we don't even care

2420
02:23:05,639 --> 02:23:14,219
about the subtraction part like it

2421
02:23:10,170 --> 02:23:16,290
doesn't matter or something we don't

2422
02:23:14,219 --> 02:23:19,799
care what happens there we do our remove

2423
02:23:16,290 --> 02:23:21,300
C value we don't have to worry about the

2424
02:23:19,799 --> 02:23:23,519
clamping because we don't have that

2425
02:23:21,299 --> 02:23:28,019
removal coefficient here so this doesn't

2426
02:23:23,520 --> 02:23:31,950
happen so all we do here is say look we

2427
02:23:28,020 --> 02:23:34,680
know that we want our sort of our

2428
02:23:31,950 --> 02:23:37,950
normalization ratio right our

2429
02:23:34,680 --> 02:23:44,670
normalization for the color we want the

2430
02:23:37,950 --> 02:23:48,210
desk some two we want the desks we want

2431
02:23:44,670 --> 02:23:49,590
to bring ourselves back up actually so

2432
02:23:48,209 --> 02:23:51,329
how do I want to do that I have the

2433
02:23:49,590 --> 02:23:59,670
total I want it to equal the previous so

2434
02:23:51,329 --> 02:24:01,920
actually this is backwards right so I I

2435
02:23:59,670 --> 02:24:03,238
have a destination I want it to equal my

2436
02:24:01,920 --> 02:24:05,398
source so I'm just gonna literally

2437
02:24:03,238 --> 02:24:08,850
multiply when we come through I'm just

2438
02:24:05,398 --> 02:24:13,978
gonna literally multiply the destined it

2439
02:24:08,850 --> 02:24:15,568
C by the normal coefficient and that's

2440
02:24:13,978 --> 02:24:22,978
just how we're gonna restore our light

2441
02:24:15,568 --> 02:24:24,750
amount period again I have no reason to

2442
02:24:22,978 --> 02:24:27,869
suggest this is a good idea it's

2443
02:24:24,750 --> 02:24:33,540
probably not I'm just gonna do it anyway

2444
02:24:27,870 --> 02:24:36,479
because I can write so this should in

2445
02:24:33,540 --> 02:24:38,370
theory normalize our lights so that we

2446
02:24:36,478 --> 02:24:39,778
can't add light the system of course it

2447
02:24:38,370 --> 02:24:48,680
doesn't seem to be working but it should

2448
02:24:39,779 --> 02:24:48,680
right did I get that right

2449
02:24:57,930 --> 02:25:02,030
I'll leave out the room color for now

2450
02:25:18,158 --> 02:25:26,359
so I feel like that should be keeping

2451
02:25:21,949 --> 02:25:28,399
our light from expanding like it is and

2452
02:25:26,359 --> 02:25:30,460
yet it isn't I mean let me go ahead and

2453
02:25:28,398 --> 02:25:33,528
step through that I'll see what that's

2454
02:25:30,459 --> 02:25:36,379
doing sorry I know we're supposed to be

2455
02:25:33,529 --> 02:25:38,979
done but I just I want to see what

2456
02:25:36,379 --> 02:25:38,978
happens here

2457
02:26:05,680 --> 02:26:20,420
very interesting so we just we do just

2458
02:26:14,449 --> 02:26:22,279
have a bug here and I guess that's the

2459
02:26:20,420 --> 02:26:27,109
amount of light that's being put into

2460
02:26:22,279 --> 02:26:30,979
system so let's take a look at this just

2461
02:26:27,109 --> 02:26:32,359
one other way what if I simply said the

2462
02:26:30,978 --> 02:26:34,929
source zone was fixed to a particular

2463
02:26:32,359 --> 02:26:34,930
value

2464
02:26:44,770 --> 02:26:49,520
so you could only have a certain amount

2465
02:26:47,029 --> 02:26:58,850
of light in the scene okay I'm just

2466
02:26:49,520 --> 02:27:10,220
making this up as I go don't know how

2467
02:26:58,850 --> 02:27:11,899
much light should be in the scene not

2468
02:27:10,219 --> 02:27:14,559
sure why that would have created such an

2469
02:27:11,898 --> 02:27:14,559
odd effect

2470
02:27:31,379 --> 02:27:34,609
unless I'm just too low

2471
02:27:41,819 --> 02:27:49,379
seems about right I don't like how spiky

2472
02:27:46,719 --> 02:27:49,379
these numbers are

2473
02:28:14,161 --> 02:28:19,751
like those are just a really high

2474
02:28:15,970 --> 02:28:27,899
numbers way too high for floating-point

2475
02:28:19,751 --> 02:28:27,899
really to be sadly

2476
02:28:36,350 --> 02:28:40,280
let's get a little more light in there

2477
02:28:52,549 --> 02:28:58,159
it's basically exposure control in a

2478
02:28:55,430 --> 02:28:59,180
sense right we're basically saying like

2479
02:28:58,159 --> 02:29:02,649
okay there's going to be a certain

2480
02:28:59,180 --> 02:29:02,649
amount of exposure control here

2481
02:29:47,990 --> 02:29:52,040
just playing around that moonlight

2482
02:29:57,459 --> 02:30:00,510
it's certainly interesting

2483
02:30:34,959 --> 02:30:39,369
gotta make sure I fix the make the

2484
02:30:37,720 --> 02:30:40,869
lighting volume properly track the

2485
02:30:39,370 --> 02:30:43,540
camera it's currently room based which

2486
02:30:40,870 --> 02:30:46,200
is dumb that's why I get that white

2487
02:30:43,540 --> 02:30:46,200
flicker over there

2488
02:31:20,069 --> 02:31:24,039
it's really weird the way the flickering

2489
02:31:22,601 --> 02:31:25,480
still works I don't know I'm still not

2490
02:31:24,040 --> 02:31:35,710
willing to believe that we don't have

2491
02:31:25,479 --> 02:31:37,841
some issues here I wonder if that's just

2492
02:31:35,709 --> 02:31:40,050
because our light max values are too

2493
02:31:37,841 --> 02:31:40,050
high

2494
02:31:52,929 --> 02:31:58,039
because that again the total amount of

2495
02:31:55,879 --> 02:32:04,669
light remember is supposed to be being

2496
02:31:58,039 --> 02:32:09,199
clamped here right we're forcing it to

2497
02:32:04,668 --> 02:32:13,248
be a particular value and in fact I

2498
02:32:09,199 --> 02:32:37,520
suppose I should be able to actually

2499
02:32:13,248 --> 02:32:38,509
double-check that there's a thing that

2500
02:32:37,520 --> 02:32:45,439
we can use to check the destination

2501
02:32:38,509 --> 02:32:48,100
light as well all right let's play with

2502
02:32:45,439 --> 02:32:48,100
this value again

2503
02:32:59,590 --> 02:33:08,630
it's weird you can actually see that

2504
02:33:03,250 --> 02:33:09,950
exposure control like it's actually sort

2505
02:33:08,629 --> 02:33:14,179
of changing the overall brightness

2506
02:33:09,950 --> 02:33:18,170
that's pretty bizarre let me go and

2507
02:33:14,180 --> 02:33:21,579
change that moonlight back now all the

2508
02:33:18,170 --> 02:33:21,579
lights are max power one

2509
02:33:44,648 --> 02:33:50,539
yeah I don't know I still think we've

2510
02:33:46,879 --> 02:33:51,559
got issues and I'm just not quite sure

2511
02:33:50,540 --> 02:33:54,439
yet

2512
02:33:51,559 --> 02:33:57,728
so we'll see but we got to play around

2513
02:33:54,439 --> 02:33:57,729
with it a little bit I'm gonna I'm gonna

2514
02:33:58,000 --> 02:34:04,780
see what happens if this value is made

2515
02:34:00,549 --> 02:34:04,779
you know something not ten

2516
02:34:23,139 --> 02:34:28,609
and so you can see that like the I guess

2517
02:34:26,780 --> 02:34:31,420
one of the problems is on every frame

2518
02:34:28,610 --> 02:34:34,760
you will concentrate the the light

2519
02:34:31,420 --> 02:34:37,399
concentration at the actual light source

2520
02:34:34,760 --> 02:34:39,979
becomes quite high because not very much

2521
02:34:37,399 --> 02:34:43,699
of it is coming out and so when you sum

2522
02:34:39,979 --> 02:34:45,560
up all of that transmission amount you

2523
02:34:43,700 --> 02:34:51,230
end up counting from mostly the light

2524
02:34:45,560 --> 02:34:56,000
that's in the light source right it's

2525
02:34:51,229 --> 02:35:01,479
interesting so I think yeah I think

2526
02:34:56,000 --> 02:35:01,479
we're like maybe one more sort of

2527
02:35:01,810 --> 02:35:05,600
transformation away from having this

2528
02:35:03,771 --> 02:35:08,530
working in a way that we can use

2529
02:35:05,600 --> 02:35:11,630
reliably I think we just need to go over

2530
02:35:08,530 --> 02:35:16,120
how we want to transfer light between

2531
02:35:11,629 --> 02:35:19,189
the surfaces and get that dialed better

2532
02:35:16,120 --> 02:35:22,850
and again the idea is to slowly diffuse

2533
02:35:19,190 --> 02:35:25,130
the light over time while not adding or

2534
02:35:22,850 --> 02:35:27,319
removing light from the system in a way

2535
02:35:25,129 --> 02:35:30,439
that produces objectionable artifacts

2536
02:35:27,319 --> 02:35:32,329
right and part of the problem there is

2537
02:35:30,440 --> 02:35:34,069
we have the concept of an emitter which

2538
02:35:32,329 --> 02:35:35,930
is something that emits light so we'll

2539
02:35:34,069 --> 02:35:41,659
also need a concept of saying that that

2540
02:35:35,930 --> 02:35:43,610
takes light away right and so I think if

2541
02:35:41,659 --> 02:35:45,139
we just kind of balance those out and by

2542
02:35:43,610 --> 02:35:46,909
doing it by directional which I think

2543
02:35:45,139 --> 02:35:48,649
I'll do tomorrow I think we could do

2544
02:35:46,909 --> 02:35:51,379
that because the sky light would take

2545
02:35:48,649 --> 02:35:54,350
light away and in general that transfer

2546
02:35:51,379 --> 02:35:55,939
takes light away in theory I think we

2547
02:35:54,350 --> 02:35:58,970
can get something that allows slow

2548
02:35:55,940 --> 02:36:02,980
transmission but still actually works

2549
02:35:58,969 --> 02:36:02,979
right so we'll see

2550
02:36:21,920 --> 02:36:25,819
what comes after lighting any ideas

2551
02:36:23,719 --> 02:36:29,929
after lighting we gonna go we're gonna

2552
02:36:25,819 --> 02:36:31,879
go clean up the game code since now we

2553
02:36:29,930 --> 02:36:33,380
kind of know exactly what needs to go on

2554
02:36:31,879 --> 02:36:34,849
in there we're gonna just go to go in

2555
02:36:33,379 --> 02:36:38,299
and make it so that like you know add

2556
02:36:34,850 --> 02:36:42,700
some nice controls and like basically

2557
02:36:38,299 --> 02:36:42,699
allow you to kind of play through a bit

2558
02:36:44,049 --> 02:36:52,129
and sort of in tandem that will we'll

2559
02:36:49,399 --> 02:36:56,719
probably do some will clean up the art

2560
02:36:52,129 --> 02:37:02,899
asset stuff so we can put in some real

2561
02:36:56,719 --> 02:37:11,449
art assets just got a basic start on on

2562
02:37:02,899 --> 02:37:14,149
game stuff game passes the current code

2563
02:37:11,450 --> 02:37:22,900
base is pretty manageable it's not that

2564
02:37:14,149 --> 02:37:24,859
big there's a clock we had a clock

2565
02:37:22,899 --> 02:37:28,039
program but I don't know that it's

2566
02:37:24,860 --> 02:37:34,040
installed on this computer when I change

2567
02:37:28,040 --> 02:37:35,120
computers I can go grab that will you

2568
02:37:34,040 --> 02:37:37,479
that up because I would like to read

2569
02:37:35,120 --> 02:37:37,479
that paper

2570
02:37:39,529 --> 02:37:53,709
I don't know what that means does that

2571
02:37:50,539 --> 02:37:53,709
mean SourceForge is down

2572
02:38:14,770 --> 02:38:17,550
here we go

2573
02:38:28,389 --> 02:38:41,549
uh so I don't know if this is installer

2574
02:38:32,500 --> 02:38:41,549
or not I'm assuming not but it might be

2575
02:38:46,800 --> 02:38:49,800
nope

2576
02:38:53,440 --> 02:39:12,880
so we should be able to do it so there

2577
02:39:04,549 --> 02:39:12,879
you go I think that's accurate probably

2578
02:39:14,709 --> 02:39:17,709
possibly

2579
02:39:23,439 --> 02:39:31,120
John must know if I can work yakety sax

2580
02:39:25,689 --> 02:39:33,370
into the program somehow the question is

2581
02:39:31,120 --> 02:39:37,090
not whether I can work it in but how I

2582
02:39:33,370 --> 02:39:39,850
would avoid the copyright violation and

2583
02:39:37,090 --> 02:39:42,430
imminent lawsuit right because I think

2584
02:39:39,850 --> 02:39:44,140
we all know that handmade hero once it

2585
02:39:42,430 --> 02:39:47,110
is released on Steam will make like

2586
02:39:44,139 --> 02:39:49,629
literally billions and billions of

2587
02:39:47,110 --> 02:39:51,939
dollars right and so the problem that

2588
02:39:49,629 --> 02:39:55,209
you're gonna have there is that then the

2589
02:39:51,939 --> 02:40:00,729
people who make yakety sax are gonna

2590
02:39:55,209 --> 02:40:02,379
come and take all the money right so the

2591
02:40:00,728 --> 02:40:10,510
question is just how do you solve that

2592
02:40:02,379 --> 02:40:12,728
problem so if John you wanted to

2593
02:40:10,510 --> 02:40:14,559
purchase the rights to yakety sax and

2594
02:40:12,728 --> 02:40:18,429
then donate them to the handmade hero

2595
02:40:14,559 --> 02:40:20,199
project I feel like that's totally

2596
02:40:18,430 --> 02:40:24,059
acceptable to me and we would have to

2597
02:40:20,200 --> 02:40:30,810
create them in after you've saved that

2598
02:40:24,059 --> 02:40:34,750
may 31 note like Vanilla Ice did or or

2599
02:40:30,809 --> 02:40:38,648
Ray Parker jr. would be because there

2600
02:40:34,750 --> 02:40:42,579
would be the other one to look at

2601
02:40:38,648 --> 02:40:44,879
I feel like handmade hero could feature

2602
02:40:42,579 --> 02:40:48,360
a suite of Huey Lewis and the news

2603
02:40:44,879 --> 02:40:48,359
modified songs

2604
02:40:54,601 --> 02:41:14,560
right uh all right I'm gonna go ahead

2605
02:41:03,220 --> 02:41:15,729
shut down all right Thank You Vern for

2606
02:41:14,560 --> 02:41:17,050
joining me for an episode of handmade

2607
02:41:15,729 --> 02:41:18,880
hero it's been a pleasure coding with

2608
02:41:17,050 --> 02:41:20,229
you as always if you want to follow

2609
02:41:18,880 --> 02:41:23,140
along with the program

2610
02:41:20,229 --> 02:41:24,761
on the stream you can always figure to

2611
02:41:23,140 --> 02:41:26,319
the game on handy hero or it comes with

2612
02:41:24,761 --> 02:41:29,381
source code so you can could follow

2613
02:41:26,319 --> 02:41:32,020
along at home just like you know picture

2614
02:41:29,380 --> 02:41:35,439
pages if you were a kid and had picture

2615
02:41:32,021 --> 02:41:37,690
pages uh anyway I will be back tomorrow

2616
02:41:35,440 --> 02:41:40,210
when we'll take a look at changing the

2617
02:41:37,690 --> 02:41:42,480
light transfer there because it's mostly

2618
02:41:40,209 --> 02:41:44,680
where I want it to be but we just have

2619
02:41:42,479 --> 02:41:46,930
to get a little bit more rigorous about

2620
02:41:44,681 --> 02:41:49,631
the math of the lighting transfer before

2621
02:41:46,931 --> 02:41:51,790
we can actually use it as something

2622
02:41:49,630 --> 02:41:55,171
that's that's you know valuable and

2623
02:41:51,790 --> 02:41:58,181
useful and contributory to the game

2624
02:41:55,171 --> 02:41:59,950
that's about it I will be back here

2625
02:41:58,181 --> 02:42:01,870
tomorrow so up to join you hope you will

2626
02:41:59,950 --> 02:42:03,551
join me for that until then have fun

2627
02:42:01,870 --> 02:42:04,360
programming everyone and I'll see you on

2628
02:42:03,550 --> 02:42:06,930
the Internet

2629
02:42:04,360 --> 02:42:06,931
take it easy everybody

