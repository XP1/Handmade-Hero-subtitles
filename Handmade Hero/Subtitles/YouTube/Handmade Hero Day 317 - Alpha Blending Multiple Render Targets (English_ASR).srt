1
00:00:02,569 --> 00:00:06,209
okay hello everyone and welcome to

2
00:00:05,099 --> 00:00:08,759
handmade hero the show we could a

3
00:00:06,209 --> 00:00:12,750
complete game live on stream we did some

4
00:00:08,759 --> 00:00:14,339
work yesterday evening to add multiple

5
00:00:12,750 --> 00:00:18,300
render targets to our software renderer

6
00:00:14,339 --> 00:00:20,368
but although we actually succeeded in

7
00:00:18,300 --> 00:00:23,100
doing that pretty quickly was not

8
00:00:20,368 --> 00:00:26,879
difficult uh we actually have not

9
00:00:23,100 --> 00:00:28,320
written the code to use any of those

10
00:00:26,879 --> 00:00:30,268
multiple round target so although our

11
00:00:28,320 --> 00:00:34,020
back and render now renders to multiple

12
00:00:30,268 --> 00:00:35,879
render targets just fine you can't do

13
00:00:34,020 --> 00:00:39,000
anything with them and well let's be

14
00:00:35,880 --> 00:00:40,920
honest how interesting is it really to

15
00:00:39,000 --> 00:00:45,359
have multiple render targets you can't

16
00:00:40,920 --> 00:00:50,039
do anything with not that interesting i

17
00:00:45,359 --> 00:00:53,399
would argue uh so let's see if we can do

18
00:00:50,039 --> 00:00:56,370
something this time with our render

19
00:00:53,399 --> 00:00:57,689
targets so here we are on day 3 17 if

20
00:00:56,369 --> 00:00:59,788
you are following along at home you're

21
00:00:57,689 --> 00:01:01,229
going to want to open up day 316 source

22
00:00:59,789 --> 00:01:03,960
code because that is source code that i

23
00:01:01,229 --> 00:01:06,658
am starting with right now and i will go

24
00:01:03,960 --> 00:01:08,250
ahead and load up for you and I am

25
00:01:06,659 --> 00:01:09,689
loading this for you everyone out there

26
00:01:08,250 --> 00:01:12,209
I just want you know I am loading this

27
00:01:09,688 --> 00:01:14,639
for you our very own handmade hero

28
00:01:12,209 --> 00:01:16,259
source code and we are going to run it

29
00:01:14,640 --> 00:01:18,960
and i'm going to show you what i mean

30
00:01:16,259 --> 00:01:22,950
when i say that we're not using any

31
00:01:18,959 --> 00:01:25,169
render target stuff so we did some weird

32
00:01:22,950 --> 00:01:26,490
stuff where we shrunk down yet we got a

33
00:01:25,170 --> 00:01:28,409
lot of stuff that we did that was weird

34
00:01:26,489 --> 00:01:29,699
so we have a kind of weird screen going

35
00:01:28,409 --> 00:01:31,228
on right now but it is actually all

36
00:01:29,700 --> 00:01:34,469
correct this is what we meant to draw

37
00:01:31,228 --> 00:01:36,629
for reasons you will know if you watch

38
00:01:34,469 --> 00:01:38,099
previous episodes and we're running

39
00:01:36,629 --> 00:01:39,359
through the software renderer right now

40
00:01:38,099 --> 00:01:43,349
and we're running through the software

41
00:01:39,359 --> 00:01:44,938
renderer in debug mode and we're still

42
00:01:43,349 --> 00:01:46,500
getting close to 30 frames a second so

43
00:01:44,938 --> 00:01:48,719
you gotta love computers because it's in

44
00:01:46,500 --> 00:01:50,219
debug mode so it's much slower than it

45
00:01:48,719 --> 00:01:52,769
normally would be but it's still it's

46
00:01:50,219 --> 00:01:54,688
still hanging in there good for it so

47
00:01:52,769 --> 00:01:57,539
anyway what we have to do now is we have

48
00:01:54,688 --> 00:02:01,048
to figure out how we are going to get

49
00:01:57,540 --> 00:02:03,329
this second render target in play and so

50
00:02:01,049 --> 00:02:05,790
what I want to do is I want to go ahead

51
00:02:03,328 --> 00:02:08,250
and move up here so now you can see I'm

52
00:02:05,790 --> 00:02:09,689
standing in between two layers and we

53
00:02:08,250 --> 00:02:11,400
intentionally made these little slat so

54
00:02:09,689 --> 00:02:13,590
you could see a little easier you can

55
00:02:11,400 --> 00:02:15,599
see these little green slats that have

56
00:02:13,590 --> 00:02:17,159
the layer above us and they're kind of

57
00:02:15,598 --> 00:02:18,659
coming in they're getting outfit in and

58
00:02:17,159 --> 00:02:20,609
then you know as I come up they kind of

59
00:02:18,659 --> 00:02:22,680
alpha in more and I can go back down

60
00:02:20,610 --> 00:02:25,140
right and I can and I can sort of

61
00:02:22,680 --> 00:02:26,489
control how alpha they are by how far up

62
00:02:25,139 --> 00:02:30,208
or down this like sort of weird

63
00:02:26,489 --> 00:02:32,430
stairwell thing I've made is so what I

64
00:02:30,209 --> 00:02:34,709
want to do now is I want to move all of

65
00:02:32,430 --> 00:02:39,540
the things that are on that layer into a

66
00:02:34,709 --> 00:02:41,819
separate render target for starters and

67
00:02:39,539 --> 00:02:44,848
then what it's going to do because we

68
00:02:41,818 --> 00:02:46,379
don't do anything with it is those

69
00:02:44,848 --> 00:02:48,629
things should disappear so is going to

70
00:02:46,379 --> 00:02:50,250
hold the game here right and I'm just

71
00:02:48,629 --> 00:02:52,109
going to use live code editing to just

72
00:02:50,250 --> 00:02:54,419
go edit the code while the game is is in

73
00:02:52,110 --> 00:02:56,849
that state and those things are going to

74
00:02:54,419 --> 00:03:00,780
disappear in theory so let's go ahead

75
00:02:56,848 --> 00:03:02,969
and jump over to entity dot CPP we know

76
00:03:00,780 --> 00:03:06,449
from the way that we've set things up

77
00:03:02,969 --> 00:03:09,329
here we set up our level indices we know

78
00:03:06,449 --> 00:03:11,818
that basically our last level index our

79
00:03:09,329 --> 00:03:14,280
maximum level index here is the one

80
00:03:11,818 --> 00:03:16,919
that's going to be fogged out and in

81
00:03:14,280 --> 00:03:18,810
fact not only do we know that but I

82
00:03:16,919 --> 00:03:22,530
believe we're sort of already using that

83
00:03:18,810 --> 00:03:29,459
piece of information I think oops not

84
00:03:22,530 --> 00:03:32,609
fog I meant alpha my bad test alpha so

85
00:03:29,459 --> 00:03:34,979
there we go so you can see us using the

86
00:03:32,609 --> 00:03:37,319
test alpha here of the layer index that

87
00:03:34,979 --> 00:03:39,719
we're on we're doing that only when were

88
00:03:37,318 --> 00:03:42,449
on the maximum level index so what I can

89
00:03:39,719 --> 00:03:45,568
do in this circumstance if I want to is

90
00:03:42,449 --> 00:03:49,138
I can use the render target system that

91
00:03:45,568 --> 00:03:52,289
we have set up to switch which of the

92
00:03:49,139 --> 00:03:54,120
clipping rectangles I'm using so what I

93
00:03:52,289 --> 00:03:57,358
can do here is I can say well if I'm at

94
00:03:54,120 --> 00:04:00,689
the Maxwell maximum level index set the

95
00:03:57,359 --> 00:04:05,250
render groups current clip clip wreck

96
00:04:00,689 --> 00:04:08,818
things x to be the whichever one we're

97
00:04:05,250 --> 00:04:12,379
using for the for that top level right

98
00:04:08,818 --> 00:04:12,379
so we'll do like alpha

99
00:04:12,789 --> 00:04:21,019
clip rekt like that and then otherwise

100
00:04:17,930 --> 00:04:24,639
in any other case we'll just set the

101
00:04:21,019 --> 00:04:28,850
current clip rekt index to you know

102
00:04:24,639 --> 00:04:32,509
other you know normal floor clip rekt

103
00:04:28,850 --> 00:04:33,650
right so we basically have two different

104
00:04:32,509 --> 00:04:35,839
clip brecks that will create at the

105
00:04:33,649 --> 00:04:37,849
beginning one for the current floor I'm

106
00:04:35,839 --> 00:04:40,099
sorry 14 floors to get alpha doubt and

107
00:04:37,850 --> 00:04:41,450
one for the normal floor right and the

108
00:04:40,100 --> 00:04:42,910
normal floor can just use the standard

109
00:04:41,449 --> 00:04:45,829
clip wreck that we're currently using

110
00:04:42,910 --> 00:04:48,350
and so at the end of all this too we

111
00:04:45,829 --> 00:04:50,240
could set the clip wrecked here at the

112
00:04:48,350 --> 00:04:52,280
end when we exit because we're kind of

113
00:04:50,240 --> 00:04:53,449
doing a little thing where we where we

114
00:04:52,279 --> 00:04:55,239
oh well it looks like we're already

115
00:04:53,449 --> 00:04:57,769
storing it anyway so that's totally fine

116
00:04:55,240 --> 00:04:59,090
so what I want to do here is say okay I

117
00:04:57,769 --> 00:05:00,859
know I've got to have two different clip

118
00:04:59,089 --> 00:05:02,929
rectangle X so I'm going to have my

119
00:05:00,860 --> 00:05:04,220
normal for clip wrecked index and that's

120
00:05:02,930 --> 00:05:05,750
just going to be because we don't

121
00:05:04,220 --> 00:05:07,940
actually need a new one we can just use

122
00:05:05,750 --> 00:05:09,740
the standard one that everyone else uses

123
00:05:07,939 --> 00:05:12,529
we can just say whatever the render

124
00:05:09,740 --> 00:05:14,569
groups current clip direct index is is

125
00:05:12,529 --> 00:05:16,579
fine with us but then we need an

126
00:05:14,569 --> 00:05:18,110
additional clip rekt index and we need

127
00:05:16,579 --> 00:05:23,779
that for the alpha floor clip wrecked

128
00:05:18,110 --> 00:05:26,240
and i don't really actually know how to

129
00:05:23,779 --> 00:05:28,239
make one of those because i forgot i

130
00:05:26,240 --> 00:05:32,090
know we've gotta push clip wrecked here

131
00:05:28,240 --> 00:05:34,850
and let's see so here's my push correct

132
00:05:32,089 --> 00:05:36,889
call i'm going to call that I'm going to

133
00:05:34,850 --> 00:05:38,600
use render target one since that's the

134
00:05:36,889 --> 00:05:40,969
you know we don't really have any other

135
00:05:38,600 --> 00:05:44,689
need for render targets at the moment so

136
00:05:40,970 --> 00:05:47,000
I've got my render group and I I want to

137
00:05:44,689 --> 00:05:49,160
draw out of the whole region I don't

138
00:05:47,000 --> 00:05:50,600
actually remember if there's anything in

139
00:05:49,160 --> 00:05:52,580
particular I guess it's just draw buffer

140
00:05:50,600 --> 00:05:54,080
width and draw before height so I guess

141
00:05:52,579 --> 00:05:57,469
we can just do drop off or withdraw

142
00:05:54,079 --> 00:06:00,250
before height and now I guess in theory

143
00:05:57,470 --> 00:06:03,650
I have pushed the clip prepped there

144
00:06:00,250 --> 00:06:06,439
these are supposed to be era science I

145
00:06:03,649 --> 00:06:10,759
admit that so let me fix that for you

146
00:06:06,439 --> 00:06:12,529
there we go and so now in theory yet you

147
00:06:10,759 --> 00:06:14,599
can see as I pop back here the alpha

148
00:06:12,529 --> 00:06:17,329
stuff is gone and so let me just

149
00:06:14,600 --> 00:06:18,500
underscore that point to you so that you

150
00:06:17,329 --> 00:06:20,839
can see what I'm talking about here

151
00:06:18,500 --> 00:06:24,319
again I'll just lean on sort of our live

152
00:06:20,839 --> 00:06:25,248
code edit stuff that we built to just

153
00:06:24,319 --> 00:06:28,699
make sure that I can

154
00:06:25,249 --> 00:06:31,278
and show you exactly what's going on and

155
00:06:28,699 --> 00:06:35,119
in fact I should probably do it in this

156
00:06:31,278 --> 00:06:37,098
window huh alright so normal flora pract

157
00:06:35,119 --> 00:06:38,509
is just using the regular pip rec alpha

158
00:06:37,098 --> 00:06:39,678
floor clip wrecked which is the stuff

159
00:06:38,509 --> 00:06:42,439
that's getting outfit out right that's

160
00:06:39,678 --> 00:06:44,748
using this other render target so if I

161
00:06:42,439 --> 00:06:46,399
set that regular target 20 now it's

162
00:06:44,749 --> 00:06:49,639
rendering to the main render target you

163
00:06:46,399 --> 00:06:51,139
can see it right if I set it to one now

164
00:06:49,639 --> 00:06:53,569
it's rendering to a different render

165
00:06:51,139 --> 00:06:55,639
target you can't see it so what we need

166
00:06:53,569 --> 00:07:02,619
to do now to finish what we were trying

167
00:06:55,639 --> 00:07:06,319
to accomplish is we need some way of

168
00:07:02,619 --> 00:07:09,259
specifying what should happen to that

169
00:07:06,319 --> 00:07:11,860
second render target when we go to

170
00:07:09,259 --> 00:07:15,079
resolve all of the stuff that we have

171
00:07:11,860 --> 00:07:18,699
now there's a lot of things we could do

172
00:07:15,079 --> 00:07:21,588
here and which ones we do depend

173
00:07:18,699 --> 00:07:24,859
entirely on what we are trying to

174
00:07:21,588 --> 00:07:26,809
accomplish with our graphics engine now

175
00:07:24,858 --> 00:07:29,209
I'm just going to do the most simple

176
00:07:26,809 --> 00:07:32,029
basic thing that we might possibly want

177
00:07:29,209 --> 00:07:33,889
to do i'm just going to write it so that

178
00:07:32,028 --> 00:07:37,308
all we really have in there is a

179
00:07:33,889 --> 00:07:39,739
hard-coded thing which says hey I'll you

180
00:07:37,309 --> 00:07:43,069
know you can push a thing on which says

181
00:07:39,738 --> 00:07:44,748
when you get here blit you know to

182
00:07:43,069 --> 00:07:46,218
render target on top of the other random

183
00:07:44,749 --> 00:07:48,019
target with an alpha value or something

184
00:07:46,218 --> 00:07:51,288
right so I'm just going to make exactly

185
00:07:48,019 --> 00:07:53,629
the one thing that we need but I would

186
00:07:51,288 --> 00:07:55,788
point out here that you know i'm i'm

187
00:07:53,629 --> 00:07:59,239
showing sort of this process in the

188
00:07:55,788 --> 00:08:01,278
general case more to just give you the

189
00:07:59,238 --> 00:08:03,618
awareness that you can have multiple

190
00:08:01,278 --> 00:08:05,649
render targets and so you might decide

191
00:08:03,619 --> 00:08:09,409
to do something more fancy if your game

192
00:08:05,649 --> 00:08:11,718
could make more use of render targets

193
00:08:09,408 --> 00:08:13,519
and doing things with render targets so

194
00:08:11,718 --> 00:08:15,618
for example one of the things that we

195
00:08:13,519 --> 00:08:17,869
would probably do if we were going to do

196
00:08:15,619 --> 00:08:20,239
a bunch of fancier stuff with render

197
00:08:17,869 --> 00:08:22,999
targets is we would want to go make it

198
00:08:20,238 --> 00:08:25,758
so that was very easy for us to use

199
00:08:22,999 --> 00:08:28,399
something that we rendered as a regular

200
00:08:25,759 --> 00:08:29,809
sprite right that would just be

201
00:08:28,399 --> 00:08:32,599
something we would do as a matter of

202
00:08:29,809 --> 00:08:36,229
course I probably won't bother doing

203
00:08:32,599 --> 00:08:37,579
that like I don't think I'm going to

204
00:08:36,229 --> 00:08:38,930
bother with that because I don't think

205
00:08:37,578 --> 00:08:40,579
we need it for anything

206
00:08:38,929 --> 00:08:41,929
but you can see why that would be

207
00:08:40,580 --> 00:08:43,370
powerful because what you'd want to be

208
00:08:41,929 --> 00:08:45,169
able to do is say like oh render a bunch

209
00:08:43,370 --> 00:08:46,339
of stuff to this render target and then

210
00:08:45,169 --> 00:08:47,809
use that render target as a sprite

211
00:08:46,339 --> 00:08:49,310
somewhere else which could even then

212
00:08:47,809 --> 00:08:50,509
make another render target so you can

213
00:08:49,309 --> 00:08:52,879
understand why you would want to make

214
00:08:50,509 --> 00:08:54,830
that system more general if you had some

215
00:08:52,879 --> 00:08:56,929
things in mind that maybe could leverage

216
00:08:54,830 --> 00:08:59,810
that like if the look of your game could

217
00:08:56,929 --> 00:09:01,549
benefit from some of those things so I'm

218
00:08:59,809 --> 00:09:03,979
just going to show one simple case but

219
00:09:01,549 --> 00:09:05,539
keep in mind that you know render

220
00:09:03,980 --> 00:09:07,159
targets are very powerful tool and if

221
00:09:05,539 --> 00:09:08,870
you go ahead and pipe them through and

222
00:09:07,159 --> 00:09:10,278
do some more architecture work to make

223
00:09:08,870 --> 00:09:13,459
it so that render targets and textures

224
00:09:10,278 --> 00:09:15,350
can be used interchangeably that gives

225
00:09:13,458 --> 00:09:17,449
you some additional power that I don't

226
00:09:15,350 --> 00:09:22,600
anticipate taking any advantage of but

227
00:09:17,450 --> 00:09:22,600
you might write so so keep that in mind

228
00:09:25,330 --> 00:09:32,149
okay so let's see what we need to do

229
00:09:29,600 --> 00:09:33,379
here here's our situation I'm going to

230
00:09:32,149 --> 00:09:34,669
close this now because we don't need

231
00:09:33,379 --> 00:09:36,559
that up and I'm probably gonna have to

232
00:09:34,669 --> 00:09:39,169
reload the render which is in the

233
00:09:36,559 --> 00:09:42,889
separate piece of code there so if I go

234
00:09:39,169 --> 00:09:45,708
over to render dot cpp and I take a look

235
00:09:42,889 --> 00:09:47,360
at what happens here with with all of

236
00:09:45,708 --> 00:09:50,629
our rendering you know you can kind of

237
00:09:47,360 --> 00:09:52,459
see we have these render targets here

238
00:09:50,629 --> 00:09:55,189
and we're passing those render target

239
00:09:52,458 --> 00:09:57,619
arrays to our renderer and when we go

240
00:09:55,190 --> 00:09:59,810
through our sort entry indices like so

241
00:09:57,620 --> 00:10:01,310
we pull out all of these different

242
00:09:59,809 --> 00:10:05,509
things that we think need to happen

243
00:10:01,309 --> 00:10:08,329
right and what I'm thinking is we could

244
00:10:05,509 --> 00:10:10,250
just make one here that's sort of like

245
00:10:08,330 --> 00:10:16,670
another case which is like render

246
00:10:10,250 --> 00:10:19,940
grouped entry type you know render or it

247
00:10:16,669 --> 00:10:23,000
resolved render target something like

248
00:10:19,940 --> 00:10:27,350
that for you know blend render targets

249
00:10:23,000 --> 00:10:29,929
I'm not sure something like this I guess

250
00:10:27,350 --> 00:10:32,990
what do I want to say uh maybe i'll call

251
00:10:29,929 --> 00:10:36,500
it apply render target or or now it's la

252
00:10:32,990 --> 00:10:38,450
blend render target and all I'll guess

253
00:10:36,500 --> 00:10:40,820
I'll do here is make it so that you can

254
00:10:38,450 --> 00:10:42,920
say a destination render target and a

255
00:10:40,820 --> 00:10:45,110
source render target and just smush them

256
00:10:42,919 --> 00:10:46,789
together with an alpha value on top of

257
00:10:45,110 --> 00:10:52,550
one of the existing ones that's there

258
00:10:46,789 --> 00:10:54,889
right so that's all I want to do

259
00:10:52,549 --> 00:10:57,439
and so I'm going to call a function here

260
00:10:54,889 --> 00:11:01,278
that's called like blend render target

261
00:10:57,440 --> 00:11:03,080
or something like that and you know it's

262
00:11:01,278 --> 00:11:05,600
basically going to be instead of using

263
00:11:03,080 --> 00:11:07,519
output target here although I guess I

264
00:11:05,600 --> 00:11:09,230
could just use output target I suppose

265
00:11:07,519 --> 00:11:12,649
that that's actually something I could

266
00:11:09,230 --> 00:11:15,470
just do where yah where I guess I have

267
00:11:12,649 --> 00:11:18,708
like the clip wrecked so how do I pass

268
00:11:15,470 --> 00:11:20,959
how do I currently pass clip Breck's to

269
00:11:18,708 --> 00:11:27,349
these things anyway do i what do i do

270
00:11:20,958 --> 00:11:29,509
there I'm not actually sure surely

271
00:11:27,350 --> 00:11:35,480
somewhere we do some kind of clipping i

272
00:11:29,509 --> 00:11:40,578
would think I mean we have to so here's

273
00:11:35,480 --> 00:11:41,930
where we do our clip rekt right so we

274
00:11:40,578 --> 00:11:44,989
know what the clip Brecht is so I'm

275
00:11:41,929 --> 00:11:47,778
going to go ahead and pass that down so

276
00:11:44,990 --> 00:11:51,139
i'm going to pass clip wrecked and i'm

277
00:11:47,778 --> 00:11:53,149
going to pass two things i'm going to

278
00:11:51,139 --> 00:11:57,169
pass the output target and then i'm also

279
00:11:53,149 --> 00:11:59,629
going to pass like a the you know source

280
00:11:57,169 --> 00:12:02,088
target or something like that and i

281
00:11:59,629 --> 00:12:05,870
don't know i guess we'll just take a

282
00:12:02,089 --> 00:12:08,300
full color as well probably I feel like

283
00:12:05,870 --> 00:12:12,078
so I feel like we would take like a you

284
00:12:08,299 --> 00:12:14,028
know a color to apply to modulate

285
00:12:12,078 --> 00:12:15,649
against like the target or something

286
00:12:14,028 --> 00:12:16,850
like that I'm not sure exactly how we're

287
00:12:15,649 --> 00:12:21,589
going to want to do this but i think we

288
00:12:16,850 --> 00:12:24,379
probably want a color you know i'm

289
00:12:21,589 --> 00:12:26,149
saying we could do something like one

290
00:12:24,379 --> 00:12:28,009
color that multiplies the output target

291
00:12:26,149 --> 00:12:32,120
and one color that multiplies the source

292
00:12:28,009 --> 00:12:34,328
target as well so you know i could do

293
00:12:32,120 --> 00:12:34,328
like

294
00:12:43,149 --> 00:12:49,188
something like this so it's like do this

295
00:12:46,698 --> 00:12:51,078
rectangle this color times this target

296
00:12:49,188 --> 00:12:53,870
Plus this color times this target

297
00:12:51,078 --> 00:12:56,748
written to the second second target like

298
00:12:53,870 --> 00:12:58,759
overwrite this one that seems like a

299
00:12:56,749 --> 00:13:01,399
pretty generic operation that we could

300
00:12:58,759 --> 00:13:04,220
do and so that's what we need to write

301
00:13:01,399 --> 00:13:06,139
our software renderer to do so if we

302
00:13:04,220 --> 00:13:07,730
were going to get that out right it sort

303
00:13:06,139 --> 00:13:09,198
of now implies exactly what the

304
00:13:07,730 --> 00:13:12,259
information is that we would need to

305
00:13:09,198 --> 00:13:22,729
have coming down here we basically have

306
00:13:12,259 --> 00:13:24,438
a blend render target entry and that

307
00:13:22,730 --> 00:13:26,300
blend render target entry just has to

308
00:13:24,438 --> 00:13:28,698
have these things in it right it has to

309
00:13:26,299 --> 00:13:30,349
have the source color it needs to have

310
00:13:28,698 --> 00:13:33,979
the source target but it's going to be a

311
00:13:30,350 --> 00:13:37,100
source target index right so really we

312
00:13:33,980 --> 00:13:40,938
probably want to do loaded bitmap source

313
00:13:37,100 --> 00:13:43,430
target equals render targets and then

314
00:13:40,938 --> 00:13:46,129
it's like entries source target index or

315
00:13:43,429 --> 00:13:47,719
something like that right and then here

316
00:13:46,129 --> 00:13:50,899
we know the output target that's just

317
00:13:47,720 --> 00:13:52,819
whatever you're currently drawing too so

318
00:13:50,899 --> 00:13:57,409
all we would do is grab the desk color

319
00:13:52,818 --> 00:14:05,889
out of there right so I think that's it

320
00:13:57,409 --> 00:14:08,448
I that seems reasonable I guess to me

321
00:14:05,889 --> 00:14:10,250
yeah and I don't know how we want to do

322
00:14:08,448 --> 00:14:13,039
those colors I don't know if we want to

323
00:14:10,250 --> 00:14:16,879
pass those colors in RGB or linear srgb

324
00:14:13,039 --> 00:14:18,469
Atlantis I feel like I feel like we're

325
00:14:16,879 --> 00:14:20,149
just going to call this guest modulate

326
00:14:18,470 --> 00:14:21,620
and source module eight so it's clear

327
00:14:20,149 --> 00:14:23,058
what it is that they're just multipliers

328
00:14:21,620 --> 00:14:24,850
that they're not going to be adjusted

329
00:14:23,058 --> 00:14:28,338
for srgb or anything else like that

330
00:14:24,850 --> 00:14:29,928
they're just going to be straightforward

331
00:14:28,339 --> 00:14:31,910
I think that's what we probably want to

332
00:14:29,928 --> 00:14:33,769
do don't quote me on that we'll see when

333
00:14:31,909 --> 00:14:35,600
we get in there and maybe we'll change

334
00:14:33,769 --> 00:14:42,350
it around I'm not entirely certain

335
00:14:35,600 --> 00:14:48,800
anyway internal void so we've got a

336
00:14:42,350 --> 00:14:50,450
rectangle to I we've got a color and we

337
00:14:48,799 --> 00:14:57,099
have a source target

338
00:14:50,450 --> 00:15:07,280
and a output target and then we've got a

339
00:14:57,100 --> 00:15:10,879
destination so something like that and I

340
00:15:07,279 --> 00:15:13,220
feel like you know we can probably just

341
00:15:10,879 --> 00:15:18,049
use essentially the same code that we

342
00:15:13,220 --> 00:15:21,519
were using for our for our rectangle

343
00:15:18,049 --> 00:15:25,159
fill which I don't really remember

344
00:15:21,519 --> 00:15:28,250
whether we actually did an optimized

345
00:15:25,159 --> 00:15:31,250
version but I think we did an optimized

346
00:15:28,250 --> 00:15:33,309
version of the rectangle fill so here it

347
00:15:31,250 --> 00:15:36,799
is right here is I've draw a rectangle

348
00:15:33,309 --> 00:15:40,489
so I believe if I come down here I

349
00:15:36,799 --> 00:15:44,479
should be able to just sort of snoop why

350
00:15:40,490 --> 00:15:46,490
do we haven't why why do we have an if

351
00:15:44,480 --> 00:15:49,610
okay it's it's a it's like here's the

352
00:15:46,490 --> 00:15:51,169
old version kind of thing all right so

353
00:15:49,610 --> 00:15:58,029
I'm going to go ahead and grab this and

354
00:15:51,169 --> 00:15:58,029
I'm going to put this down here like so

355
00:15:58,059 --> 00:16:01,819
so there's our blend render target and

356
00:16:00,529 --> 00:16:03,230
what I'm going to do is I'm going to

357
00:16:01,820 --> 00:16:07,450
start I guess I'll start with just

358
00:16:03,230 --> 00:16:12,500
exactly the way we're doing it before

359
00:16:07,450 --> 00:16:14,540
where we've got a a reference version

360
00:16:12,500 --> 00:16:17,480
that I'll run first and make sure that

361
00:16:14,539 --> 00:16:23,919
that works at all and then we'll go from

362
00:16:17,480 --> 00:16:27,050
there right so okay so I believe that

363
00:16:23,919 --> 00:16:28,309
this is just our and I can tell that

364
00:16:27,049 --> 00:16:31,719
wrecked it's not really a clip wrecked

365
00:16:28,309 --> 00:16:35,179
at this point so I should be able to do

366
00:16:31,720 --> 00:16:39,410
this exact same thing here where I can

367
00:16:35,179 --> 00:16:40,789
just call well I don't even need to call

368
00:16:39,409 --> 00:16:43,610
anything because we've or it's already a

369
00:16:40,789 --> 00:16:46,189
rectangle to I so we can go ahead and

370
00:16:43,610 --> 00:16:48,610
get rid of all of this we don't need any

371
00:16:46,190 --> 00:16:50,870
of this color stuff yet at the moment

372
00:16:48,610 --> 00:16:53,899
and so really all we're going to do is

373
00:16:50,870 --> 00:16:57,830
do this exact same loop here through all

374
00:16:53,899 --> 00:16:58,879
of the code let me go ahead and place

375
00:16:57,830 --> 00:17:02,739
those I don't know why they look like

376
00:16:58,879 --> 00:17:06,788
that so

377
00:17:02,739 --> 00:17:10,129
what I need to do now is I need to do

378
00:17:06,788 --> 00:17:12,349
this operation this was a previously a

379
00:17:10,128 --> 00:17:14,568
rectangle fill right so we started found

380
00:17:12,349 --> 00:17:16,099
the road we were starting on well it's

381
00:17:14,568 --> 00:17:18,168
actually the row and picks it like that

382
00:17:16,099 --> 00:17:19,548
row and column we're starting on we

383
00:17:18,169 --> 00:17:21,500
would increment it by the pitch every

384
00:17:19,548 --> 00:17:24,558
time and then we just go through and

385
00:17:21,500 --> 00:17:27,349
romp in the colors right but that's not

386
00:17:24,558 --> 00:17:29,808
what we want to do this time around this

387
00:17:27,349 --> 00:17:32,599
time around we need to do an actual

388
00:17:29,808 --> 00:17:34,668
operation to create whatever the pixels

389
00:17:32,599 --> 00:17:39,109
going to be so we need to do like an

390
00:17:34,669 --> 00:17:43,850
unpack and then a pack of the colors and

391
00:17:39,109 --> 00:17:46,278
and all that good stuff right so yeah so

392
00:17:43,849 --> 00:17:47,719
we need to we need to do some work here

393
00:17:46,278 --> 00:17:51,200
we need to do some alpha blending work

394
00:17:47,720 --> 00:17:54,100
here and we need to do essentially the

395
00:17:51,200 --> 00:17:56,419
following equation so we've got our

396
00:17:54,099 --> 00:17:58,219
source color is going to have to be

397
00:17:56,419 --> 00:17:59,899
something and our desk lar something's

398
00:17:58,220 --> 00:18:03,019
going to be something we have to load

399
00:17:59,898 --> 00:18:06,109
both of these right then we're going to

400
00:18:03,019 --> 00:18:08,419
have to make our results our result has

401
00:18:06,109 --> 00:18:11,178
to be you know our source color plus our

402
00:18:08,419 --> 00:18:14,389
desk color and we have to sort of make

403
00:18:11,179 --> 00:18:16,370
that operation work with an alpha value

404
00:18:14,388 --> 00:18:18,349
the Alpha value in this case is going to

405
00:18:16,369 --> 00:18:19,489
come from the source the source the

406
00:18:18,349 --> 00:18:21,558
sources alpha is what's going to

407
00:18:19,490 --> 00:18:24,919
determine it so we're basically going to

408
00:18:21,558 --> 00:18:27,888
have you know a alpha value that comes

409
00:18:24,919 --> 00:18:29,690
from the source colors alpha so we're

410
00:18:27,888 --> 00:18:31,128
going to do one minus the Alpha this is

411
00:18:29,690 --> 00:18:33,649
a standard the standard linear blend

412
00:18:31,128 --> 00:18:36,408
we've used over and over again so we're

413
00:18:33,648 --> 00:18:39,648
going to do one minus the alpha plus the

414
00:18:36,409 --> 00:18:43,070
Alpha time suggests color to do our

415
00:18:39,648 --> 00:18:45,258
blind right and now that's non

416
00:18:43,069 --> 00:18:47,388
premultiplied alpha but of course it

417
00:18:45,259 --> 00:18:49,669
should in theory be okay because we're

418
00:18:47,388 --> 00:18:51,378
just doing pics of the pixel so we're

419
00:18:49,669 --> 00:18:53,750
not doing any other operations so in

420
00:18:51,378 --> 00:18:55,519
theory that should work and not create

421
00:18:53,750 --> 00:18:57,230
any artifacts for us and it would be a

422
00:18:55,519 --> 00:18:59,960
lot harder for us not to do it that way

423
00:18:57,230 --> 00:19:04,099
because we would need to pre multiply

424
00:18:59,960 --> 00:19:05,750
all of our colors by their alpha values

425
00:19:04,099 --> 00:19:09,709
which I don't think we're currently

426
00:19:05,750 --> 00:19:12,259
doing right like when we write into

427
00:19:09,710 --> 00:19:15,909
those buffers I have to thank are we

428
00:19:12,259 --> 00:19:15,909
actually doing that or not

429
00:19:21,079 --> 00:19:25,109
you know I don't know I'd have to think

430
00:19:22,919 --> 00:19:31,250
about that so when we write in an alpha

431
00:19:25,109 --> 00:19:31,250
value we are taking the colors I guess I

432
00:19:33,919 --> 00:19:39,509
guess technically well okay but the more

433
00:19:37,919 --> 00:19:42,299
important part here I guess is that it

434
00:19:39,509 --> 00:19:44,369
comes from the source color so obviously

435
00:19:42,298 --> 00:19:47,759
that has nothing to do we didn't pre

436
00:19:44,369 --> 00:19:49,648
multiply the things by that right so

437
00:19:47,759 --> 00:19:52,379
that's the more important here the more

438
00:19:49,648 --> 00:19:55,379
important part here for sure so I guess

439
00:19:52,380 --> 00:19:57,120
that's that's a good point so really we

440
00:19:55,380 --> 00:20:00,600
wanted to say the source color comes

441
00:19:57,119 --> 00:20:03,058
from modulate that's actually I suppose

442
00:20:00,599 --> 00:20:05,519
the more correct thing there because

443
00:20:03,058 --> 00:20:08,398
we're loading it from that so okay so

444
00:20:05,519 --> 00:20:11,480
that seems that seems a little more

445
00:20:08,398 --> 00:20:11,479
plausible to me

446
00:20:16,710 --> 00:20:22,079
yeah so if that's going to happen this

447
00:20:20,940 --> 00:20:24,570
is going to be a little bit tricky

448
00:20:22,079 --> 00:20:28,079
actually now that I think about it and I

449
00:20:24,569 --> 00:20:30,569
suppose we could also not do the source

450
00:20:28,079 --> 00:20:32,460
color desk color thing I'd have to think

451
00:20:30,569 --> 00:20:35,069
about whether maybe I'm overcomplicating

452
00:20:32,460 --> 00:20:37,259
that like maybe we're just creating too

453
00:20:35,069 --> 00:20:40,259
many math ops in here so i suppose what

454
00:20:37,259 --> 00:20:42,480
i could do also is just say maybe all we

455
00:20:40,259 --> 00:20:44,250
have is the alpha between these two so

456
00:20:42,480 --> 00:20:47,519
it's literally literally just a single

457
00:20:44,250 --> 00:20:50,640
lerp you know so that way we can just

458
00:20:47,519 --> 00:20:53,069
load you know source color desk color

459
00:20:50,640 --> 00:20:56,640
these would just be loads the Alpha is

460
00:20:53,069 --> 00:20:58,950
is just whatever we pass in so then we

461
00:20:56,640 --> 00:21:00,450
do the one myself at times and plus the

462
00:20:58,950 --> 00:21:05,460
Alpha for the desk color and maybe

463
00:21:00,450 --> 00:21:07,710
that's maybe that's better that seems

464
00:21:05,460 --> 00:21:10,409
reasonable probably also we want it this

465
00:21:07,710 --> 00:21:13,829
way i would guess because we're probably

466
00:21:10,409 --> 00:21:15,630
saying how much we want to go towards

467
00:21:13,829 --> 00:21:17,609
the source target of course if that's

468
00:21:15,630 --> 00:21:19,140
the case we probably want it to look

469
00:21:17,609 --> 00:21:20,788
more like this because if that's the way

470
00:21:19,140 --> 00:21:24,090
we would normally write a linear blend

471
00:21:20,788 --> 00:21:27,028
right we'd say go from the desk to this

472
00:21:24,089 --> 00:21:29,069
much of the source so probably that's a

473
00:21:27,028 --> 00:21:34,849
little bit better all right so let's

474
00:21:29,069 --> 00:21:34,849
take a look at this blend render target

475
00:21:35,298 --> 00:21:49,158
so let's say we were going to do that it

476
00:21:38,038 --> 00:21:57,089
would look like this entry alpha and

477
00:21:49,159 --> 00:22:05,899
back we go all right so when we lift

478
00:21:57,089 --> 00:22:05,898
these two fine fellows out of the bitmap

479
00:22:06,319 --> 00:22:12,000
we're going to get you 30 tues basically

480
00:22:09,419 --> 00:22:13,679
out of it right and we're going to have

481
00:22:12,000 --> 00:22:15,599
like I'm going to have to have two of

482
00:22:13,679 --> 00:22:20,009
these I'm going to have to have a destro

483
00:22:15,599 --> 00:22:21,869
in a source row they're both going to do

484
00:22:20,009 --> 00:22:24,058
exactly the same thing essentially it's

485
00:22:21,869 --> 00:22:27,119
just the buffer part of things this is

486
00:22:24,058 --> 00:22:30,980
going to be a desk target in both cases

487
00:22:27,119 --> 00:22:36,769
and this is going to be a source

488
00:22:30,980 --> 00:22:39,529
in both places right then through here

489
00:22:36,769 --> 00:22:41,089
same exact thing happens we've got the

490
00:22:39,529 --> 00:22:43,639
destro in the source row and they're

491
00:22:41,089 --> 00:22:49,058
going to be updated by the desk target

492
00:22:43,640 --> 00:22:53,990
pitch and thesaurus target pitch and

493
00:22:49,058 --> 00:23:03,918
when I am advancing I need two of those

494
00:22:53,990 --> 00:23:08,089
as well okay so in this case I've got a

495
00:23:03,919 --> 00:23:12,230
desk pixel in a source pixel and so

496
00:23:08,089 --> 00:23:28,069
we're going to do source pixel just

497
00:23:12,230 --> 00:23:30,019
pixel and writing the desk pixel all

498
00:23:28,069 --> 00:23:33,019
right so that's all we're really doing

499
00:23:30,019 --> 00:23:35,480
for loading everything in it's just now

500
00:23:33,019 --> 00:23:37,339
we're going to have to and in fact we're

501
00:23:35,480 --> 00:23:42,319
pretty much done here it's just we need

502
00:23:37,339 --> 00:23:45,019
to convert from u32 packed color up to a

503
00:23:42,319 --> 00:23:49,970
vector do the math and then convert back

504
00:23:45,019 --> 00:23:53,019
down to packed again right and so you

505
00:23:49,970 --> 00:23:58,730
know that's that's this stuff right here

506
00:23:53,019 --> 00:24:01,400
and yeah we don't we have some do we

507
00:23:58,730 --> 00:24:06,190
seriously not have like a call to just

508
00:24:01,400 --> 00:24:06,190
do an unpack with alpha

509
00:24:09,970 --> 00:24:18,110
we haven't unpacked four by eight but it

510
00:24:15,319 --> 00:24:20,599
doesn't it doesn't I mean with them with

511
00:24:18,109 --> 00:24:22,399
gamma it's what I meant to say we do an

512
00:24:20,599 --> 00:24:25,519
unpacked four by eight but it doesn't do

513
00:24:22,400 --> 00:24:27,860
the gamma but well that's okay because

514
00:24:25,519 --> 00:24:32,450
the gamma is just squaring the numbers

515
00:24:27,859 --> 00:24:38,629
so i suppose i can do that part after

516
00:24:32,450 --> 00:24:45,710
the fact so yeah so unpack four by eight

517
00:24:38,630 --> 00:24:51,560
is what i need to do here and then do we

518
00:24:45,710 --> 00:24:53,930
have a pack four by eight how is it that

519
00:24:51,559 --> 00:24:58,309
we have a unpack four by eight but we

520
00:24:53,930 --> 00:25:02,830
don't have a pack four by eight it's a

521
00:24:58,309 --> 00:25:02,829
little strange it's not a little strange

522
00:25:03,700 --> 00:25:14,600
maybe I'm missing something but it seems

523
00:25:08,569 --> 00:25:24,200
I mean it just seems like we would have

524
00:25:14,599 --> 00:25:31,149
written that evidently we didn't who

525
00:25:24,200 --> 00:25:31,150
knows why certainly not me so anyway

526
00:25:39,420 --> 00:25:46,180
that's all we're talking about here so

527
00:25:43,660 --> 00:26:01,360
yeah so in theory we should be able to

528
00:25:46,180 --> 00:26:03,490
just use that and happy birthday yeah so

529
00:26:01,359 --> 00:26:05,649
like I said this doesn't actually do

530
00:26:03,490 --> 00:26:09,930
alpha properly i mean the gamma properly

531
00:26:05,650 --> 00:26:24,250
so i think we also want to do here a

532
00:26:09,930 --> 00:26:31,120
like a square on the way in and we want

533
00:26:24,250 --> 00:26:36,039
to do a square root on the way out if we

534
00:26:31,119 --> 00:26:38,319
want the gamma to be respected because

535
00:26:36,039 --> 00:26:43,539
those are frame buffer values which have

536
00:26:38,319 --> 00:26:47,230
been stored in gamma a hue 322 that's a

537
00:26:43,539 --> 00:26:50,079
lot of bits 322 bits maybe it's for

538
00:26:47,230 --> 00:26:53,049
cryptography who knows I've got a few

539
00:26:50,079 --> 00:26:55,679
typos here well not really typos a non

540
00:26:53,049 --> 00:26:58,480
ported code that's what it used to read

541
00:26:55,680 --> 00:27:01,600
let's go ahead and get that cleaned up a

542
00:26:58,480 --> 00:27:05,710
little bit there just a little bit and

543
00:27:01,599 --> 00:27:14,019
see if we're any better so what are

544
00:27:05,710 --> 00:27:17,039
these s 30 tues yeah all right so now I

545
00:27:14,019 --> 00:27:20,289
that's some going to be some real slow

546
00:27:17,039 --> 00:27:22,960
nasty not very good code that we can sse

547
00:27:20,289 --> 00:27:28,859
in a second you might even have time to

548
00:27:22,960 --> 00:27:35,559
do that tonight we'll see maybe not but

549
00:27:28,859 --> 00:27:37,599
we've got our our our render group has

550
00:27:35,559 --> 00:27:40,539
to be able to actually store the fact

551
00:27:37,599 --> 00:27:41,649
that the user wants to do this thing so

552
00:27:40,539 --> 00:27:46,720
i'm going to go ahead and put that in

553
00:27:41,650 --> 00:27:49,720
here oops so let's do render group entry

554
00:27:46,720 --> 00:28:08,420
type ren

555
00:27:49,720 --> 00:28:11,120
entry lend render target uh so yeah if I

556
00:28:08,420 --> 00:28:13,009
do that then I should be able to create

557
00:28:11,119 --> 00:28:17,000
one of these that just has the stuff

558
00:28:13,009 --> 00:28:23,410
that I just said it had right so we've

559
00:28:17,000 --> 00:28:23,410
got a struct it's one of these it has a

560
00:28:26,440 --> 00:28:35,750
source target index it has a output

561
00:28:33,559 --> 00:28:38,450
target which we know implicitly for the

562
00:28:35,750 --> 00:28:43,579
clip wrecked it's got an alpha value and

563
00:28:38,450 --> 00:28:45,080
it's got a source target which we

564
00:28:43,579 --> 00:28:48,759
already know that's what I put right

565
00:28:45,079 --> 00:28:55,189
there so it's really just that that's it

566
00:28:48,759 --> 00:28:57,980
and that's still we needed so what is

567
00:28:55,190 --> 00:29:02,509
the problem something should be preceded

568
00:28:57,980 --> 00:29:07,400
by something else I need a colon that

569
00:29:02,509 --> 00:29:13,660
would help for starters and render

570
00:29:07,400 --> 00:29:17,480
target that should have looked like that

571
00:29:13,660 --> 00:29:20,060
okay so now we're good to go this won't

572
00:29:17,480 --> 00:29:27,620
do anything because no one is ever

573
00:29:20,059 --> 00:29:30,019
pushing on that actual call right so

574
00:29:27,619 --> 00:29:33,919
it's ineffectual so you can see we still

575
00:29:30,019 --> 00:29:36,170
don't see anything happening there but

576
00:29:33,920 --> 00:29:38,660
what I'm going to try anyway and let's

577
00:29:36,170 --> 00:29:42,019
see if we can make this happen is I'm

578
00:29:38,660 --> 00:29:47,360
going to try pushing one of those on so

579
00:29:42,019 --> 00:29:51,650
you know we've got sort of this where is

580
00:29:47,359 --> 00:29:56,750
it at here let's see perspective and

581
00:29:51,650 --> 00:30:00,259
render group orthographic so essentially

582
00:29:56,750 --> 00:30:01,490
what we need to do is we need to push

583
00:30:00,259 --> 00:30:03,289
one of these on and we

584
00:30:01,490 --> 00:30:07,190
need to push one of these on in a way

585
00:30:03,289 --> 00:30:09,710
that you know is not going to get sort

586
00:30:07,190 --> 00:30:12,620
of messed with or sorted with anything

587
00:30:09,710 --> 00:30:15,590
else now previously we took the clear

588
00:30:12,619 --> 00:30:21,439
and we sort of put the clear out in the

589
00:30:15,589 --> 00:30:23,509
middle of nowhere and bye-bye sort of

590
00:30:21,440 --> 00:30:32,150
putting it into a separate thing we kind

591
00:30:23,509 --> 00:30:34,339
of need that to come back because like

592
00:30:32,150 --> 00:30:36,200
right now we're not actually clearing

593
00:30:34,339 --> 00:30:37,519
our render targets at all so we got we

594
00:30:36,200 --> 00:30:39,679
got other things we're going to have to

595
00:30:37,519 --> 00:30:41,779
deal with here but point being let's

596
00:30:39,679 --> 00:30:46,160
start with one thing at a time I mean I

597
00:30:41,779 --> 00:30:51,289
see what we are doing for that yes so

598
00:30:46,160 --> 00:30:54,259
we're we don't actually clear anything

599
00:30:51,289 --> 00:30:55,819
other than the initial render target so

600
00:30:54,259 --> 00:30:58,640
really we probably need to clear all the

601
00:30:55,819 --> 00:31:00,200
render targets or have the user

602
00:30:58,640 --> 00:31:02,150
specified when to clear them so I think

603
00:31:00,200 --> 00:31:07,670
we should probably do to do Casey put

604
00:31:02,150 --> 00:31:12,620
clears back into the list just use sort

605
00:31:07,670 --> 00:31:14,750
barriers to isolate them it's probably

606
00:31:12,619 --> 00:31:17,479
the right thing to do so anyway here we

607
00:31:14,750 --> 00:31:21,190
go I'm going to do this this way i'm

608
00:31:17,480 --> 00:31:24,589
going to say target index equals 0

609
00:31:21,190 --> 00:31:28,190
target index is less than commands max

610
00:31:24,589 --> 00:31:30,519
render target index let's just target

611
00:31:28,190 --> 00:31:30,519
index

612
00:31:32,009 --> 00:31:48,129
wow so this way i'll just have it so

613
00:31:45,669 --> 00:31:52,570
that everyone gets cleared using the

614
00:31:48,130 --> 00:31:53,830
initial clear call of course that's not

615
00:31:52,569 --> 00:31:57,278
going to live code voted because that's

616
00:31:53,829 --> 00:31:59,710
not actually in there but ok so inside

617
00:31:57,278 --> 00:32:04,028
handmade render group if i wanted to do

618
00:31:59,710 --> 00:32:09,778
a composite operation here what i'm

619
00:32:04,028 --> 00:32:14,380
going to do is say well uh you know I

620
00:32:09,778 --> 00:32:18,659
want to do a standard push call here

621
00:32:14,380 --> 00:32:25,528
right I like I would like to do

622
00:32:18,659 --> 00:32:28,980
effectively like what push a bitmap does

623
00:32:25,528 --> 00:32:34,480
or actually you know probably more

624
00:32:28,980 --> 00:32:38,048
probably more almost like what push clip

625
00:32:34,480 --> 00:32:42,519
wrecked does i think probably something

626
00:32:38,048 --> 00:32:44,829
more like that yeah so i'm going to i'm

627
00:32:42,519 --> 00:32:49,509
going to grab this guy and I'm going to

628
00:32:44,829 --> 00:32:55,000
put it down here I'm gonna go ahead and

629
00:32:49,509 --> 00:33:03,898
say push a target blend or something

630
00:32:55,000 --> 00:33:07,558
like that push blend under target and I

631
00:33:03,898 --> 00:33:10,928
call this the source render target index

632
00:33:07,558 --> 00:33:14,019
and what I'm going to do here is I'm

633
00:33:10,929 --> 00:33:15,909
going to ask for a push buffer push I'm

634
00:33:14,019 --> 00:33:20,889
going to say that I want a sort entry

635
00:33:15,909 --> 00:33:23,039
and I want a render entry clip correct

636
00:33:20,890 --> 00:33:26,500
I'm sorry render entry blend source

637
00:33:23,038 --> 00:33:29,950
render target assuming I get one of

638
00:33:26,500 --> 00:33:39,690
those I'm going to go ahead and fill it

639
00:33:29,950 --> 00:33:39,690
out and this stuff is all irrelevant

640
00:33:44,329 --> 00:33:49,980
so yeah so when I push and I asked for

641
00:33:47,940 --> 00:33:52,019
the sword entries if the render target

642
00:33:49,980 --> 00:33:54,000
stuff I don't ever want this to be

643
00:33:52,019 --> 00:33:55,410
sorted I want it to just happen in the

644
00:33:54,000 --> 00:33:57,299
stream where ever you say it's going to

645
00:33:55,410 --> 00:34:01,920
happen so I'm going to try something

646
00:33:57,299 --> 00:34:04,259
here where I just push three sword

647
00:34:01,920 --> 00:34:05,820
entries on and so those three sword

648
00:34:04,259 --> 00:34:09,659
entries are going to be like to sort

649
00:34:05,819 --> 00:34:14,880
barriers and just one op you know this

650
00:34:09,659 --> 00:34:20,609
operation basically so let's see here

651
00:34:14,880 --> 00:34:24,210
how do I push a sort barrier it's really

652
00:34:20,610 --> 00:34:31,430
just that and so what I should be able

653
00:34:24,210 --> 00:34:37,320
to do here is set these up in that way

654
00:34:31,429 --> 00:34:45,809
so let's see so let's just do a sword

655
00:34:37,320 --> 00:34:54,030
entry so push sort entry how does that

656
00:34:45,809 --> 00:35:00,239
happen how does that happen where is

657
00:34:54,030 --> 00:35:03,120
that struct there it is I wish you to

658
00:35:00,239 --> 00:35:08,399
come out to the outer side of things

659
00:35:03,119 --> 00:35:10,920
there we go so our sword entry zero and

660
00:35:08,400 --> 00:35:13,829
our sword entry two are going to look

661
00:35:10,920 --> 00:35:18,809
like that but our sword entry one is

662
00:35:13,829 --> 00:35:22,279
going to look like the actual offset

663
00:35:18,809 --> 00:35:22,279
that we care about right

664
00:35:29,989 --> 00:35:54,419
this value basically so I'm you know I'm

665
00:35:45,000 --> 00:36:00,059
a little confused as to why this is

666
00:35:54,420 --> 00:36:05,970
called header why did we call that

667
00:36:00,059 --> 00:36:10,549
header because is it actually the header

668
00:36:05,969 --> 00:36:10,549
and if it is the header isn't this wrong

669
00:36:17,179 --> 00:36:21,949
hold please while I think about this

670
00:36:30,289 --> 00:36:38,130
yeah so so isn't isn't that wrong when

671
00:36:36,059 --> 00:36:40,920
we do a push clip wrecked oh I guess not

672
00:36:38,130 --> 00:36:43,019
because the push clip rekt doesn't need

673
00:36:40,920 --> 00:36:47,369
the header so I suppose that's actually

674
00:36:43,019 --> 00:36:49,320
okay but this guy does so this is this

675
00:36:47,369 --> 00:36:51,539
this guy actually does care about that

676
00:36:49,320 --> 00:36:55,920
if that makes sense because he's an act

677
00:36:51,539 --> 00:37:02,699
he's a real he's a real thing so I've

678
00:36:55,920 --> 00:37:07,409
got this rectangle push happening here

679
00:37:02,699 --> 00:37:15,858
blend render target I guess we don't

680
00:37:07,409 --> 00:37:15,858
need any of these this is really blend

681
00:37:16,820 --> 00:37:29,369
so this blend is going to have a source

682
00:37:23,039 --> 00:37:37,949
render target index which we took and an

683
00:37:29,369 --> 00:37:40,858
alpha value which I forgot to have but

684
00:37:37,949 --> 00:37:44,730
that's it and the other thing that I'm

685
00:37:40,858 --> 00:37:49,279
not sure about is we have to fill out

686
00:37:44,730 --> 00:37:52,079
some of the other bits i think here so

687
00:37:49,280 --> 00:37:54,330
you know i could also and i probably

688
00:37:52,079 --> 00:37:58,319
should now i think about it i should

689
00:37:54,329 --> 00:37:59,789
also probably go ahead and take rather

690
00:37:58,320 --> 00:38:02,369
than doing sort of that finicky stuff

691
00:37:59,789 --> 00:38:05,039
myself i suppose i could take this and

692
00:38:02,369 --> 00:38:07,559
still just use it and just do a push

693
00:38:05,039 --> 00:38:08,489
sort barrier just do instead of trying

694
00:38:07,559 --> 00:38:09,509
to be efficient about it because it's

695
00:38:08,489 --> 00:38:13,348
not something is going to happen very

696
00:38:09,510 --> 00:38:15,210
often i could instead just do hey do one

697
00:38:13,349 --> 00:38:21,930
of these guys where I do a push render

698
00:38:15,210 --> 00:38:26,750
element oops of render entry blend

699
00:38:21,929 --> 00:38:33,589
render target I see here again

700
00:38:26,750 --> 00:38:37,039
and rectangle to I screen area we don't

701
00:38:33,590 --> 00:38:42,650
care about and sort sprite bound sort

702
00:38:37,039 --> 00:38:46,190
key these are meaningless because we're

703
00:38:42,650 --> 00:38:47,690
not actually going to ever have it sort

704
00:38:46,190 --> 00:38:52,990
against anything so they can just be

705
00:38:47,690 --> 00:39:04,309
completely irrelevant that makes sense

706
00:38:52,989 --> 00:39:06,739
and then I don't have to do this so now

707
00:39:04,309 --> 00:39:09,049
that I've got my blend I can do about

708
00:39:06,739 --> 00:39:11,299
whatever I want and then I just need to

709
00:39:09,050 --> 00:39:12,980
put some code around it that will

710
00:39:11,300 --> 00:39:17,510
prevent this from being a problem so I

711
00:39:12,980 --> 00:39:19,550
can push a sort barrier here push

712
00:39:17,510 --> 00:39:21,620
another sort barrier here and then I

713
00:39:19,550 --> 00:39:23,539
know that nothing like when that was

714
00:39:21,619 --> 00:39:25,489
said it will do the blend at that time

715
00:39:23,539 --> 00:39:28,759
and it won't sort against anything else

716
00:39:25,489 --> 00:39:31,449
or create problems for anybody right so

717
00:39:28,760 --> 00:39:31,450
that seems good

718
00:39:37,179 --> 00:39:45,199
alright so now i should be able to do

719
00:39:41,059 --> 00:39:47,509
this blend if I want to so if i go into

720
00:39:45,199 --> 00:39:50,750
entity dot cpp i'm going to do this in

721
00:39:47,510 --> 00:39:54,580
two steps here the first step I'm going

722
00:39:50,750 --> 00:39:59,389
to do is I'm actually going to re-enable

723
00:39:54,579 --> 00:40:03,289
this momentarily so I can see what I'm

724
00:39:59,389 --> 00:40:05,719
drawing so there they are I'm did that

725
00:40:03,289 --> 00:40:12,219
so that i can go that i want to take

726
00:40:05,719 --> 00:40:16,489
that alpha and i want to get rid of it

727
00:40:12,219 --> 00:40:23,599
so this entity transform t color bit we

728
00:40:16,489 --> 00:40:27,559
want that to just be I guess all zeros

729
00:40:23,599 --> 00:40:30,889
in this case right so now it's

730
00:40:27,559 --> 00:40:39,039
completely a pake and what was the

731
00:40:30,889 --> 00:40:39,039
actual value there okay

732
00:40:41,719 --> 00:40:46,769
so I'm going to make that be that way

733
00:40:44,480 --> 00:40:49,380
and so now we know what's getting drawn

734
00:40:46,769 --> 00:40:58,590
properly and then at the end we will

735
00:40:49,380 --> 00:41:00,090
composite those on top of each other so

736
00:40:58,590 --> 00:41:03,090
then what I'm going to do is push one of

737
00:41:00,090 --> 00:41:14,190
these plans the source target index and

738
00:41:03,090 --> 00:41:19,019
the test alpha and off we should go of

739
00:41:14,190 --> 00:41:23,429
course what are we doing here we

740
00:41:19,019 --> 00:41:26,000
actually don't care too much about this

741
00:41:23,429 --> 00:41:28,409
so it's always just maximum level index

742
00:41:26,000 --> 00:41:31,230
we can simplify this a little bit now

743
00:41:28,409 --> 00:41:41,309
that we know what we're doing all right

744
00:41:31,230 --> 00:41:48,059
oh dear that didn't go well it looks

745
00:41:41,309 --> 00:41:52,070
like this is for some reason did we are

746
00:41:48,059 --> 00:41:54,420
we still compiling in optimized man ah

747
00:41:52,070 --> 00:41:57,450
no wonder we were kidding 30 frames

748
00:41:54,420 --> 00:42:00,450
second that did seem a bit high for one

749
00:41:57,449 --> 00:42:04,739
hop demise but ok nevermind I take it

750
00:42:00,449 --> 00:42:08,819
back now will be much much slower ok so

751
00:42:04,739 --> 00:42:14,569
let's see here it looks like our source

752
00:42:08,820 --> 00:42:14,570
target is bogus I'm not sure why

753
00:42:21,829 --> 00:42:32,509
for some reason the max render target

754
00:42:25,860 --> 00:42:32,510
index is 0 but it definitely suck up

755
00:42:33,380 --> 00:42:46,050
that's actually correct we aren't using

756
00:42:40,710 --> 00:42:52,079
that render target yet so I'm going to

757
00:42:46,050 --> 00:43:00,780
do alpha floor render target is one off

758
00:42:52,079 --> 00:43:05,549
the floor render target and then so that

759
00:43:00,780 --> 00:43:08,760
is actually a a correct crash no one

760
00:43:05,550 --> 00:43:10,289
should have called that's okay so now

761
00:43:08,760 --> 00:43:13,890
we're doing an incredibly expensive

762
00:43:10,289 --> 00:43:16,139
incredibly slow composite step I should

763
00:43:13,889 --> 00:43:26,069
probably compile in a release mode to

764
00:43:16,139 --> 00:43:27,869
have any prayer of running this and as

765
00:43:26,070 --> 00:43:29,130
you can see it's horrifically slow right

766
00:43:27,869 --> 00:43:32,579
because we're doing this really

767
00:43:29,130 --> 00:43:34,980
expensive really slow sloppy stuff for

768
00:43:32,579 --> 00:43:38,039
every pixel there and that's nobody's

769
00:43:34,980 --> 00:43:42,150
not good for anybody all right so if we

770
00:43:38,039 --> 00:43:46,199
come up here let's get to a point where

771
00:43:42,150 --> 00:43:49,619
we should be seeing some alpha like here

772
00:43:46,199 --> 00:43:52,049
for example and it doesn't look like

773
00:43:49,619 --> 00:43:56,420
we're getting any like okay so we kind

774
00:43:52,050 --> 00:43:58,350
of it kind of looks like whenever we're

775
00:43:56,420 --> 00:44:00,659
expecting to see something here we're

776
00:43:58,349 --> 00:44:03,119
not actually seeing anything so I'm

777
00:44:00,659 --> 00:44:05,579
going to step in well of course it's

778
00:44:03,119 --> 00:44:07,529
going to be all optimized unfortunately

779
00:44:05,579 --> 00:44:10,319
so I don't know that I can see too much

780
00:44:07,530 --> 00:44:17,360
but I want to get a sense of what's

781
00:44:10,320 --> 00:44:17,360
happening in our in our blend code

782
00:44:22,909 --> 00:44:28,239
well

783
00:44:25,349 --> 00:44:31,079
thank you welcome tablet I did not

784
00:44:28,239 --> 00:44:31,079
actually want to do that

785
00:44:39,219 --> 00:44:42,149
mm-hmm

786
00:44:44,690 --> 00:44:53,880
alright so that's some fantastic typing

787
00:44:48,989 --> 00:44:59,549
there so we're going to have to fix that

788
00:44:53,880 --> 00:45:01,559
to say the least so obviously if the

789
00:44:59,550 --> 00:45:03,810
source color is getting square I don't

790
00:45:01,559 --> 00:45:05,759
even know I was kind of sleeping here

791
00:45:03,809 --> 00:45:13,710
obviously i don't know what i was doing

792
00:45:05,760 --> 00:45:14,910
exactly that's supposed to be both of

793
00:45:13,710 --> 00:45:16,199
these were supposed to square themselves

794
00:45:14,909 --> 00:45:20,579
and then this one's supposed to be

795
00:45:16,199 --> 00:45:24,960
result so that was just like cut and

796
00:45:20,579 --> 00:45:34,619
paste fun or copy pasta as people I've

797
00:45:24,960 --> 00:45:36,090
heard call it on the stream alright so

798
00:45:34,619 --> 00:45:41,309
that should at least be slightly more

799
00:45:36,090 --> 00:45:43,490
sane but we'll see it still may not be

800
00:45:41,309 --> 00:45:43,489
correct

801
00:45:56,219 --> 00:45:59,868
not seeing anything

802
00:46:02,579 --> 00:46:15,269
hmm very strange so we unpack our source

803
00:46:09,728 --> 00:46:18,518
color and our desk color from the pixels

804
00:46:15,268 --> 00:46:20,288
we are writing to des pixel so you'd

805
00:46:18,518 --> 00:46:24,938
think we would see something happening

806
00:46:20,289 --> 00:46:27,189
here but apparently not so we square of

807
00:46:24,938 --> 00:46:28,748
these for gamma purposes so whatever the

808
00:46:27,188 --> 00:46:31,868
source color and desk low that we loaded

809
00:46:28,748 --> 00:46:37,058
our we get squared versions of them we

810
00:46:31,869 --> 00:46:41,798
then do a loops yeah we then do alpha

811
00:46:37,059 --> 00:46:45,278
blends I'm going to go ahead and just

812
00:46:41,798 --> 00:46:47,380
see because I would like to to find out

813
00:46:45,278 --> 00:46:50,579
what happens if I just hard code the

814
00:46:47,380 --> 00:46:50,579
Alpha to fifty percent

815
00:47:16,519 --> 00:47:22,159
so it literally does not matter what the

816
00:47:19,820 --> 00:47:24,760
Alpha is it does not produce anything

817
00:47:22,159 --> 00:47:24,759
interesting

818
00:47:41,329 --> 00:47:45,818
I'll admit that's a little confusing

819
00:48:00,369 --> 00:48:11,389
well I guess it's time to step in so

820
00:48:10,130 --> 00:48:14,240
what I'm going to do here is we're going

821
00:48:11,389 --> 00:48:30,049
to say i would like to break any where

822
00:48:14,239 --> 00:48:33,439
the source pixel is not zero so I'm just

823
00:48:30,050 --> 00:48:38,240
going to go ahead and run I did change

824
00:48:33,440 --> 00:48:39,769
the build to debug did not yes so I'm

825
00:48:38,239 --> 00:48:41,149
just going to set a breakpoint there and

826
00:48:39,769 --> 00:48:43,130
I want to see what happens when we have

827
00:48:41,150 --> 00:48:46,130
a source pixel that's actually got

828
00:48:43,130 --> 00:48:49,099
something in it so I can see what

829
00:48:46,130 --> 00:48:53,240
happens all right so here's our source

830
00:48:49,099 --> 00:49:03,440
color here's our desk color there's our

831
00:48:53,239 --> 00:49:06,879
alpha oh those are thus it what did we

832
00:49:03,440 --> 00:49:06,880
pass the same target

833
00:49:09,190 --> 00:49:12,190
what

834
00:49:23,010 --> 00:49:39,240
ah i see what happened very clever Casey

835
00:49:33,500 --> 00:49:42,480
we outsmarted ourselves this transient

836
00:49:39,239 --> 00:49:47,909
clip rekt will not restore the old clip

837
00:49:42,480 --> 00:49:49,940
rekt until after we're done right so

838
00:49:47,909 --> 00:49:52,559
it's kind of completely useless actually

839
00:49:49,940 --> 00:49:55,440
thanks for nothing transient clip

840
00:49:52,559 --> 00:49:57,659
wrecked so what we actually want to do

841
00:49:55,440 --> 00:50:00,990
here is we actually want to manually set

842
00:49:57,659 --> 00:50:07,649
the current clip rekt to be the normal

843
00:50:00,989 --> 00:50:09,629
clip rekt right there so that was the

844
00:50:07,650 --> 00:50:13,500
problem we were basically blending the

845
00:50:09,630 --> 00:50:19,130
render target with itself oh that is

846
00:50:13,500 --> 00:50:19,130
pretty can we play the game like that

847
00:50:19,369 --> 00:50:25,940
Wow I kind of like that I kind of want

848
00:50:24,150 --> 00:50:30,180
to see that running in full at full

849
00:50:25,940 --> 00:50:31,500
speed I was not expecting that I'll be

850
00:50:30,179 --> 00:50:38,250
honest that was not what I was expecting

851
00:50:31,500 --> 00:50:40,429
to see but I kind of want to see that

852
00:50:38,250 --> 00:50:40,429
again

853
00:50:48,818 --> 00:50:51,818
whoa

854
00:50:57,929 --> 00:51:01,190
that is wicked cool

855
00:51:09,099 --> 00:51:15,940
that is really really cool all right uh

856
00:51:13,119 --> 00:51:18,519
well you know cool as it is it's not

857
00:51:15,940 --> 00:51:20,889
correct so you know we're going to have

858
00:51:18,519 --> 00:51:25,440
to stop doing it but let's just take a

859
00:51:20,889 --> 00:51:28,659
look at what's going on here with that

860
00:51:25,440 --> 00:51:30,820
so we should be having an even blend

861
00:51:28,659 --> 00:51:32,409
here these are getting squared what is

862
00:51:30,820 --> 00:51:39,490
owed is this leaving it to is this

863
00:51:32,409 --> 00:51:44,049
leaving it in 255 space though yeah so

864
00:51:39,489 --> 00:51:46,329
this is leaving it in 255 space so if

865
00:51:44,050 --> 00:51:55,930
what after I do that unpack I'm going to

866
00:51:46,329 --> 00:52:03,190
have to I'm going to have to oh there's

867
00:51:55,929 --> 00:52:05,609
my weight srgb where is srgb bilinear

868
00:52:03,190 --> 00:52:05,610
blend

869
00:52:15,900 --> 00:52:29,440
this is what we actually wanted all

870
00:52:27,639 --> 00:52:31,440
right so basically that was just me not

871
00:52:29,440 --> 00:52:33,909
remembering what we had actually written

872
00:52:31,440 --> 00:52:35,230
so that will take care of it for us I

873
00:52:33,909 --> 00:52:36,849
was going to say I've got a ticket out

874
00:52:35,230 --> 00:52:40,449
to 25 face it looks like we already have

875
00:52:36,849 --> 00:52:42,369
a thing for that yeah there are bent you

876
00:52:40,449 --> 00:52:43,809
know downsize to streaming one hour a

877
00:52:42,369 --> 00:52:49,389
night you forget the stuff that you've

878
00:52:43,809 --> 00:52:52,989
already written pretty quickly anyway so

879
00:52:49,389 --> 00:53:07,150
after the unpack I guess we can just do

880
00:52:52,989 --> 00:53:09,579
srgb to linear what does that do so it

881
00:53:07,150 --> 00:53:11,559
does the in 255 and it does the square

882
00:53:09,579 --> 00:53:16,900
so that does everything that we wanted

883
00:53:11,559 --> 00:53:19,389
and linear 12 s RGB 255 does the exact

884
00:53:16,900 --> 00:53:22,059
opposite okay so we did already have the

885
00:53:19,389 --> 00:53:24,269
stuff it just wasn't in this file good

886
00:53:22,059 --> 00:53:24,269
to know

887
00:53:35,358 --> 00:53:47,190
so really all we needed to have done was

888
00:53:39,358 --> 00:53:50,429
that right and now we're at least

889
00:53:47,190 --> 00:53:52,980
running through the old paths in a more

890
00:53:50,429 --> 00:53:55,108
correct way okay so now we're but it

891
00:53:52,980 --> 00:53:55,980
were being operating in theory in the

892
00:53:55,108 --> 00:53:58,529
right space where they were still

893
00:53:55,980 --> 00:54:01,409
sparkly which is weird so to be 25 to

894
00:53:58,530 --> 00:54:04,980
linear one after the unpack refuge for

895
00:54:01,409 --> 00:54:07,828
later one after the unpack of those two

896
00:54:04,980 --> 00:54:09,570
we do the blend then we do a linear one

897
00:54:07,829 --> 00:54:13,410
test three be 255 and then we do the

898
00:54:09,570 --> 00:54:17,160
pack oh but the pack four by eight does

899
00:54:13,409 --> 00:54:21,299
the multiply so to make these symmetric

900
00:54:17,159 --> 00:54:25,828
the packed four by eight should not be

901
00:54:21,300 --> 00:54:33,570
doing that right that's actually the

902
00:54:25,829 --> 00:54:36,539
correct operation now okay so I think

903
00:54:33,570 --> 00:54:38,789
we're getting closer to being correct

904
00:54:36,539 --> 00:54:41,579
but obviously we still have some issues

905
00:54:38,789 --> 00:54:44,489
here I'm kind of loving whatever is

906
00:54:41,579 --> 00:54:49,289
happening with some of that drawing

907
00:54:44,489 --> 00:54:51,568
though that's pretty spiffy all right so

908
00:54:49,289 --> 00:54:53,730
let's go ahead and put the correct alpha

909
00:54:51,568 --> 00:54:56,009
value back in because we were stuffing

910
00:54:53,730 --> 00:55:00,990
the Alpha value before which we don't

911
00:54:56,010 --> 00:55:02,400
want to do uh yeah and then we may be

912
00:55:00,989 --> 00:55:05,068
out of time so we may have to do the

913
00:55:02,400 --> 00:55:07,800
rest of the debugging tomorrow or the

914
00:55:05,068 --> 00:55:10,039
end the SSC version or whatever because

915
00:55:07,800 --> 00:55:13,740
it looks like it's still drawing

916
00:55:10,039 --> 00:55:15,568
somewhat incorrectly or something is

917
00:55:13,739 --> 00:55:18,629
happening odd I'm not sure what exactly

918
00:55:15,568 --> 00:55:21,800
will find out I suppose so let's go

919
00:55:18,630 --> 00:55:21,800
ahead up here

920
00:55:29,090 --> 00:55:46,100
why am I not seeing are we not passing

921
00:55:31,880 --> 00:55:49,490
the Alpha value down I love that you

922
00:55:46,099 --> 00:55:56,269
have to switch that thing tick that's

923
00:55:49,489 --> 00:56:02,029
the weirdest thing why are we always

924
00:55:56,269 --> 00:56:05,389
passing zero it seems like we're seems

925
00:56:02,030 --> 00:56:07,960
like we're not actually passing a valid

926
00:56:05,389 --> 00:56:07,960
value there

927
00:56:16,349 --> 00:56:31,769
I think maximum level index is wow yeah

928
00:56:30,028 --> 00:56:34,920
that's just that's just bogus what we

929
00:56:31,768 --> 00:56:37,379
actually want is the array count so

930
00:56:34,920 --> 00:56:41,369
really and plus I guess the other thing

931
00:56:37,380 --> 00:56:46,979
too is we don't really need the Alpha

932
00:56:41,369 --> 00:56:49,318
for anything else so really you know we

933
00:56:46,978 --> 00:56:56,278
just I mean we could just do this this

934
00:56:49,318 --> 00:57:10,108
is what we actually want right that was

935
00:56:56,278 --> 00:57:14,778
just ouch to screw up ok so now I think

936
00:57:10,108 --> 00:57:14,778
we're good let's go ahead and run

937
00:57:15,440 --> 00:57:26,818
evidently not and the test alpha from

938
00:57:21,568 --> 00:57:29,389
top starts Z to top NZ camera relative

939
00:57:26,818 --> 00:57:29,389
ground

940
00:57:37,018 --> 00:57:43,998
I feel like that should be going the

941
00:57:40,108 --> 00:57:49,108
right direction yes from the top start

942
00:57:43,998 --> 00:57:51,718
to the top end do they go yeah so they

943
00:57:49,108 --> 00:57:54,778
go in in height order so it should be as

944
00:57:51,719 --> 00:57:57,148
you get higher you get closer to one

945
00:57:54,778 --> 00:58:00,268
right if I'm looking at that correctly

946
00:57:57,148 --> 00:58:02,219
so it should be that at first it should

947
00:58:00,268 --> 00:58:14,008
be very low it should be like an alpha

948
00:58:02,219 --> 00:58:17,880
value of zero right and yeah so I'm not

949
00:58:14,009 --> 00:58:20,009
one hundred percent sure why we're

950
00:58:17,880 --> 00:58:26,509
seeing that I would like to take a quick

951
00:58:20,009 --> 00:58:26,509
look at that let's see here

952
00:58:36,210 --> 00:58:45,240
I love how it can't ever tell you any

953
00:58:43,050 --> 00:58:48,599
values in release mode it's like I have

954
00:58:45,239 --> 00:58:51,419
no idea so how did test alpha get to be

955
00:58:48,599 --> 00:58:53,580
1 point 0 in this case I'm very

956
00:58:51,420 --> 00:58:56,730
interested to see that so if i come

957
00:58:53,579 --> 00:59:00,539
through here right i'm going to loop

958
00:58:56,730 --> 00:59:05,849
through here a few times and when the

959
00:59:00,539 --> 00:59:09,269
level index gets to be five right which

960
00:59:05,849 --> 00:59:29,490
is how many there should be or six note

961
00:59:09,269 --> 00:59:32,099
my guess is five ok I 1.5 say top end so

962
00:59:29,489 --> 00:59:37,409
this is a bit strange so that's saying

963
00:59:32,099 --> 00:59:39,869
that the final camera ground Z so these

964
00:59:37,409 --> 00:59:42,420
why were these set to what they were did

965
00:59:39,869 --> 00:59:45,930
we have some other weird bug that was

966
00:59:42,420 --> 00:59:52,829
happening why weren't these when we were

967
00:59:45,929 --> 00:59:56,730
using the test alpha before why were we

968
00:59:52,829 --> 01:00:02,730
seeing stuff fade in like that we have

969
00:59:56,730 --> 01:00:04,289
we have a bug here that's different we

970
01:00:02,730 --> 01:00:06,740
have some kind of a different bug that's

971
01:00:04,289 --> 01:00:06,739
going on

972
01:00:08,349 --> 01:00:14,309
it must have been that before let me see

973
01:00:14,789 --> 01:00:25,690
this is level index 5 maximum level

974
01:00:18,219 --> 01:00:33,518
index is what one and how are we

975
01:00:25,690 --> 01:00:35,588
computing which one to use before we're

976
01:00:33,518 --> 01:00:38,728
using the relative layer minus the

977
01:00:35,588 --> 01:00:38,728
minimum level index

978
01:00:44,139 --> 01:00:50,969
so it's whatever the entities Z layer

979
01:00:46,510 --> 01:00:50,970
was minus the chunk origin z

980
01:01:00,619 --> 01:01:06,679
so that should equal one I agree with

981
01:01:04,940 --> 01:01:11,059
the fact that that should equal one on

982
01:01:06,679 --> 01:01:14,079
the maximum level index and that maximum

983
01:01:11,059 --> 01:01:14,079
level index though

984
01:01:24,338 --> 01:01:33,460
you would think would only have been one

985
01:01:27,940 --> 01:01:44,259
floor heights worth up which I guess is

986
01:01:33,460 --> 01:01:45,429
what it is you know what no so it's just

987
01:01:44,259 --> 01:01:47,498
been a slow night and I guess it

988
01:01:45,429 --> 01:01:49,449
continues to be a slow night so that is

989
01:01:47,498 --> 01:01:52,268
actually true the higher the thing is

990
01:01:49,449 --> 01:01:54,098
the less the Alpha value should be so

991
01:01:52,268 --> 01:01:55,868
this is yet another case of like okay

992
01:01:54,099 --> 01:01:57,548
every time we flip the meaning of alpha

993
01:01:55,869 --> 01:02:01,059
we have to switch the way that range is

994
01:01:57,548 --> 01:02:05,228
computed so no need for panic that was

995
01:02:01,059 --> 01:02:09,278
actually the case and off we go first I

996
01:02:05,228 --> 01:02:17,108
really do need to compile in Nam debug

997
01:02:09,278 --> 01:02:19,599
mode but off we go all right so now

998
01:02:17,108 --> 01:02:22,298
we're still slowly limping along here

999
01:02:19,599 --> 01:02:25,798
limping limping we're going to have to

1000
01:02:22,298 --> 01:02:25,798
SSE this tomorrow as you can see

1001
01:02:34,190 --> 01:02:40,789
there we go now we're actually blending

1002
01:02:37,070 --> 01:02:43,460
that incorrectly so the current problem

1003
01:02:40,789 --> 01:02:46,940
just looks to me like that for whatever

1004
01:02:43,460 --> 01:02:49,630
reason is either not clearing or not

1005
01:02:46,940 --> 01:02:53,539
it's not drawing that second layer

1006
01:02:49,630 --> 01:02:58,900
correctly so we have some other bug in

1007
01:02:53,539 --> 01:03:01,940
the in the render group code that is

1008
01:02:58,900 --> 01:03:07,190
keeping us from being correct yet and we

1009
01:03:01,940 --> 01:03:09,139
want to be correct before we do any of

1010
01:03:07,190 --> 01:03:11,539
the optimization so we'll have to take a

1011
01:03:09,139 --> 01:03:23,809
look at what's going on there for

1012
01:03:11,539 --> 01:03:24,920
certain the clear there we go the clear

1013
01:03:23,809 --> 01:03:26,420
was only clearing the first one because

1014
01:03:24,920 --> 01:03:29,389
number it's a max render target index

1015
01:03:26,420 --> 01:03:30,619
not the count so the clear has to clear

1016
01:03:29,389 --> 01:03:32,929
both of those so that could have been

1017
01:03:30,619 --> 01:03:34,609
part of it as well if it just wasn't

1018
01:03:32,929 --> 01:03:36,619
clearing maybe everything else is

1019
01:03:34,610 --> 01:03:39,039
actually fine so let's give that one

1020
01:03:36,619 --> 01:03:39,039
more shot

1021
01:03:47,559 --> 01:04:00,759
okay now it looks like we're good okay

1022
01:03:57,389 --> 01:04:03,150
all right so that's all good we do have

1023
01:04:00,759 --> 01:04:07,900
one problem here which is the clear is

1024
01:04:03,150 --> 01:04:10,539
clearing at one point 0 alpha because

1025
01:04:07,900 --> 01:04:13,509
it's using that draw rectangle call so

1026
01:04:10,539 --> 01:04:19,359
we need to do like to do kc clear also

1027
01:04:13,509 --> 01:04:26,920
has to actually clear not blend because

1028
01:04:19,358 --> 01:04:29,139
the alpha is wrong so we have two things

1029
01:04:26,920 --> 01:04:30,309
we have to do tomorrow one is we have to

1030
01:04:29,139 --> 01:04:31,868
make it so that we're actually doing

1031
01:04:30,309 --> 01:04:38,309
clear and we should just go make an

1032
01:04:31,869 --> 01:04:41,890
actual clear and like not a blend and

1033
01:04:38,309 --> 01:04:46,959
the other one is we have to go SSE that

1034
01:04:41,889 --> 01:04:49,438
but then I think we're good let's go

1035
01:04:46,958 --> 01:04:49,438
ahead and QA

1036
01:05:58,458 --> 01:06:09,929
Geiger Lovecraft themed handmade zero

1037
01:06:00,958 --> 01:06:12,149
DLC ha doubtful soy sauce the kid are

1038
01:06:09,929 --> 01:06:14,639
you willing to are you writing to the

1039
01:06:12,150 --> 01:06:16,619
second buffer all the time if so is it

1040
01:06:14,639 --> 01:06:20,489
possible to only use when you need it

1041
01:06:16,619 --> 01:06:25,259
like during trans the transitions uh so

1042
01:06:20,489 --> 01:06:28,349
yeah we could we are not writing to the

1043
01:06:25,259 --> 01:06:31,048
second buffer when we don't need it in

1044
01:06:28,349 --> 01:06:34,318
the sense that if we just don't output

1045
01:06:31,048 --> 01:06:37,380
anything to it it will never get seen so

1046
01:06:34,318 --> 01:06:41,159
what we can do if we want to and this is

1047
01:06:37,380 --> 01:06:59,910
pretty easy is in here we can just do

1048
01:06:41,159 --> 01:07:03,478
like right so this way we just do only

1049
01:06:59,909 --> 01:07:10,498
if the the Alpha is actually enabled do

1050
01:07:03,478 --> 01:07:14,218
we bother doing any of this stuff and

1051
01:07:10,498 --> 01:07:20,129
then you would never actually pay the

1052
01:07:14,219 --> 01:07:22,588
cost of it right so the only thing that

1053
01:07:20,130 --> 01:07:25,318
we have to do is and I guess I could

1054
01:07:22,588 --> 01:07:27,058
also do that right now to the only thing

1055
01:07:25,318 --> 01:07:30,420
that we have to do is not draw anything

1056
01:07:27,059 --> 01:07:34,170
that was going to have an alpha there so

1057
01:07:30,420 --> 01:07:37,528
like I guess you don't know what the

1058
01:07:34,170 --> 01:07:40,309
easiest way to do this would be probably

1059
01:07:37,528 --> 01:07:40,309
something like

1060
01:07:52,759 --> 01:07:58,708
we just want to clip these out in the

1061
01:07:56,278 --> 01:08:01,409
case where we can't see them so probably

1062
01:07:58,708 --> 01:08:06,419
like you know we we'd have something

1063
01:08:01,409 --> 01:08:11,368
called likes top-level index and we just

1064
01:08:06,420 --> 01:08:17,099
do like stop level index equals maximum

1065
01:08:11,369 --> 01:08:18,989
level index stop level index so we

1066
01:08:17,099 --> 01:08:23,219
default the saying don't draw anything

1067
01:08:18,988 --> 01:08:30,088
above that layer and then only in the

1068
01:08:23,219 --> 01:08:31,920
case oops only in the case where we

1069
01:08:30,088 --> 01:08:36,118
actually know that we're going to draw

1070
01:08:31,920 --> 01:08:38,520
those things do we bother right so then

1071
01:08:36,118 --> 01:08:40,019
you're not actually paying the cost of

1072
01:08:38,520 --> 01:08:43,349
that except when you're when you're in

1073
01:08:40,020 --> 01:08:44,790
transitions like so you can see the

1074
01:08:43,349 --> 01:08:47,940
framerate take a huge hit there right

1075
01:08:44,789 --> 01:08:49,920
but you know ideally I don't know

1076
01:08:47,939 --> 01:08:51,689
whether that's really all that great I

1077
01:08:49,920 --> 01:08:55,710
mean at the end of the day because you

1078
01:08:51,689 --> 01:08:57,448
figure I you don't want your framerate

1079
01:08:55,710 --> 01:08:58,859
to be slow at certain times so you know

1080
01:08:57,448 --> 01:09:02,568
I feel like we should make sure it's

1081
01:08:58,859 --> 01:09:06,170
just fast enough to always be doing that

1082
01:09:02,569 --> 01:09:06,170
it's neither here nor there

1083
01:09:24,578 --> 01:09:30,248
andrew has how does the limbless child

1084
01:09:27,048 --> 01:09:35,420
limp along exactly you know just really

1085
01:09:30,248 --> 01:09:37,519
powerful AB strength i think inquiry how

1086
01:09:35,420 --> 01:09:39,859
many floors can this code support i

1087
01:09:37,519 --> 01:09:41,838
envision a tall tower or stairwell

1088
01:09:39,859 --> 01:09:43,460
peering down 20 or so floriston singh

1089
01:09:41,838 --> 01:09:47,960
nbc's acting as normal was that your

1090
01:09:43,460 --> 01:09:55,069
intent well really it's gated mostly

1091
01:09:47,960 --> 01:09:59,658
just by the performance and we're not

1092
01:09:55,069 --> 01:10:00,738
like I'm never gonna have 20 floors down

1093
01:09:59,658 --> 01:10:02,478
because you wouldn't you'll be able to

1094
01:10:00,738 --> 01:10:04,578
see them that the shrinking would be

1095
01:10:02,479 --> 01:10:07,070
such that you would have to have 20

1096
01:10:04,578 --> 01:10:09,380
floors with it's the exact right shapes

1097
01:10:07,069 --> 01:10:10,868
you know going down them or whatever to

1098
01:10:09,380 --> 01:10:15,469
make that happen so we're probably that

1099
01:10:10,868 --> 01:10:17,779
six I think was the number that we were

1100
01:10:15,469 --> 01:10:19,788
using that we thought looked neat but

1101
01:10:17,779 --> 01:10:20,889
yeah it's supposed to do exactly that

1102
01:10:19,788 --> 01:10:23,328
you supposed to be able to look down

1103
01:10:20,889 --> 01:10:26,179
there and see like oh there's some stuff

1104
01:10:23,328 --> 01:10:28,399
happening down there and maybe I need to

1105
01:10:26,179 --> 01:10:30,710
go down and there and do something

1106
01:10:28,399 --> 01:10:32,179
because I see something interesting so

1107
01:10:30,710 --> 01:10:35,809
that was why we're doing all the extra

1108
01:10:32,179 --> 01:10:36,920
work to support it in a cool way I think

1109
01:10:35,809 --> 01:10:39,860
it's going to be really cool once you

1110
01:10:36,920 --> 01:10:42,649
put some art in there and clean up all

1111
01:10:39,859 --> 01:10:44,948
the rough edges because we've got a lot

1112
01:10:42,649 --> 01:10:44,948
of nice stuff

1113
01:10:55,770 --> 01:11:03,250
knut goals how do you use trace files to

1114
01:10:59,140 --> 01:11:05,650
debug someone trying my game I had a

1115
01:11:03,250 --> 01:11:07,929
crash and sent me a 95 megabyte dump

1116
01:11:05,649 --> 01:11:09,819
file since you once said it's helpful I

1117
01:11:07,929 --> 01:11:13,960
don't doubt that but what do you do with

1118
01:11:09,819 --> 01:11:16,229
the damn thing well so unfortunately the

1119
01:11:13,960 --> 01:11:18,909
answer may not be super useful to you

1120
01:11:16,229 --> 01:11:21,939
this time around but hopefully we are

1121
01:11:18,909 --> 01:11:24,250
useful next time around the answer is

1122
01:11:21,939 --> 01:11:27,369
you need to when you do a build that you

1123
01:11:24,250 --> 01:11:30,219
ship to some two people two testers you

1124
01:11:27,369 --> 01:11:35,019
need to save the PDB file and the source

1125
01:11:30,219 --> 01:11:38,140
tree at that time like off to a separate

1126
01:11:35,020 --> 01:11:40,690
directory or something and then what you

1127
01:11:38,140 --> 01:11:41,679
can do is you can actually load them I

1128
01:11:40,689 --> 01:11:43,719
don't know if there's an easy way to

1129
01:11:41,679 --> 01:11:46,179
load them in here you can load them in

1130
01:11:43,719 --> 01:11:55,869
windbg but I think you can load them in

1131
01:11:46,179 --> 01:11:57,730
here I'm not always so good with

1132
01:11:55,869 --> 01:12:00,929
developer studio but I believe you can

1133
01:11:57,729 --> 01:12:00,928
actually load them in here

1134
01:12:09,920 --> 01:12:14,010
uh let me put this way if you search on

1135
01:12:13,020 --> 01:12:14,969
the internet there should be a thing

1136
01:12:14,010 --> 01:12:16,460
that tells you how to load them in here

1137
01:12:14,969 --> 01:12:18,899
you can definitely load them in windbag

1138
01:12:16,460 --> 01:12:20,760
windbg which is a free debugger that

1139
01:12:18,899 --> 01:12:25,259
Microsoft ships for debugging crashes

1140
01:12:20,760 --> 01:12:28,079
and stuff like that but the idea is if

1141
01:12:25,260 --> 01:12:30,719
you save the PDB and all of the source

1142
01:12:28,079 --> 01:12:32,488
code you can then load the dump into the

1143
01:12:30,719 --> 01:12:38,250
debugger and see in the code where you

1144
01:12:32,488 --> 01:12:40,769
crashed and get some stack information

1145
01:12:38,250 --> 01:12:46,710
as well usually depending on what kind

1146
01:12:40,770 --> 01:12:50,580
of crash it was so in theory anyway in

1147
01:12:46,710 --> 01:12:52,889
theory you should be able to do that

1148
01:12:50,579 --> 01:12:55,500
next time if you happen to save have

1149
01:12:52,889 --> 01:12:58,889
saved the PDB and the source code from

1150
01:12:55,500 --> 01:13:02,850
when you built the XE you sent you could

1151
01:12:58,889 --> 01:13:06,590
use the one that that they sent you but

1152
01:13:02,850 --> 01:13:06,590
if not then then not really

1153
01:13:38,520 --> 01:13:49,870
alright not many questions so I think we

1154
01:13:41,529 --> 01:13:51,159
can go ahead and wrap it up alright

1155
01:13:49,869 --> 01:13:52,449
thanks everyone for joining me for

1156
01:13:51,159 --> 01:13:53,559
another episode of handmade hero it's

1157
01:13:52,449 --> 01:13:55,210
been a pleasure coding with you as

1158
01:13:53,560 --> 01:13:56,410
always if you want to follow along at

1159
01:13:55,210 --> 01:13:59,050
home you can always peer to the game on

1160
01:13:56,409 --> 01:14:00,069
handmade hero org it comes with a source

1161
01:13:59,050 --> 01:14:03,070
code so you can play around with it

1162
01:14:00,069 --> 01:14:04,239
yourself and do some experimenting we

1163
01:14:03,069 --> 01:14:05,979
also have a forum site you can go to ask

1164
01:14:04,239 --> 01:14:07,569
questions a patreon page if you want to

1165
01:14:05,979 --> 01:14:08,649
support the video series we have a

1166
01:14:07,569 --> 01:14:10,899
schedule about that'll tweet the

1167
01:14:08,649 --> 01:14:12,879
schedule at you if you would like to

1168
01:14:10,899 --> 01:14:14,439
know when we're going to be live and an

1169
01:14:12,880 --> 01:14:18,489
episode guide if you're trying to catch

1170
01:14:14,439 --> 01:14:20,559
up on old episodes that's it for today I

1171
01:14:18,489 --> 01:14:22,539
will be back here tomorrow I believe 5

1172
01:14:20,560 --> 01:14:24,280
p.m. pacific daylight time until then

1173
01:14:22,539 --> 01:14:27,630
have fun programming and i'll see you on

1174
01:14:24,279 --> 01:14:27,630
the Internet take it easy everyone

